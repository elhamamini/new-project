require.config({waitSeconds:600,map:{"*":{css:"iframe/libs/css"}}}),define("core",function(){}),define("iframe/libs/text",["module"],function(e){"use strict";var t,r,i,n,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),c=d&&location.hostname,h=d&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,r;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){r=a[t];try{e=new ActiveXObject(r)}catch(e){}if(e){a=[r];break}}return e},parseName:function(e){var t,r,i,n=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),r=e.substring(o+1,e.length)):t=e,i=r||t,o=i.indexOf("!"),-1!==o&&(n="strip"===i.substring(o+1),i=i.substring(0,o),r?r=i:t=i),{moduleName:t,ext:r,strip:n}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,r,i,n){var o,a,s,l=t.xdRegExp.exec(e);return!l||(o=l[2],a=l[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==r||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==n))},finishLoad:function(e,r,i,n){i=r?t.strip(i):i,f.isBuild&&(p[e]=i),n(i)},load:function(e,r,i,n){if(n.isBuild&&!n.inlineText)return void i();f.isBuild=n.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=r.toUrl(a),l=f.useXhr||t.useXhr;if(0===s.indexOf("empty:"))return void i();!d||l(s,u,c,h)?t.get(s,function(r){t.finishLoad(e,o.strip,r,i)},function(e){i.error&&i.error(e)}):r([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,r,i,n){if(p.hasOwnProperty(r)){var o=t.jsEscape(p[r]);i.asModule(e+"!"+r,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,r,i,n,o){var a=t.parseName(r),s=a.ext?"."+a.ext:"",l=a.moduleName+s,d=i.toUrl(a.moduleName+s)+".js";t.load(l,i,function(r){var i=function(e){return n(d,e)};i.asModule=function(e,t){return n.asModule(e,d,t)},t.write(e,l,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(r=require.nodeRequire("fs"),t.get=function(e,t,i){try{var n=r.readFileSync(e,"utf8");0===n.indexOf("\ufeff")&&(n=n.substring(1)),t(n)}catch(e){i(e)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,r,i,n){var o,a=t.createXhr();if(a.open("GET",e,!0),n)for(o in n)n.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),n[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(t){var n,o;4===a.readyState&&(n=a.status,n>399&&n<600?(o=new Error(e+" HTTP status: "+n),o.xhr=a,i(o)):r(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var r,i,n=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),s="";try{for(r=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&r.append(i);null!==(i=a.readLine());)r.append(o),r.append(i);s=String(r.toString())}finally{a.close()}t(s)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,n=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var r,a,s,l={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{r=i["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream),r.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream),a.init(r,"utf-8",r.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(r.available(),l),a.close(),r.close(),t(l.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),t}),define("iframe/libs/css",[],function(){if("undefined"==typeof window)return{load:function(e,t,r){r()}};var e=document.getElementsByTagName("head")[0],t=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)/)||0,r=!1,i=!0;t[1]||t[7]?r=parseInt(t[1])<6||parseInt(t[7])<=9:t[2]?i=!1:t[4]&&(r=parseInt(t[4])<18);var n={};n.pluginBuilder="./css-builder";var o,a,s,l=function(){o=document.createElement("style"),e.appendChild(o),a=o.styleSheet||o.sheet},d=0,u=[],c=function(e){d++,32==d&&(l(),d=0),a.addImport(e),o.onload=h},h=function(){s();var e=u.shift();if(!e)return void(s=null);s=e[1],c(e[0])},p=function(e,t){if(a&&a.addImport||l(),a&&a.addImport)s?u.push([e,t]):(c(e),s=t);else{o.textContent='@import "'+e+'";';var r=setInterval(function(){try{o.sheet.cssRules,clearInterval(r),t()}catch(e){}},10)}},f=function(t,r){var n=document.createElement("link");if(n.type="text/css",n.rel="stylesheet",i)n.onload=function(){n.onload=function(){},setTimeout(r,7)};else var o=setInterval(function(){for(var e=0;e<document.styleSheets.length;e++){if(document.styleSheets[e].href==n.href)return clearInterval(o),r()}},10);n.href=t,e.appendChild(n)};return n.normalize=function(e,t){return".css"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)},n.load=function(e,t,i,n){(r?p:f)(t.toUrl(e+".css"),i)},n}),define("vastvmap",[],function(){function e(e,t,r,i){var n=ZeusUtils.substituteMacros(e);LOG.debug("[Bolt3 vastvmap] URL after substitution: "+n),window.postLogMessage("URL after substitution "+n);var o=function(e){var i=new DOMParser,n=i.parseFromString(e,"application/xml");n.getElementsByTagName("Ad").length?r(n,t):(LOG.error("[Bolt3 vastvmap] Empty VAST",n),window.postLogMessage("Empty VAST XML","error"),BoltAdManager.selectedServer.isSpotxRaw?BoltAdManager._fail():a())},a=function(){i()};ZeusUtils.xhr(n,"get",null,o,a)}function t(t,r,i){var o=function(e){try{BoltAdManager.triedCampaigns.push(e)}catch(e){LOG.error("[VASTMap] - SpotX Raw::Couldn't add spotx campaign to tried stack.")}};LOG.debug("[Bolt3 vastvmap] fetching "+t),window.postLogMessage("Fetching "+t),e(t,null,function(e){BoltAdManager.selectedServer.isSpotxRaw&&o(BoltAdManager.getSpotxCampaignIdRemoveExtra(e.getElementsByTagName("Ad")[0].id)),new n(e,r,i)},function(){LOG.error("[Bolt3 vastvmap] Failed to load VAST from '"+t+"':"),window.postLogMessage("Failed to load VAST from '"+t,"error"),r(null)})}function r(e,t){if(this.events={},this.ad=t,null!==e){if("TrackingEvents"!==e.tagName&&"vmap:TrackingEvents"!==e.tagName){if(e=e.getElementsByTagName("TrackingEvents"),1!==e.length)return;e=e.item(0)}var r=e.getElementsByTagName("Tracking");0===r.length&&(r=e.getElementsByTagNameNS("*","Tracking"));for(var i=0;i<r.length;i++){var n=r[i].getAttribute("event");if(n){var o=null;"progress"===n&&(o=r[i].getAttribute("offset"),n+="-"+o),this.events[n]=this.events[n]||[];var a={url:r[i].textContent.replace(/\s/g,""),offset:o,event:n};this.events[n].push(a)}}}}function i(i,o,a){this.breaks=[];var s=this;e(i,null,function(e){for(var i=e.getElementsByTagName("AdBreak"),l=[],d=0;d<i.length;d++){var u=i.item(d),c=u.getAttribute("timeOffset");if(0!==c.indexOf("#")){var h={ad:null,breakId:u.getAttribute("breakId"),tracking:new r(u,null),position:c},p=o.bind(s,s.breaks.length,c),f=u.getElementsByTagName("VASTData");if(f)h.ad=new n(f.item(0).getElementByTagName(null,"VAST").item(0),p);else{var g=u.getElementsByTagName("AdTagURI");if(!g){LOG.error("[Bolt3 vastvmap] No supported ad target for break #"+d);continue}var v;!function(e){v=function(t){e.ad=t,null!==t&&p(t)}}(h),t(g.item(0).textContent.replace(/\s/g,""),v)}s.breaks.push(h),l.push(h.position)}}"function"==typeof a&&a(l)},function(e){LOG.error("[Bolt3 vastvmap] Failed to load VMAP from '"+i+"':",e),a([])})}function n(e,r,i){var n=e.getElementsByTagName("Ad");if(void 0===n||0===n.length)LOG.error("[Bolt3 vastvmap] No Ads found in ",(new XMLSerializer).serializeToString(e)),r&&r.call(null);else{this.ads=[],this.onAdsAvailable=r,this.id=void 0!==e.getElementsByTagName("Ad")[0]?e.getElementsByTagName("Ad")[0].getAttribute("id"):null;for(var a=e.getElementsByTagName("Ad"),s=0;s<a.length;s++){var l=new o(this,a.item(s),i||null);if(!l.isEmpty()){var d=e.getElementsByTagName("Price");try{d=d.length>0&&"CPM"===d[0].getAttribute("model").toUpperCase()?parseFloat(d[0].textContent)||0:null}catch(e){d=null}if(this.ads.push(l),!l.hasData()||l.hasSequence()&&!l.isNumber(1)){var u=this,c=a.item(s).getElementsByTagName("Wrapper").item(0),h=c.getElementsByTagName("VASTAdTagURI");if(0===h.length)continue;h=h.item(0).textContent.replace(/\s/g,""),n[0].getAttribute("spxRaw")&&"true"===n[0].getAttribute("spxRaw")&&(h=this.appendToSpotxRawTag(h));try{h=ZeusUtils.substituteMacros(h)}catch(e){}BoltAdManager.thirdPartyTag&&(BoltAdManager.thirdPartyTag=h);var p,f="true"===c.getAttribute("allowMultipleAds");!function(e,t,r){p=function(i){if(e.onLoaded(i,t),r.onAdsAvailable){var n=r.onAdsAvailable;r.onAdsAvailable=null,n.call(r,r,d)}}}(l,f,u),t(h,r,l)}else if(r){var g=this.onAdsAvailable;this.onAdsAvailable=null;try{g.call(this,this,d)}catch(e){}}}}}}function o(e,t,i,n){this.vast=e,this.pod=e,this.parentAd=i,this.onAdAvailable=n,this.sequence=null,this.hasContent=!0,this.loaded=!0,this.linear=null,this.companions=[],this.companionsRequired="none",this.nonlinears=[],this.nonlinearsTracking=null,this.impressions=[],this.currentPodAd=this,this.sentImpression=!1,this.properties={};var o,a;if(null!==this.parentAd){var l=this.parentAd;if(this.companionsRequired=l.companionsRequired,this.linear=l.linear?l.linear.copy(this):null,l.companions.length)for(o=0;o<l.companions.length;o++)this.companions.push(l.companions[o].copy(this));if(l.nonlinears.length)for(o=0;o<l.nonlinears.length;o++)this.companions.push(l.nonlinears[o].copy(this));null!==l.nonlinearsTracking&&(this.nonlinearsTracking=l.nonlinearsTracking.copy(this));for(a in l.properties)l.properties.hasOwnProperty(a)&&(this.properties[a]=l.properties[a])}null===this.nonlinearsTracking&&(this.nonlinearsTracking=new r(null,this)),t.hasAttribute("sequence")&&(this.sequence=parseInt(t.getAttribute("sequence"),10));var d=t.getElementsByTagName("InLine");if(0===d.length&&(this.loaded=!1,d=t.getElementsByTagName("Wrapper"),0===d.length))return void(this.hasContent=!1);d=d.item(0);for(var h=d.firstChild;null!==h;){if(1===h.nodeType)switch(h.tagName){case"Creatives":case"InLine":case"Wrapper":case"Impression":case"VASTAdTagURI":case"Error":break;default:this.properties[h.tagName]=h.textContent.replace(/^\s*|\s*$/g,"")}h=h.nextSibling}var p=d.getElementsByTagName("Impression");for(o=0;o<p.length;o++){var f=p.item(o).textContent.replace(/\s/g,"");0!==f.length&&(LOG.debug("[Bolt3 vastvmap] VAST impression "+f),-1===this.impressions.indexOf(f)?this.impressions.push(f):LOG.info("[Bolt3 vastvmap] skipping impression because it's a duplicate"))}LOG.debug("[Bolt3 vastvmap] IMPRESSIONS",this.impressions,"length ",this.impressions.length);var g=d.getElementsByTagName("Creatives");if(0!==g.length)for(g=g.item(0).getElementsByTagName("Creative"),o=0;o<g.length;o++){for(var v=g.item(o).firstChild;null!==v&&3===v.nodeType;)v=v.nextSibling;if(null!==v){var m;switch(v.tagName){case"Linear":m=new s(this,v),this.linear?(this.linear=c(this,m),null!==this.parentAd&&this.linear.tracking.augment(this.parentAd.linear.tracking)):this.linear=m;break;case"NonLinearAds":var y=v.tagName.replace("Ads","");if("NonLinear"===y){var _=new r(v,this);this.nonlinearsTracking.augment(_)}for(var b=v.getElementsByTagName(y),E=0;E<b.length;E++)m=new u(this,b.item(E)),this.nonlinears=c(this,m)}}}}function a(e,t){this.root=t,this.clickThrough=null,"NonLinear"===t.tagName&&(t=t.parentNode),this.tracking=new r(t,e)}function s(e,t){a.call(this,e,t),this.mediaFiles=[],this.clickThrough=null,this.duration=null;var r,i=t.getElementsByTagName("VideoClicks");if(i.length){i=i.item(0);var n=i.getElementsByTagName("ClickThrough");for(n.length&&(this.clickThrough=n.item(0).textContent.replace(/\s/g,"")),n=i.getElementsByTagName("ClickTracking"),r=0;r<n.length;r++)this.tracking.addClickTracking(n.item(r).textContent.replace(/\s/g,""))}var o=t.getElementsByTagName("Duration");o.length&&(this.duration=this.timecodeFromString(o.item(0).textContent.replace(/\s/g,"")));var s=t.getElementsByTagName("MediaFiles");if(s.length){for(s=s.item(0).getElementsByTagName("MediaFile"),r=0;r<s.length;r++){for(var l=s.item(r),d={},u=0;u<l.attributes.length;u++)d[l.attributes[u].name]=l.attributes[u].value;d.src=s.item(r).textContent.replace(/\s/g,""),this.mediaFiles.push(d)}this.parameters=null,t.getElementsByTagName("AdParameters").length>0&&(this.parameters=t.getElementsByTagName("AdParameters")[0].textContent,window.site.isSecure&&(LOG.info("[Bolt3 vastvmap] Normalizing all protocols in AdParameters"),LOG.info("[Bolt3 vastvmap] Ad Parameters BEFORE normalisation:",this.parameters.concat()),this.parameters=this.parameters.replace(/http:/gi,"https:").replace(/http%3A/gi,"https%3A"),LOG.info("[Bolt3 vastvmap] Ad Parameters AFTER normalisation:",this.parameters)))}}function l(e,t){a.call(this,e,t),this.resources={iframe:null,html:null,images:{}};var r;r=t.getElementsByTagName("IFrameResource"),r.length>0&&(this.resources.iframe=r.item(0).textContent.replace(/\s/g,"")),r=t.getElementsByTagName("HTMLResource"),r.length>0&&(this.resources.html=r.item(0).textContent.replace(/\s/g,"")),r=t.getElementsByTagName("StaticResource");for(var i=0;i<r.length;i++)this.resources.images[r.item(i).getAttribute("creativeType")]=r.item(i).textContent.replace(/\s/g,"")}function d(e,t){l.call(this,e,t),this.altText="",l.prototype.extractClicks.call(this,"Companion");var r=t.getElementsByTagName("AltText");r.length&&(this.altText=r.item(0).textContent.replace(/\s/g,""))}function u(e,t){l.call(this,e,t),this.tracking=e.nonlinearsTracking,l.prototype.extractClicks.call(this,"NonLinear")}function c(e,t){for(var r in t)try{t[r].constructor==Object?e[r]=c(e[r],t[r]):e[r]=t[r]}catch(i){e[r]=t[r]}return e}r.prototype.copy=function(e){var t=Object.create(r.prototype);t.events={};for(var i in this.events)this.events.hasOwnProperty(i)&&(t.events[i]=[].concat(this.events[i]));return t.ad=e,t},r.prototype.finger=function(e,t){var r=ZeusUtils.substituteMacros(e),i=document.getElementById("bolt_trackingpixels"),n=ZeusUtils.normalizeProtocol(r),o=document.createElement("img");o.setAttribute("style","position:absolute;bottom:0;left:0;visibility:hidden"),o.src=n,i.appendChild(o),LOG.info("[Bolt3 vastvmap] Image tracking pixel loaded: "+r)},r.prototype.augment=function(e){for(var t in e.events)e.events.hasOwnProperty(t)&&(this.events[t]?this.events[t]=this.events[t].concat(e.events[t]):this.events[t]=e.events[t])},r.prototype.addClickTracking=function(e){var t={url:e,event:"click",offset:null};this.events.click?this.events.click.push(t):this.events.click=[t]},r.prototype.getEventsOfTypes=function(e){var t=[],r=e.indexOf("progress")>-1;for(var i in this.events)this.events.hasOwnProperty(i)&&(e.indexOf(i)>-1||r&&0===i.indexOf("progress-"))&&(t=t.concat(this.events[i]));return t},r.prototype.track=function(e,t){if(this.events[e]&&0!==this.events[e].length){t||(t={});var r,i=[].concat(this.events[e]);for(var n in t)t.hasOwnProperty(n)&&(t["["+n+"]"]=encodeURIComponent(t[n]),delete t[n]);var o=this;for(r=0;r<i.length;r++){for(var a=i[r],s=a.url,l=""+parseInt(99999999*Math.random(),10);8!==l.length;)l="0"+l;t["[CACHEBUSTING]"]=l;for(n in t)t.hasOwnProperty(n)&&(s=s.replace(n,t[n]));""!==s&&"about:blank"!==s&&(LOG.debug("[Bolt3 vastvmap] tracking",e,s),o.finger(s,e))}}},r.prototype.trackImpressions=function(){LOG.debug("[Bolt3 vastvmap] tracking impressions for ad");for(var e,t,r=this.ad;null!==r&&!r.hasSentImpression();){for(r.impressionSent(),e=0;e<r.impressions.length;e++)""!==(t=r.impressions[e])&&"about:blank"!==t&&(LOG.debug("[Bolt3 vastvmap] track impression",t),this.finger(t,"impression"));LOG.debug("[Bolt3 vastvmap] backtracking to parent ad, if any"),r=r.parentAd}},i.prototype.onBreakStart=function(e){return this.breaks[e].tracking.track("breakStart"),this.breaks[e].ad},i.prototype.onBreakEnd=function(e){this.breaks[e].tracking.track("breakEnd")},n.prototype.appendToSpotxRawTag=function(e){if(BoltAdManager.selectedServer.isSpotxRaw=!0,BoltAdManager.selectedServer&&BoltAdManager.selectedServer._getSpotxChannelId()){var t="search.spotxchange.com/vast/",r=t.length+4,i=e.substring(e.indexOf(t)+r,e.indexOf(t)+r+6);e=e.replace(i,BoltAdManager.selectedServer._getSpotxChannelId())}return e+="?VPAID=js&custom_skin=1&content_page_url=__WEB_URL__&player_width=__WIDTH__&player_height=__HEIGHT__",client.hasFlash&&(e+="&allow_flash_creative=true"),!1!==CurrentVideoConfig.settings.autoplay&&(e+="&ad_volume=0"),LOG.debug("[VASTMap] - Using SpotX [Raw] tag",e),window.postLogMessage("[VASTMap] - Using SpotX Raw tag"),e},n.prototype.getAd=function(e){var t=null;if(e&&(t=this.getAdWithSequence(1))&&!t.current().isEmpty())return t.current();for(var r=0;r<this.ads.length;r++)if(!this.ads[r].hasSequence()&&!this.ads[r].current().isEmpty())return this.ads[r].current()},n.prototype.getAdWithSequence=function(e){for(var t=0;t<this.ads.length;t++)if(this.ads[t].isNumber(e))return this.ads[t];return null},o.prototype.getTag=function(e,t){return this.properties.hasOwnProperty(e)?this.properties[e]:t},o.prototype.onLoaded=function(e,t){this.pod=e,this.currentPodAd=e.getAd(t),this.currentPodAd.isEmpty()||(this.loaded=!0,this.onAdAvailable&&this.onAdAvailable.call(this,this))},o.prototype.hasSentImpression=function(){return this.sentImpression},o.prototype.impressionSent=function(){this.sentImpression=!0},o.prototype.current=function(){return this.currentPodAd},o.prototype.isNumber=function(e){return this.sequence===e},o.prototype.hasSequence=function(){return null!==this.sequence},o.prototype.isEmpty=function(){return!this.hasContent},o.prototype.hasData=function(){return this.loaded},o.prototype.getNextAd=function(){return this.vast!==this.pod&&(this.currentPodAd=this.currentPodAd.getNextAd(),null!==this.currentPod)?this.currentPodAd.current():this.hasSequence()?this.vast.getAdWithSequence(this.sequence+1).current():null},o.prototype.getLinear=function(){return this.linear},o.prototype.getCompanions=function(){return this.companions},o.prototype.getCompanion=function(e){for(var t=0;t<this.companions.length;t++)if(this.companions[t].attribute("id")===e)return this.companions[t];return null},o.prototype.companionsRequired=function(){return this.companionsRequired},o.prototype.getNonLinears=function(){return this.nonlinears},a.prototype.track=function(e,t,r){this.tracking.track(e,{CONTENTPLAYHEAD:this.timecodeToString(t),ASSETURI:r})},a.prototype.trackImpressions=function(e){this.tracking.trackImpressions()},a.prototype.timecodeToString=function(e){return("0"+parseInt(e/3600,10)+":0"+parseInt(e%3600/60,10)+":0"+e%60).replace(/(^|:|\.)0(\d{2})/g,"$1$2")},a.prototype.timecodeFromString=function(e){return-1===e.indexOf(":")?e:3600*parseInt(e.substr(0,2),10)+60*parseInt(e.substr(3,2),10)+parseInt(e.substr(6,2),10)},a.prototype.getClickThrough=function(){return this.clickThrough},a.prototype.attribute=function(e,t){if(!this.root.hasAttribute(e))return t;var r=this.root.getAttribute(e);switch(e){case"skipoffset":case"duration":case"offset":case"minSuggestedDuration":r=this.timecodeFromString(r)}return r},s.prototype=Object.create(a.prototype),s.prototype.getDuration=function(){return this.duration},s.prototype.copy=function(e){return new s(e,this.root)},s.prototype.augment=function(e){this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough},s.prototype.getAllMedias=function(){return this.mediaFiles},s.prototype.getAllMediaAsObject=function(){var e;return this.mediaFiles&&this.mediaFiles.forEach(function(t){e||(e={}),e[t.type]=t}),e},s.prototype.getBestMedia=function(e){for(var t=Number.POSITIVE_INFINITY,r=-1,i=0;i<this.mediaFiles.length;i++){var n=this.mediaFiles[i],o=Math.sqrt(Math.pow(e.width-n.width,2)+Math.pow(e.height-n.height,2));if(o<t)t=o,r=i;else if(o===t){var a=this.mediaFiles[r],s=a.bitrate||a.maxBitrate,l=n.bitrate||n.maxBitrate;l&&!s?r=i:e.bitrate&&s&&l?Math.abs(l-e.bitrate)<Math.abs(s-e.bitrate)&&(r=i):l>s&&(r=i)}}return-1===r?null:this.mediaFiles[r]};var h=["start","firstQuartile","midpoint","thirdQuartile","complete","progress"];return s.prototype.getTrackingPoints=function(){for(var e=this.tracking.getEventsOfTypes(h),t=[],r=0;r<e.length;r++){var i={event:e[r].event,offset:null};switch(e[r].event){case"start":i.offset="start";break;case"firstQuartile":i.offset="25%";break;case"midpoint":i.offset="50%";break;case"thirdQuartile":i.offset="75%";break;case"complete":i.offset="end";break;default:var n=e[r].offset;if(!n)continue;i.offset=a.prototype.timecodeFromString(n)}t.push(i)}return t},l.prototype=Object.create(a.prototype),l.prototype.augment=function(e){this.tracking.augment(e.tracking),this.clickThrough=e.clickThrough||this.clickThrough,this.resources.iframe=e.resources.iframe||this.resources.iframe,this.resources.html=e.resources.html||this.resources.html;for(var t in e.resources.images)e.resources.images.hasOwnProperty(t)&&(this.resources.images[t]=e.resources.images[t])},l.prototype.getAllResources=function(){return this.resources},l.prototype.extractClicks=function(e){var t;t=this.root.getElementsByTagName(e+"ClickThrough"),t.length&&(this.clickThrough=t.item(0).textContent.replace(/\s/g,"")),t=this.root.getElementsByTagName(e+"ClickTracking"),t.length&&this.tracking.addClickTracking(t.item(0).textContent.replace(/\s/g,""))},d.prototype=Object.create(l.prototype),d.prototype.copy=function(e){return new d(e,this.root)},d.prototype.augment=function(e){l.prototype.augment.call(this,e),this.altText=e.altText||this.altText},d.prototype.getAltText=function(){return this.altText},u.prototype=Object.create(l.prototype),u.prototype.augment=function(e){l.prototype.augment.call(this,e)},u.prototype.copy=function(e){return new u(e,this.root)},{fetchXML:e,queryVAST:t,VASTAds:n,TrackingEvents:r}}),function(e,t,r){_xamzrequire=function(){function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return n(t[a][1][e]||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}return e}()({38:[function(e,t,r){var i={util:e("./util")};({}).toString(),t.exports=i,i.util.update(i,{VERSION:"2.252.1",Signers:{},Protocol:{Json:e("./protocol/json"),Query:e("./protocol/query"),Rest:e("./protocol/rest"),RestJson:e("./protocol/rest_json"),RestXml:e("./protocol/rest_xml")},XML:{Builder:e("./xml/builder"),Parser:null},JSON:{Builder:e("./json/builder"),Parser:e("./json/parser")},Model:{Api:e("./model/api"),Operation:e("./model/operation"),Shape:e("./model/shape"),Paginator:e("./model/paginator"),ResourceWaiter:e("./model/resource_waiter")},apiLoader:e("./api_loader")}),e("./service"),e("./config"),e("./http"),e("./sequential_executor"),e("./event_listeners"),e("./request"),e("./response"),e("./resource_waiter"),e("./signers/request_signer"),e("./param_validator"),i.events=new i.SequentialExecutor},{"./api_loader":27,"./config":37,"./event_listeners":51,"./http":52,"./json/builder":54,"./json/parser":55,"./model/api":56,"./model/operation":58,"./model/paginator":59,"./model/resource_waiter":60,"./model/shape":61,"./param_validator":62,"./protocol/json":64,"./protocol/query":65,"./protocol/rest":66,"./protocol/rest_json":67,"./protocol/rest_xml":68,"./request":73,"./resource_waiter":74,"./response":75,"./sequential_executor":77,"./service":78,"./signers/request_signer":97,"./util":105,"./xml/builder":107}],107:[function(e,t,r){function i(){}function n(e,t,r){switch(r.type){case"structure":return o(e,t,r);case"map":return a(e,t,r);case"list":return s(e,t,r);default:return l(e,t,r)}}function o(e,t,r){u.arrayEach(r.memberNames,function(i){var o=r.members[i];if("body"===o.location){var a=t[i],s=o.name;if(void 0!==a&&null!==a)if(o.isXmlAttribute)e.addAttribute(s,a);else if(o.flattened)n(e,a,o);else{var l=new c(s);e.addChildNode(l),d(l,o),n(l,a,o)}}})}function a(e,t,r){var i=r.key.name||"key",o=r.value.name||"value";u.each(t,function(t,a){var s=new c(r.flattened?r.name:"entry");e.addChildNode(s);var l=new c(i),d=new c(o);s.addChildNode(l),s.addChildNode(d),n(l,t,r.key),n(d,a,r.value)})}function s(e,t,r){r.flattened?u.arrayEach(t,function(t){var i=r.member.name||r.name,o=new c(i);e.addChildNode(o),n(o,t,r.member)}):u.arrayEach(t,function(t){var i=r.member.name||"member",o=new c(i);e.addChildNode(o),n(o,t,r.member)})}function l(e,t,r){e.addChildNode(new h(r.toWireFormat(t)))}function d(e,t,r){var i,n="xmlns";t.xmlNamespaceUri?(i=t.xmlNamespaceUri,t.xmlNamespacePrefix&&(n+=":"+t.xmlNamespacePrefix)):r&&t.api.xmlNamespaceUri&&(i=t.api.xmlNamespaceUri),i&&e.addAttribute(n,i)}var u=e("../util"),c=e("./xml-node").XmlNode,h=e("./xml-text").XmlText;i.prototype.toXML=function(e,t,r,i){var o=new c(r);return d(o,t,!0),n(o,e,t),o.children.length>0||i?o.toString():""},t.exports=i},{"../util":105,"./xml-node":110,"./xml-text":111}],111:[function(e,t,r){function i(e){this.value=e}var n=e("./escape-element").escapeElement;i.prototype.toString=function(){return n(""+this.value)},t.exports={XmlText:i}},{"./escape-element":109}],109:[function(e,t,r){function i(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}t.exports={escapeElement:i}},{}],110:[function(e,t,r){function i(e,t){void 0===t&&(t=[]),this.name=e,this.children=t,this.attributes={}}var n=e("./escape-attribute").escapeAttribute;i.prototype.addAttribute=function(e,t){return this.attributes[e]=t,this},i.prototype.addChildNode=function(e){return this.children.push(e),this},i.prototype.removeAttribute=function(e){return delete this.attributes[e],this},i.prototype.toString=function(){for(var e=Boolean(this.children.length),t="<"+this.name,r=this.attributes,i=0,o=Object.keys(r);i<o.length;i++){var a=o[i],s=r[a];void 0!==s&&null!==s&&(t+=" "+a+'="'+n(""+s)+'"')}return t+=e?">"+this.children.map(function(e){return e.toString()}).join("")+"</"+this.name+">":"/>"},t.exports={XmlNode:i}},{"./escape-attribute":108}],108:[function(e,t,r){function i(e){return e.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}t.exports={escapeAttribute:i}},{}],97:[function(e,t,r){var i=e("../core"),n=i.util.inherit;i.Signers.RequestSigner=n({constructor:function(e){this.request=e},setServiceClientId:function(e){this.serviceClientId=e},getServiceClientId:function(){return this.serviceClientId}}),i.Signers.RequestSigner.getVersion=function(e){switch(e){case"v2":return i.Signers.V2;case"v3":return i.Signers.V3;case"v4":return i.Signers.V4;case"s3":return i.Signers.S3;case"v3https":return i.Signers.V3Https}throw new Error("Unknown signing version "+e)},e("./v2"),e("./v3"),e("./v3https"),e("./v4"),e("./s3"),e("./presign")},{"../core":38,"./presign":96,"./s3":98,"./v2":99,"./v3":100,"./v3https":101,"./v4":102}],102:[function(e,t,r){var i=e("../core"),n=e("./v4_credentials"),o=i.util.inherit;i.Signers.V4=o(i.Signers.RequestSigner,{constructor:function(e,t,r){i.Signers.RequestSigner.call(this,e),this.serviceName=t,r=r||{},this.signatureCache="boolean"!=typeof r.signatureCache||r.signatureCache,this.operation=r.operation},algorithm:"AWS4-HMAC-SHA256",addAuthorization:function(e,t){var r=i.util.date.iso8601(t).replace(/[:\-]|\.\d{3}/g,"");this.isPresigned()?this.updateForPresigned(e,r):this.addHeaders(e,r),this.request.headers.Authorization=this.authorization(e,r)},addHeaders:function(e,t){this.request.headers["X-Amz-Date"]=t,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken)},updateForPresigned:function(e,t){var r=this.credentialString(t),n={"X-Amz-Date":t,"X-Amz-Algorithm":this.algorithm,"X-Amz-Credential":e.accessKeyId+"/"+r,"X-Amz-Expires":this.request.headers["presigned-expires"],"X-Amz-SignedHeaders":this.signedHeaders()};e.sessionToken&&(n["X-Amz-Security-Token"]=e.sessionToken),this.request.headers["Content-Type"]&&(n["Content-Type"]=this.request.headers["Content-Type"]),this.request.headers["Content-MD5"]&&(n["Content-MD5"]=this.request.headers["Content-MD5"]),this.request.headers["Cache-Control"]&&(n["Cache-Control"]=this.request.headers["Cache-Control"]),i.util.each.call(this,this.request.headers,function(e,t){if("presigned-expires"!==e&&this.isSignableHeader(e)){var r=e.toLowerCase();0===r.indexOf("x-amz-meta-")?n[r]=t:0===r.indexOf("x-amz-")&&(n[e]=t)}});var o=this.request.path.indexOf("?")>=0?"&":"?";this.request.path+=o+i.util.queryParamsToString(n)},authorization:function(e,t){var r=[],i=this.credentialString(t);return r.push(this.algorithm+" Credential="+e.accessKeyId+"/"+i),r.push("SignedHeaders="+this.signedHeaders()),r.push("Signature="+this.signature(e,t)),r.join(", ")},signature:function(e,t){var r=n.getSigningKey(e,t.substr(0,8),this.request.region,this.serviceName,this.signatureCache);return i.util.crypto.hmac(r,this.stringToSign(t),"hex")},stringToSign:function(e){var t=[];return t.push("AWS4-HMAC-SHA256"),t.push(e),t.push(this.credentialString(e)),t.push(this.hexEncodedHash(this.canonicalString())),t.join("\n")},canonicalString:function(){var e=[],t=this.request.pathname();return"s3"!==this.serviceName&&(t=i.util.uriEscapePath(t)),e.push(this.request.method),e.push(t),e.push(this.request.search()),e.push(this.canonicalHeaders()+"\n"),e.push(this.signedHeaders()),e.push(this.hexEncodedBodyHash()),e.join("\n")},canonicalHeaders:function(){var e=[];i.util.each.call(this,this.request.headers,function(t,r){e.push([t,r])}),e.sort(function(e,t){return e[0].toLowerCase()<t[0].toLowerCase()?-1:1});var t=[];return i.util.arrayEach.call(this,e,function(e){var r=e[0].toLowerCase();if(this.isSignableHeader(r)){var n=e[1];if(void 0===n||null===n||"function"!=typeof n.toString)throw i.util.error(new Error("Header "+r+" contains invalid value"),{code:"InvalidHeader"});t.push(r+":"+this.canonicalHeaderValues(n.toString()))}}),t.join("\n")},canonicalHeaderValues:function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},signedHeaders:function(){var e=[];return i.util.each.call(this,this.request.headers,function(t){t=t.toLowerCase(),this.isSignableHeader(t)&&e.push(t)}),e.sort().join(";")},credentialString:function(e){return n.createScope(e.substr(0,8),this.request.region,this.serviceName)},hexEncodedHash:function(e){return i.util.crypto.sha256(e,"hex")},hexEncodedBodyHash:function(){var e=this.request;return this.isPresigned()&&"s3"===this.serviceName&&!e.body?"UNSIGNED-PAYLOAD":e.headers["X-Amz-Content-Sha256"]?e.headers["X-Amz-Content-Sha256"]:this.hexEncodedHash(this.request.body||"")},unsignableHeaders:["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id"],isSignableHeader:function(e){return 0===e.toLowerCase().indexOf("x-amz-")||this.unsignableHeaders.indexOf(e)<0},isPresigned:function(){return!!this.request.headers["presigned-expires"]}}),t.exports=i.Signers.V4},{"../core":38,"./v4_credentials":103}],103:[function(e,t,r){var i=e("../core"),n={},o=[];t.exports={createScope:function(e,t,r){return[e.substr(0,8),t,r,"aws4_request"].join("/")},getSigningKey:function(e,t,r,a,s){
var l=i.util.crypto.hmac(e.secretAccessKey,e.accessKeyId,"base64"),d=[l,t,r,a].join("_");if((s=!1!==s)&&d in n)return n[d];var u=i.util.crypto.hmac("AWS4"+e.secretAccessKey,t,"buffer"),c=i.util.crypto.hmac(u,r,"buffer"),h=i.util.crypto.hmac(c,a,"buffer"),p=i.util.crypto.hmac(h,"aws4_request","buffer");return s&&(n[d]=p,o.push(d),o.length>50&&delete n[o.shift()]),p},emptyCache:function(){n={},o=[]}}},{"../core":38}],101:[function(e,t,r){var i=e("../core"),n=i.util.inherit;e("./v3"),i.Signers.V3Https=n(i.Signers.V3,{authorization:function(e){return"AWS3-HTTPS AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,Signature="+this.signature(e)},stringToSign:function(){return this.request.headers["X-Amz-Date"]}}),t.exports=i.Signers.V3Https},{"../core":38,"./v3":100}],100:[function(e,t,r){var i=e("../core"),n=i.util.inherit;i.Signers.V3=n(i.Signers.RequestSigner,{addAuthorization:function(e,t){var r=i.util.date.rfc822(t);this.request.headers["X-Amz-Date"]=r,e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken),this.request.headers["X-Amzn-Authorization"]=this.authorization(e,r)},authorization:function(e){return"AWS3 AWSAccessKeyId="+e.accessKeyId+",Algorithm=HmacSHA256,SignedHeaders="+this.signedHeaders()+",Signature="+this.signature(e)},signedHeaders:function(){var e=[];return i.util.arrayEach(this.headersToSign(),function(t){e.push(t.toLowerCase())}),e.sort().join(";")},canonicalHeaders:function(){var e=this.request.headers,t=[];return i.util.arrayEach(this.headersToSign(),function(r){t.push(r.toLowerCase().trim()+":"+String(e[r]).trim())}),t.sort().join("\n")+"\n"},headersToSign:function(){var e=[];return i.util.each(this.request.headers,function(t){("Host"===t||"Content-Encoding"===t||t.match(/^X-Amz/i))&&e.push(t)}),e},signature:function(e){return i.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push("/"),e.push(""),e.push(this.canonicalHeaders()),e.push(this.request.body),i.util.crypto.sha256(e.join("\n"))}}),t.exports=i.Signers.V3},{"../core":38}],99:[function(e,t,r){var i=e("../core"),n=i.util.inherit;i.Signers.V2=n(i.Signers.RequestSigner,{addAuthorization:function(e,t){t||(t=i.util.date.getDate());var r=this.request;r.params.Timestamp=i.util.date.iso8601(t),r.params.SignatureVersion="2",r.params.SignatureMethod="HmacSHA256",r.params.AWSAccessKeyId=e.accessKeyId,e.sessionToken&&(r.params.SecurityToken=e.sessionToken),delete r.params.Signature,r.params.Signature=this.signature(e),r.body=i.util.queryParamsToString(r.params),r.headers["Content-Length"]=r.body.length},signature:function(e){return i.util.crypto.hmac(e.secretAccessKey,this.stringToSign(),"base64")},stringToSign:function(){var e=[];return e.push(this.request.method),e.push(this.request.endpoint.host.toLowerCase()),e.push(this.request.pathname()),e.push(i.util.queryParamsToString(this.request.params)),e.join("\n")}}),t.exports=i.Signers.V2},{"../core":38}],98:[function(e,t,r){var i=e("../core"),n=i.util.inherit;i.Signers.S3=n(i.Signers.RequestSigner,{subResources:{acl:1,accelerate:1,analytics:1,cors:1,lifecycle:1,delete:1,inventory:1,location:1,logging:1,metrics:1,notification:1,partNumber:1,policy:1,requestPayment:1,replication:1,restore:1,tagging:1,torrent:1,uploadId:1,uploads:1,versionId:1,versioning:1,versions:1,website:1},responseHeaders:{"response-content-type":1,"response-content-language":1,"response-expires":1,"response-cache-control":1,"response-content-disposition":1,"response-content-encoding":1},addAuthorization:function(e,t){this.request.headers["presigned-expires"]||(this.request.headers["X-Amz-Date"]=i.util.date.rfc822(t)),e.sessionToken&&(this.request.headers["x-amz-security-token"]=e.sessionToken);var r=this.sign(e.secretAccessKey,this.stringToSign()),n="AWS "+e.accessKeyId+":"+r;this.request.headers.Authorization=n},stringToSign:function(){var e=this.request,t=[];t.push(e.method),t.push(e.headers["Content-MD5"]||""),t.push(e.headers["Content-Type"]||""),t.push(e.headers["presigned-expires"]||"");var r=this.canonicalizedAmzHeaders();return r&&t.push(r),t.push(this.canonicalizedResource()),t.join("\n")},canonicalizedAmzHeaders:function(){var e=[];i.util.each(this.request.headers,function(t){t.match(/^x-amz-/i)&&e.push(t)}),e.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1});var t=[];return i.util.arrayEach.call(this,e,function(e){t.push(e.toLowerCase()+":"+String(this.request.headers[e]))}),t.join("\n")},canonicalizedResource:function(){var e=this.request,t=e.path.split("?"),r=t[0],n=t[1],o="";if(e.virtualHostedBucket&&(o+="/"+e.virtualHostedBucket),o+=r,n){var a=[];i.util.arrayEach.call(this,n.split("&"),function(e){var t=e.split("=")[0],r=e.split("=")[1];if(this.subResources[t]||this.responseHeaders[t]){var i={name:t};void 0!==r&&(this.subResources[t]?i.value=r:i.value=decodeURIComponent(r)),a.push(i)}}),a.sort(function(e,t){return e.name<t.name?-1:1}),a.length&&(n=[],i.util.arrayEach(a,function(e){void 0===e.value?n.push(e.name):n.push(e.name+"="+e.value)}),o+="?"+n.join("&"))}return o},sign:function(e,t){return i.util.crypto.hmac(e,t,"base64","sha1")}}),t.exports=i.Signers.S3},{"../core":38}],96:[function(e,t,r){function i(e){var t=e.httpRequest.headers[s],r=e.service.getSignerClass(e);if(delete e.httpRequest.headers["User-Agent"],delete e.httpRequest.headers["X-Amz-User-Agent"],r===o.Signers.V4){if(t>604800)throw o.util.error(new Error,{code:"InvalidExpiryTime",message:"Presigning does not support expiry time greater than a week with SigV4 signing.",retryable:!1});e.httpRequest.headers[s]=t}else{if(r!==o.Signers.S3)throw o.util.error(new Error,{message:"Presigning only supports S3 or SigV4 signing.",code:"UnsupportedSigner",retryable:!1});var i=e.service?e.service.getSkewCorrectedDate():o.util.date.getDate();e.httpRequest.headers[s]=parseInt(o.util.date.unixTimestamp(i)+t,10).toString()}}function n(e){var t=e.httpRequest.endpoint,r=o.util.urlParse(e.httpRequest.path),i={};r.search&&(i=o.util.queryStringParse(r.search.substr(1)));var n=e.httpRequest.headers.Authorization.split(" ");if("AWS"===n[0])n=n[1].split(":"),i.AWSAccessKeyId=n[0],i.Signature=n[1],o.util.each(e.httpRequest.headers,function(e,t){e===s&&(e="Expires"),0===e.indexOf("x-amz-meta-")&&(delete i[e],e=e.toLowerCase()),i[e]=t}),delete e.httpRequest.headers[s],delete i.Authorization,delete i.Host;else if("AWS4-HMAC-SHA256"===n[0]){n.shift();var a=n.join(" "),l=a.match(/Signature=(.*?)(?:,|\s|\r?\n|$)/)[1];i["X-Amz-Signature"]=l,delete i.Expires}t.pathname=r.pathname,t.search=o.util.queryParamsToString(i)}var o=e("../core"),a=o.util.inherit,s="presigned-expires";o.Signers.Presign=a({sign:function(e,t,r){if(e.httpRequest.headers[s]=t||3600,e.on("build",i),e.on("sign",n),e.removeListener("afterBuild",o.EventListeners.Core.SET_CONTENT_LENGTH),e.removeListener("afterBuild",o.EventListeners.Core.COMPUTE_SHA256),e.emit("beforePresign",[e]),!r){if(e.build(),e.response.error)throw e.response.error;return o.util.urlFormat(e.httpRequest.endpoint)}e.build(function(){this.response.error?r(this.response.error):r(null,o.util.urlFormat(e.httpRequest.endpoint))})}}),t.exports=o.Signers.Presign},{"../core":38}],78:[function(e,t,r){var i=e("./core"),n=e("./model/api"),o=e("./region_config"),a=i.util.inherit,s=0;i.Service=a({constructor:function(e){if(!this.loadServiceClass)throw i.util.error(new Error,"Service must be constructed with `new' operator");var t=this.loadServiceClass(e||{});if(t){var r=i.util.copy(e),n=new t(e);return Object.defineProperty(n,"_originalConfig",{get:function(){return r},enumerable:!1,configurable:!0}),n._clientId=++s,n}this.initialize(e)},initialize:function(e){var t=i.config[this.serviceIdentifier];this.config=new i.Config(i.config),t&&this.config.update(t,!0),e&&this.config.update(e,!0),this.validateService(),this.config.endpoint||o(this),this.config.endpoint=this.endpointFromTemplate(this.config.endpoint),this.setEndpoint(this.config.endpoint)},validateService:function(){},loadServiceClass:function(e){var t=e;if(i.util.isEmpty(this.api)){if(t.apiConfig)return i.Service.defineServiceApi(this.constructor,t.apiConfig);if(this.constructor.services){t=new i.Config(i.config),t.update(e,!0);var r=t.apiVersions[this.constructor.serviceIdentifier];return r=r||t.apiVersion,this.getLatestServiceClass(r)}return null}return null},getLatestServiceClass:function(e){return e=this.getLatestServiceVersion(e),null===this.constructor.services[e]&&i.Service.defineServiceApi(this.constructor,e),this.constructor.services[e]},getLatestServiceVersion:function(e){if(!this.constructor.services||0===this.constructor.services.length)throw new Error("No services defined on "+this.constructor.serviceIdentifier);if(e?i.util.isType(e,Date)&&(e=i.util.date.iso8601(e).split("T")[0]):e="latest",Object.hasOwnProperty(this.constructor.services,e))return e;for(var t=Object.keys(this.constructor.services).sort(),r=null,n=t.length-1;n>=0;n--)if("*"!==t[n][t[n].length-1]&&(r=t[n]),t[n].substr(0,10)<=e)return r;throw new Error("Could not find "+this.constructor.serviceIdentifier+" API to satisfy version constraint `"+e+"'")},api:{},defaultRetryCount:3,customizeRequests:function(e){if(e){if("function"!=typeof e)throw new Error("Invalid callback type '"+typeof e+"' provided in customizeRequests");this.customRequestHandler=e}else this.customRequestHandler=null},makeRequest:function(e,t,r){if("function"==typeof t&&(r=t,t=null),t=t||{},this.config.params){var n=this.api.operations[e];n&&(t=i.util.copy(t),i.util.each(this.config.params,function(e,r){n.input.members[e]&&(void 0!==t[e]&&null!==t[e]||(t[e]=r))}))}var o=new i.Request(this,e,t);return this.addAllRequestListeners(o),r&&o.send(r),o},makeUnauthenticatedRequest:function(e,t,r){"function"==typeof t&&(r=t,t={});var i=this.makeRequest(e,t).toUnauthenticated();return r?i.send(r):i},waitFor:function(e,t,r){return new i.ResourceWaiter(this,e).wait(t,r)},addAllRequestListeners:function(e){for(var t=[i.events,i.EventListeners.Core,this.serviceInterface(),i.EventListeners.CorePost],r=0;r<t.length;r++)t[r]&&e.addListeners(t[r]);this.config.paramValidation||e.removeListener("validate",i.EventListeners.Core.VALIDATE_PARAMETERS),this.config.logger&&e.addListeners(i.EventListeners.Logger),this.setupRequestListeners(e),"function"==typeof this.constructor.prototype.customRequestHandler&&this.constructor.prototype.customRequestHandler(e),Object.prototype.hasOwnProperty.call(this,"customRequestHandler")&&"function"==typeof this.customRequestHandler&&this.customRequestHandler(e)},setupRequestListeners:function(){},getSignerClass:function(e){var t,r=null,n="";return e&&(r=(e.service.api.operations||{})[e.operation]||null,n=r?r.authtype:""),t=this.config.signatureVersion?this.config.signatureVersion:"v4"===n||"v4-unsigned-body"===n?"v4":this.api.signatureVersion,i.Signers.RequestSigner.getVersion(t)},serviceInterface:function(){switch(this.api.protocol){case"ec2":case"query":return i.EventListeners.Query;case"json":return i.EventListeners.Json;case"rest-json":return i.EventListeners.RestJson;case"rest-xml":return i.EventListeners.RestXml}if(this.api.protocol)throw new Error("Invalid service `protocol' "+this.api.protocol+" in API config")},successfulResponse:function(e){return e.httpResponse.statusCode<300},numRetries:function(){return void 0!==this.config.maxRetries?this.config.maxRetries:this.defaultRetryCount},retryDelays:function(e){return i.util.calculateRetryDelay(e,this.config.retryDelayOptions)},retryableError:function(e){return!!this.timeoutError(e)||!!this.networkingError(e)||!!this.expiredCredentialsError(e)||!!this.throttledError(e)||e.statusCode>=500},networkingError:function(e){return"NetworkingError"===e.code},timeoutError:function(e){return"TimeoutError"===e.code},expiredCredentialsError:function(e){return"ExpiredTokenException"===e.code},clockSkewError:function(e){switch(e.code){case"RequestTimeTooSkewed":case"RequestExpired":case"InvalidSignatureException":case"SignatureDoesNotMatch":case"AuthFailure":case"RequestInTheFuture":return!0;default:return!1}},getSkewCorrectedDate:function(){return new Date(Date.now()+this.config.systemClockOffset)},applyClockOffset:function(e){e&&(this.config.systemClockOffset=e-Date.now())},isClockSkewed:function(e){if(e)return Math.abs(this.getSkewCorrectedDate().getTime()-e)>=3e4},throttledError:function(e){switch(e.code){case"ProvisionedThroughputExceededException":case"Throttling":case"ThrottlingException":case"RequestLimitExceeded":case"RequestThrottled":return!0;default:return!1}},endpointFromTemplate:function(e){if("string"!=typeof e)return e;var t=e;return t=t.replace(/\{service\}/g,this.api.endpointPrefix),t=t.replace(/\{region\}/g,this.config.region),t=t.replace(/\{scheme\}/g,this.config.sslEnabled?"https":"http")},setEndpoint:function(e){this.endpoint=new i.Endpoint(e,this.config)},paginationConfig:function(e,t){var r=this.api.operations[e].paginator;if(!r){if(t){var n=new Error;throw i.util.error(n,"No pagination configuration for "+e)}return null}return r}}),i.util.update(i.Service,{defineMethods:function(e){i.util.each(e.prototype.api.operations,function(t){e.prototype[t]||("none"===e.prototype.api.operations[t].authtype?e.prototype[t]=function(e,r){return this.makeUnauthenticatedRequest(t,e,r)}:e.prototype[t]=function(e,r){return this.makeRequest(t,e,r)})})},defineService:function(e,t,r){i.Service._serviceMap[e]=!0,Array.isArray(t)||(r=t,t=[]);var n=a(i.Service,r||{});if("string"==typeof e){i.Service.addVersions(n,t);var o=n.serviceIdentifier||e;n.serviceIdentifier=o}else n.prototype.api=e,i.Service.defineMethods(n);return n},addVersions:function(e,t){Array.isArray(t)||(t=[t]),e.services=e.services||{};for(var r=0;r<t.length;r++)void 0===e.services[t[r]]&&(e.services[t[r]]=null);e.apiVersions=Object.keys(e.services).sort()},defineServiceApi:function(e,t,r){function o(e){e.isApi?s.prototype.api=e:s.prototype.api=new n(e)}var s=a(e,{serviceIdentifier:e.serviceIdentifier});if("string"==typeof t){if(r)o(r);else try{o(i.apiLoader(e.serviceIdentifier,t))}catch(r){throw i.util.error(r,{message:"Could not find API configuration "+e.serviceIdentifier+"-"+t})}Object.prototype.hasOwnProperty.call(e.services,t)||(e.apiVersions=e.apiVersions.concat(t).sort()),e.services[t]=s}else o(t);return i.Service.defineMethods(s),s},hasService:function(e){return Object.prototype.hasOwnProperty.call(i.Service._serviceMap,e)},_serviceMap:{}}),t.exports=i.Service},{"./core":38,"./model/api":56,"./region_config":71}],71:[function(e,t,r){function i(e){if(!e)return null;var t=e.split("-");return t.length<3?null:t.slice(0,t.length-2).join("-")+"-*"}function n(e){var t=e.config.region,r=i(t),n=e.api.endpointPrefix;return[[t,n],[r,n],[t,"*"],[r,"*"],["*",n],["*","*"]].map(function(e){return e[0]&&e[1]?e.join("/"):null})}function o(e,t){s.each(t,function(t,r){"globalEndpoint"!==t&&(void 0!==e.config[t]&&null!==e.config[t]||(e.config[t]=r))})}function a(e){for(var t=n(e),r=0;r<t.length;r++){var i=t[r];if(i&&Object.prototype.hasOwnProperty.call(l.rules,i)){var a=l.rules[i];return"string"==typeof a&&(a=l.patterns[a]),e.config.useDualstack&&s.isDualstackAvailable(e)&&(a=s.copy(a),a.endpoint="{service}.dualstack.{region}.amazonaws.com"),e.isGlobalEndpoint=!!a.globalEndpoint,a.signatureVersion||(a.signatureVersion="v4"),void o(e,a)}}}var s=e("./util"),l=e("./region_config_data.json");t.exports=a},{"./region_config_data.json":72,"./util":105}],72:[function(e,t,r){t.exports={rules:{"*/*":{endpoint:"{service}.{region}.amazonaws.com"},"cn-*/*":{endpoint:"{service}.{region}.amazonaws.com.cn"},"*/budgets":"globalSSL","*/cloudfront":"globalSSL","*/iam":"globalSSL","*/sts":"globalSSL","*/importexport":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2",globalEndpoint:!0},"*/route53":{endpoint:"https://{service}.amazonaws.com",signatureVersion:"v3https",globalEndpoint:!0},"*/waf":"globalSSL","us-gov-*/iam":"globalGovCloud","us-gov-*/sts":{endpoint:"{service}.{region}.amazonaws.com"},"us-gov-west-1/s3":"s3signature","us-west-1/s3":"s3signature","us-west-2/s3":"s3signature","eu-west-1/s3":"s3signature","ap-southeast-1/s3":"s3signature","ap-southeast-2/s3":"s3signature","ap-northeast-1/s3":"s3signature","sa-east-1/s3":"s3signature","us-east-1/s3":{endpoint:"{service}.amazonaws.com",signatureVersion:"s3"},"us-east-1/sdb":{endpoint:"{service}.amazonaws.com",signatureVersion:"v2"},"*/sdb":{endpoint:"{service}.{region}.amazonaws.com",signatureVersion:"v2"}},patterns:{globalSSL:{endpoint:"https://{service}.amazonaws.com",globalEndpoint:!0},globalGovCloud:{endpoint:"{service}.us-gov.amazonaws.com"},s3signature:{endpoint:"{service}.{region}.amazonaws.com",signatureVersion:"s3"}}}},{}],75:[function(e,t,r){var i=e("./core"),n=i.util.inherit,o=e("jmespath");i.Response=n({constructor:function(e){this.request=e,this.data=null,this.error=null,this.retryCount=0,this.redirectCount=0,this.httpResponse=new i.HttpResponse,e&&(this.maxRetries=e.service.numRetries(),this.maxRedirects=e.service.config.maxRedirects)},nextPage:function(e){var t,r=this.request.service,n=this.request.operation;try{t=r.paginationConfig(n,!0)}catch(e){this.error=e}if(!this.hasNextPage()){if(e)e(this.error,null);else if(this.error)throw this.error;return null}var o=i.util.copy(this.request.params);if(this.nextPageTokens){var a=t.inputToken;"string"==typeof a&&(a=[a]);for(var s=0;s<a.length;s++)o[a[s]]=this.nextPageTokens[s];return r.makeRequest(this.request.operation,o,e)}return e?e(null,null):null},hasNextPage:function(){return this.cacheNextPageTokens(),!!this.nextPageTokens||void 0===this.nextPageTokens&&void 0},cacheNextPageTokens:function(){if(Object.prototype.hasOwnProperty.call(this,"nextPageTokens"))return this.nextPageTokens;this.nextPageTokens=void 0;var e=this.request.service.paginationConfig(this.request.operation);if(!e)return this.nextPageTokens;if(this.nextPageTokens=null,e.moreResults&&!o.search(this.data,e.moreResults))return this.nextPageTokens;var t=e.outputToken;return"string"==typeof t&&(t=[t]),i.util.arrayEach.call(this,t,function(e){var t=o.search(this.data,e);t&&(this.nextPageTokens=this.nextPageTokens||[],this.nextPageTokens.push(t))}),this.nextPageTokens}})},{"./core":38,jmespath:8}],74:[function(e,t,r){function i(e){var t=e.request._waiter,r=t.config.acceptors,i=!1,n="retry";r.forEach(function(r){if(!i){var o=t.matchers[r.matcher];o&&o(e,r.expected,r.argument)&&(i=!0,n=r.state)}}),!i&&e.error&&(n="failure"),"success"===n?t.setSuccess(e):t.setError(e,"retry"===n)}var n=e("./core"),o=n.util.inherit,a=e("jmespath");n.ResourceWaiter=o({constructor:function(e,t){this.service=e,this.state=t,this.loadWaiterConfig(this.state)},service:null,state:null,config:null,matchers:{path:function(e,t,r){try{var i=a.search(e.data,r)}catch(e){return!1}return a.strictDeepEqual(i,t)},pathAll:function(e,t,r){try{var i=a.search(e.data,r)}catch(e){return!1}Array.isArray(i)||(i=[i]);var n=i.length;if(!n)return!1;for(var o=0;o<n;o++)if(!a.strictDeepEqual(i[o],t))return!1;return!0},pathAny:function(e,t,r){try{var i=a.search(e.data,r)}catch(e){return!1}Array.isArray(i)||(i=[i]);for(var n=i.length,o=0;o<n;o++)if(a.strictDeepEqual(i[o],t))return!0;return!1},status:function(e,t){var r=e.httpResponse.statusCode;return"number"==typeof r&&r===t},error:function(e,t){return"string"==typeof t&&e.error?t===e.error.code:t===!!e.error}},listeners:(new n.SequentialExecutor).addNamedListeners(function(e){e("RETRY_CHECK","retry",function(e){var t=e.request._waiter;e.error&&"ResourceNotReady"===e.error.code&&(e.error.retryDelay=1e3*(t.config.delay||0))}),e("CHECK_OUTPUT","extractData",i),e("CHECK_ERROR","extractError",i)}),wait:function(e,t){"function"==typeof e&&(t=e,e=void 0),e&&e.$waiter&&(e=n.util.copy(e),"number"==typeof e.$waiter.delay&&(this.config.delay=e.$waiter.delay),"number"==typeof e.$waiter.maxAttempts&&(this.config.maxAttempts=e.$waiter.maxAttempts),delete e.$waiter);var r=this.service.makeRequest(this.config.operation,e);return r._waiter=this,r.response.maxRetries=this.config.maxAttempts,r.addListeners(this.listeners),t&&r.send(t),r},setSuccess:function(e){e.error=null,e.data=e.data||{},e.request.removeAllListeners("extractData")},setError:function(e,t){e.data=null,e.error=n.util.error(e.error||new Error,{code:"ResourceNotReady",message:"Resource is not in the state "+this.state,retryable:t})},loadWaiterConfig:function(e){if(!this.service.api.waiters[e])throw new n.util.error(new Error,{code:"StateNotFoundError",message:"State "+e+" not found."});this.config=n.util.copy(this.service.api.waiters[e])}})},{"./core":38,jmespath:8}],73:[function(e,t,r){(function(t){function r(e){return Object.prototype.hasOwnProperty.call(l,e._asm.currentState)}var i=e("./core"),n=e("./state_machine"),o=i.util.inherit,a=i.util.domain,s=e("jmespath"),l={success:1,error:1,complete:1},d=new n;d.setupStates=function(){var e=function(e,t){var i=this;i._haltHandlersOnError=!1,i.emit(i._asm.currentState,function(e){if(e)if(r(i)){if(!(a&&i.domain instanceof a.Domain))throw e;e.domainEmitter=i,e.domain=i.domain,e.domainThrown=!1,i.domain.emit("error",e)}else i.response.error=e,t(e);else t(i.response.error)})};this.addState("validate","build","error",e),this.addState("build","afterBuild","restart",e),this.addState("afterBuild","sign","restart",e),this.addState("sign","send","retry",e),this.addState("retry","afterRetry","afterRetry",e),this.addState("afterRetry","sign","error",e),this.addState("send","validateResponse","retry",e),this.addState("validateResponse","extractData","extractError",e),this.addState("extractError","extractData","retry",e),this.addState("extractData","success","retry",e),this.addState("restart","build","error",e),this.addState("success","complete","complete",e),this.addState("error","complete","complete",e),this.addState("complete",null,null,e)},d.setupStates(),i.Request=o({constructor:function(e,t,r){var o=e.endpoint,s=e.config.region,l=e.config.customUserAgent;e.isGlobalEndpoint&&(s="us-east-1"),this.domain=a&&a.active,this.service=e,this.operation=t,this.params=r||{},this.httpRequest=new i.HttpRequest(o,s),this.httpRequest.appendToUserAgent(l),this.startTime=e.getSkewCorrectedDate(),this.response=new i.Response(this),this._asm=new n(d.states,"validate"),this._haltHandlersOnError=!1,i.SequentialExecutor.call(this),this.emit=this.emitEvent},send:function(e){return e&&(this.httpRequest.appendToUserAgent("callback"),this.on("complete",function(t){e.call(t,t.error,t.data)})),this.runTo(),this.response},build:function(e){return this.runTo("send",e)},runTo:function(e,t){return this._asm.runTo(e,t,this),this},abort:function(){return this.removeAllListeners("validateResponse"),this.removeAllListeners("extractError"),this.on("validateResponse",function(e){e.error=i.util.error(new Error("Request aborted by user"),{code:"RequestAbortedError",retryable:!1})}),this.httpRequest.stream&&!this.httpRequest.stream.didCallback&&(this.httpRequest.stream.abort(),this.httpRequest._abortCallback?this.httpRequest._abortCallback():this.removeAllListeners("send")),this},eachPage:function(e){function t(r){e.call(r,r.error,r.data,function(n){!1!==n&&(r.hasNextPage()?r.nextPage().on("complete",t).send():e.call(r,null,null,i.util.fn.noop))})}e=i.util.fn.makeAsync(e,3),this.on("complete",t).send()},eachItem:function(e){function t(t,n){if(t)return e(t,null);if(null===n)return e(null,null);var o=r.service.paginationConfig(r.operation),a=o.resultKey;Array.isArray(a)&&(a=a[0]);var l=s.search(n,a),d=!0;return i.util.arrayEach(l,function(t){if(!1===(d=e(null,t)))return i.util.abort}),d}var r=this;this.eachPage(t)},isPageable:function(){return!!this.service.paginationConfig(this.operation)},createReadStream:function(){var e=i.util.stream,r=this,n=null;return 2===i.HttpClient.streamsApiVersion?(n=new e.PassThrough,t.nextTick(function(){r.send()})):(n=new e.Stream,n.readable=!0,n.sent=!1,n.on("newListener",function(e){n.sent||"data"!==e||(n.sent=!0,t.nextTick(function(){r.send()}))})),this.on("error",function(e){n.emit("error",e)}),this.on("httpHeaders",function(t,o,a){if(t<300){r.removeListener("httpData",i.EventListeners.Core.HTTP_DATA),r.removeListener("httpError",i.EventListeners.Core.HTTP_ERROR),r.on("httpError",function(e){a.error=e,a.error.retryable=!1});var s,l=!1;if("HEAD"!==r.httpRequest.method&&(s=parseInt(o["content-length"],10)),void 0!==s&&!isNaN(s)&&s>=0){l=!0;var d=0}var u=function(){l&&d!==s?n.emit("error",i.util.error(new Error("Stream content length mismatch. Received "+d+" of "+s+" bytes."),{code:"StreamContentLengthMismatch"})):2===i.HttpClient.streamsApiVersion?n.end():n.emit("end")},c=a.httpResponse.createUnbufferedStream();if(2===i.HttpClient.streamsApiVersion)if(l){var h=new e.PassThrough;h._write=function(t){return t&&t.length&&(d+=t.length),e.PassThrough.prototype._write.apply(this,arguments)},h.on("end",u),n.on("error",function(e){l=!1,c.unpipe(h),h.emit("end"),h.end()}),c.pipe(h).pipe(n,{end:!1})}else c.pipe(n);else l&&c.on("data",function(e){e&&e.length&&(d+=e.length)}),c.on("data",function(e){n.emit("data",e)}),c.on("end",u);c.on("error",function(e){l=!1,n.emit("error",e)})}}),n},emitEvent:function(e,t,r){"function"==typeof t&&(r=t,t=null),r||(r=function(){}),t||(t=this.eventParameters(e,this.response)),i.SequentialExecutor.prototype.emit.call(this,e,t,function(e){e&&(this.response.error=e),r.call(this,e)})},eventParameters:function(e){switch(e){case"restart":case"validate":case"sign":case"build":case"afterValidate":case"afterBuild":return[this];case"error":return[this.response.error,this.response];default:return[this.response]}},presign:function(e,t){return t||"function"!=typeof e||(t=e,e=null),(new i.Signers.Presign).sign(this.toGet(),e,t)},isPresigned:function(){return Object.prototype.hasOwnProperty.call(this.httpRequest.headers,"presigned-expires")},toUnauthenticated:function(){return this.removeListener("validate",i.EventListeners.Core.VALIDATE_CREDENTIALS),this.removeListener("sign",i.EventListeners.Core.SIGN),this},toGet:function(){return"query"!==this.service.api.protocol&&"ec2"!==this.service.api.protocol||(this.removeListener("build",this.buildAsGet),this.addListener("build",this.buildAsGet)),this},buildAsGet:function(e){e.httpRequest.method="GET",e.httpRequest.path=e.service.endpoint.path+"?"+e.httpRequest.body,e.httpRequest.body="",delete e.httpRequest.headers["Content-Length"],delete e.httpRequest.headers["Content-Type"]},haltHandlersOnError:function(){this._haltHandlersOnError=!0}}),i.Request.addPromisesToClass=function(e){this.prototype.promise=function(){var t=this;return this.httpRequest.appendToUserAgent("promise"),new e(function(e,r){t.on("complete",function(t){t.error?r(t.error):e(Object.defineProperty(t.data||{},"$response",{value:t}))}),t.runTo()})}},i.Request.deletePromisesFromClass=function(){delete this.prototype.promise},i.util.addPromises(i.Request),i.util.mixin(i.Request,i.SequentialExecutor)}).call(this,e("_process"))},{"./core":38,"./state_machine":104,_process:9,jmespath:8}],104:[function(e,t,r){function i(e,t){this.currentState=t||null,this.states=e||{}}i.prototype.runTo=function(e,t,r,i){"function"==typeof e&&(i=r,r=t,t=e,e=null);var n=this,o=n.states[n.currentState];o.fn.call(r||n,i,function(i){if(i){if(!o.fail)return t?t.call(r,i):null;n.currentState=o.fail}else{if(!o.accept)return t?t.call(r):null;n.currentState=o.accept}if(n.currentState===e)return t?t.call(r,i):null;n.runTo(e,t,r,i)})},i.prototype.addState=function(e,t,r,i){return"function"==typeof t?(i=t,t=null,r=null):"function"==typeof r&&(i=r,r=null),this.currentState||(this.currentState=e),this.states[e]={accept:t,fail:r,fn:i},this},t.exports=i},{}],62:[function(e,t,r){var i=e("./core");i.ParamValidator=i.util.inherit({constructor:function(e){!0!==e&&void 0!==e||(e={min:!0}),this.validation=e},validate:function(e,t,r){if(this.errors=[],this.validateMember(e,t||{},r||"params"),this.errors.length>1){var n=this.errors.join("\n* ");throw n="There were "+this.errors.length+" validation errors:\n* "+n,i.util.error(new Error(n),{code:"MultipleValidationErrors",errors:this.errors})}if(1===this.errors.length)throw this.errors[0];return!0},fail:function(e,t){this.errors.push(i.util.error(new Error(t),{code:e}))},validateStructure:function(e,t,r){this.validateType(t,r,["object"],"structure");for(var i,n=0;e.required&&n<e.required.length;n++){i=e.required[n];var o=t[i];void 0!==o&&null!==o||this.fail("MissingRequiredParameter","Missing required key '"+i+"' in "+r)}for(i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i],s=e.members[i];if(void 0!==s){var l=[r,i].join(".");this.validateMember(s,a,l)}else this.fail("UnexpectedParameter","Unexpected key '"+i+"' found in "+r)}return!0},validateMember:function(e,t,r){switch(e.type){case"structure":return this.validateStructure(e,t,r);case"list":return this.validateList(e,t,r);case"map":return this.validateMap(e,t,r);default:return this.validateScalar(e,t,r)}},validateList:function(e,t,r){if(this.validateType(t,r,[Array])){this.validateRange(e,t.length,r,"list member count");for(var i=0;i<t.length;i++)this.validateMember(e.member,t[i],r+"["+i+"]")}},validateMap:function(e,t,r){if(this.validateType(t,r,["object"],"map")){var i=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this.validateMember(e.key,n,r+"[key='"+n+"']"),this.validateMember(e.value,t[n],r+"['"+n+"']"),i++);this.validateRange(e,i,r,"map member count")}},validateScalar:function(e,t,r){switch(e.type){case null:case void 0:case"string":return this.validateString(e,t,r);case"base64":case"binary":return this.validatePayload(t,r);case"integer":case"float":return this.validateNumber(e,t,r);case"boolean":return this.validateType(t,r,["boolean"]);case"timestamp":return this.validateType(t,r,[Date,/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?Z$/,"number"],"Date object, ISO-8601 string, or a UNIX timestamp");default:return this.fail("UnkownType","Unhandled type "+e.type+" for "+r)}},validateString:function(e,t,r){var i=["string"];e.isJsonValue&&(i=i.concat(["number","object","boolean"])),null!==t&&this.validateType(t,r,i)&&(this.validateEnum(e,t,r),this.validateRange(e,t.length,r,"string length"),this.validatePattern(e,t,r))},validatePattern:function(e,t,r){this.validation.pattern&&void 0!==e.pattern&&(new RegExp(e.pattern).test(t)||this.fail("PatternMatchError",'Provided value "'+t+'" does not match regex pattern /'+e.pattern+"/ for "+r))},validateRange:function(e,t,r,i){this.validation.min&&void 0!==e.min&&t<e.min&&this.fail("MinRangeError","Expected "+i+" >= "+e.min+", but found "+t+" for "+r),this.validation.max&&void 0!==e.max&&t>e.max&&this.fail("MaxRangeError","Expected "+i+" <= "+e.max+", but found "+t+" for "+r)},validateEnum:function(e,t,r){this.validation.enum&&void 0!==e.enum&&-1===e.enum.indexOf(t)&&this.fail("EnumError","Found string value of "+t+", but expected "+e.enum.join("|")+" for "+r)},validateType:function(e,t,r,n){if(null===e||void 0===e)return!1;for(var o=!1,a=0;a<r.length;a++){if("string"==typeof r[a]){if(typeof e===r[a])return!0}else if(r[a]instanceof RegExp){if((e||"").toString().match(r[a]))return!0}else{if(e instanceof r[a])return!0;if(i.util.isType(e,r[a]))return!0;n||o||(r=r.slice()),r[a]=i.util.typeName(r[a])}o=!0}var s=n;s||(s=r.join(", ").replace(/,([^,]+)$/,", or$1"));var l=s.match(/^[aeiou]/i)?"n":"";return this.fail("InvalidParameterType","Expected "+t+" to be a"+l+" "+s),!1},validateNumber:function(e,t,r){if(null!==t&&void 0!==t){if("string"==typeof t){var i=parseFloat(t);i.toString()===t&&(t=i)}this.validateType(t,r,["number"])&&this.validateRange(e,t,r,"numeric value")}},validatePayload:function(e,t){if(null!==e&&void 0!==e&&"string"!=typeof e&&(!e||"number"!=typeof e.byteLength)){if(i.util.isNode()){var r=i.util.stream.Stream;if(i.util.Buffer.isBuffer(e)||e instanceof r)return}var n=["Buffer","Stream","File","Blob","ArrayBuffer","DataView"];if(e)for(var o=0;o<n.length;o++){if(i.util.isType(e,n[o]))return;if(i.util.typeName(e.constructor)===n[o])return}
this.fail("InvalidParameterType","Expected "+t+" to be a string, Buffer, Stream, Blob, or typed array object")}}})},{"./core":38}],56:[function(e,t,r){function i(e,t){e=e||{},t=t||{},t.api=this,e.metadata=e.metadata||{},u(this,"isApi",!0,!1),u(this,"apiVersion",e.metadata.apiVersion),u(this,"endpointPrefix",e.metadata.endpointPrefix),u(this,"signingName",e.metadata.signingName),u(this,"globalEndpoint",e.metadata.globalEndpoint),u(this,"signatureVersion",e.metadata.signatureVersion),u(this,"jsonVersion",e.metadata.jsonVersion),u(this,"targetPrefix",e.metadata.targetPrefix),u(this,"protocol",e.metadata.protocol),u(this,"timestampFormat",e.metadata.timestampFormat),u(this,"xmlNamespaceUri",e.metadata.xmlNamespace),u(this,"abbreviation",e.metadata.serviceAbbreviation),u(this,"fullName",e.metadata.serviceFullName),c(this,"className",function(){var t=e.metadata.serviceAbbreviation||e.metadata.serviceFullName;return t?(t=t.replace(/^Amazon|AWS\s*|\(.*|\s+|\W+/g,""),"ElasticLoadBalancing"===t&&(t="ELB"),t):null}),u(this,"operations",new n(e.operations,t,function(e,r){return new o(e,r,t)},d.string.lowerFirst)),u(this,"shapes",new n(e.shapes,t,function(e,r){return a.create(r,t)})),u(this,"paginators",new n(e.paginators,t,function(e,r){return new s(e,r,t)})),u(this,"waiters",new n(e.waiters,t,function(e,r){return new l(e,r,t)},d.string.lowerFirst)),t.documentation&&(u(this,"documentation",e.documentation),u(this,"documentationUrl",e.documentationUrl))}var n=e("./collection"),o=e("./operation"),a=e("./shape"),s=e("./paginator"),l=e("./resource_waiter"),d=e("../util"),u=d.property,c=d.memoizedProperty;t.exports=i},{"../util":105,"./collection":57,"./operation":58,"./paginator":59,"./resource_waiter":60,"./shape":61}],60:[function(e,t,r){function i(e,t,r){r=r||{},o(this,"name",e),o(this,"api",r.api,!1),t.operation&&o(this,"operation",n.string.lowerFirst(t.operation));var i=this;["type","description","delay","maxAttempts","acceptors"].forEach(function(e){var r=t[e];r&&o(i,e,r)})}var n=e("../util"),o=n.property;t.exports=i},{"../util":105}],59:[function(e,t,r){function i(e,t){n(this,"inputToken",t.input_token),n(this,"limitKey",t.limit_key),n(this,"moreResults",t.more_results),n(this,"outputToken",t.output_token),n(this,"resultKey",t.result_key)}var n=e("../util").property;t.exports=i},{"../util":105}],58:[function(e,t,r){function i(e,t,r){var i=this;r=r||{},a(this,"name",t.name||e),a(this,"api",r.api,!1),t.http=t.http||{},a(this,"httpMethod",t.http.method||"POST"),a(this,"httpPath",t.http.requestUri||"/"),a(this,"authtype",t.authtype||""),s(this,"input",function(){return t.input?n.create(t.input,r):new n.create({type:"structure"},r)}),s(this,"output",function(){return t.output?n.create(t.output,r):new n.create({type:"structure"},r)}),s(this,"errors",function(){var e=[];if(!t.errors)return null;for(var i=0;i<t.errors.length;i++)e.push(n.create(t.errors[i],r));return e}),s(this,"paginator",function(){return r.api.paginators[e]}),r.documentation&&(a(this,"documentation",t.documentation),a(this,"documentationUrl",t.documentationUrl)),s(this,"idempotentMembers",function(){var e=[],t=i.input,r=t.members;if(!t.members)return e;for(var n in r)r.hasOwnProperty(n)&&!0===r[n].isIdempotent&&e.push(n);return e})}var n=e("./shape"),o=e("../util"),a=o.property,s=o.memoizedProperty;t.exports=i},{"../util":105,"./shape":61}],52:[function(e,t,r){var i=e("./core"),n=i.util.inherit;i.Endpoint=n({constructor:function(e,t){if(i.util.hideProperties(this,["slashes","auth","hash","search","query"]),void 0===e||null===e)throw new Error("Invalid endpoint: "+e);if("string"!=typeof e)return i.util.copy(e);e.match(/^http/)||(e=((t&&void 0!==t.sslEnabled?t.sslEnabled:i.config.sslEnabled)?"https":"http")+"://"+e),i.util.update(this,i.util.urlParse(e)),this.port?this.port=parseInt(this.port,10):this.port="https:"===this.protocol?443:80}}),i.HttpRequest=n({constructor:function(e,t){e=new i.Endpoint(e),this.method="POST",this.path=e.path||"/",this.headers={},this.body="",this.endpoint=e,this.region=t,this._userAgent="",this.setUserAgent()},setUserAgent:function(){this._userAgent=this.headers[this.getUserAgentHeaderName()]=i.util.userAgent()},getUserAgentHeaderName:function(){return(i.util.isBrowser()?"X-Amz-":"")+"User-Agent"},appendToUserAgent:function(e){"string"==typeof e&&e&&(this._userAgent+=" "+e),this.headers[this.getUserAgentHeaderName()]=this._userAgent},getUserAgent:function(){return this._userAgent},pathname:function(){return this.path.split("?",1)[0]},search:function(){var e=this.path.split("?",2)[1];return e?(e=i.util.queryStringParse(e),i.util.queryParamsToString(e)):""}}),i.HttpResponse=n({constructor:function(){this.statusCode=void 0,this.headers={},this.body=void 0,this.streaming=!1,this.stream=null},createUnbufferedStream:function(){return this.streaming=!0,this.stream}}),i.HttpClient=n({}),i.HttpClient.getInstance=function(){return void 0===this.singleton&&(this.singleton=new this),this.singleton}},{"./core":38}],51:[function(e,t,r){function i(e){if(!e.service.api.operations)return"";var t=e.service.api.operations[e.operation];return t?t.authtype:""}var n=e("./core"),o=e("./sequential_executor");n.EventListeners={Core:{}},n.EventListeners={Core:(new o).addNamedListeners(function(e,t){t("VALIDATE_CREDENTIALS","validate",function(e,t){if(!e.service.api.signatureVersion)return t();e.service.config.getCredentials(function(r){r&&(e.response.error=n.util.error(r,{code:"CredentialsError",message:"Missing credentials in config"})),t()})}),e("VALIDATE_REGION","validate",function(e){e.service.config.region||e.service.isGlobalEndpoint||(e.response.error=n.util.error(new Error,{code:"ConfigError",message:"Missing region in config"}))}),e("BUILD_IDEMPOTENCY_TOKENS","validate",function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation];if(t){var r=t.idempotentMembers;if(r.length){for(var i=n.util.copy(e.params),o=0,a=r.length;o<a;o++)i[r[o]]||(i[r[o]]=n.util.uuid.v4());e.params=i}}}}),e("VALIDATE_PARAMETERS","validate",function(e){if(e.service.api.operations){var t=e.service.api.operations[e.operation].input,r=e.service.config.paramValidation;new n.ParamValidator(r).validate(t,e.params)}}),t("COMPUTE_SHA256","afterBuild",function(e,t){if(e.haltHandlersOnError(),e.service.api.operations){var r=e.service.api.operations[e.operation],i=r?r.authtype:"";if(!e.service.api.signatureVersion&&!i)return t();if(e.service.getSignerClass(e)===n.Signers.V4){var o=e.httpRequest.body||"";if(i.indexOf("unsigned-body")>=0)return e.httpRequest.headers["X-Amz-Content-Sha256"]="UNSIGNED-PAYLOAD",t();n.util.computeSha256(o,function(r,i){r?t(r):(e.httpRequest.headers["X-Amz-Content-Sha256"]=i,t())})}else t()}}),e("SET_CONTENT_LENGTH","afterBuild",function(e){var t=i(e);if(void 0===e.httpRequest.headers["Content-Length"]&&-1===t.indexOf("unsigned-body")){var r=n.util.string.byteLength(e.httpRequest.body);e.httpRequest.headers["Content-Length"]=r}}),e("SET_HTTP_HOST","afterBuild",function(e){e.httpRequest.headers.Host=e.httpRequest.endpoint.host}),e("RESTART","restart",function(){var e=this.response.error;e&&e.retryable&&(this.httpRequest=new n.HttpRequest(this.service.endpoint,this.service.region),this.response.retryCount<this.service.config.maxRetries?this.response.retryCount++:this.response.error=null)}),t("SIGN","sign",function(e,t){var r=e.service,i=e.service.api.operations||{},n=i[e.operation],o=n?n.authtype:"";if(!r.api.signatureVersion&&!o)return t();r.config.getCredentials(function(i,o){if(i)return e.response.error=i,t();try{var a=r.getSkewCorrectedDate(),s=r.getSignerClass(e),l=new s(e.httpRequest,r.api.signingName||r.api.endpointPrefix,{signatureCache:r.config.signatureCache,operation:n});l.setServiceClientId(r._clientId),delete e.httpRequest.headers.Authorization,delete e.httpRequest.headers.Date,delete e.httpRequest.headers["X-Amz-Date"],l.addAuthorization(o,a),e.signedAt=a}catch(t){e.response.error=t}t()})}),e("VALIDATE_RESPONSE","validateResponse",function(e){this.service.successfulResponse(e,this)?(e.data={},e.error=null):(e.data=null,e.error=n.util.error(new Error,{code:"UnknownError",message:"An unknown error occurred."}))}),t("SEND","send",function(e,t){function r(r){e.httpResponse.stream=r;var i=e.request.httpRequest.stream;r.on("headers",function(t,i,o){e.request.emit("httpHeaders",[t,i,e,o]),e.httpResponse.streaming||(2===n.HttpClient.streamsApiVersion?r.on("readable",function(){var t=r.read();null!==t&&e.request.emit("httpData",[t,e])}):r.on("data",function(t){e.request.emit("httpData",[t,e])}))}),r.on("end",function(){i&&i.didCallback||(e.request.emit("httpDone"),t())})}function i(t){t.on("sendProgress",function(t){e.request.emit("httpUploadProgress",[t,e])}),t.on("receiveProgress",function(t){e.request.emit("httpDownloadProgress",[t,e])})}function o(r){if("RequestAbortedError"!==r.code){var i="TimeoutError"===r.code?r.code:"NetworkingError";r=n.util.error(r,{code:i,region:e.request.httpRequest.region,hostname:e.request.httpRequest.endpoint.hostname,retryable:!0})}e.error=r,e.request.emit("httpError",[e.error,e],function(){t()})}function a(){var t=n.HttpClient.getInstance(),a=e.request.service.config.httpOptions||{};try{i(t.handleRequest(e.request.httpRequest,a,r,o))}catch(e){o(e)}}e.httpResponse._abortCallback=t,e.error=null,e.data=null,(e.request.service.getSkewCorrectedDate()-this.signedAt)/1e3>=600?this.emit("sign",[this],function(e){e?t(e):a()}):a()}),e("HTTP_HEADERS","httpHeaders",function(e,t,r,i){r.httpResponse.statusCode=e,r.httpResponse.statusMessage=i,r.httpResponse.headers=t,r.httpResponse.body=new n.util.Buffer(""),r.httpResponse.buffers=[],r.httpResponse.numBytes=0;var o=t.date||t.Date,a=r.request.service;if(o){var s=Date.parse(o);a.config.correctClockSkew&&a.isClockSkewed(s)&&a.applyClockOffset(s)}}),e("HTTP_DATA","httpData",function(e,t){if(e){if(n.util.isNode()){t.httpResponse.numBytes+=e.length;var r=t.httpResponse.headers["content-length"],i={loaded:t.httpResponse.numBytes,total:r};t.request.emit("httpDownloadProgress",[i,t])}t.httpResponse.buffers.push(new n.util.Buffer(e))}}),e("HTTP_DONE","httpDone",function(e){if(e.httpResponse.buffers&&e.httpResponse.buffers.length>0){var t=n.util.buffer.concat(e.httpResponse.buffers);e.httpResponse.body=t}delete e.httpResponse.numBytes,delete e.httpResponse.buffers}),e("FINALIZE_ERROR","retry",function(e){e.httpResponse.statusCode&&(e.error.statusCode=e.httpResponse.statusCode,void 0===e.error.retryable&&(e.error.retryable=this.service.retryableError(e.error,this)))}),e("INVALIDATE_CREDENTIALS","retry",function(e){if(e.error)switch(e.error.code){case"RequestExpired":case"ExpiredTokenException":case"ExpiredToken":e.error.retryable=!0,e.request.service.config.credentials.expired=!0}}),e("EXPIRED_SIGNATURE","retry",function(e){var t=e.error;t&&"string"==typeof t.code&&"string"==typeof t.message&&t.code.match(/Signature/)&&t.message.match(/expired/)&&(e.error.retryable=!0)}),e("CLOCK_SKEWED","retry",function(e){e.error&&this.service.clockSkewError(e.error)&&this.service.config.correctClockSkew&&(e.error.retryable=!0)}),e("REDIRECT","retry",function(e){e.error&&e.error.statusCode>=300&&e.error.statusCode<400&&e.httpResponse.headers.location&&(this.httpRequest.endpoint=new n.Endpoint(e.httpResponse.headers.location),this.httpRequest.headers.Host=this.httpRequest.endpoint.host,e.error.redirect=!0,e.error.retryable=!0)}),e("RETRY_CHECK","retry",function(e){e.error&&(e.error.redirect&&e.redirectCount<e.maxRedirects?e.error.retryDelay=0:e.retryCount<e.maxRetries&&(e.error.retryDelay=this.service.retryDelays(e.retryCount)||0))}),t("RESET_RETRY_STATE","afterRetry",function(e,t){var r,i=!1;e.error&&(r=e.error.retryDelay||0,e.error.retryable&&e.retryCount<e.maxRetries?(e.retryCount++,i=!0):e.error.redirect&&e.redirectCount<e.maxRedirects&&(e.redirectCount++,i=!0)),i?(e.error=null,setTimeout(t,r)):t()})}),CorePost:(new o).addNamedListeners(function(e){e("EXTRACT_REQUEST_ID","extractData",n.util.extractRequestId),e("EXTRACT_REQUEST_ID","extractError",n.util.extractRequestId),e("ENOTFOUND_ERROR","httpError",function(e){if("NetworkingError"===e.code&&"ENOTFOUND"===e.errno){var t="Inaccessible host: `"+e.hostname+"'. This service may not be available in the `"+e.region+"' region.";this.response.error=n.util.error(new Error(t),{code:"UnknownEndpoint",region:e.region,hostname:e.hostname,retryable:!0,originalError:e})}})}),Logger:(new o).addNamedListeners(function(t){t("LOG_REQUEST","complete",function(t){function r(e,t){if(!t)return t;switch(e.type){case"structure":var i={};return n.util.each(t,function(t,n){Object.prototype.hasOwnProperty.call(e.members,t)?i[t]=r(e.members[t],n):i[t]=n}),i;case"list":var o=[];return n.util.arrayEach(t,function(t,i){o.push(r(e.member,t))}),o;case"map":var a={};return n.util.each(t,function(t,i){a[t]=r(e.value,i)}),a;default:return e.isSensitive?"***SensitiveInformation***":t}}var i=t.request,o=i.service.config.logger;if(o){var a=function(){var a=t.request.service.getSkewCorrectedDate().getTime(),s=(a-i.startTime.getTime())/1e3,l=!!o.isTTY,d=t.httpResponse.statusCode,u=i.params;i.service.api.operations&&i.service.api.operations[i.operation]&&i.service.api.operations[i.operation].input&&(u=r(i.service.api.operations[i.operation].input,i.params));var c=e("util").inspect(u,!0,null),h="";return l&&(h+="[33m"),h+="[AWS "+i.service.serviceIdentifier+" "+d,h+=" "+s.toString()+"s "+t.retryCount+" retries]",l&&(h+="[0;1m"),h+=" "+n.util.string.lowerFirst(i.operation),h+="("+c+")",l&&(h+="[0m"),h}();"function"==typeof o.log?o.log(a):"function"==typeof o.write&&o.write(a+"\n")}})}),Json:(new o).addNamedListeners(function(t){var r=e("./protocol/json");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),Rest:(new o).addNamedListeners(function(t){var r=e("./protocol/rest");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),RestJson:(new o).addNamedListeners(function(t){var r=e("./protocol/rest_json");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),RestXml:(new o).addNamedListeners(function(t){var r=e("./protocol/rest_xml");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)}),Query:(new o).addNamedListeners(function(t){var r=e("./protocol/query");t("BUILD","build",r.buildRequest),t("EXTRACT_DATA","extractData",r.extractData),t("EXTRACT_ERROR","extractError",r.extractError)})}},{"./core":38,"./protocol/json":64,"./protocol/query":65,"./protocol/rest":66,"./protocol/rest_json":67,"./protocol/rest_xml":68,"./sequential_executor":77,util:20}],77:[function(e,t,r){var i=e("./core");i.SequentialExecutor=i.util.inherit({constructor:function(){this._events={}},listeners:function(e){return this._events[e]?this._events[e].slice(0):[]},on:function(e,t){return this._events[e]?this._events[e].push(t):this._events[e]=[t],this},onAsync:function(e,t){return t._isAsync=!0,this.on(e,t)},removeListener:function(e,t){var r=this._events[e];if(r){for(var i=r.length,n=-1,o=0;o<i;++o)r[o]===t&&(n=o);n>-1&&r.splice(n,1)}return this},removeAllListeners:function(e){return e?delete this._events[e]:this._events={},this},emit:function(e,t,r){r||(r=function(){});var i=this.listeners(e),n=i.length;return this.callListeners(i,t,r),n>0},callListeners:function(e,t,r,n){function o(n){if(n&&(s=i.util.error(s||new Error,n),a._haltHandlersOnError))return r.call(a,s);a.callListeners(e,t,r,s)}for(var a=this,s=n||null;e.length>0;){var l=e.shift();if(l._isAsync)return void l.apply(a,t.concat([o]));try{l.apply(a,t)}catch(e){s=i.util.error(s||new Error,e)}if(s&&a._haltHandlersOnError)return void r.call(a,s)}r.call(a,s)},addListeners:function(e){var t=this;return e._events&&(e=e._events),i.util.each(e,function(e,r){"function"==typeof r&&(r=[r]),i.util.arrayEach(r,function(r){t.on(e,r)})}),t},addNamedListener:function(e,t,r){return this[e]=r,this.addListener(t,r),this},addNamedAsyncListener:function(e,t,r){return r._isAsync=!0,this.addNamedListener(e,t,r)},addNamedListeners:function(e){var t=this;return e(function(){t.addNamedListener.apply(t,arguments)},function(){t.addNamedAsyncListener.apply(t,arguments)}),this}}),i.SequentialExecutor.prototype.addListener=i.SequentialExecutor.prototype.on,t.exports=i.SequentialExecutor},{"./core":38}],68:[function(e,t,r){function i(e){var t=e.service.api.operations[e.operation].input,r=new s.XML.Builder,i=e.params,n=t.payload;if(n){var o=t.members[n];if(void 0===(i=i[n]))return;if("structure"===o.type){var a=o.name;e.httpRequest.body=r.toXML(i,o,a,!0)}else e.httpRequest.body=i}else e.httpRequest.body=r.toXML(i,t,t.name||t.shape||l.string.upperFirst(e.operation)+"Request")}function n(e){d.buildRequest(e),["GET","HEAD"].indexOf(e.httpRequest.method)<0&&i(e)}function o(e){d.extractError(e);var t;try{t=(new s.XML.Parser).parse(e.httpResponse.body.toString())}catch(r){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=l.error(new Error,{code:t.Code,message:t.Message}):e.error=l.error(new Error,{code:e.httpResponse.statusCode,message:null})}function a(e){d.extractData(e);var t,r=e.request,i=e.httpResponse.body,n=r.service.api.operations[r.operation],o=n.output,a=o.payload;if(a){var u=o.members[a];"structure"===u.type?(t=new s.XML.Parser,e.data[a]=t.parse(i.toString(),u)):"binary"===u.type||u.isStreaming?e.data[a]=i:e.data[a]=u.toType(i)}else if(i.length>0){t=new s.XML.Parser;var c=t.parse(i.toString(),o);l.update(e.data,c)}}var s=e("../core"),l=e("../util"),d=e("./rest");t.exports={buildRequest:n,extractError:o,extractData:a}},{"../core":38,"../util":105,"./rest":66}],67:[function(e,t,r){function i(e){var t=new c,r=e.service.api.operations[e.operation].input;if(r.payload){var i={},o=r.members[r.payload];if(void 0===(i=e.params[r.payload]))return;"structure"===o.type?(e.httpRequest.body=t.build(i,o),n(e)):(e.httpRequest.body=i,("binary"===o.type||o.isStreaming)&&n(e,!0))}else e.httpRequest.body=t.build(e.params,r),n(e)}function n(e,t){if(e.service.api.operations[e.operation].input,!e.httpRequest.headers["Content-Type"]){var r=t?"binary/octet-stream":"application/json";e.httpRequest.headers["Content-Type"]=r}}function o(e){d.buildRequest(e),["GET","HEAD","DELETE"].indexOf(e.httpRequest.method)<0&&i(e)}function a(e){u.extractError(e)}function s(e){d.extractData(e);var t=e.request,r=t.service.api.operations[t.operation].output||{};if(r.payload){var i=r.members[r.payload],n=e.httpResponse.body;if("structure"===i.type||"list"===i.type){var o=new h;e.data[r.payload]=o.parse(n,i)}else"binary"===i.type||i.isStreaming?e.data[r.payload]=n:e.data[r.payload]=i.toType(n)}else{var a=e.data;u.extractData(e),e.data=l.merge(a,e.data)}}var l=e("../util"),d=e("./rest"),u=e("./json"),c=e("../json/builder"),h=e("../json/parser");t.exports={buildRequest:o,extractError:a,extractData:s}},{"../json/builder":54,"../json/parser":55,"../util":105,"./json":64,"./rest":66}],66:[function(e,t,r){function i(e){e.httpRequest.method=e.service.api.operations[e.operation].httpMethod}function n(e,t,r,i){var n=[e,t].join("/");n=n.replace(/\/+/g,"/");var o={},a=!1;if(u.each(r.members,function(e,t){var r=i[e];if(null!==r&&void 0!==r)if("uri"===t.location){var s=new RegExp("\\{"+t.name+"(\\+)?\\}");n=n.replace(s,function(e,t){return(t?u.uriEscapePath:u.uriEscape)(String(r))})}else"querystring"===t.location&&(a=!0,"list"===t.type?o[t.name]=r.map(function(e){return u.uriEscape(String(e))}):"map"===t.type?u.each(r,function(e,t){Array.isArray(t)?o[e]=t.map(function(e){return u.uriEscape(String(e))}):o[e]=u.uriEscape(String(t))}):o[t.name]=u.uriEscape(String(r)))}),a){n+=n.indexOf("?")>=0?"&":"?";var s=[];u.arrayEach(Object.keys(o).sort(),function(e){Array.isArray(o[e])||(o[e]=[o[e]]);for(var t=0;t<o[e].length;t++)s.push(u.uriEscape(String(e))+"="+o[e][t])}),n+=s.join("&")}return n}function o(e){var t=e.service.api.operations[e.operation],r=t.input,i=n(e.httpRequest.endpoint.path,t.httpPath,r,e.params);e.httpRequest.path=i}function a(e){var t=e.service.api.operations[e.operation];u.each(t.input.members,function(t,r){var i=e.params[t];null!==i&&void 0!==i&&("headers"===r.location&&"map"===r.type?u.each(i,function(t,i){e.httpRequest.headers[r.name+t]=i}):"header"===r.location&&(i=r.toWireFormat(i).toString(),r.isJsonValue&&(i=u.base64.encode(i)),e.httpRequest.headers[r.name]=i))})}function s(e){i(e),o(e),a(e)}function l(){}function d(e){var t=e.request,r={},i=e.httpResponse,n=t.service.api.operations[t.operation],o=n.output,a={};u.each(i.headers,function(e,t){a[e.toLowerCase()]=t}),u.each(o.members,function(e,t){var n=(t.name||e).toLowerCase();if("headers"===t.location&&"map"===t.type){r[e]={};var o=t.isLocationName?t.name:"",s=new RegExp("^"+o+"(.+)","i");u.each(i.headers,function(t,i){var n=t.match(s);null!==n&&(r[e][n[1]]=i)})}else if("header"===t.location){if(void 0!==a[n]){var l=t.isJsonValue?u.base64.decode(a[n]):a[n];r[e]=t.toType(l)}}else"statusCode"===t.location&&(r[e]=parseInt(i.statusCode,10))}),e.data=r}var u=e("../util");t.exports={buildRequest:s,extractError:l,extractData:d,generateURI:n}},{"../util":105}],65:[function(e,t,r){function i(e){var t=e.service.api.operations[e.operation],r=e.httpRequest;r.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",r.params={Version:e.service.api.apiVersion,Action:t.name},(new l).serialize(e.params,t.input,function(e,t){r.params[e]=t}),r.body=s.queryParamsToString(r.params)}function n(e){var t,r=e.httpResponse.body.toString();if(r.match("<UnknownOperationException"))t={Code:"UnknownOperation",Message:"Unknown operation "+e.request.operation};else try{t=(new a.XML.Parser).parse(r)}catch(r){t={Code:e.httpResponse.statusCode,Message:e.httpResponse.statusMessage}}t.requestId&&!e.requestId&&(e.requestId=t.requestId),t.Errors&&(t=t.Errors),t.Error&&(t=t.Error),t.Code?e.error=s.error(new Error,{code:t.Code,message:t.Message}):e.error=s.error(new Error,{code:e.httpResponse.statusCode,message:null})}function o(e){var t=e.request,r=t.service.api.operations[t.operation],i=r.output||{},n=i;if(n.resultWrapper){var o=d.create({type:"structure"});o.members[n.resultWrapper]=i,o.memberNames=[n.resultWrapper],s.property(i,"name",i.resultWrapper),i=o}var l=new a.XML.Parser;if(i&&i.members&&!i.members._XAMZRequestId){var u=d.create({type:"string"},{api:{protocol:"query"}},"requestId");i.members._XAMZRequestId=u}var c=l.parse(e.httpResponse.body.toString(),i);e.requestId=c._XAMZRequestId||c.requestId,c._XAMZRequestId&&delete c._XAMZRequestId,n.resultWrapper&&c[n.resultWrapper]&&(s.update(c,c[n.resultWrapper]),delete c[n.resultWrapper]),e.data=c}var a=e("../core"),s=e("../util"),l=e("../query/query_param_serializer"),d=e("../model/shape");t.exports={buildRequest:i,extractError:n,extractData:o}},{"../core":38,"../model/shape":61,"../query/query_param_serializer":69,"../util":105}],69:[function(e,t,r){function i(){}function n(e){return e.isQueryName||"ec2"!==e.api.protocol?e.name:e.name[0].toUpperCase()+e.name.substr(1)}function o(e,t,r,i){d.each(r.members,function(r,o){var a=t[r];if(null!==a&&void 0!==a){var s=n(o);s=e?e+"."+s:s,l(s,a,o,i)}})}function a(e,t,r,i){var n=1;d.each(t,function(t,o){var a=r.flattened?".":".entry.",s=a+n+++".",d=s+(r.key.name||"key"),u=s+(r.value.name||"value");l(e+d,t,r.key,i),l(e+u,o,r.value,i)})}function s(e,t,r,i){var o=r.member||{};if(0===t.length)return void i.call(this,e,null);d.arrayEach(t,function(t,a){var s="."+(a+1);if("ec2"===r.api.protocol)s+="";else if(r.flattened){if(o.name){var d=e.split(".");d.pop(),d.push(n(o)),e=d.join(".")}}else s="."+(o.name?o.name:"member")+s;l(e+s,t,o,i)})}function l(e,t,r,i){null!==t&&void 0!==t&&("structure"===r.type?o(e,t,r,i):"list"===r.type?s(e,t,r,i):"map"===r.type?a(e,t,r,i):i(e,r.toWireFormat(t).toString()))}var d=e("../util");i.prototype.serialize=function(e,t,r){o("",e,t,r)},t.exports=i},{"../util":105}],61:[function(e,t,r){function i(e,t,r){null!==r&&void 0!==r&&y.property.apply(this,arguments)}function n(e,t){e.constructor.prototype[t]||y.memoizedProperty.apply(this,arguments)}function o(e,t,r){t=t||{},i(this,"shape",e.shape),i(this,"api",t.api,!1),i(this,"type",e.type),i(this,"enum",e.enum),i(this,"min",e.min),i(this,"max",e.max),i(this,"pattern",e.pattern),i(this,"location",e.location||this.location||"body"),i(this,"name",this.name||e.xmlName||e.queryName||e.locationName||r),i(this,"isStreaming",e.streaming||this.isStreaming||!1),i(this,"isComposite",e.isComposite||!1),i(this,"isShape",!0,!1),i(this,"isQueryName",Boolean(e.queryName),!1),i(this,"isLocationName",Boolean(e.locationName),!1),i(this,"isIdempotent",!0===e.idempotencyToken),i(this,"isJsonValue",!0===e.jsonvalue),i(this,"isSensitive",!0===e.sensitive||e.prototype&&!0===e.prototype.sensitive),t.documentation&&(i(this,"documentation",e.documentation),i(this,"documentationUrl",e.documentationUrl)),e.xmlAttribute&&i(this,"isXmlAttribute",e.xmlAttribute||!1),i(this,"defaultValue",null),this.toWireFormat=function(e){return null===e||void 0===e?"":e},this.toType=function(e){return e}}function a(e){o.apply(this,arguments),i(this,"isComposite",!0),e.flattened&&i(this,"flattened",e.flattened||!1)}function s(e,t){var r=null,s=!this.isShape;a.apply(this,arguments),s&&(i(this,"defaultValue",function(){return{}}),i(this,"members",{}),i(this,"memberNames",[]),i(this,"required",[]),i(this,"isRequired",function(){return!1})),e.members&&(i(this,"members",new m(e.members,t,function(e,r){return o.create(r,t,e)})),n(this,"memberNames",function(){return e.xmlOrder||Object.keys(e.members)})),e.required&&(i(this,"required",e.required),i(this,"isRequired",function(t){if(!r){r={};for(var i=0;i<e.required.length;i++)r[e.required[i]]=!0}return r[t]},!1,!0)),i(this,"resultWrapper",e.resultWrapper||null),e.payload&&i(this,"payload",e.payload),"string"==typeof e.xmlNamespace?i(this,"xmlNamespaceUri",e.xmlNamespace):"object"==typeof e.xmlNamespace&&(i(this,"xmlNamespacePrefix",e.xmlNamespace.prefix),i(this,"xmlNamespaceUri",e.xmlNamespace.uri))}function l(e,t){var r=this,s=!this.isShape;if(a.apply(this,arguments),s&&i(this,"defaultValue",function(){return[]}),e.member&&n(this,"member",function(){return o.create(e.member,t)}),this.flattened){var l=this.name;n(this,"name",function(){return r.member.name||l})}}function d(e,t){var r=!this.isShape;a.apply(this,arguments),r&&(i(this,"defaultValue",function(){return{}}),i(this,"key",o.create({type:"string"},t)),i(this,"value",o.create({type:"string"},t))),e.key&&n(this,"key",function(){return o.create(e.key,t)}),e.value&&n(this,"value",function(){return o.create(e.value,t)})}function u(e){var t=this;if(o.apply(this,arguments),"header"===this.location)i(this,"timestampFormat","rfc822");else if(e.timestampFormat)i(this,"timestampFormat",e.timestampFormat);else if(!this.timestampFormat&&this.api)if(this.api.timestampFormat)i(this,"timestampFormat",this.api.timestampFormat);else switch(this.api.protocol){case"json":case"rest-json":i(this,"timestampFormat","unixTimestamp");break;case"rest-xml":case"query":case"ec2":i(this,"timestampFormat","iso8601")}this.toType=function(e){return null===e||void 0===e?null:"function"==typeof e.toUTCString?e:"string"==typeof e||"number"==typeof e?y.date.parseTimestamp(e):null},this.toWireFormat=function(e){return y.date.format(e,t.timestampFormat)}}function c(){o.apply(this,arguments);var e=["rest-xml","query","ec2"];this.toType=function(t){return t=this.api&&e.indexOf(this.api.protocol)>-1?t||"":t,this.isJsonValue?JSON.parse(t):t&&"function"==typeof t.toString?t.toString():t},this.toWireFormat=function(e){return this.isJsonValue?JSON.stringify(e):e}}function h(){o.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseFloat(e)},this.toWireFormat=this.toType}function p(){o.apply(this,arguments),this.toType=function(e){return null===e||void 0===e?null:parseInt(e,10)},this.toWireFormat=this.toType}function f(){o.apply(this,arguments),this.toType=y.base64.decode,this.toWireFormat=y.base64.encode}function g(){f.apply(this,arguments)}function v(){o.apply(this,arguments),this.toType=function(e){return"boolean"==typeof e?e:null===e||void 0===e?null:"true"===e}}var m=e("./collection"),y=e("../util");o.normalizedTypes={character:"string",double:"float",long:"integer",short:"integer",biginteger:"integer",bigdecimal:"float",blob:"binary"},o.types={structure:s,list:l,map:d,boolean:v,timestamp:u,float:h,integer:p,string:c,base64:g,binary:f},o.resolve=function(e,t){if(e.shape){var r=t.api.shapes[e.shape];if(!r)throw new Error("Cannot find shape reference: "+e.shape);return r}return null},o.create=function(e,t,r){if(e.isShape)return e;var i=o.resolve(e,t);if(i){var n=Object.keys(e);t.documentation||(n=n.filter(function(e){return!e.match(/documentation/)}));var a=function(){i.constructor.call(this,e,t,r)};return a.prototype=i,new a}e.type||(e.members?e.type="structure":e.member?e.type="list":e.key?e.type="map":e.type="string");var s=e.type;if(o.normalizedTypes[e.type]&&(e.type=o.normalizedTypes[e.type]),o.types[e.type])return new o.types[e.type](e,t,r);throw new Error("Unrecognized shape type: "+s)},o.shapes={StructureShape:s,ListShape:l,MapShape:d,StringShape:c,BooleanShape:v,Base64Shape:g},t.exports=o},{"../util":105,"./collection":57}],57:[function(e,t,r){function i(e,t,r,i){o(this,i(e),function(){return r(e,t)})}function n(e,t,r,n){n=n||String;var o=this;for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&i.call(o,a,e[a],r,n)}var o=e("../util").memoizedProperty;t.exports=n},{"../util":105}],64:[function(e,t,r){function i(e){var t=e.httpRequest,r=e.service.api,i=r.targetPrefix+"."+r.operations[e.operation].name,n=r.jsonVersion||"1.0",o=r.operations[e.operation].input,a=new s;1===n&&(n="1.0"),t.body=a.build(e.params||{},o),t.headers["Content-Type"]="application/x-amz-json-"+n,t.headers["X-Amz-Target"]=i}function n(e){var t={},r=e.httpResponse;if(t.code=r.headers["x-amzn-errortype"]||"UnknownError","string"==typeof t.code&&(t.code=t.code.split(":")[0]),r.body.length>0)try{var i=JSON.parse(r.body.toString());(i.__type||i.code)&&(t.code=(i.__type||i.code).split("#").pop()),"RequestEntityTooLarge"===t.code?t.message="Request body must be less than 1 MB":t.message=i.message||i.Message||null}catch(i){t.statusCode=r.statusCode,t.message=r.statusMessage}else t.statusCode=r.statusCode,t.message=r.statusCode.toString();e.error=a.error(new Error,t)}function o(e){var t=e.httpResponse.body.toString()||"{}";if(!1===e.request.service.config.convertResponseTypes)e.data=JSON.parse(t);else{var r=e.request.service.api.operations[e.request.operation],i=r.output||{},n=new l;e.data=n.parse(t,i)}}var a=e("../util"),s=e("../json/builder"),l=e("../json/parser");t.exports={buildRequest:i,extractError:n,extractData:o}},{"../json/builder":54,"../json/parser":55,"../util":105}],55:[function(e,t,r){function i(){}function n(e,t){if(t&&void 0!==e)switch(t.type){case"structure":return o(e,t);case"map":return s(e,t);case"list":return a(e,t);default:return l(e,t)}}function o(e,t){if(null!=e){var r={},i=t.members;return d.each(i,function(t,i){var o=i.isLocationName?i.name:t;if(Object.prototype.hasOwnProperty.call(e,o)){var a=e[o],s=n(a,i);void 0!==s&&(r[t]=s)}}),r}}function a(e,t){if(null!=e){var r=[];return d.arrayEach(e,function(e){var i=n(e,t.member);void 0===i?r.push(null):r.push(i)}),r}}function s(e,t){if(null!=e){var r={};return d.each(e,function(e,i){var o=n(i,t.value);r[e]=void 0===o?null:o}),r}}function l(e,t){return t.toType(e)}var d=e("../util");i.prototype.parse=function(e,t){return n(JSON.parse(e),t)},t.exports=i},{"../util":105}],54:[function(e,t,r){function i(){}function n(e,t){if(t&&void 0!==e&&null!==e)switch(t.type){case"structure":return o(e,t);case"map":return s(e,t);case"list":return a(e,t);default:return l(e,t)}}function o(e,t){var r={};return d.each(e,function(e,i){
var o=t.members[e];if(o){if("body"!==o.location)return;var a=o.isLocationName?o.name:e,s=n(i,o);void 0!==s&&(r[a]=s)}}),r}function a(e,t){var r=[];return d.arrayEach(e,function(e){var i=n(e,t.member);void 0!==i&&r.push(i)}),r}function s(e,t){var r={};return d.each(e,function(e,i){var o=n(i,t.value);void 0!==o&&(r[e]=o)}),r}function l(e,t){return t.toWireFormat(e)}var d=e("../util");i.prototype.build=function(e,t){return JSON.stringify(n(e,t))},t.exports=i},{"../util":105}],105:[function(e,t,r){(function(r,i){var n,o={environment:"nodejs",engine:function(){if(o.isBrowser()&&"undefined"!=typeof navigator)return navigator.userAgent;var e=r.platform+"/"+r.version;return r.env.AWS_EXECUTION_ENV&&(e+=" exec-env/"+r.env.AWS_EXECUTION_ENV),e},userAgent:function(){var t=o.environment,r="aws-sdk-"+t+"/"+e("./core").VERSION;return"nodejs"===t&&(r+=" "+o.engine()),r},isBrowser:function(){return r&&r.browser},isNode:function(){return!o.isBrowser()},uriEscape:function(e){var t=encodeURIComponent(e);return t=t.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),t=t.replace(/[*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},uriEscapePath:function(e){var t=[];return o.arrayEach(e.split("/"),function(e){t.push(o.uriEscape(e))}),t.join("/")},urlParse:function(e){return o.url.parse(e)},urlFormat:function(e){return o.url.format(e)},queryStringParse:function(e){return o.querystring.parse(e)},queryParamsToString:function(e){var t=[],r=o.uriEscape,i=Object.keys(e).sort();return o.arrayEach(i,function(i){var n=e[i],a=r(i),s=a+"=";if(Array.isArray(n)){var l=[];o.arrayEach(n,function(e){l.push(r(e))}),s=a+"="+l.sort().join("&"+a+"=")}else void 0!==n&&null!==n&&(s=a+"="+r(n));t.push(s)}),t.join("&")},readFileSync:function(t){return o.isBrowser()?null:e("fs").readFileSync(t,"utf-8")},base64:{encode:function(e){if("number"==typeof e)throw o.error(new Error("Cannot base64 encode number "+e));return null===e||void 0===e?e:("function"==typeof o.Buffer.from&&o.Buffer.from!==Uint8Array.from?o.Buffer.from(e):new o.Buffer(e)).toString("base64")},decode:function(e){if("number"==typeof e)throw o.error(new Error("Cannot base64 decode number "+e));return null===e||void 0===e?e:"function"==typeof o.Buffer.from&&o.Buffer.from!==Uint8Array.from?o.Buffer.from(e,"base64"):new o.Buffer(e,"base64")}},buffer:{toStream:function(e){o.Buffer.isBuffer(e)||(e=new o.Buffer(e));var t=new o.stream.Readable,r=0;return t._read=function(i){if(r>=e.length)return t.push(null);var n=r+i;n>e.length&&(n=e.length),t.push(e.slice(r,n)),r=n},t},concat:function(e){var t,r=0,i=0,n=null;for(t=0;t<e.length;t++)r+=e[t].length;for(n=new o.Buffer(r),t=0;t<e.length;t++)e[t].copy(n,i),i+=e[t].length;return n}},string:{byteLength:function(t){if(null===t||void 0===t)return 0;if("string"==typeof t&&(t=new o.Buffer(t)),"number"==typeof t.byteLength)return t.byteLength;if("number"==typeof t.length)return t.length;if("number"==typeof t.size)return t.size;if("string"==typeof t.path)return e("fs").lstatSync(t.path).size;throw o.error(new Error("Cannot determine length of "+t),{object:t})},upperFirst:function(e){return e[0].toUpperCase()+e.substr(1)},lowerFirst:function(e){return e[0].toLowerCase()+e.substr(1)}},ini:{parse:function(e){var t,r={};return o.arrayEach(e.split(/\r?\n/),function(e){e=e.split(/(^|\s)[;#]/)[0];var i=e.match(/^\s*\[([^\[\]]+)\]\s*$/);if(i)t=i[1];else if(t){var n=e.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);n&&(r[t]=r[t]||{},r[t][n[1]]=n[2])}}),r}},fn:{noop:function(){},makeAsync:function(e,t){return t&&t<=e.length?e:function(){var t=Array.prototype.slice.call(arguments,0);t.pop()(e.apply(null,t))}}},date:{getDate:function(){return n||(n=e("./core")),n.config.systemClockOffset?new Date((new Date).getTime()+n.config.systemClockOffset):new Date},iso8601:function(e){return void 0===e&&(e=o.date.getDate()),e.toISOString().replace(/\.\d{3}Z$/,"Z")},rfc822:function(e){return void 0===e&&(e=o.date.getDate()),e.toUTCString()},unixTimestamp:function(e){return void 0===e&&(e=o.date.getDate()),e.getTime()/1e3},from:function(e){return"number"==typeof e?new Date(1e3*e):new Date(e)},format:function(e,t){return t||(t="iso8601"),o.date[t](o.date.from(e))},parseTimestamp:function(e){if("number"==typeof e)return new Date(1e3*e);if(e.match(/^\d+$/))return new Date(1e3*e);if(e.match(/^\d{4}/))return new Date(e);if(e.match(/^\w{3},/))return new Date(e);throw o.error(new Error("unhandled timestamp format: "+e),{code:"TimestampParserError"})}},crypto:{crc32Table:[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32:function(e){var t=o.crypto.crc32Table,r=-1;"string"==typeof e&&(e=new o.Buffer(e));for(var i=0;i<e.length;i++)r=r>>>8^t[255&(r^e.readUInt8(i))];return(-1^r)>>>0},hmac:function(e,t,r,i){return r||(r="binary"),"buffer"===r&&(r=void 0),i||(i="sha256"),"string"==typeof t&&(t=new o.Buffer(t)),o.crypto.lib.createHmac(i,e).update(t).digest(r)},md5:function(e,t,r){return o.crypto.hash("md5",e,t,r)},sha256:function(e,t,r){return o.crypto.hash("sha256",e,t,r)},hash:function(e,t,r,i){var n=o.crypto.createHash(e);r||(r="binary"),"buffer"===r&&(r=void 0),"string"==typeof t&&(t=new o.Buffer(t));var a=o.arraySliceFn(t),s=o.Buffer.isBuffer(t);if(o.isBrowser()&&"undefined"!=typeof ArrayBuffer&&t&&t.buffer instanceof ArrayBuffer&&(s=!0),i&&"object"==typeof t&&"function"==typeof t.on&&!s)t.on("data",function(e){n.update(e)}),t.on("error",function(e){i(e)}),t.on("end",function(){i(null,n.digest(r))});else{if(!i||!a||s||"undefined"==typeof FileReader){o.isBrowser()&&"object"==typeof t&&!s&&(t=new o.Buffer(new Uint8Array(t)));var l=n.update(t).digest(r);return i&&i(null,l),l}var d=0,u=new FileReader;u.onerror=function(){i(new Error("Failed to read data."))},u.onload=function(){var e=new o.Buffer(new Uint8Array(u.result));n.update(e),d+=e.length,u._continueReading()},u._continueReading=function(){if(d>=t.size)return void i(null,n.digest(r));var e=d+524288;e>t.size&&(e=t.size),u.readAsArrayBuffer(a.call(t,d,e))},u._continueReading()}},toHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push(("0"+e.charCodeAt(r).toString(16)).substr(-2,2));return t.join("")},createHash:function(e){return o.crypto.lib.createHash(e)}},abort:{},each:function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t.call(this,r,e[r]);if(i===o.abort)break}},arrayEach:function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t.call(this,e[r],parseInt(r,10));if(i===o.abort)break}},update:function(e,t){return o.each(t,function(t,r){e[t]=r}),e},merge:function(e,t){return o.update(o.copy(e),t)},copy:function(e){if(null===e||void 0===e)return e;var t={};for(var r in e)t[r]=e[r];return t},isEmpty:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},arraySliceFn:function(e){var t=e.slice||e.webkitSlice||e.mozSlice;return"function"==typeof t?t:null},isType:function(e,t){return"function"==typeof t&&(t=o.typeName(t)),Object.prototype.toString.call(e)==="[object "+t+"]"},typeName:function(e){if(Object.prototype.hasOwnProperty.call(e,"name"))return e.name;var t=e.toString(),r=t.match(/^\s*function (.+)\(/);return r?r[1]:t},error:function(e,t){var r=null;return"string"==typeof e.message&&""!==e.message&&("string"==typeof t||t&&t.message)&&(r=o.copy(e),r.message=e.message),e.message=e.message||null,"string"==typeof t?e.message=t:"object"==typeof t&&null!==t&&(o.update(e,t),t.message&&(e.message=t.message),(t.code||t.name)&&(e.code=t.code||t.name),t.stack&&(e.stack=t.stack)),"function"==typeof Object.defineProperty&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=t&&t.name||e.name||e.code||"Error",e.time=new Date,r&&(e.originalError=r),e},inherit:function(e,t){var r=null;if(void 0===t)t=e,e=Object,r={};else{var i=function(){};i.prototype=e.prototype,r=new i}return t.constructor===Object&&(t.constructor=function(){if(e!==Object)return e.apply(this,arguments)}),t.constructor.prototype=r,o.update(t.constructor.prototype,t),t.constructor.__super__=e,t.constructor},mixin:function(){for(var e=arguments[0],t=1;t<arguments.length;t++)for(var r in arguments[t].prototype){var i=arguments[t].prototype[r];"constructor"!==r&&(e.prototype[r]=i)}return e},hideProperties:function(e,t){"function"==typeof Object.defineProperty&&o.arrayEach(t,function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0})})},property:function(e,t,r,i,n){var o={configurable:!0,enumerable:void 0===i||i};"function"!=typeof r||n?(o.value=r,o.writable=!0):o.get=r,Object.defineProperty(e,t,o)},memoizedProperty:function(e,t,r,i){var n=null;o.property(e,t,function(){return null===n&&(n=r()),n},i)},hoistPayloadMember:function(e){var t=e.request,r=t.operation,i=t.service.api.operations[r].output;if(i.payload){var n=i.members[i.payload],a=e.data[i.payload];"structure"===n.type&&o.each(a,function(t,r){o.property(e.data,t,r,!1)})}},computeSha256:function(t,r){if(o.isNode()){var i=o.stream.Stream,n=e("fs");if(t instanceof i){if("string"!=typeof t.path)return r(new Error("Non-file stream objects are not supported with SigV4"));var a={};"number"==typeof t.start&&(a.start=t.start),"number"==typeof t.end&&(a.end=t.end),t=n.createReadStream(t.path,a)}}o.crypto.sha256(t,"hex",function(e,t){e?r(e):r(null,t)})},isClockSkewed:function(e){if(e)return o.property(n.config,"isClockSkewed",Math.abs((new Date).getTime()-e)>=3e5,!1),n.config.isClockSkewed},applyClockOffset:function(e){e&&(n.config.systemClockOffset=e-(new Date).getTime())},extractRequestId:function(e){var t=e.httpResponse.headers["x-amz-request-id"]||e.httpResponse.headers["x-amzn-requestid"];!t&&e.data&&e.data.ResponseMetadata&&(t=e.data.ResponseMetadata.RequestId),t&&(e.requestId=t),e.error&&(e.error.requestId=t)},addPromises:function(e,t){if(void 0===t&&n&&n.config&&(t=n.config.getPromisesDependency()),void 0===t&&"undefined"!=typeof Promise&&(t=Promise),"function"!=typeof t)var r=!0;Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var o=e[i];r?o.deletePromisesFromClass&&o.deletePromisesFromClass():o.addPromisesToClass&&o.addPromisesToClass(t)}},promisifyMethod:function(e,t){return function(){var r=this;return new t(function(t,i){r[e](function(e,r){e?i(e):t(r)})})}},isDualstackAvailable:function(t){if(!t)return!1;var r=e("../apis/metadata.json");return"string"!=typeof t&&(t=t.serviceIdentifier),!("string"!=typeof t||!r.hasOwnProperty(t)||!r[t].dualstackAvailable)},calculateRetryDelay:function(e,t){t||(t={});var r=t.customBackoff||null;if("function"==typeof r)return r(e);var i="number"==typeof t.base?t.base:100;return Math.random()*(Math.pow(2,e)*i)},handleRequestWithRetries:function(e,t,r){t||(t={});var i=n.HttpClient.getInstance(),a=t.httpOptions||{},s=0,l=function(e){var i=t.maxRetries||0;if(e&&"TimeoutError"===e.code&&(e.retryable=!0),e&&e.retryable&&s<i){s++;var n=o.calculateRetryDelay(s,t.retryDelayOptions);setTimeout(d,n+(e.retryAfter||0))}else r(e)},d=function(){var t="";i.handleRequest(e,a,function(e){e.on("data",function(e){t+=e.toString()}),e.on("end",function(){var i=e.statusCode;if(i<300)r(null,t);else{var n=1e3*parseInt(e.headers["retry-after"],10)||0,a=o.error(new Error,{retryable:i>=500||429===i});n&&a.retryable&&(a.retryAfter=n),l(a)}})},l)};n.util.defer(d)},uuid:{v4:function(){return e("uuid").v4()}},convertPayloadToString:function(e){var t=e.request,r=t.operation,i=t.service.api.operations[r].output||{};i.payload&&e.data[i.payload]&&(e.data[i.payload]=e.data[i.payload].toString())},defer:function(e){"object"==typeof r&&"function"==typeof r.nextTick?r.nextTick(e):"function"==typeof i?i(e):setTimeout(e,0)},defaultProfile:"default",configOptInEnv:"AWS_SDK_LOAD_CONFIG",sharedCredentialsFileEnv:"AWS_SHARED_CREDENTIALS_FILE",sharedConfigFileEnv:"AWS_CONFIG_FILE",imdsDisabledEnv:"AWS_EC2_METADATA_DISABLED"};t.exports=o}).call(this,e("_process"),e("timers").setImmediate)},{"../apis/metadata.json":26,"./core":38,_process:9,fs:2,timers:17,uuid:21}],37:[function(e,t,r){var i=e("./core");e("./credentials"),e("./credentials/credential_provider_chain");var n;i.Config=i.util.inherit({constructor:function(e){void 0===e&&(e={}),e=this.extractCredentials(e),i.util.each.call(this,this.keys,function(t,r){this.set(t,e[t],r)})},getCredentials:function(e){function t(t){e(t,t?null:n.credentials)}function r(e,t){return new i.util.error(t||new Error,{code:"CredentialsError",message:e,name:"CredentialsError"})}var n=this;n.credentials?"function"==typeof n.credentials.get?function(){n.credentials.get(function(e){e&&(e=r("Could not load credentials from "+n.credentials.constructor.name,e)),t(e)})}():function(){var e=null;n.credentials.accessKeyId&&n.credentials.secretAccessKey||(e=r("Missing credentials")),t(e)}():n.credentialProvider?n.credentialProvider.resolve(function(e,i){e&&(e=r("Could not load credentials from any providers",e)),n.credentials=i,t(e)}):t(r("No credentials to load"))},update:function(e,t){t=t||!1,e=this.extractCredentials(e),i.util.each.call(this,e,function(e,r){(t||Object.prototype.hasOwnProperty.call(this.keys,e)||i.Service.hasService(e))&&this.set(e,r)})},loadFromPath:function(e){this.clear();var t=JSON.parse(i.util.readFileSync(e)),r=new i.FileSystemCredentials(e),n=new i.CredentialProviderChain;return n.providers.unshift(r),n.resolve(function(e,r){if(e)throw e;t.credentials=r}),this.constructor(t),this},clear:function(){i.util.each.call(this,this.keys,function(e){delete this[e]}),this.set("credentials",void 0),this.set("credentialProvider",void 0)},set:function(e,t,r){void 0===t?(void 0===r&&(r=this.keys[e]),this[e]="function"==typeof r?r.call(this):r):"httpOptions"===e&&this[e]?this[e]=i.util.merge(this[e],t):this[e]=t},keys:{credentials:null,credentialProvider:null,region:null,logger:null,apiVersions:{},apiVersion:null,endpoint:void 0,httpOptions:{timeout:12e4},maxRetries:void 0,maxRedirects:10,paramValidation:!0,sslEnabled:!0,s3ForcePathStyle:!1,s3BucketEndpoint:!1,s3DisableBodySigning:!0,computeChecksums:!0,convertResponseTypes:!0,correctClockSkew:!1,customUserAgent:null,dynamoDbCrc32:!0,systemClockOffset:0,signatureVersion:null,signatureCache:!0,retryDelayOptions:{},useAccelerateEndpoint:!1},extractCredentials:function(e){return e.accessKeyId&&e.secretAccessKey&&(e=i.util.copy(e),e.credentials=new i.Credentials(e)),e},setPromisesDependency:function(e){n=e,null===e&&"function"==typeof Promise&&(n=Promise);var t=[i.Request,i.Credentials,i.CredentialProviderChain];i.S3&&i.S3.ManagedUpload&&t.push(i.S3.ManagedUpload),i.util.addPromises(t,n)},getPromisesDependency:function(){return n}}),i.config=new i.Config},{"./core":38,"./credentials":39,"./credentials/credential_provider_chain":41}],41:[function(e,t,r){var i=e("../core");i.CredentialProviderChain=i.util.inherit(i.Credentials,{constructor:function(e){this.providers=e||i.CredentialProviderChain.defaultProviders.slice(0)},resolve:function(e){function t(n,o){if(!n&&o||r===i.length)return void e(n,o);var a=i[r++];o="function"==typeof a?a.call():a,o.get?o.get(function(e){t(e,e?null:o)}):t(null,o)}if(0===this.providers.length)return e(new Error("No providers")),this;var r=0,i=this.providers.slice(0);return t(),this}}),i.CredentialProviderChain.defaultProviders=[],i.CredentialProviderChain.addPromisesToClass=function(e){this.prototype.resolvePromise=i.util.promisifyMethod("resolve",e)},i.CredentialProviderChain.deletePromisesFromClass=function(){delete this.prototype.resolvePromise},i.util.addPromises(i.CredentialProviderChain)},{"../core":38}],39:[function(e,t,r){var i=e("./core");i.Credentials=i.util.inherit({constructor:function(){if(i.util.hideProperties(this,["secretAccessKey"]),this.expired=!1,this.expireTime=null,1===arguments.length&&"object"==typeof arguments[0]){var e=arguments[0].credentials||arguments[0];this.accessKeyId=e.accessKeyId,this.secretAccessKey=e.secretAccessKey,this.sessionToken=e.sessionToken}else this.accessKeyId=arguments[0],this.secretAccessKey=arguments[1],this.sessionToken=arguments[2]},expiryWindow:15,needsRefresh:function(){var e=i.util.date.getDate().getTime(),t=new Date(e+1e3*this.expiryWindow);return!!(this.expireTime&&t>this.expireTime)||this.expired||!this.accessKeyId||!this.secretAccessKey},get:function(e){var t=this;this.needsRefresh()?this.refresh(function(r){r||(t.expired=!1),e&&e(r)}):e&&e()},refresh:function(e){this.expired=!1,e()}}),i.Credentials.addPromisesToClass=function(e){this.prototype.getPromise=i.util.promisifyMethod("get",e),this.prototype.refreshPromise=i.util.promisifyMethod("refresh",e)},i.Credentials.deletePromisesFromClass=function(){delete this.prototype.getPromise,delete this.prototype.refreshPromise},i.util.addPromises(i.Credentials)},{"./core":38}],27:[function(e,t,r){function i(e,t){if(!i.services.hasOwnProperty(e))throw new Error("InvalidService: Failed to load api for "+e);return i.services[e][t]}i.services={},t.exports=i},{}],26:[function(e,t,r){t.exports={acm:{name:"ACM",cors:!0},apigateway:{name:"APIGateway",cors:!0},applicationautoscaling:{prefix:"application-autoscaling",name:"ApplicationAutoScaling",cors:!0},appstream:{name:"AppStream"},autoscaling:{name:"AutoScaling",cors:!0},batch:{name:"Batch"},budgets:{name:"Budgets"},clouddirectory:{name:"CloudDirectory"},cloudformation:{name:"CloudFormation",cors:!0},cloudfront:{name:"CloudFront",versions:["2013-05-12*","2013-11-11*","2014-05-31*","2014-10-21*","2014-11-06*","2015-04-17*","2015-07-27*","2015-09-17*","2016-01-13*","2016-01-28*","2016-08-01*","2016-08-20*","2016-09-07*","2016-09-29*","2016-11-25*","2017-03-25*"],cors:!0},cloudhsm:{name:"CloudHSM",cors:!0},cloudsearch:{name:"CloudSearch"},cloudsearchdomain:{name:"CloudSearchDomain"},cloudtrail:{name:"CloudTrail",cors:!0},cloudwatch:{prefix:"monitoring",name:"CloudWatch",cors:!0},cloudwatchevents:{prefix:"events",name:"CloudWatchEvents",versions:["2014-02-03*"],cors:!0},cloudwatchlogs:{prefix:"logs",name:"CloudWatchLogs",cors:!0},codebuild:{name:"CodeBuild",cors:!0},codecommit:{name:"CodeCommit",cors:!0},codedeploy:{name:"CodeDeploy",cors:!0},codepipeline:{name:"CodePipeline",cors:!0},cognitoidentity:{prefix:"cognito-identity",name:"CognitoIdentity",cors:!0},cognitoidentityserviceprovider:{prefix:"cognito-idp",name:"CognitoIdentityServiceProvider",cors:!0},cognitosync:{prefix:"cognito-sync",name:"CognitoSync",cors:!0},configservice:{prefix:"config",name:"ConfigService",cors:!0},cur:{name:"CUR",cors:!0},datapipeline:{name:"DataPipeline"},devicefarm:{name:"DeviceFarm",cors:!0},directconnect:{name:"DirectConnect",cors:!0},directoryservice:{prefix:"ds",name:"DirectoryService"},discovery:{name:"Discovery"},dms:{name:"DMS"},dynamodb:{name:"DynamoDB",cors:!0},dynamodbstreams:{prefix:"streams.dynamodb",name:"DynamoDBStreams",cors:!0},ec2:{name:"EC2",versions:["2013-06-15*","2013-10-15*","2014-02-01*","2014-05-01*","2014-06-15*","2014-09-01*","2014-10-01*","2015-03-01*","2015-04-15*","2015-10-01*","2016-04-01*","2016-09-15*"],cors:!0},ecr:{name:"ECR",cors:!0},ecs:{name:"ECS",cors:!0},efs:{prefix:"elasticfilesystem",name:"EFS",cors:!0},elasticache:{name:"ElastiCache",versions:["2012-11-15*","2014-03-24*","2014-07-15*","2014-09-30*"],cors:!0},elasticbeanstalk:{name:"ElasticBeanstalk",cors:!0},elb:{prefix:"elasticloadbalancing",name:"ELB",cors:!0},elbv2:{prefix:"elasticloadbalancingv2",name:"ELBv2",cors:!0},emr:{prefix:"elasticmapreduce",name:"EMR",cors:!0},es:{name:"ES"},elastictranscoder:{name:"ElasticTranscoder",cors:!0},firehose:{name:"Firehose",cors:!0},gamelift:{name:"GameLift",cors:!0},glacier:{name:"Glacier"},health:{name:"Health"},iam:{name:"IAM"},importexport:{name:"ImportExport"},inspector:{name:"Inspector",versions:["2015-08-18*"],cors:!0},iot:{name:"Iot",cors:!0},iotdata:{prefix:"iot-data",name:"IotData",cors:!0},kinesis:{name:"Kinesis",cors:!0},kinesisanalytics:{name:"KinesisAnalytics"},kms:{name:"KMS",cors:!0},lambda:{name:"Lambda",cors:!0},lexruntime:{prefix:"runtime.lex",name:"LexRuntime",cors:!0},lightsail:{name:"Lightsail"},machinelearning:{name:"MachineLearning",cors:!0},marketplacecommerceanalytics:{name:"MarketplaceCommerceAnalytics",cors:!0},marketplacemetering:{prefix:"meteringmarketplace",name:"MarketplaceMetering"},mturk:{prefix:"mturk-requester",name:"MTurk",cors:!0},mobileanalytics:{name:"MobileAnalytics",cors:!0},opsworks:{name:"OpsWorks",cors:!0},opsworkscm:{name:"OpsWorksCM"},organizations:{name:"Organizations"},pinpoint:{name:"Pinpoint"},polly:{name:"Polly",cors:!0},rds:{name:"RDS",versions:["2014-09-01*"],cors:!0},redshift:{name:"Redshift",cors:!0},rekognition:{name:"Rekognition",cors:!0},resourcegroupstaggingapi:{name:"ResourceGroupsTaggingAPI"},route53:{name:"Route53",cors:!0},route53domains:{name:"Route53Domains",cors:!0},s3:{name:"S3",dualstackAvailable:!0,cors:!0},servicecatalog:{name:"ServiceCatalog",cors:!0},ses:{prefix:"email",name:"SES",cors:!0},shield:{name:"Shield"},simpledb:{prefix:"sdb",name:"SimpleDB"},sms:{name:"SMS"},snowball:{name:"Snowball"},sns:{name:"SNS",cors:!0},sqs:{name:"SQS",cors:!0},ssm:{name:"SSM",cors:!0},storagegateway:{name:"StorageGateway",cors:!0},stepfunctions:{prefix:"states",name:"StepFunctions"},sts:{name:"STS",cors:!0},support:{name:"Support"},swf:{name:"SWF"},xray:{name:"XRay"},waf:{name:"WAF",cors:!0},wafregional:{prefix:"waf-regional",name:"WAFRegional"},workdocs:{name:"WorkDocs",cors:!0},workspaces:{name:"WorkSpaces"},codestar:{name:"CodeStar"},lexmodelbuildingservice:{prefix:"lex-models",name:"LexModelBuildingService",cors:!0},marketplaceentitlementservice:{prefix:"entitlement.marketplace",name:"MarketplaceEntitlementService"},athena:{name:"Athena"},greengrass:{name:"Greengrass"},dax:{name:"DAX"},migrationhub:{prefix:"AWSMigrationHub",name:"MigrationHub"},cloudhsmv2:{name:"CloudHSMV2"},glue:{name:"Glue"},mobile:{name:"Mobile"},pricing:{name:"Pricing"},costexplorer:{prefix:"ce",name:"CostExplorer"},mediaconvert:{name:"MediaConvert"},medialive:{name:"MediaLive"},mediapackage:{name:"MediaPackage"},mediastore:{name:"MediaStore"},mediastoredata:{prefix:"mediastore-data",name:"MediaStoreData"},appsync:{name:"AppSync"},guardduty:{name:"GuardDuty"},mq:{name:"MQ"},comprehend:{name:"Comprehend"},iotjobsdataplane:{prefix:"iot-jobs-data",name:"IoTJobsDataPlane"},kinesisvideoarchivedmedia:{prefix:"kinesis-video-archived-media",name:"KinesisVideoArchivedMedia"},kinesisvideomedia:{prefix:"kinesis-video-media",name:"KinesisVideoMedia"},kinesisvideo:{name:"KinesisVideo"},sagemakerruntime:{prefix:"runtime.sagemaker",name:"SageMakerRuntime"},sagemaker:{name:"SageMaker"},translate:{name:"Translate"},resourcegroups:{prefix:"resource-groups",name:"ResourceGroups"},alexaforbusiness:{name:"AlexaForBusiness"},cloud9:{name:"Cloud9"},serverlessapplicationrepository:{prefix:"serverlessrepo",name:"ServerlessApplicationRepository"},servicediscovery:{name:"ServiceDiscovery"},workmail:{name:"WorkMail"},autoscalingplans:{prefix:"autoscaling-plans",name:"AutoScalingPlans"},transcribeservice:{prefix:"transcribe",name:"TranscribeService"},connect:{name:"Connect"},acmpca:{prefix:"acm-pca",name:"ACMPCA"},fms:{name:"FMS"},secretsmanager:{name:"SecretsManager"},iotanalytics:{name:"IoTAnalytics"},iot1clickdevicesservice:{prefix:"iot1click-devices",name:"IoT1ClickDevicesService"},iot1clickprojects:{prefix:"iot1click-projects",name:"IoT1ClickProjects"},pi:{name:"PI"},neptune:{name:"Neptune"},mediatailor:{name:"MediaTailor"},eks:{name:"EKS"}}},{}],21:[function(e,t,r){var i=e("./v1"),n=e("./v4"),o=n;o.v1=i,o.v4=n,t.exports=o},{"./v1":24,"./v4":25}],25:[function(e,t,r){function i(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}var n=e("./lib/rng"),o=e("./lib/bytesToUuid");t.exports=i},{"./lib/bytesToUuid":22,"./lib/rng":23}],24:[function(e,t,r){function i(e,t,r){var i=t&&r||0,n=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:l,c=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:u+1,p=c-d+(h-u)/1e4;if(p<0&&void 0===e.clockseq&&(a=a+1&16383),(p<0||c>d)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=c,u=h,l=a,c+=122192928e5;var f=(1e4*(268435455&c)+h)%4294967296;n[i++]=f>>>24&255,n[i++]=f>>>16&255,n[i++]=f>>>8&255,n[i++]=255&f;var g=c/4294967296*1e4&268435455;n[i++]=g>>>8&255,n[i++]=255&g,n[i++]=g>>>24&15|16,n[i++]=g>>>16&255,n[i++]=a>>>8|128,n[i++]=255&a;for(var v=e.node||s,m=0;m<6;++m)n[i+m]=v[m];return t||o(n)}var n=e("./lib/rng"),o=e("./lib/bytesToUuid"),a=n(),s=[1|a[0],a[1],a[2],a[3],a[4],a[5]],l=16383&(a[6]<<8|a[7]),d=0,u=0;t.exports=i},{"./lib/bytesToUuid":22,"./lib/rng":23}],23:[function(t,r,i){(function(e){var t,i=e.crypto||e.msCrypto;if(i&&i.getRandomValues){var n=new Uint8Array(16);t=function(){return i.getRandomValues(n),n}}if(!t){var o=new Array(16);t=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}r.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==e?e:{})},{}],22:[function(e,t,r){function i(e,t){var r=t||0,i=n;return i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]}for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);t.exports=i},{}],20:[function(t,r,i){(function(e,r){function n(e,t){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&i._extend(r,t),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),l(r,e,r.depth)}function o(e,t){var r=n.styles[t];return r?"["+n.colors[r][0]+"m"+e+"["+n.colors[r][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function l(e,t,r){if(e.customInspect&&t&&L(t.inspect)&&t.inspect!==i.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return _(n)||(n=l(e,n,r)),n}var o=d(e,t);if(o)return o;var a=Object.keys(t),g=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),T(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(t);if(0===a.length){if(L(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(A(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return u(t)}var m="",y=!1,b=["{","}"];if(f(t)&&(y=!0,b=["[","]"]),L(t)&&(m=" [Function"+(t.name?": "+t.name:"")+"]"),A(t)&&(m=" "+RegExp.prototype.toString.call(t)),w(t)&&(m=" "+Date.prototype.toUTCString.call(t)),T(t)&&(m=" "+u(t)),0===a.length&&(!y||0==t.length))return b[0]+m+b[1];if(r<0)return A(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return E=y?c(e,t,r,g,a):a.map(function(i){return h(e,t,r,g,i,y)}),e.seen.pop(),p(E,m,b)}function d(e,t){if(E(t))return e.stylize("undefined","undefined");if(_(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return y(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function c(e,t,r,i,n){for(var o=[],a=0,s=t.length;a<s;++a)R(t,String(a))?o.push(h(e,t,r,i,String(a),!0)):o.push("");return n.forEach(function(n){n.match(/^\d+$/)||o.push(h(e,t,r,i,n,!0))}),o}function h(e,t,r,i,n,o){var a,s,d;if(d=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]},d.get?s=d.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):d.set&&(s=e.stylize("[Setter]","special")),R(i,n)||(a="["+n+"]"),s||(e.seen.indexOf(d.value)<0?(s=v(r)?l(e,d.value,null):l(e,d.value,r-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),E(a)){if(o&&n.match(/^\d+$/))return s;a=JSON.stringify(""+n),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e,t,r){var i=0;return e.reduce(function(e,t){return i++,t.indexOf("\n")>=0&&i++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function f(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function v(e){return null===e}function m(e){return null==e}function y(e){return"number"==typeof e}function _(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function E(e){return void 0===e}function A(e){return S(e)&&"[object RegExp]"===C(e)}function S(e){return"object"==typeof e&&null!==e}function w(e){return S(e)&&"[object Date]"===C(e)}function T(e){return S(e)&&("[object Error]"===C(e)||e instanceof Error)}function L(e){return"function"==typeof e}function I(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function C(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}
function M(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),x[e.getMonth()],t].join(" ")}function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var O=/%[sdj%]/g;i.format=function(e){if(!_(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(n(arguments[r]));return t.join(" ")}for(var r=1,i=arguments,o=i.length,a=String(e).replace(O,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(e){return"[Circular]"}default:return e}}),s=i[r];r<o;s=i[++r])v(s)||!S(s)?a+=" "+s:a+=" "+n(s);return a},i.deprecate=function(t,n){function o(){if(!a){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),a=!0}return t.apply(this,arguments)}if(E(r.process))return function(){return i.deprecate(t,n).apply(this,arguments)};if(!0===e.noDeprecation)return t;var a=!1;return o};var k,D={};i.debuglog=function(t){if(E(k)&&(k=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(k)){var r=e.pid;D[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,r,e)}}else D[t]=function(){};return D[t]},i.inspect=n,n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},n.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=f,i.isBoolean=g,i.isNull=v,i.isNullOrUndefined=m,i.isNumber=y,i.isString=_,i.isSymbol=b,i.isUndefined=E,i.isRegExp=A,i.isObject=S,i.isDate=w,i.isError=T,i.isFunction=L,i.isPrimitive=I,i.isBuffer=t("./support/isBuffer");var x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",M(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),i=r.length;i--;)e[r[i]]=t[r[i]];return e}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==e?e:{})},{"./support/isBuffer":19,_process:9,inherits:6}],19:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],17:[function(t,r,i){(function(r,n){function o(e,t){this._id=e,this._clearFn=t}var a=t("process/browser.js").nextTick,s=Function.prototype.apply,l=Array.prototype.slice,d={},u=0;i.setTimeout=function(){return new o(s.call(setTimeout,e,arguments),clearTimeout)},i.setInterval=function(){return new o(s.call(setInterval,e,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(e,this._id)},i.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},i.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},i._unrefActive=i.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},i.setImmediate="function"==typeof r?r:function(e){var t=u++,r=!(arguments.length<2)&&l.call(arguments,1);return d[t]=!0,a(function(){d[t]&&(r?e.apply(null,r):e.call(null),i.clearImmediate(t))}),t},i.clearImmediate="function"==typeof n?n:function(e){delete d[e]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":9,timers:17}],9:[function(e,t,r){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===i||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function a(e){if(h===clearTimeout)return clearTimeout(e);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function s(){v&&f&&(v=!1,f.length?g=f.concat(g):m=-1,g.length&&l())}function l(){if(!v){var e=o(s);v=!0;for(var t=g.length;t;){for(f=g,g=[];++m<t;)f&&f[m].run();m=-1,t=g.length}f=null,v=!1,a(e)}}function d(e,t){this.fun=e,this.array=t}function u(){}var c,h,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:i}catch(e){c=i}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(e){h=n}}();var f,g=[],v=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];g.push(new d(e,t)),1!==g.length||v||o(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=u,p.addListener=u,p.once=u,p.off=u,p.removeListener=u,p.removeAllListeners=u,p.emit=u,p.prependListener=u,p.prependOnceListener=u,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],8:[function(e,t,r){!function(e){"use strict";function t(e){return null!==e&&"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function i(e,n){if(e===n)return!0;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(n))return!1;if(!0===t(e)){if(e.length!==n.length)return!1;for(var o=0;o<e.length;o++)if(!1===i(e[o],n[o]))return!1;return!0}if(!0===r(e)){var a={};for(var s in e)if(hasOwnProperty.call(e,s)){if(!1===i(e[s],n[s]))return!1;a[s]=!0}for(var l in n)if(hasOwnProperty.call(n,l)&&!0!==a[l])return!1;return!0}return!1}function n(e){if(""===e||!1===e||null===e)return!0;if(t(e)&&0===e.length)return!0;if(r(e)){for(var i in e)if(e.hasOwnProperty(i))return!1;return!0}return!1}function o(e){for(var t=Object.keys(e),r=[],i=0;i<t.length;i++)r.push(e[t[i]]);return r}function a(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"===e}function s(e){return e>="0"&&e<="9"||"-"===e}function l(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"_"===e}function d(){}function u(){}function c(e){this.runtime=e}function h(e){this._interpreter=e,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[m]}]},avg:{_func:this._functionAvg,_signature:[{types:[S]}]},ceil:{_func:this._functionCeil,_signature:[{types:[m]}]},contains:{_func:this._functionContains,_signature:[{types:[_,b]},{types:[y]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[_]},{types:[_]}]},floor:{_func:this._functionFloor,_signature:[{types:[m]}]},length:{_func:this._functionLength,_signature:[{types:[_,b,E]}]},map:{_func:this._functionMap,_signature:[{types:[A]},{types:[b]}]},max:{_func:this._functionMax,_signature:[{types:[S,w]}]},merge:{_func:this._functionMerge,_signature:[{types:[E],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[b]},{types:[A]}]},sum:{_func:this._functionSum,_signature:[{types:[S]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[_]},{types:[_]}]},min:{_func:this._functionMin,_signature:[{types:[S,w]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[b]},{types:[A]}]},type:{_func:this._functionType,_signature:[{types:[y]}]},keys:{_func:this._functionKeys,_signature:[{types:[E]}]},values:{_func:this._functionValues,_signature:[{types:[E]}]},sort:{_func:this._functionSort,_signature:[{types:[w,S]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[b]},{types:[A]}]},join:{_func:this._functionJoin,_signature:[{types:[_]},{types:[w]}]},reverse:{_func:this._functionReverse,_signature:[{types:[_,b]}]},to_array:{_func:this._functionToArray,_signature:[{types:[y]}]},to_string:{_func:this._functionToString,_signature:[{types:[y]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[y]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[y],variadic:!0}]}}}function p(e){return(new u).parse(e)}function f(e){return(new d).tokenize(e)}function g(e,t){var r=new u,i=new h,n=new c(i);i._interpreter=n;var o=r.parse(t);return n.search(o,e)}var v;v="function"==typeof String.prototype.trimLeft?function(e){return e.trimLeft()}:function(e){return e.match(/^\s*(.*)/)[1]};var m=0,y=1,_=2,b=3,E=4,A=6,S=8,w=9,T={".":"Dot","*":"Star",",":"Comma",":":"Colon","{":"Lbrace","}":"Rbrace","]":"Rbracket","(":"Lparen",")":"Rparen","@":"Current"},L={"<":!0,">":!0,"=":!0,"!":!0},I={" ":!0,"\t":!0,"\n":!0};d.prototype={tokenize:function(e){var t=[];this._current=0;for(var r,i,n;this._current<e.length;)if(a(e[this._current]))r=this._current,i=this._consumeUnquotedIdentifier(e),t.push({type:"UnquotedIdentifier",value:i,start:r});else if(void 0!==T[e[this._current]])t.push({type:T[e[this._current]],value:e[this._current],start:this._current}),this._current++;else if(s(e[this._current]))n=this._consumeNumber(e),t.push(n);else if("["===e[this._current])n=this._consumeLBracket(e),t.push(n);else if('"'===e[this._current])r=this._current,i=this._consumeQuotedIdentifier(e),t.push({type:"QuotedIdentifier",value:i,start:r});else if("'"===e[this._current])r=this._current,i=this._consumeRawStringLiteral(e),t.push({type:"Literal",value:i,start:r});else if("`"===e[this._current]){r=this._current;var o=this._consumeLiteral(e);t.push({type:"Literal",value:o,start:r})}else if(void 0!==L[e[this._current]])t.push(this._consumeOperator(e));else if(void 0!==I[e[this._current]])this._current++;else if("&"===e[this._current])r=this._current,this._current++,"&"===e[this._current]?(this._current++,t.push({type:"And",value:"&&",start:r})):t.push({type:"Expref",value:"&",start:r});else{if("|"!==e[this._current]){var l=new Error("Unknown character:"+e[this._current]);throw l.name="LexerError",l}r=this._current,this._current++,"|"===e[this._current]?(this._current++,t.push({type:"Or",value:"||",start:r})):t.push({type:"Pipe",value:"|",start:r})}return t},_consumeUnquotedIdentifier:function(e){var t=this._current;for(this._current++;this._current<e.length&&l(e[this._current]);)this._current++;return e.slice(t,this._current)},_consumeQuotedIdentifier:function(e){var t=this._current;this._current++;for(var r=e.length;'"'!==e[this._current]&&this._current<r;){var i=this._current;"\\"!==e[i]||"\\"!==e[i+1]&&'"'!==e[i+1]?i++:i+=2,this._current=i}return this._current++,JSON.parse(e.slice(t,this._current))},_consumeRawStringLiteral:function(e){var t=this._current;this._current++;for(var r=e.length;"'"!==e[this._current]&&this._current<r;){var i=this._current;"\\"!==e[i]||"\\"!==e[i+1]&&"'"!==e[i+1]?i++:i+=2,this._current=i}return this._current++,e.slice(t+1,this._current-1).replace("\\'","'")},_consumeNumber:function(e){var t=this._current;this._current++;for(var r=e.length;s(e[this._current])&&this._current<r;)this._current++;return{type:"Number",value:parseInt(e.slice(t,this._current)),start:t}},_consumeLBracket:function(e){var t=this._current;return this._current++,"?"===e[this._current]?(this._current++,{type:"Filter",value:"[?",start:t}):"]"===e[this._current]?(this._current++,{type:"Flatten",value:"[]",start:t}):{type:"Lbracket",value:"[",start:t}},_consumeOperator:function(e){var t=this._current,r=e[t];return this._current++,"!"===r?"="===e[this._current]?(this._current++,{type:"NE",value:"!=",start:t}):{type:"Not",value:"!",start:t}:"<"===r?"="===e[this._current]?(this._current++,{type:"LTE",value:"<=",start:t}):{type:"LT",value:"<",start:t}:">"===r?"="===e[this._current]?(this._current++,{type:"GTE",value:">=",start:t}):{type:"GT",value:">",start:t}:"="===r&&"="===e[this._current]?(this._current++,{type:"EQ",value:"==",start:t}):void 0},_consumeLiteral:function(e){this._current++;for(var t,r=this._current,i=e.length;"`"!==e[this._current]&&this._current<i;){var n=this._current;"\\"!==e[n]||"\\"!==e[n+1]&&"`"!==e[n+1]?n++:n+=2,this._current=n}var o=v(e.slice(r,this._current));return o=o.replace("\\`","`"),t=this._looksLikeJSON(o)?JSON.parse(o):JSON.parse('"'+o+'"'),this._current++,t},_looksLikeJSON:function(e){var t='[{"',r=["true","false","null"],i="-0123456789";if(""===e)return!1;if(t.indexOf(e[0])>=0)return!0;if(r.indexOf(e)>=0)return!0;if(!(i.indexOf(e[0])>=0))return!1;try{return JSON.parse(e),!0}catch(e){return!1}}};var C={};C.EOF=0,C.UnquotedIdentifier=0,C.QuotedIdentifier=0,C.Rbracket=0,C.Rparen=0,C.Comma=0,C.Rbrace=0,C.Number=0,C.Current=0,C.Expref=0,C.Pipe=1,C.Or=2,C.And=3,C.EQ=5,C.GT=5,C.LT=5,C.GTE=5,C.LTE=5,C.NE=5,C.Flatten=9,C.Star=20,C.Filter=21,C.Dot=40,C.Not=45,C.Lbrace=50,C.Lbracket=55,C.Lparen=60,u.prototype={parse:function(e){this._loadTokens(e),this.index=0;var t=this.expression(0);if("EOF"!==this._lookahead(0)){var r=this._lookaheadToken(0),i=new Error("Unexpected token type: "+r.type+", value: "+r.value);throw i.name="ParserError",i}return t},_loadTokens:function(e){var t=new d,r=t.tokenize(e);r.push({type:"EOF",value:"",start:e.length}),this.tokens=r},expression:function(e){var t=this._lookaheadToken(0);this._advance();for(var r=this.nud(t),i=this._lookahead(0);e<C[i];)this._advance(),r=this.led(i,r),i=this._lookahead(0);return r},_lookahead:function(e){return this.tokens[this.index+e].type},_lookaheadToken:function(e){return this.tokens[this.index+e]},_advance:function(){this.index++},nud:function(e){var t,r,i;switch(e.type){case"Literal":return{type:"Literal",value:e.value};case"UnquotedIdentifier":return{type:"Field",name:e.value};case"QuotedIdentifier":var n={type:"Field",name:e.value};if("Lparen"===this._lookahead(0))throw new Error("Quoted identifier not allowed for function names.");return n;case"Not":return r=this.expression(C.Not),{type:"NotExpression",children:[r]};case"Star":return t={type:"Identity"},r=null,r="Rbracket"===this._lookahead(0)?{type:"Identity"}:this._parseProjectionRHS(C.Star),{type:"ValueProjection",children:[t,r]};case"Filter":return this.led(e.type,{type:"Identity"});case"Lbrace":return this._parseMultiselectHash();case"Flatten":return t={type:"Flatten",children:[{type:"Identity"}]},r=this._parseProjectionRHS(C.Flatten),{type:"Projection",children:[t,r]};case"Lbracket":return"Number"===this._lookahead(0)||"Colon"===this._lookahead(0)?(r=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},r)):"Star"===this._lookahead(0)&&"Rbracket"===this._lookahead(1)?(this._advance(),this._advance(),r=this._parseProjectionRHS(C.Star),{type:"Projection",children:[{type:"Identity"},r]}):this._parseMultiselectList();case"Current":return{type:"Current"};case"Expref":return i=this.expression(C.Expref),{type:"ExpressionReference",children:[i]};case"Lparen":for(var o=[];"Rparen"!==this._lookahead(0);)"Current"===this._lookahead(0)?(i={type:"Current"},this._advance()):i=this.expression(0),o.push(i);return this._match("Rparen"),o[0];default:this._errorToken(e)}},led:function(e,t){var r;switch(e){case"Dot":var i=C.Dot;return"Star"!==this._lookahead(0)?(r=this._parseDotRHS(i),{type:"Subexpression",children:[t,r]}):(this._advance(),r=this._parseProjectionRHS(i),{type:"ValueProjection",children:[t,r]});case"Pipe":return r=this.expression(C.Pipe),{type:"Pipe",children:[t,r]};case"Or":return r=this.expression(C.Or),{type:"OrExpression",children:[t,r]};case"And":return r=this.expression(C.And),{type:"AndExpression",children:[t,r]};case"Lparen":for(var n,o=t.name,a=[];"Rparen"!==this._lookahead(0);)"Current"===this._lookahead(0)?(n={type:"Current"},this._advance()):n=this.expression(0),"Comma"===this._lookahead(0)&&this._match("Comma"),a.push(n);return this._match("Rparen"),{type:"Function",name:o,children:a};case"Filter":var s=this.expression(0);return this._match("Rbracket"),r="Flatten"===this._lookahead(0)?{type:"Identity"}:this._parseProjectionRHS(C.Filter),{type:"FilterProjection",children:[t,r,s]};case"Flatten":return{type:"Projection",children:[{type:"Flatten",children:[t]},this._parseProjectionRHS(C.Flatten)]};case"EQ":case"NE":case"GT":case"GTE":case"LT":case"LTE":return this._parseComparator(t,e);case"Lbracket":var l=this._lookaheadToken(0);return"Number"===l.type||"Colon"===l.type?(r=this._parseIndexExpression(),this._projectIfSlice(t,r)):(this._match("Star"),this._match("Rbracket"),r=this._parseProjectionRHS(C.Star),{type:"Projection",children:[t,r]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(e){if(this._lookahead(0)!==e){var t=this._lookaheadToken(0),r=new Error("Expected "+e+", got: "+t.type);throw r.name="ParserError",r}this._advance()},_errorToken:function(e){var t=new Error("Invalid token ("+e.type+'): "'+e.value+'"');throw t.name="ParserError",t},_parseIndexExpression:function(){if("Colon"===this._lookahead(0)||"Colon"===this._lookahead(1))return this._parseSliceExpression();var e={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match("Rbracket"),e},_projectIfSlice:function(e,t){var r={type:"IndexExpression",children:[e,t]};return"Slice"===t.type?{type:"Projection",children:[r,this._parseProjectionRHS(C.Star)]}:r},_parseSliceExpression:function(){for(var e=[null,null,null],t=0,r=this._lookahead(0);"Rbracket"!==r&&t<3;){if("Colon"===r)t++,this._advance();else{if("Number"!==r){var i=this._lookahead(0),n=new Error("Syntax error, unexpected token: "+i.value+"("+i.type+")");throw n.name="Parsererror",n}e[t]=this._lookaheadToken(0).value,this._advance()}r=this._lookahead(0)}return this._match("Rbracket"),{type:"Slice",children:e}},_parseComparator:function(e,t){return{type:"Comparator",name:t,children:[e,this.expression(C[t])]}},_parseDotRHS:function(e){var t=this._lookahead(0);return["UnquotedIdentifier","QuotedIdentifier","Star"].indexOf(t)>=0?this.expression(e):"Lbracket"===t?(this._match("Lbracket"),this._parseMultiselectList()):"Lbrace"===t?(this._match("Lbrace"),this._parseMultiselectHash()):void 0},_parseProjectionRHS:function(e){var t;if(C[this._lookahead(0)]<10)t={type:"Identity"};else if("Lbracket"===this._lookahead(0))t=this.expression(e);else if("Filter"===this._lookahead(0))t=this.expression(e);else{if("Dot"!==this._lookahead(0)){var r=this._lookaheadToken(0),i=new Error("Sytanx error, unexpected token: "+r.value+"("+r.type+")");throw i.name="ParserError",i}this._match("Dot"),t=this._parseDotRHS(e)}return t},_parseMultiselectList:function(){for(var e=[];"Rbracket"!==this._lookahead(0);){var t=this.expression(0);if(e.push(t),"Comma"===this._lookahead(0)&&(this._match("Comma"),"Rbracket"===this._lookahead(0)))throw new Error("Unexpected token Rbracket")}return this._match("Rbracket"),{type:"MultiSelectList",children:e}},_parseMultiselectHash:function(){for(var e,t,r,i,n=[],o=["UnquotedIdentifier","QuotedIdentifier"];;){if(e=this._lookaheadToken(0),o.indexOf(e.type)<0)throw new Error("Expecting an identifier token, got: "+e.type);if(t=e.value,this._advance(),this._match("Colon"),r=this.expression(0),i={type:"KeyValuePair",name:t,value:r},n.push(i),"Comma"===this._lookahead(0))this._match("Comma");else if("Rbrace"===this._lookahead(0)){this._match("Rbrace");break}}return{type:"MultiSelectHash",children:n}}},c.prototype={search:function(e,t){return this.visit(e,t)},visit:function(e,a){var s,l,d,u,c,h,p,f,g;switch(e.type){case"Field":return null===a?null:r(a)?(h=a[e.name],void 0===h?null:h):null;case"Subexpression":for(d=this.visit(e.children[0],a),g=1;g<e.children.length;g++)if(null===(d=this.visit(e.children[1],d)))return null;return d;case"IndexExpression":return p=this.visit(e.children[0],a),this.visit(e.children[1],p);case"Index":if(!t(a))return null;var v=e.value;return v<0&&(v=a.length+v),d=a[v],void 0===d&&(d=null),d;case"Slice":if(!t(a))return null;var m=e.children.slice(0),y=this.computeSliceParams(a.length,m),_=y[0],b=y[1],E=y[2];if(d=[],E>0)for(g=_;g<b;g+=E)d.push(a[g]);else for(g=_;g>b;g+=E)d.push(a[g]);return d;case"Projection":var A=this.visit(e.children[0],a);if(!t(A))return null;for(f=[],g=0;g<A.length;g++)null!==(l=this.visit(e.children[1],A[g]))&&f.push(l);return f;case"ValueProjection":if(A=this.visit(e.children[0],a),!r(A))return null;f=[];var S=o(A);for(g=0;g<S.length;g++)null!==(l=this.visit(e.children[1],S[g]))&&f.push(l);return f;case"FilterProjection":if(A=this.visit(e.children[0],a),!t(A))return null;var w=[],T=[];for(g=0;g<A.length;g++)s=this.visit(e.children[2],A[g]),n(s)||w.push(A[g]);for(var L=0;L<w.length;L++)null!==(l=this.visit(e.children[1],w[L]))&&T.push(l);return T;case"Comparator":switch(u=this.visit(e.children[0],a),c=this.visit(e.children[1],a),e.name){case"EQ":d=i(u,c);break;case"NE":d=!i(u,c);break;case"GT":d=u>c;break;case"GTE":d=u>=c;break;case"LT":d=u<c;break;case"LTE":d=u<=c;break;default:throw new Error("Unknown comparator: "+e.name)}return d;case"Flatten":var I=this.visit(e.children[0],a);if(!t(I))return null;var C=[];for(g=0;g<I.length;g++)l=I[g],t(l)?C.push.apply(C,l):C.push(l);return C;case"Identity":return a;case"MultiSelectList":if(null===a)return null;for(f=[],g=0;g<e.children.length;g++)f.push(this.visit(e.children[g],a));return f;case"MultiSelectHash":if(null===a)return null;f={};var P;for(g=0;g<e.children.length;g++)P=e.children[g],f[P.name]=this.visit(P.value,a);return f;case"OrExpression":return s=this.visit(e.children[0],a),n(s)&&(s=this.visit(e.children[1],a)),s;case"AndExpression":return u=this.visit(e.children[0],a),!0===n(u)?u:this.visit(e.children[1],a);case"NotExpression":return u=this.visit(e.children[0],a),n(u);case"Literal":return e.value;case"Pipe":return p=this.visit(e.children[0],a),this.visit(e.children[1],p);case"Current":return a;case"Function":var M=[];for(g=0;g<e.children.length;g++)M.push(this.visit(e.children[g],a));return this.runtime.callFunction(e.name,M);case"ExpressionReference":var R=e.children[0];return R.jmespathType="Expref",R;default:throw new Error("Unknown node type: "+e.type)}},computeSliceParams:function(e,t){var r=t[0],i=t[1],n=t[2],o=[null,null,null];if(null===n)n=1;else if(0===n){var a=new Error("Invalid slice, step cannot be 0");throw a.name="RuntimeError",a}var s=n<0;return r=null===r?s?e-1:0:this.capSliceRange(e,r,n),i=null===i?s?-1:e:this.capSliceRange(e,i,n),o[0]=r,o[1]=i,o[2]=n,o},capSliceRange:function(e,t,r){return t<0?(t+=e)<0&&(t=r<0?-1:0):t>=e&&(t=r<0?e-1:e),t}},h.prototype={callFunction:function(e,t){var r=this.functionTable[e];if(void 0===r)throw new Error("Unknown function: "+e+"()");return this._validateArgs(e,t,r._signature),r._func.call(this,t)},_validateArgs:function(e,t,r){var i;if(r[r.length-1].variadic){if(t.length<r.length)throw i=1===r.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes at least"+r.length+i+" but received "+t.length)}else if(t.length!==r.length)throw i=1===r.length?" argument":" arguments",new Error("ArgumentError: "+e+"() takes "+r.length+i+" but received "+t.length);for(var n,o,a,s=0;s<r.length;s++){a=!1,n=r[s].types,o=this._getTypeName(t[s]);for(var l=0;l<n.length;l++)if(this._typeMatches(o,n[l],t[s])){a=!0;break}if(!a)throw new Error("TypeError: "+e+"() expected argument "+(s+1)+" to be type "+n+" but received type "+o+" instead.")}},_typeMatches:function(e,t,r){if(t===y)return!0;if(t!==w&&t!==S&&t!==b)return e===t;if(t===b)return e===b;if(e===b){var i;t===S?i=m:t===w&&(i=_);for(var n=0;n<r.length;n++)if(!this._typeMatches(this._getTypeName(r[n]),i,r[n]))return!1;return!0}},_getTypeName:function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return _;case"[object Number]":return m;case"[object Array]":return b;case"[object Boolean]":return 5;case"[object Null]":return 7;case"[object Object]":return"Expref"===e.jmespathType?A:E}},_functionStartsWith:function(e){return 0===e[0].lastIndexOf(e[1])},_functionEndsWith:function(e){var t=e[0],r=e[1];return-1!==t.indexOf(r,t.length-r.length)},_functionReverse:function(e){if(this._getTypeName(e[0])===_){for(var t=e[0],r="",i=t.length-1;i>=0;i--)r+=t[i];return r}var n=e[0].slice(0);return n.reverse(),n},_functionAbs:function(e){return Math.abs(e[0])},_functionCeil:function(e){return Math.ceil(e[0])},_functionAvg:function(e){for(var t=0,r=e[0],i=0;i<r.length;i++)t+=r[i];return t/r.length},_functionContains:function(e){return e[0].indexOf(e[1])>=0},_functionFloor:function(e){return Math.floor(e[0])},_functionLength:function(e){return r(e[0])?Object.keys(e[0]).length:e[0].length},_functionMap:function(e){for(var t=[],r=this._interpreter,i=e[0],n=e[1],o=0;o<n.length;o++)t.push(r.visit(i,n[o]));return t},_functionMerge:function(e){for(var t={},r=0;r<e.length;r++){var i=e[r];for(var n in i)t[n]=i[n]}return t},_functionMax:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===m)return Math.max.apply(Math,e[0]);for(var t=e[0],r=t[0],i=1;i<t.length;i++)r.localeCompare(t[i])<0&&(r=t[i]);return r}return null},_functionMin:function(e){if(e[0].length>0){if(this._getTypeName(e[0][0])===m)return Math.min.apply(Math,e[0]);for(var t=e[0],r=t[0],i=1;i<t.length;i++)t[i].localeCompare(r)<0&&(r=t[i]);return r}return null},_functionSum:function(e){for(var t=0,r=e[0],i=0;i<r.length;i++)t+=r[i];return t},_functionType:function(e){switch(this._getTypeName(e[0])){case m:return"number";case _:return"string";case b:return"array";case E:return"object";case 5:return"boolean";case A:return"expref";case 7:return"null"}},_functionKeys:function(e){return Object.keys(e[0])},_functionValues:function(e){for(var t=e[0],r=Object.keys(t),i=[],n=0;n<r.length;n++)i.push(t[r[n]]);return i},_functionJoin:function(e){var t=e[0];return e[1].join(t)},_functionToArray:function(e){return this._getTypeName(e[0])===b?e[0]:[e[0]]},_functionToString:function(e){return this._getTypeName(e[0])===_?e[0]:JSON.stringify(e[0])},_functionToNumber:function(e){var t,r=this._getTypeName(e[0]);return r===m?e[0]:r!==_||(t=+e[0],isNaN(t))?null:t},_functionNotNull:function(e){for(var t=0;t<e.length;t++)if(7!==this._getTypeName(e[t]))return e[t];return null},_functionSort:function(e){var t=e[0].slice(0);return t.sort(),t},_functionSortBy:function(e){var t=e[0].slice(0);if(0===t.length)return t;var r=this._interpreter,i=e[1],n=this._getTypeName(r.visit(i,t[0]));if([m,_].indexOf(n)<0)throw new Error("TypeError");for(var o=this,a=[],s=0;s<t.length;s++)a.push([s,t[s]]);a.sort(function(e,t){var a=r.visit(i,e[1]),s=r.visit(i,t[1]);if(o._getTypeName(a)!==n)throw new Error("TypeError: expected "+n+", received "+o._getTypeName(a));if(o._getTypeName(s)!==n)throw new Error("TypeError: expected "+n+", received "+o._getTypeName(s));return a>s?1:a<s?-1:e[0]-t[0]});for(var l=0;l<a.length;l++)t[l]=a[l][1];return t},_functionMaxBy:function(e){for(var t,r,i=e[1],n=e[0],o=this.createKeyFunction(i,[m,_]),a=-1/0,s=0;s<n.length;s++)(r=o(n[s]))>a&&(a=r,t=n[s]);return t},_functionMinBy:function(e){for(var t,r,i=e[1],n=e[0],o=this.createKeyFunction(i,[m,_]),a=1/0,s=0;s<n.length;s++)(r=o(n[s]))<a&&(a=r,t=n[s]);return t},createKeyFunction:function(e,t){var r=this,i=this._interpreter;return function(n){var o=i.visit(e,n);if(t.indexOf(r._getTypeName(o))<0){var a="TypeError: expected one of "+t+", received "+r._getTypeName(o);throw new Error(a)}return o}}},e.tokenize=f,e.compile=p,e.search=g,e.strictDeepEqual=i}(void 0===r?this.jmespath={}:r)},{}],6:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],2:[function(e,t,r){},{}]},{},[]),_xamzrequire=function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof _xamzrequire&&_xamzrequire;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return n(t[a][1][e]||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,a=0;a<i.length;a++)n(i[a]);return n}({28:[function(t,r,i){t("./browser_loader");var n=t("./core");void 0!==e&&(e.AWS=n),void 0!==r&&(r.exports=n),"undefined"!=typeof self&&(self.AWS=n)},{"./browser_loader":35,"./core":38}],35:[function(e,t,r){(function(r){var i=e("./util");i.crypto.lib=e("./browserCryptoLib"),i.Buffer=e("buffer/").Buffer,i.url=e("url/"),i.querystring=e("querystring/"),i.environment="js";var n=e("./core");t.exports=n,e("./credentials"),e("./credentials/credential_provider_chain"),e("./credentials/temporary_credentials"),e("./credentials/web_identity_credentials"),e("./credentials/cognito_identity_credentials"),e("./credentials/saml_credentials"),n.XML.Parser=e("./xml/browser_parser"),e("./http/xhr"),void 0===r&&(r={browser:!0})}).call(this,e("_process"))},{"./browserCryptoLib":29,"./core":38,"./credentials":39,"./credentials/cognito_identity_credentials":40,"./credentials/credential_provider_chain":41,"./credentials/saml_credentials":42,"./credentials/temporary_credentials":43,"./credentials/web_identity_credentials":44,"./http/xhr":53,"./util":105,"./xml/browser_parser":106,_process:9,"buffer/":3,"querystring/":16,"url/":18}],106:[function(t,r,i){function n(){}function o(e,t){switch(t||(t={}),t.type){case"structure":return a(e,t);case"map":return s(e,t);case"list":return l(e,t);case void 0:case null:return u(e);default:return d(e,t)}}function a(e,t){var r={};return null===e?r:(c.each(t.members,function(t,i){if(i.isXmlAttribute){if(Object.prototype.hasOwnProperty.call(e.attributes,i.name)){var n=e.attributes[i.name].value;r[t]=o({textContent:n},i)}}else{var a=i.flattened?e:e.getElementsByTagName(i.name)[0];a?r[t]=o(a,i):i.flattened||"list"!==i.type||(r[t]=i.defaultValue)}}),r)}function s(e,t){for(var r={},i=t.key.name||"key",n=t.value.name||"value",a=t.flattened?t.name:"entry",s=e.firstElementChild;s;){if(s.nodeName===a){var l=s.getElementsByTagName(i)[0].textContent,d=s.getElementsByTagName(n)[0];r[l]=o(d,t.value)}s=s.nextElementSibling}return r}function l(e,t){for(var r=[],i=t.flattened?t.name:t.member.name||"member",n=e.firstElementChild;n;)n.nodeName===i&&r.push(o(n,t.member)),n=n.nextElementSibling;return r}function d(e,t){if(e.getAttribute){var r=e.getAttribute("encoding");"base64"===r&&(t=new h.create({type:r}))}var i=e.textContent;return""===i&&(i=null),"function"==typeof t.toType?t.toType(i):i}function u(e){if(void 0===e||null===e)return"";if(!e.firstElementChild)return null===e.parentNode.parentNode?{}:0===e.childNodes.length?"":e.textContent;for(var t={type:"structure",members:{}},r=e.firstElementChild;r;){var i=r.nodeName;Object.prototype.hasOwnProperty.call(t.members,i)?t.members[i].type="list":t.members[i]={name:i},r=r.nextElementSibling}return a(e,t)}var c=t("../util"),h=t("../model/shape");n.prototype.parse=function(t,r){if(""===t.replace(/^\s+/,""))return{};var i,n;try{if(e.DOMParser){try{i=(new DOMParser).parseFromString(t,"text/xml")}catch(t){throw c.error(new Error("Parse error in document"),{originalError:t,code:"XMLParserError",retryable:!0})}if(null===i.documentElement)throw c.error(new Error("Cannot parse empty document."),{code:"XMLParserError",retryable:!0});var a=i.getElementsByTagName("parsererror")[0];if(a&&(a.parentNode===i||"body"===a.parentNode.nodeName||a.parentNode.parentNode===i||"body"===a.parentNode.parentNode.nodeName)){var s=a.getElementsByTagName("div")[0]||a;throw c.error(new Error(s.textContent||"Parser error in document"),{code:"XMLParserError",retryable:!0})}}else{if(!e.ActiveXObject)throw new Error("Cannot load XML parser");if(i=new e.ActiveXObject("Microsoft.XMLDOM"),i.async=!1,!i.loadXML(t))throw c.error(new Error("Parse error in document"),{code:"XMLParserError",retryable:!0})}}catch(t){n=t}if(i&&i.documentElement&&!n){var l=o(i.documentElement,r),d=i.getElementsByTagName("ResponseMetadata")[0];return d&&(l.ResponseMetadata=o(d,{})),l}if(n)throw c.error(n||new Error,{code:"XMLParserError",retryable:!0});return{}},r.exports=n},{"../model/shape":61,"../util":105}],
53:[function(e,t,r){var i=e("../core"),n=e("events").EventEmitter;e("../http"),i.XHRClient=i.util.inherit({handleRequest:function(e,t,r,o){var a=this,s=e.endpoint,l=new n,d=s.protocol+"//"+s.hostname;80!==s.port&&443!==s.port&&(d+=":"+s.port),d+=e.path;var u=new XMLHttpRequest,c=!1;e.stream=u,u.addEventListener("readystatechange",function(){try{if(0===u.status)return}catch(e){return}this.readyState>=this.HEADERS_RECEIVED&&!c&&(l.statusCode=u.status,l.headers=a.parseHeaders(u.getAllResponseHeaders()),l.emit("headers",l.statusCode,l.headers,u.statusText),c=!0),this.readyState===this.DONE&&a.finishRequest(u,l)},!1),u.upload.addEventListener("progress",function(e){l.emit("sendProgress",e)}),u.addEventListener("progress",function(e){l.emit("receiveProgress",e)},!1),u.addEventListener("timeout",function(){o(i.util.error(new Error("Timeout"),{code:"TimeoutError"}))},!1),u.addEventListener("error",function(){o(i.util.error(new Error("Network Failure"),{code:"NetworkingError"}))},!1),u.addEventListener("abort",function(){o(i.util.error(new Error("Request aborted"),{code:"RequestAbortedError"}))},!1),r(l),u.open(e.method,d,!1!==t.xhrAsync),i.util.each(e.headers,function(e,t){"Content-Length"!==e&&"User-Agent"!==e&&"Host"!==e&&u.setRequestHeader(e,t)}),t.timeout&&!1!==t.xhrAsync&&(u.timeout=t.timeout),t.xhrWithCredentials&&(u.withCredentials=!0);try{u.responseType="arraybuffer"}catch(e){}try{e.body?u.send(e.body):u.send()}catch(t){if(!e.body||"object"!=typeof e.body.buffer)throw t;u.send(e.body.buffer)}return l},parseHeaders:function(e){var t={};return i.util.arrayEach(e.split(/\r?\n/),function(e){var r=e.split(":",1)[0],i=e.substring(r.length+2);r.length>0&&(t[r.toLowerCase()]=i)}),t},finishRequest:function(e,t){var r;if("arraybuffer"===e.responseType&&e.response){var n=e.response;r=new i.util.Buffer(n.byteLength);for(var o=new Uint8Array(n),a=0;a<r.length;++a)r[a]=o[a]}try{r||"string"!=typeof e.responseText||(r=new i.util.Buffer(e.responseText))}catch(e){}r&&t.emit("data",r),t.emit("end")}}),i.HttpClient.prototype=i.XHRClient.prototype,i.HttpClient.streamsApiVersion=1},{"../core":38,"../http":52,events:4}],44:[function(e,t,r){var i=e("../core");i.WebIdentityCredentials=i.util.inherit(i.Credentials,{constructor:function(e,t){i.Credentials.call(this),this.expired=!0,this.params=e,this.params.RoleSessionName=this.params.RoleSessionName||"web-identity",this.data=null,this._clientConfig=i.util.copy(t||{})},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.service.assumeRoleWithWebIdentity(function(r,i){t.data=null,r||(t.data=i,t.service.credentialsFrom(i,t)),e(r)})},createClients:function(){if(!this.service){var e=i.util.merge({},this._clientConfig);e.params=this.params,this.service=new i.STS(e)}}})},{"../core":38}],43:[function(e,t,r){var i=e("../core");i.TemporaryCredentials=i.util.inherit(i.Credentials,{constructor:function(e,t){i.Credentials.call(this),this.loadMasterCredentials(t),this.expired=!0,this.params=e||{},this.params.RoleArn&&(this.params.RoleSessionName=this.params.RoleSessionName||"temporary-credentials")},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.masterCredentials.get(function(){t.service.config.credentials=t.masterCredentials,(t.params.RoleArn?t.service.assumeRole:t.service.getSessionToken).call(t.service,function(r,i){r||t.service.credentialsFrom(i,t),e(r)})})},loadMasterCredentials:function(e){for(this.masterCredentials=e||i.config.credentials;this.masterCredentials.masterCredentials;)this.masterCredentials=this.masterCredentials.masterCredentials;"function"!=typeof this.masterCredentials.get&&(this.masterCredentials=new i.Credentials(this.masterCredentials))},createClients:function(){this.service=this.service||new i.STS({params:this.params})}})},{"../core":38}],42:[function(e,t,r){var i=e("../core");i.SAMLCredentials=i.util.inherit(i.Credentials,{constructor:function(e){i.Credentials.call(this),this.expired=!0,this.params=e},refresh:function(e){var t=this;t.createClients(),e||(e=function(e){if(e)throw e}),t.service.assumeRoleWithSAML(function(r,i){r||t.service.credentialsFrom(i,t),e(r)})},createClients:function(){this.service=this.service||new i.STS({params:this.params})}})},{"../core":38}],40:[function(t,r,i){var n=t("../core");n.CognitoIdentityCredentials=n.util.inherit(n.Credentials,{localStorageKey:{id:"aws.cognito.identity-id.",providers:"aws.cognito.identity-providers."},constructor:function(e,t){n.Credentials.call(this),this.expired=!0,this.params=e,this.data=null,this._identityId=null,this._clientConfig=n.util.copy(t||{}),this.loadCachedId();var r=this;Object.defineProperty(this,"identityId",{get:function(){return r.loadCachedId(),r._identityId||r.params.IdentityId},set:function(e){r._identityId=e}})},refresh:function(e){var t=this;t.createClients(),t.data=null,t._identityId=null,t.getId(function(r){r?(t.clearIdOnNotAuthorized(r),e(r)):t.params.RoleArn?t.getCredentialsFromSTS(e):t.getCredentialsForIdentity(e)})},clearCachedId:function(){this._identityId=null,delete this.params.IdentityId;var e=this.params.IdentityPoolId,t=this.params.LoginId||"";delete this.storage[this.localStorageKey.id+e+t],delete this.storage[this.localStorageKey.providers+e+t]},clearIdOnNotAuthorized:function(e){var t=this;"NotAuthorizedException"==e.code&&t.clearCachedId()},getId:function(e){var t=this;if("string"==typeof t.params.IdentityId)return e(null,t.params.IdentityId);t.cognito.getId(function(r,i){!r&&i.IdentityId?(t.params.IdentityId=i.IdentityId,e(null,i.IdentityId)):e(r)})},loadCredentials:function(e,t){e&&t&&(t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration)},getCredentialsForIdentity:function(e){var t=this;t.cognito.getCredentialsForIdentity(function(r,i){r?t.clearIdOnNotAuthorized(r):(t.cacheId(i),t.data=i,t.loadCredentials(t.data,t)),e(r)})},getCredentialsFromSTS:function(e){var t=this;t.cognito.getOpenIdToken(function(r,i){r?(t.clearIdOnNotAuthorized(r),e(r)):(t.cacheId(i),t.params.WebIdentityToken=i.Token,t.webIdentityCredentials.refresh(function(r){r||(t.data=t.webIdentityCredentials.data,t.sts.credentialsFrom(t.data,t)),e(r)}))})},loadCachedId:function(){var e=this;if(n.util.isBrowser()&&!e.params.IdentityId){var t=e.getStorage("id");if(t&&e.params.Logins){var r=Object.keys(e.params.Logins);0!==(e.getStorage("providers")||"").split(",").filter(function(e){return-1!==r.indexOf(e)}).length&&(e.params.IdentityId=t)}else t&&(e.params.IdentityId=t)}},createClients:function(){var e=this._clientConfig;if(this.webIdentityCredentials=this.webIdentityCredentials||new n.WebIdentityCredentials(this.params,e),!this.cognito){var t=n.util.merge({},e);t.params=this.params,this.cognito=new n.CognitoIdentity(t)}this.sts=this.sts||new n.STS(e)},cacheId:function(e){this._identityId=e.IdentityId,this.params.IdentityId=this._identityId,n.util.isBrowser()&&(this.setStorage("id",e.IdentityId),this.params.Logins&&this.setStorage("providers",Object.keys(this.params.Logins).join(",")))},getStorage:function(e){return this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||"")]},setStorage:function(e,t){try{this.storage[this.localStorageKey[e]+this.params.IdentityPoolId+(this.params.LoginId||"")]=t}catch(e){}},storage:function(){try{var t=n.util.isBrowser()&&null!==e.localStorage&&"object"==typeof e.localStorage?e.localStorage:{};return t["aws.test-storage"]="foobar",delete t["aws.test-storage"],t}catch(t){return{}}}()})},{"../core":38}],29:[function(e,t,r){var i=e("./browserHmac"),n=e("./browserMd5"),o=e("./browserSha1"),a=e("./browserSha256");t.exports={createHash:function(e){if("md5"===(e=e.toLowerCase()))return new n;if("sha256"===e)return new a;if("sha1"===e)return new o;throw new Error("Hash algorithm "+e+" is not supported in the browser SDK")},createHmac:function(e,t){if("md5"===(e=e.toLowerCase()))return new i(n,t);if("sha256"===e)return new i(a,t);if("sha1"===e)return new i(o,t);throw new Error("HMAC algorithm "+e+" is not supported in the browser SDK")},createSign:function(){throw new Error("createSign is not implemented in the browser")}}},{"./browserHmac":31,"./browserMd5":32,"./browserSha1":33,"./browserSha256":34}],34:[function(e,t,r){function i(){this.state=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}var n=e("buffer/").Buffer,o=e("./browserHashUtils"),a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),s=Math.pow(2,53)-1;t.exports=i,i.BLOCK_SIZE=64,i.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");if(o.isEmptyData(e))return this;e=o.convertToBuffer(e);var t=0,r=e.byteLength;if(this.bytesHashed+=r,8*this.bytesHashed>s)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=e[t++],r--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0);return this},i.prototype.digest=function(e){if(!this.finished){var t=8*this.bytesHashed,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(r.setUint8(this.bufferLength++,128),i%64>=56){for(var o=this.bufferLength;o<64;o++)r.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(var o=this.bufferLength;o<56;o++)r.setUint8(o,0);r.setUint32(56,Math.floor(t/4294967296),!0),r.setUint32(60,t),this.hashBuffer(),this.finished=!0}for(var a=new n(32),o=0;o<8;o++)a[4*o]=this.state[o]>>>24&255,a[4*o+1]=this.state[o]>>>16&255,a[4*o+2]=this.state[o]>>>8&255,a[4*o+3]=this.state[o]>>>0&255;return e?a.toString(e):a},i.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,r=e.state,i=r[0],n=r[1],o=r[2],s=r[3],l=r[4],d=r[5],u=r[6],c=r[7],h=0;h<64;h++){if(h<16)this.temp[h]=(255&t[4*h])<<24|(255&t[4*h+1])<<16|(255&t[4*h+2])<<8|255&t[4*h+3];else{var p=this.temp[h-2],f=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10;p=this.temp[h-15];var g=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[h]=(f+this.temp[h-7]|0)+(g+this.temp[h-16]|0)}var v=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&d^~l&u)|0)+(c+(a[h]+this.temp[h]|0)|0)|0,m=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&n^i&o^n&o)|0;c=u,u=d,d=l,l=s+v|0,s=o,o=n,n=i,i=v+m|0}r[0]+=i,r[1]+=n,r[2]+=o,r[3]+=s,r[4]+=l,r[5]+=d,r[6]+=u,r[7]+=c}},{"./browserHashUtils":30,"buffer/":3}],33:[function(e,t,r){function i(){this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=new Uint32Array(80),this.offset=0,this.shift=24,this.totalLength=0}var n=e("buffer/").Buffer,o=e("./browserHashUtils");new Uint32Array([1518500249,1859775393,-1894007588,-899497514]),Math.pow(2,53),t.exports=i,i.BLOCK_SIZE=64,i.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");if(o.isEmptyData(e))return this;e=o.convertToBuffer(e);var t=e.length;this.totalLength+=8*t;for(var r=0;r<t;r++)this.write(e[r]);return this},i.prototype.write=function(e){this.block[this.offset]|=(255&e)<<this.shift,this.shift?this.shift-=8:(this.offset++,this.shift=24),16===this.offset&&this.processBlock()},i.prototype.digest=function(e){this.write(128),(this.offset>14||14===this.offset&&this.shift<24)&&this.processBlock(),this.offset=14,this.shift=24,this.write(0),this.write(0),this.write(this.totalLength>0xffffffffff?this.totalLength/1099511627776:0),this.write(this.totalLength>4294967295?this.totalLength/4294967296:0);for(var t=24;t>=0;t-=8)this.write(this.totalLength>>t);var r=new n(20),i=new DataView(r.buffer);return i.setUint32(0,this.h0,!1),i.setUint32(4,this.h1,!1),i.setUint32(8,this.h2,!1),i.setUint32(12,this.h3,!1),i.setUint32(16,this.h4,!1),e?r.toString(e):r},i.prototype.processBlock=function(){for(var e=16;e<80;e++){var t=this.block[e-3]^this.block[e-8]^this.block[e-14]^this.block[e-16];this.block[e]=t<<1|t>>>31}var r,i,n=this.h0,o=this.h1,a=this.h2,s=this.h3,l=this.h4;for(e=0;e<80;e++){e<20?(r=s^o&(a^s),i=1518500249):e<40?(r=o^a^s,i=1859775393):e<60?(r=o&a|s&(o|a),i=2400959708):(r=o^a^s,i=3395469782);var d=(n<<5|n>>>27)+r+l+i+(0|this.block[e]);l=s,s=a,a=o<<30|o>>>2,o=n,n=d}for(this.h0=this.h0+n|0,this.h1=this.h1+o|0,this.h2=this.h2+a|0,this.h3=this.h3+s|0,this.h4=this.h4+l|0,this.offset=0,e=0;e<16;e++)this.block[e]=0}},{"./browserHashUtils":30,"buffer/":3}],32:[function(e,t,r){function i(){this.state=[1732584193,4023233417,2562383102,271733878],this.buffer=new DataView(new ArrayBuffer(c)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}function n(e,t,r,i,n,o){return((t=(t+e&4294967295)+(i+o&4294967295)&4294967295)<<n|t>>>32-n)+r&4294967295}function o(e,t,r,i,o,a,s){return n(t&r|~t&i,e,t,o,a,s)}function a(e,t,r,i,o,a,s){return n(t&i|r&~i,e,t,o,a,s)}function s(e,t,r,i,o,a,s){return n(t^r^i,e,t,o,a,s)}function l(e,t,r,i,o,a,s){return n(r^(t|~i),e,t,o,a,s)}var d=e("./browserHashUtils"),u=e("buffer/").Buffer,c=64;t.exports=i,i.BLOCK_SIZE=c,i.prototype.update=function(e){if(d.isEmptyData(e))return this;if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=d.convertToBuffer(e),r=0,i=t.byteLength;for(this.bytesHashed+=i;i>0;)this.buffer.setUint8(this.bufferLength++,t[r++]),i--,this.bufferLength===c&&(this.hashBuffer(),this.bufferLength=0);return this},i.prototype.digest=function(e){if(!this.finished){var t=this,r=t.buffer,i=t.bufferLength,n=t.bytesHashed,o=8*n;if(r.setUint8(this.bufferLength++,128),i%c>=c-8){for(var a=this.bufferLength;a<c;a++)r.setUint8(a,0);this.hashBuffer(),this.bufferLength=0}for(var a=this.bufferLength;a<c-8;a++)r.setUint8(a,0);r.setUint32(c-8,o>>>0,!0),r.setUint32(c-4,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}for(var s=new DataView(new ArrayBuffer(16)),a=0;a<4;a++)s.setUint32(4*a,this.state[a],!0);var l=new u(s.buffer,s.byteOffset,s.byteLength);return e?l.toString(e):l},i.prototype.hashBuffer=function(){var e=this,t=e.buffer,r=e.state,i=r[0],n=r[1],d=r[2],u=r[3];i=o(i,n,d,u,t.getUint32(0,!0),7,3614090360),u=o(u,i,n,d,t.getUint32(4,!0),12,3905402710),d=o(d,u,i,n,t.getUint32(8,!0),17,606105819),n=o(n,d,u,i,t.getUint32(12,!0),22,3250441966),i=o(i,n,d,u,t.getUint32(16,!0),7,4118548399),u=o(u,i,n,d,t.getUint32(20,!0),12,1200080426),d=o(d,u,i,n,t.getUint32(24,!0),17,2821735955),n=o(n,d,u,i,t.getUint32(28,!0),22,4249261313),i=o(i,n,d,u,t.getUint32(32,!0),7,1770035416),u=o(u,i,n,d,t.getUint32(36,!0),12,2336552879),d=o(d,u,i,n,t.getUint32(40,!0),17,4294925233),n=o(n,d,u,i,t.getUint32(44,!0),22,2304563134),i=o(i,n,d,u,t.getUint32(48,!0),7,1804603682),u=o(u,i,n,d,t.getUint32(52,!0),12,4254626195),d=o(d,u,i,n,t.getUint32(56,!0),17,2792965006),n=o(n,d,u,i,t.getUint32(60,!0),22,1236535329),i=a(i,n,d,u,t.getUint32(4,!0),5,4129170786),u=a(u,i,n,d,t.getUint32(24,!0),9,3225465664),d=a(d,u,i,n,t.getUint32(44,!0),14,643717713),n=a(n,d,u,i,t.getUint32(0,!0),20,3921069994),i=a(i,n,d,u,t.getUint32(20,!0),5,3593408605),u=a(u,i,n,d,t.getUint32(40,!0),9,38016083),d=a(d,u,i,n,t.getUint32(60,!0),14,3634488961),n=a(n,d,u,i,t.getUint32(16,!0),20,3889429448),i=a(i,n,d,u,t.getUint32(36,!0),5,568446438),u=a(u,i,n,d,t.getUint32(56,!0),9,3275163606),d=a(d,u,i,n,t.getUint32(12,!0),14,4107603335),n=a(n,d,u,i,t.getUint32(32,!0),20,1163531501),i=a(i,n,d,u,t.getUint32(52,!0),5,2850285829),u=a(u,i,n,d,t.getUint32(8,!0),9,4243563512),d=a(d,u,i,n,t.getUint32(28,!0),14,1735328473),n=a(n,d,u,i,t.getUint32(48,!0),20,2368359562),i=s(i,n,d,u,t.getUint32(20,!0),4,4294588738),u=s(u,i,n,d,t.getUint32(32,!0),11,2272392833),d=s(d,u,i,n,t.getUint32(44,!0),16,1839030562),n=s(n,d,u,i,t.getUint32(56,!0),23,4259657740),i=s(i,n,d,u,t.getUint32(4,!0),4,2763975236),u=s(u,i,n,d,t.getUint32(16,!0),11,1272893353),d=s(d,u,i,n,t.getUint32(28,!0),16,4139469664),n=s(n,d,u,i,t.getUint32(40,!0),23,3200236656),i=s(i,n,d,u,t.getUint32(52,!0),4,681279174),u=s(u,i,n,d,t.getUint32(0,!0),11,3936430074),d=s(d,u,i,n,t.getUint32(12,!0),16,3572445317),n=s(n,d,u,i,t.getUint32(24,!0),23,76029189),i=s(i,n,d,u,t.getUint32(36,!0),4,3654602809),u=s(u,i,n,d,t.getUint32(48,!0),11,3873151461),d=s(d,u,i,n,t.getUint32(60,!0),16,530742520),n=s(n,d,u,i,t.getUint32(8,!0),23,3299628645),i=l(i,n,d,u,t.getUint32(0,!0),6,4096336452),u=l(u,i,n,d,t.getUint32(28,!0),10,1126891415),d=l(d,u,i,n,t.getUint32(56,!0),15,2878612391),n=l(n,d,u,i,t.getUint32(20,!0),21,4237533241),i=l(i,n,d,u,t.getUint32(48,!0),6,1700485571),u=l(u,i,n,d,t.getUint32(12,!0),10,2399980690),d=l(d,u,i,n,t.getUint32(40,!0),15,4293915773),n=l(n,d,u,i,t.getUint32(4,!0),21,2240044497),i=l(i,n,d,u,t.getUint32(32,!0),6,1873313359),u=l(u,i,n,d,t.getUint32(60,!0),10,4264355552),d=l(d,u,i,n,t.getUint32(24,!0),15,2734768916),n=l(n,d,u,i,t.getUint32(52,!0),21,1309151649),i=l(i,n,d,u,t.getUint32(16,!0),6,4149444226),u=l(u,i,n,d,t.getUint32(44,!0),10,3174756917),d=l(d,u,i,n,t.getUint32(8,!0),15,718787259),n=l(n,d,u,i,t.getUint32(36,!0),21,3951481745),r[0]=i+r[0]&4294967295,r[1]=n+r[1]&4294967295,r[2]=d+r[2]&4294967295,r[3]=u+r[3]&4294967295}},{"./browserHashUtils":30,"buffer/":3}],31:[function(e,t,r){function i(e,t){this.hash=new e,this.outer=new e;var r=n(e,t),i=new Uint8Array(e.BLOCK_SIZE);i.set(r);for(var o=0;o<e.BLOCK_SIZE;o++)r[o]^=54,i[o]^=92;this.hash.update(r),this.outer.update(i);for(var o=0;o<r.byteLength;o++)r[o]=0}function n(e,t){var r=o.convertToBuffer(t);if(r.byteLength>e.BLOCK_SIZE){var i=new e;i.update(r),r=i.digest()}var n=new Uint8Array(e.BLOCK_SIZE);return n.set(r),n}var o=e("./browserHashUtils");t.exports=i,i.prototype.update=function(e){if(o.isEmptyData(e)||this.error)return this;try{this.hash.update(o.convertToBuffer(e))}catch(e){this.error=e}return this},i.prototype.digest=function(e){return this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest(e)}},{"./browserHashUtils":30}],30:[function(e,t,r){function i(e){return"string"==typeof e?0===e.length:0===e.byteLength}function n(e){return"string"==typeof e&&(e=new o(e,"utf8")),ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var o=e("buffer/").Buffer;"undefined"!=typeof ArrayBuffer&&void 0===ArrayBuffer.isView&&(ArrayBuffer.isView=function(e){return a.indexOf(Object.prototype.toString.call(e))>-1});var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]","[object DataView]"];t.exports={isEmptyData:i,convertToBuffer:n}},{"buffer/":3}],18:[function(e,t,r){function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,r){if(e&&d(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}function o(e){return l(e)&&(e=n(e)),e instanceof i?e.format():i.prototype.format.call(e)}function a(e,t){return n(e,!1,!0).resolve(t)}function s(e,t){return e?n(e,!1,!0).resolveObject(t):t}function l(e){return"string"==typeof e}function d(e){return"object"==typeof e&&null!==e}function u(e){return null===e}function c(e){return null==e}var h=e("punycode");r.parse=n,r.resolve=a,r.resolveObject=s,r.format=o,r.Url=i;var p=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,g=["<",">",'"',"`"," ","\r","\n","\t"],v=["{","}","|","\\","^","`"].concat(g),m=["'"].concat(v),y=["%","/","?",";","#"].concat(m),_=["/","?","#"],b=/^[a-z0-9A-Z_-]{0,63}$/,E=/^([a-z0-9A-Z_-]{0,63})(.*)$/,A={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=e("querystring");i.prototype.parse=function(e,t,r){if(!l(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e;i=i.trim();var n=p.exec(i);if(n){n=n[0];var o=n.toLowerCase();this.protocol=o,i=i.substr(n.length)}if(r||n||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===i.substr(0,2);!a||n&&S[n]||(i=i.substr(2),this.slashes=!0)}if(!S[n]&&(a||n&&!w[n])){for(var s=-1,d=0;d<_.length;d++){var u=i.indexOf(_[d]);-1!==u&&(-1===s||u<s)&&(s=u)}var c,f;f=-1===s?i.lastIndexOf("@"):i.lastIndexOf("@",s),-1!==f&&(c=i.slice(0,f),i=i.slice(f+1),this.auth=decodeURIComponent(c)),s=-1;for(var d=0;d<y.length;d++){var u=i.indexOf(y[d]);-1!==u&&(-1===s||u<s)&&(s=u)}-1===s&&(s=i.length),this.host=i.slice(0,s),i=i.slice(s),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var v=this.hostname.split(/\./),d=0,L=v.length;d<L;d++){var I=v[d];if(I&&!I.match(b)){for(var C="",P=0,M=I.length;P<M;P++)I.charCodeAt(P)>127?C+="x":C+=I[P];if(!C.match(b)){var R=v.slice(0,d),O=v.slice(d+1),k=I.match(E);k&&(R.push(k[1]),O.unshift(k[2])),O.length&&(i="/"+O.join(".")+i),this.hostname=R.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!g){for(var D=this.hostname.split("."),x=[],d=0;d<D.length;++d){var N=D[d];x.push(N.match(/[^A-Za-z0-9_-]/)?"xn--"+h.encode(N):N)}this.hostname=x.join(".")}var U=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+U,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!A[o])for(var d=0,L=m.length;d<L;d++){var G=m[d],V=encodeURIComponent(G);V===G&&(V=escape(G)),i=i.split(G).join(V)}var F=i.indexOf("#");-1!==F&&(this.hash=i.substr(F),i=i.slice(0,F));var q=i.indexOf("?");if(-1!==q?(this.search=i.substr(q),this.query=i.substr(q+1),t&&(this.query=T.parse(this.query)),i=i.slice(0,q)):t&&(this.search="",this.query={}),i&&(this.pathname=i),w[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",N=this.search||"";this.path=U+N}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,o="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&d(this.query)&&Object.keys(this.query).length&&(o=T.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||w[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+n+r+a+i},i.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(l(e)){var t=new i;t.parse(e,!1,!0),e=t}var r=new i;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(r[t]=e[t])}),w[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!w[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||S[e.protocol])r.pathname=e.pathname;else{for(var n=(e.pathname||"").split("/");n.length&&!(e.host=n.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),r.pathname=n.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||"",a=r.search||"";r.path=o+a}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),d=e.host||e.pathname&&"/"===e.pathname.charAt(0),h=d||s||r.host&&e.pathname,p=h,f=r.pathname&&r.pathname.split("/")||[],n=e.pathname&&e.pathname.split("/")||[],g=r.protocol&&!w[r.protocol];if(g&&(r.hostname="",r.port=null,r.host&&(""===f[0]?f[0]=r.host:f.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===n[0]?n[0]=e.host:n.unshift(e.host)),e.host=null),h=h&&(""===n[0]||""===f[0])),d)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,f=n;else if(n.length)f||(f=[]),f.pop(),f=f.concat(n),r.search=e.search,r.query=e.query;else if(!c(e.search)){if(g){r.hostname=r.host=f.shift();var v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return r.search=e.search,r.query=e.query,u(r.pathname)&&u(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!f.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var m=f.slice(-1)[0],y=(r.host||e.host)&&("."===m||".."===m)||""===m,_=0,b=f.length;b>=0;b--)m=f[b],"."==m?f.splice(b,1):".."===m?(f.splice(b,1),_++):_&&(f.splice(b,1),_--);if(!h&&!p)for(;_--;_)f.unshift("..");!h||""===f[0]||f[0]&&"/"===f[0].charAt(0)||f.unshift(""),y&&"/"!==f.join("/").substr(-1)&&f.push("");var E=""===f[0]||f[0]&&"/"===f[0].charAt(0);if(g){r.hostname=r.host=E?"":f.length?f.shift():"";var v=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");v&&(r.auth=v.shift(),r.host=r.hostname=v.shift())}return h=h||r.host&&f.length,h&&!E&&f.unshift(""),f.length?r.pathname=f.join("/"):(r.pathname=null,r.path=null),u(r.pathname)&&u(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:10,querystring:13}],16:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"./decode":14,"./encode":15,dup:13}],15:[function(e,t,r){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(n){var o=encodeURIComponent(i(n))+r;return Array.isArray(e[n])?e[n].map(function(e){return o+encodeURIComponent(i(e))}).join(t):o+encodeURIComponent(i(e[n]))}).join(t):n?encodeURIComponent(i(n))+r+encodeURIComponent(i(e)):""}},{}],14:[function(e,t,r){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,n){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var d=0;d<l;++d){var u,c,h,p,f=e[d].replace(a,"%20"),g=f.indexOf(r);g>=0?(u=f.substr(0,g),c=f.substr(g+1)):(u=f,c=""),h=decodeURIComponent(u),p=decodeURIComponent(c),i(o,h)?Array.isArray(o[h])?o[h].push(p):o[h]=[o[h],p]:o[h]=p}return o}},{}],13:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":11,"./encode":12}],12:[function(e,t,r){"use strict";function i(e,t){if(e.map)return e.map(t);for(var r=[],i=0;i<e.length;i++)r.push(t(e[i],i));return r}var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),function(a){var s=encodeURIComponent(n(a))+r;return o(e[a])?i(e[a],function(e){return s+encodeURIComponent(n(e))}).join(t):s+encodeURIComponent(n(e[a]))}).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],11:[function(e,t,r){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var d=e.length;l>0&&d>l&&(d=l);for(var u=0;u<d;++u){var c,h,p,f,g=e[u].replace(s,"%20"),v=g.indexOf(r);v>=0?(c=g.substr(0,v),h=g.substr(v+1)):(c=g,h=""),p=decodeURIComponent(c),f=decodeURIComponent(h),i(a,p)?n(a[p])?a[p].push(f):a[p]=[a[p],f]:a[p]=f}return a};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],10:[function(t,r,i){(function(e){!function(t){function n(e){throw RangeError(k[e])}function o(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function a(e,t){var r=e.split("@"),i="";return r.length>1&&(i=r[0]+"@",e=r[1]),e=e.replace(O,"."),i+o(e.split("."),t).join(".")}function s(e){for(var t,r,i=[],n=0,o=e.length;n<o;)t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<o?(r=e.charCodeAt(n++),56320==(64512&r)?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--)):i.push(t);return i}function l(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function d(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:A}function u(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function c(e,t,r){var i=0;for(e=r?x(e/L):e>>1,e+=x(e/t);e>D*w>>1;i+=A)e=x(e/D);return x(i+(D+1)*e/(e+T))}function h(e){var t,r,i,o,a,s,u,h,p,f,g=[],v=e.length,m=0,y=C,_=I;for(r=e.lastIndexOf(P),r<0&&(r=0),i=0;i<r;++i)e.charCodeAt(i)>=128&&n("not-basic"),g.push(e.charCodeAt(i));for(o=r>0?r+1:0;o<v;){for(a=m,s=1,u=A;o>=v&&n("invalid-input"),h=d(e.charCodeAt(o++)),(h>=A||h>x((E-m)/s))&&n("overflow"),m+=h*s,p=u<=_?S:u>=_+w?w:u-_,!(h<p);u+=A)f=A-p,s>x(E/f)&&n("overflow"),s*=f;t=g.length+1,_=c(m-a,t,0==a),x(m/t)>E-y&&n("overflow"),y+=x(m/t),m%=t,g.splice(m++,0,y)}return l(g)}function p(e){var t,r,i,o,a,l,d,h,p,f,g,v,m,y,_,b=[];for(e=s(e),v=e.length,t=C,r=0,a=I,l=0;l<v;++l)(g=e[l])<128&&b.push(N(g));for(i=o=b.length,o&&b.push(P);i<v;){for(d=E,l=0;l<v;++l)(g=e[l])>=t&&g<d&&(d=g);for(m=i+1,d-t>x((E-r)/m)&&n("overflow"),r+=(d-t)*m,t=d,l=0;l<v;++l)if(g=e[l],g<t&&++r>E&&n("overflow"),g==t){for(h=r,p=A;f=p<=a?S:p>=a+w?w:p-a,!(h<f);p+=A)_=h-f,y=A-f,b.push(N(u(f+_%y,0))),h=x(_/y);b.push(N(u(h,0))),a=c(r,m,i==o),r=0,++i}++r,++t}return b.join("")}function f(e){return a(e,function(e){return M.test(e)?h(e.slice(4).toLowerCase()):e})}function g(e){return a(e,function(e){return R.test(e)?"xn--"+p(e):e})}var v="object"==typeof i&&i&&!i.nodeType&&i,m="object"==typeof r&&r&&!r.nodeType&&r,y="object"==typeof e&&e;y.global!==y&&y.window!==y&&y.self!==y||(t=y);var _,b,E=2147483647,A=36,S=1,w=26,T=38,L=700,I=72,C=128,P="-",M=/^xn--/,R=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},D=A-S,x=Math.floor,N=String.fromCharCode;if(_={version:"1.3.2",ucs2:{decode:s,encode:l},decode:h,encode:p,toASCII:g,toUnicode:f},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",[],function(){return _});else if(v&&m)if(r.exports==v)m.exports=_;else for(b in _)_.hasOwnProperty(b)&&(v[b]=_[b]);else t.punycode=_}(this)
}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==e?e:{})},{}],4:[function(e,t,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,r,i,o,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),d=r.slice(),i=d.length,l=0;l<i;l++)d[l].apply(this,o);return!0},i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},i.prototype.removeListener=function(e,t){var r,i,o,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(t,r,i){(function(e){"use strict";function r(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function n(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return a(this,e,t,r)}function a(e,t,r,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,i):"string"==typeof t?u(e,t,r):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t,r,i){return s(t),t<=0?n(e,t):void 0!==r?"string"==typeof i?n(e,t).fill(r,i):n(e,t).fill(r):n(e,t)}function d(e,t){if(s(t),e=n(e,t<0?0:0|f(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function u(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|v(t,r);e=n(e,i);var a=e.write(t,r);return a!==i&&(e=e.slice(0,a)),e}function c(e,t){var r=t.length<0?0:0|f(t.length);e=n(e,r);for(var i=0;i<r;i+=1)e[i]=255&t[i];return e}function h(e,t,r,i){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,r):new Uint8Array(t,r,i),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=c(e,t),e}function p(e,t){if(o.isBuffer(t)){var r=0|f(t.length);return e=n(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?n(e,0):c(e,t);if("Buffer"===t.type&&J(t.data))return c(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function f(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return M(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function _(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=o.from(t,i)),o.isBuffer(t))return 0===t.length?-1:b(e,t,r,i,n);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,i,n){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}var d;if(n){var u=-1;for(d=r;d<s;d++)if(o(e,d)===o(t,-1===u?0:d-u)){if(-1===u&&(u=d),d-u+1===l)return u*a}else-1!==u&&(d-=d-u),u=-1}else for(r+l>s&&(r=s-l),d=r;d>=0;d--){for(var c=!0,h=0;h<l;h++)if(o(e,d+h)!==o(t,h)){c=!1;break}if(c)return d}return-1}function E(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function A(e,t,r,i){return K(j(t,e.length-r),e,r,i)}function S(e,t,r,i){return K(z(t),e,r,i)}function w(e,t,r,i){return S(e,t,r,i)}function T(e,t,r,i){return K(Y(t),e,r,i)}function L(e,t,r,i){return K(W(t,e.length-r),e,r,i)}function I(e,t,r){return 0===t&&r===e.length?Q.fromByteArray(e):Q.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var o=e[n],a=null,s=o>239?4:o>223?3:o>191?2:1;if(n+s<=r){var l,d,u,c;switch(s){case 1:o<128&&(a=o);break;case 2:128==(192&(l=e[n+1]))&&(c=(31&o)<<6|63&l)>127&&(a=c);break;case 3:l=e[n+1],d=e[n+2],128==(192&l)&&128==(192&d)&&(c=(15&o)<<12|(63&l)<<6|63&d)>2047&&(c<55296||c>57343)&&(a=c);break;case 4:l=e[n+1],d=e[n+2],u=e[n+3],128==(192&l)&&128==(192&d)&&128==(192&u)&&(c=(15&o)<<18|(63&l)<<12|(63&d)<<6|63&u)>65535&&c<1114112&&(a=c)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|1023&a),i.push(a),n+=s}return P(i)}function P(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=$));return r}function M(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function R(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function O(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=t;o<r;++o)n+=H(e[o]);return n}function k(e,t,r){for(var i=e.slice(t,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,r,i,n,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function N(e,t,r,i){t<0&&(t=65535+t+1);for(var n=0,o=Math.min(e.length-r,2);n<o;++n)e[r+n]=(t&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function U(e,t,r,i){t<0&&(t=4294967295+t+1);for(var n=0,o=Math.min(e.length-r,4);n<o;++n)e[r+n]=t>>>8*(i?n:3-n)&255}function B(e,t,r,i,n,o){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function G(e,t,r,i,n){return n||B(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,r,i,23,4),r+4}function V(e,t,r,i,n){return n||B(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,r,i,52,8),r+8}function F(e){if(e=q(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function q(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){t=t||1/0;for(var r,i=e.length,n=null,o=[],a=0;a<i;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function z(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function W(e,t){for(var r,i,n,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,n=r%256,o.push(n),o.push(i);return o}function Y(e){return Q.toByteArray(F(e))}function K(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function X(e){return e!==e}var Q=t("base64-js"),Z=t("ieee754"),J=t("isarray");i.Buffer=o,i.SlowBuffer=g,i.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),i.kMaxLength=r(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return a(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return l(null,e,t,r)},o.allocUnsafe=function(e){return d(null,e)},o.allocUnsafeSlow=function(e){return d(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!J(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=o.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var a=e[r];if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,n),n+=a.length}return i},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,i,n){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,n>>>=0,this===e)return 0;for(var a=n-i,s=r-t,l=Math.min(a,s),d=this.slice(i,n),u=e.slice(t,r),c=0;c<l;++c)if(d[c]!==u[c]){a=d[c],s=u[c];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return _(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return _(this,e,t,r,!1)},o.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return A(this,e,t,r);case"ascii":return S(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i;if(o.TYPED_ARRAY_SUPPORT)i=this.subarray(e,t),i.__proto__=o.prototype;else{var n=t-e;i=new o(n,void 0);for(var a=0;a<n;++a)i[a]=this[a+e]}return i},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return i},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},o.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=this[e],n=1,o=0;++o<t&&(n*=256);)i+=this[e+o]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||D(e,t,this.length);for(var i=t,n=1,o=this[e+--i];i>0&&(n*=256);)o+=this[e+--i]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),Z.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),Z.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),Z.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),Z.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,i){e=+e,t|=0,r|=0,i||x(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,o=0;for(this[t]=255&e;++o<r&&(n*=256);)this[t+o]=e/n&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,i){e=+e,t|=0,r|=0,i||x(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):U(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);x(this,e,t,r,n-1,-n)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t|=0,!i){var n=Math.pow(2,8*r-1);x(this,e,t,r,n-1,-n)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):U(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):U(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return G(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return G(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return V(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return V(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,i){if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n,a=i-r;if(this===e&&r<t&&t<i)for(n=a-1;n>=0;--n)e[n+t]=this[n+r];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(n=0;n<a;++n)e[n+t]=this[n+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},o.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=o.isBuffer(e)?e:j(new o(e,i).toString()),l=s.length;for(a=0;a<r-t;++a)this[a+t]=s[a%l]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0!==e?e:{})},{"base64-js":1,ieee754:5,isarray:7}],7:[function(e,t,r){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],5:[function(e,t,r){r.read=function(e,t,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,d=l>>1,u=-7,c=r?n-1:0,h=r?-1:1,p=e[t+c];for(c+=h,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+c],c+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;u>0;a=256*a+e[t+c],c+=h,u-=8);if(0===o)o=1-d;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=d}return(p?-1:1)*a*Math.pow(2,o-i)},r.write=function(e,t,r,i,n,o){var a,s,l,d=8*o-n-1,u=(1<<d)-1,c=u>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),t+=a+c>=1?h/l:h*Math.pow(2,1-c),t*l>=2&&(a++,l/=2),a+c>=u?(s=0,a=u):a+c>=1?(s=(t*l-1)*Math.pow(2,n),a+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,n),a=0));n>=8;e[r+p]=255&s,p+=f,s/=256,n-=8);for(a=a<<n|s,d+=n;d>0;e[r+p]=255&a,p+=f,a/=256,d-=8);e[r+p-f]|=128*g}},{}],1:[function(e,t,r){"use strict";function i(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function n(e){var t=i(e),r=t[0],n=t[1];return 3*(r+n)/4-n}function o(e,t,r){return 3*(t+r)/4-r}function a(e){for(var t,r=i(e),n=r[0],a=r[1],s=new h(o(e,n,a)),l=0,d=a>0?n-4:n,u=0;u<d;u+=4)t=c[e.charCodeAt(u)]<<18|c[e.charCodeAt(u+1)]<<12|c[e.charCodeAt(u+2)]<<6|c[e.charCodeAt(u+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;return 2===a&&(t=c[e.charCodeAt(u)]<<2|c[e.charCodeAt(u+1)]>>4,s[l++]=255&t),1===a&&(t=c[e.charCodeAt(u)]<<10|c[e.charCodeAt(u+1)]<<4|c[e.charCodeAt(u+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t),s}function s(e){return u[e>>18&63]+u[e>>12&63]+u[e>>6&63]+u[63&e]}function l(e,t,r){for(var i,n=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),n.push(s(i));return n.join("")}function d(e){for(var t,r=e.length,i=r%3,n=[],o=0,a=r-i;o<a;o+=16383)n.push(l(e,o,o+16383>a?a:o+16383));return 1===i?(t=e[r-1],n.push(u[t>>2]+u[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],n.push(u[t>>10]+u[t>>4&63]+u[t<<2&63]+"=")),n.join("")}r.byteLength=n,r.toByteArray=a,r.fromByteArray=d;for(var u=[],c=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,g=p.length;f<g;++f)u[f]=p[f],c[p.charCodeAt(f)]=f;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}]},{},[28]),AWS.apiLoader.services.cognitoidentity={},AWS.CognitoIdentity=AWS.Service.defineService("cognitoidentity",["2014-06-30"]),_xamzrequire=function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof _xamzrequire&&_xamzrequire;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return n(t[a][1][e]||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,a=0;a<i.length;a++)n(i[a]);return n}({82:[function(e,t,r){var i=e("../core");i.util.update(i.CognitoIdentity.prototype,{getOpenIdToken:function(e,t){return this.makeUnauthenticatedRequest("getOpenIdToken",e,t)},getId:function(e,t){return this.makeUnauthenticatedRequest("getId",e,t)},getCredentialsForIdentity:function(e,t){return this.makeUnauthenticatedRequest("getCredentialsForIdentity",e,t)}})},{"../core":38}]},{},[82]),AWS.apiLoader.services.cognitoidentity["2014-06-30"]={version:"2.0",metadata:{apiVersion:"2014-06-30",endpointPrefix:"cognito-identity",jsonVersion:"1.1",protocol:"json",serviceFullName:"Amazon Cognito Identity",signatureVersion:"v4",targetPrefix:"AWSCognitoIdentityService",uid:"cognito-identity-2014-06-30"},operations:{CreateIdentityPool:{input:{type:"structure",required:["IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},SupportedLoginProviders:{shape:"S4"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S8"},CognitoIdentityProviders:{shape:"Sa"},SamlProviderARNs:{shape:"Sf"}}},output:{shape:"Sg"}},DeleteIdentities:{input:{type:"structure",required:["IdentityIdsToDelete"],members:{IdentityIdsToDelete:{type:"list",member:{}}}},output:{type:"structure",members:{UnprocessedIdentityIds:{type:"list",member:{type:"structure",members:{IdentityId:{},ErrorCode:{}}}}}}},DeleteIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}}},DescribeIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{}}},output:{shape:"Sr"}},DescribeIdentityPool:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},output:{shape:"Sg"}},GetCredentialsForIdentity:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"Sw"},CustomRoleArn:{}}},output:{type:"structure",members:{IdentityId:{},Credentials:{type:"structure",members:{AccessKeyId:{},SecretKey:{},SessionToken:{},Expiration:{type:"timestamp"}}}}}},GetId:{input:{type:"structure",required:["IdentityPoolId"],members:{AccountId:{},IdentityPoolId:{},Logins:{shape:"Sw"}}},output:{type:"structure",members:{IdentityId:{}}}},GetIdentityPoolRoles:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{}}},output:{type:"structure",members:{IdentityPoolId:{},Roles:{shape:"S18"},RoleMappings:{shape:"S1a"}}}},GetOpenIdToken:{input:{type:"structure",required:["IdentityId"],members:{IdentityId:{},Logins:{shape:"Sw"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}}},GetOpenIdTokenForDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId","Logins"],members:{IdentityPoolId:{},IdentityId:{},Logins:{shape:"Sw"},TokenDuration:{type:"long"}}},output:{type:"structure",members:{IdentityId:{},Token:{}}}},ListIdentities:{input:{type:"structure",required:["IdentityPoolId","MaxResults"],members:{IdentityPoolId:{},MaxResults:{type:"integer"},NextToken:{},HideDisabled:{type:"boolean"}}},output:{type:"structure",members:{IdentityPoolId:{},Identities:{type:"list",member:{shape:"Sr"}},NextToken:{}}}},ListIdentityPools:{input:{type:"structure",required:["MaxResults"],members:{MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityPools:{type:"list",member:{type:"structure",members:{IdentityPoolId:{},IdentityPoolName:{}}}},NextToken:{}}}},LookupDeveloperIdentity:{input:{type:"structure",required:["IdentityPoolId"],members:{IdentityPoolId:{},IdentityId:{},DeveloperUserIdentifier:{},MaxResults:{type:"integer"},NextToken:{}}},output:{type:"structure",members:{IdentityId:{},DeveloperUserIdentifierList:{type:"list",member:{}},NextToken:{}}}},MergeDeveloperIdentities:{input:{type:"structure",required:["SourceUserIdentifier","DestinationUserIdentifier","DeveloperProviderName","IdentityPoolId"],members:{SourceUserIdentifier:{},DestinationUserIdentifier:{},DeveloperProviderName:{},IdentityPoolId:{}}},output:{type:"structure",members:{IdentityId:{}}}},SetIdentityPoolRoles:{input:{type:"structure",required:["IdentityPoolId","Roles"],members:{IdentityPoolId:{},Roles:{shape:"S18"},RoleMappings:{shape:"S1a"}}}},UnlinkDeveloperIdentity:{input:{type:"structure",required:["IdentityId","IdentityPoolId","DeveloperProviderName","DeveloperUserIdentifier"],members:{IdentityId:{},IdentityPoolId:{},DeveloperProviderName:{},DeveloperUserIdentifier:{}}}},UnlinkIdentity:{input:{type:"structure",required:["IdentityId","Logins","LoginsToRemove"],members:{IdentityId:{},Logins:{shape:"Sw"},LoginsToRemove:{shape:"Ss"}}}},UpdateIdentityPool:{input:{shape:"Sg"},output:{shape:"Sg"}}},shapes:{S4:{type:"map",key:{},value:{}},S8:{type:"list",member:{}},Sa:{type:"list",member:{type:"structure",members:{ProviderName:{},ClientId:{},ServerSideTokenCheck:{type:"boolean"}}}},Sf:{type:"list",member:{}},Sg:{type:"structure",required:["IdentityPoolId","IdentityPoolName","AllowUnauthenticatedIdentities"],members:{IdentityPoolId:{},IdentityPoolName:{},AllowUnauthenticatedIdentities:{type:"boolean"},SupportedLoginProviders:{shape:"S4"},DeveloperProviderName:{},OpenIdConnectProviderARNs:{shape:"S8"},CognitoIdentityProviders:{shape:"Sa"},SamlProviderARNs:{shape:"Sf"}}},Sr:{type:"structure",members:{IdentityId:{},Logins:{shape:"Ss"},CreationDate:{type:"timestamp"},LastModifiedDate:{type:"timestamp"}
}},Ss:{type:"list",member:{}},Sw:{type:"map",key:{},value:{}},S18:{type:"map",key:{},value:{}},S1a:{type:"map",key:{},value:{type:"structure",required:["Type"],members:{Type:{},AmbiguousRoleResolution:{},RulesConfiguration:{type:"structure",required:["Rules"],members:{Rules:{type:"list",member:{type:"structure",required:["Claim","MatchType","Value","RoleARN"],members:{Claim:{},MatchType:{},Value:{},RoleARN:{}}}}}}}}}},paginators:{}},AWS.apiLoader.services.kinesis={},AWS.Kinesis=AWS.Service.defineService("kinesis",["2013-12-02"]),AWS.apiLoader.services.kinesis["2013-12-02"]={version:"2.0",metadata:{apiVersion:"2013-12-02",endpointPrefix:"kinesis",jsonVersion:"1.1",protocol:"json",serviceAbbreviation:"Kinesis",serviceFullName:"Amazon Kinesis",serviceId:"Kinesis",signatureVersion:"v4",targetPrefix:"Kinesis_20131202",uid:"kinesis-2013-12-02"},operations:{AddTagsToStream:{input:{type:"structure",required:["StreamName","Tags"],members:{StreamName:{},Tags:{type:"map",key:{},value:{}}}}},CreateStream:{input:{type:"structure",required:["StreamName","ShardCount"],members:{StreamName:{},ShardCount:{type:"integer"}}}},DecreaseStreamRetentionPeriod:{input:{type:"structure",required:["StreamName","RetentionPeriodHours"],members:{StreamName:{},RetentionPeriodHours:{type:"integer"}}}},DeleteStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{}}}},DescribeLimits:{input:{type:"structure",members:{}},output:{type:"structure",required:["ShardLimit","OpenShardCount"],members:{ShardLimit:{type:"integer"},OpenShardCount:{type:"integer"}}}},DescribeStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{},Limit:{type:"integer"},ExclusiveStartShardId:{}}},output:{type:"structure",required:["StreamDescription"],members:{StreamDescription:{type:"structure",required:["StreamName","StreamARN","StreamStatus","Shards","HasMoreShards","RetentionPeriodHours","StreamCreationTimestamp","EnhancedMonitoring"],members:{StreamName:{},StreamARN:{},StreamStatus:{},Shards:{shape:"Sl"},HasMoreShards:{type:"boolean"},RetentionPeriodHours:{type:"integer"},StreamCreationTimestamp:{type:"timestamp"},EnhancedMonitoring:{shape:"St"},EncryptionType:{},KeyId:{}}}}}},DescribeStreamSummary:{input:{type:"structure",required:["StreamName"],members:{StreamName:{}}},output:{type:"structure",required:["StreamDescriptionSummary"],members:{StreamDescriptionSummary:{type:"structure",required:["StreamName","StreamARN","StreamStatus","RetentionPeriodHours","StreamCreationTimestamp","EnhancedMonitoring","OpenShardCount"],members:{StreamName:{},StreamARN:{},StreamStatus:{},RetentionPeriodHours:{type:"integer"},StreamCreationTimestamp:{type:"timestamp"},EnhancedMonitoring:{shape:"St"},EncryptionType:{},KeyId:{},OpenShardCount:{type:"integer"}}}}}},DisableEnhancedMonitoring:{input:{type:"structure",required:["StreamName","ShardLevelMetrics"],members:{StreamName:{},ShardLevelMetrics:{shape:"Sv"}}},output:{shape:"S13"}},EnableEnhancedMonitoring:{input:{type:"structure",required:["StreamName","ShardLevelMetrics"],members:{StreamName:{},ShardLevelMetrics:{shape:"Sv"}}},output:{shape:"S13"}},GetRecords:{input:{type:"structure",required:["ShardIterator"],members:{ShardIterator:{},Limit:{type:"integer"}}},output:{type:"structure",required:["Records"],members:{Records:{type:"list",member:{type:"structure",required:["SequenceNumber","Data","PartitionKey"],members:{SequenceNumber:{},ApproximateArrivalTimestamp:{type:"timestamp"},Data:{type:"blob"},PartitionKey:{},EncryptionType:{}}}},NextShardIterator:{},MillisBehindLatest:{type:"long"}}}},GetShardIterator:{input:{type:"structure",required:["StreamName","ShardId","ShardIteratorType"],members:{StreamName:{},ShardId:{},ShardIteratorType:{},StartingSequenceNumber:{},Timestamp:{type:"timestamp"}}},output:{type:"structure",members:{ShardIterator:{}}}},IncreaseStreamRetentionPeriod:{input:{type:"structure",required:["StreamName","RetentionPeriodHours"],members:{StreamName:{},RetentionPeriodHours:{type:"integer"}}}},ListShards:{input:{type:"structure",members:{StreamName:{},NextToken:{},ExclusiveStartShardId:{},MaxResults:{type:"integer"},StreamCreationTimestamp:{type:"timestamp"}}},output:{type:"structure",members:{Shards:{shape:"Sl"},NextToken:{}}}},ListStreams:{input:{type:"structure",members:{Limit:{type:"integer"},ExclusiveStartStreamName:{}}},output:{type:"structure",required:["StreamNames","HasMoreStreams"],members:{StreamNames:{type:"list",member:{}},HasMoreStreams:{type:"boolean"}}}},ListTagsForStream:{input:{type:"structure",required:["StreamName"],members:{StreamName:{},ExclusiveStartTagKey:{},Limit:{type:"integer"}}},output:{type:"structure",required:["Tags","HasMoreTags"],members:{Tags:{type:"list",member:{type:"structure",required:["Key"],members:{Key:{},Value:{}}}},HasMoreTags:{type:"boolean"}}}},MergeShards:{input:{type:"structure",required:["StreamName","ShardToMerge","AdjacentShardToMerge"],members:{StreamName:{},ShardToMerge:{},AdjacentShardToMerge:{}}}},PutRecord:{input:{type:"structure",required:["StreamName","Data","PartitionKey"],members:{StreamName:{},Data:{type:"blob"},PartitionKey:{},ExplicitHashKey:{},SequenceNumberForOrdering:{}}},output:{type:"structure",required:["ShardId","SequenceNumber"],members:{ShardId:{},SequenceNumber:{},EncryptionType:{}}}},PutRecords:{input:{type:"structure",required:["Records","StreamName"],members:{Records:{type:"list",member:{type:"structure",required:["Data","PartitionKey"],members:{Data:{type:"blob"},ExplicitHashKey:{},PartitionKey:{}}}},StreamName:{}}},output:{type:"structure",required:["Records"],members:{FailedRecordCount:{type:"integer"},Records:{type:"list",member:{type:"structure",members:{SequenceNumber:{},ShardId:{},ErrorCode:{},ErrorMessage:{}}}},EncryptionType:{}}}},RemoveTagsFromStream:{input:{type:"structure",required:["StreamName","TagKeys"],members:{StreamName:{},TagKeys:{type:"list",member:{}}}}},SplitShard:{input:{type:"structure",required:["StreamName","ShardToSplit","NewStartingHashKey"],members:{StreamName:{},ShardToSplit:{},NewStartingHashKey:{}}}},StartStreamEncryption:{input:{type:"structure",required:["StreamName","EncryptionType","KeyId"],members:{StreamName:{},EncryptionType:{},KeyId:{}}}},StopStreamEncryption:{input:{type:"structure",required:["StreamName","EncryptionType","KeyId"],members:{StreamName:{},EncryptionType:{},KeyId:{}}}},UpdateShardCount:{input:{type:"structure",required:["StreamName","TargetShardCount","ScalingType"],members:{StreamName:{},TargetShardCount:{type:"integer"},ScalingType:{}}},output:{type:"structure",members:{StreamName:{},CurrentShardCount:{type:"integer"},TargetShardCount:{type:"integer"}}}}},shapes:{Sl:{type:"list",member:{type:"structure",required:["ShardId","HashKeyRange","SequenceNumberRange"],members:{ShardId:{},ParentShardId:{},AdjacentParentShardId:{},HashKeyRange:{type:"structure",required:["StartingHashKey","EndingHashKey"],members:{StartingHashKey:{},EndingHashKey:{}}},SequenceNumberRange:{type:"structure",required:["StartingSequenceNumber"],members:{StartingSequenceNumber:{},EndingSequenceNumber:{}}}}}},St:{type:"list",member:{type:"structure",members:{ShardLevelMetrics:{shape:"Sv"}}}},Sv:{type:"list",member:{}},S13:{type:"structure",members:{StreamName:{},CurrentShardLevelMetrics:{shape:"Sv"},DesiredShardLevelMetrics:{shape:"Sv"}}}},paginators:{DescribeStream:{input_token:"ExclusiveStartShardId",limit_key:"Limit",more_results:"StreamDescription.HasMoreShards",output_token:"StreamDescription.Shards[-1].ShardId",result_key:"StreamDescription.Shards"},ListStreams:{input_token:"ExclusiveStartStreamName",limit_key:"Limit",more_results:"HasMoreStreams",output_token:"StreamNames[-1]",result_key:"StreamNames"}},waiters:{StreamExists:{delay:10,operation:"DescribeStream",maxAttempts:18,acceptors:[{expected:"ACTIVE",matcher:"path",state:"success",argument:"StreamDescription.StreamStatus"}]},StreamNotExists:{delay:10,operation:"DescribeStream",maxAttempts:18,acceptors:[{expected:"ResourceNotFoundException",matcher:"error",state:"success"}]}}},AWS.apiLoader.services.sts={},AWS.STS=AWS.Service.defineService("sts",["2011-06-15"]),_xamzrequire=function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof _xamzrequire&&_xamzrequire;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){return n(t[a][1][e]||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof _xamzrequire&&_xamzrequire,a=0;a<i.length;a++)n(i[a]);return n}({94:[function(e,t,r){var i=e("../core");i.util.update(i.STS.prototype,{credentialsFrom:function(e,t){return e?(t||(t=new i.TemporaryCredentials),t.expired=!1,t.accessKeyId=e.Credentials.AccessKeyId,t.secretAccessKey=e.Credentials.SecretAccessKey,t.sessionToken=e.Credentials.SessionToken,t.expireTime=e.Credentials.Expiration,t):null},assumeRoleWithWebIdentity:function(e,t){return this.makeUnauthenticatedRequest("assumeRoleWithWebIdentity",e,t)},assumeRoleWithSAML:function(e,t){return this.makeUnauthenticatedRequest("assumeRoleWithSAML",e,t)}})},{"../core":38}]},{},[94]),AWS.apiLoader.services.sts["2011-06-15"]={version:"2.0",metadata:{apiVersion:"2011-06-15",endpointPrefix:"sts",globalEndpoint:"sts.amazonaws.com",protocol:"query",serviceAbbreviation:"AWS STS",serviceFullName:"AWS Security Token Service",serviceId:"STS",signatureVersion:"v4",uid:"sts-2011-06-15",xmlNamespace:"https://sts.amazonaws.com/doc/2011-06-15/"},operations:{AssumeRole:{input:{type:"structure",required:["RoleArn","RoleSessionName"],members:{RoleArn:{},RoleSessionName:{},Policy:{},DurationSeconds:{type:"integer"},ExternalId:{},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"AssumeRoleResult",type:"structure",members:{Credentials:{shape:"Sa"},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"}}}},AssumeRoleWithSAML:{input:{type:"structure",required:["RoleArn","PrincipalArn","SAMLAssertion"],members:{RoleArn:{},PrincipalArn:{},SAMLAssertion:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithSAMLResult",type:"structure",members:{Credentials:{shape:"Sa"},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"},Subject:{},SubjectType:{},Issuer:{},Audience:{},NameQualifier:{}}}},AssumeRoleWithWebIdentity:{input:{type:"structure",required:["RoleArn","RoleSessionName","WebIdentityToken"],members:{RoleArn:{},RoleSessionName:{},WebIdentityToken:{},ProviderId:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"AssumeRoleWithWebIdentityResult",type:"structure",members:{Credentials:{shape:"Sa"},SubjectFromWebIdentityToken:{},AssumedRoleUser:{shape:"Sf"},PackedPolicySize:{type:"integer"},Provider:{},Audience:{}}}},DecodeAuthorizationMessage:{input:{type:"structure",required:["EncodedMessage"],members:{EncodedMessage:{}}},output:{resultWrapper:"DecodeAuthorizationMessageResult",type:"structure",members:{DecodedMessage:{}}}},GetCallerIdentity:{input:{type:"structure",members:{}},output:{resultWrapper:"GetCallerIdentityResult",type:"structure",members:{UserId:{},Account:{},Arn:{}}}},GetFederationToken:{input:{type:"structure",required:["Name"],members:{Name:{},Policy:{},DurationSeconds:{type:"integer"}}},output:{resultWrapper:"GetFederationTokenResult",type:"structure",members:{Credentials:{shape:"Sa"},FederatedUser:{type:"structure",required:["FederatedUserId","Arn"],members:{FederatedUserId:{},Arn:{}}},PackedPolicySize:{type:"integer"}}}},GetSessionToken:{input:{type:"structure",members:{DurationSeconds:{type:"integer"},SerialNumber:{},TokenCode:{}}},output:{resultWrapper:"GetSessionTokenResult",type:"structure",members:{Credentials:{shape:"Sa"}}}}},shapes:{Sa:{type:"structure",required:["AccessKeyId","SecretAccessKey","SessionToken","Expiration"],members:{AccessKeyId:{},SecretAccessKey:{},SessionToken:{},Expiration:{type:"timestamp"}}},Sf:{type:"structure",required:["AssumedRoleId","Arn"],members:{AssumedRoleId:{},Arn:{}}}},paginators:{}}}(window,document),define("aws_kinesis",function(){}),function(e,t,r,i){"use strict";function n(e,t,r){return setTimeout(u(e,r),t)}function o(e,t,r){return!!Array.isArray(e)&&(a(e,r[t],r),!0)}function a(e,t,r){var n;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==i)for(n=0;n<e.length;)t.call(r,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}function s(e,t,r){for(var n=Object.keys(t),o=0;o<n.length;)(!r||r&&e[n[o]]===i)&&(e[n[o]]=t[n[o]]),o++;return e}function l(e,t){return s(e,t,!0)}function d(e,t,r){var i,n=t.prototype;i=e.prototype=Object.create(n),i.constructor=e,i._super=n,r&&s(i,r)}function u(e,t){return function(){return e.apply(t,arguments)}}function c(e,t){return typeof e==ue?e.apply(t?t[0]||i:i,t):e}function h(e,t){return e===i?t:e}function p(e,t,r){a(m(t),function(t){e.addEventListener(t,r,!1)})}function f(e,t,r){a(m(t),function(t){e.removeEventListener(t,r,!1)})}function g(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function v(e,t){return e.indexOf(t)>-1}function m(e){return e.trim().split(/\s+/g)}function y(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var i=0;i<e.length;){if(r&&e[i][r]==t||!r&&e[i]===t)return i;i++}return-1}function _(e){return Array.prototype.slice.call(e,0)}function b(e,t,r){for(var i=[],n=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];y(n,a)<0&&i.push(e[o]),n[o]=a,o++}return r&&(i=t?i.sort(function(e,r){return e[t]>r[t]}):i.sort()),i}function E(e,t){for(var r,n,o=t[0].toUpperCase()+t.slice(1),a=0;a<le.length;){if(r=le[a],(n=r?r+o:t)in e)return n;a++}return i}function A(){return fe++}function S(e){var t=e.ownerDocument;return t.defaultView||t.parentWindow}function w(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){c(e.options.enable,[e])&&r.handler(t)},this.init()}function T(e){var t=e.options.inputClass;return new(t||(me?G:ye?q:ve?j:B))(e,L)}function L(e,t,r){var i=r.pointers.length,n=r.changedPointers.length,o=t&be&&i-n==0,a=t&(Ae|Se)&&i-n==0;r.isFirst=!!o,r.isFinal=!!a,o&&(e.session={}),r.eventType=t,I(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function I(e,t){var r=e.session,i=t.pointers,n=i.length;r.firstInput||(r.firstInput=M(t)),n>1&&!r.firstMultiple?r.firstMultiple=M(t):1===n&&(r.firstMultiple=!1);var o=r.firstInput,a=r.firstMultiple,s=a?a.center:o.center,l=t.center=R(i);t.timeStamp=pe(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=x(s,l),t.distance=D(s,l),C(r,t),t.offsetDirection=k(t.deltaX,t.deltaY),t.scale=a?U(a.pointers,i):1,t.rotation=a?N(a.pointers,i):0,P(r,t);var d=e.element;g(t.srcEvent.target,d)&&(d=t.srcEvent.target),t.target=d}function C(e,t){var r=t.center,i=e.offsetDelta||{},n=e.prevDelta||{},o=e.prevInput||{};t.eventType!==be&&o.eventType!==Ae||(n=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:r.x,y:r.y}),t.deltaX=n.x+(r.x-i.x),t.deltaY=n.y+(r.y-i.y)}function P(e,t){var r,n,o,a,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp;if(t.eventType!=Se&&(l>_e||s.velocity===i)){var d=s.deltaX-t.deltaX,u=s.deltaY-t.deltaY,c=O(l,d,u);n=c.x,o=c.y,r=he(c.x)>he(c.y)?c.x:c.y,a=k(d,u),e.lastInterval=t}else r=s.velocity,n=s.velocityX,o=s.velocityY,a=s.direction;t.velocity=r,t.velocityX=n,t.velocityY=o,t.direction=a}function M(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:ce(e.pointers[r].clientX),clientY:ce(e.pointers[r].clientY)},r++;return{timeStamp:pe(),pointers:t,center:R(t),deltaX:e.deltaX,deltaY:e.deltaY}}function R(e){var t=e.length;if(1===t)return{x:ce(e[0].clientX),y:ce(e[0].clientY)};for(var r=0,i=0,n=0;n<t;)r+=e[n].clientX,i+=e[n].clientY,n++;return{x:ce(r/t),y:ce(i/t)}}function O(e,t,r){return{x:t/e||0,y:r/e||0}}function k(e,t){return e===t?we:he(e)>=he(t)?e>0?Te:Le:t>0?Ie:Ce}function D(e,t,r){r||(r=Oe);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return Math.sqrt(i*i+n*n)}function x(e,t,r){r||(r=Oe);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return 180*Math.atan2(n,i)/Math.PI}function N(e,t){return x(t[1],t[0],ke)-x(e[1],e[0],ke)}function U(e,t){return D(t[0],t[1],ke)/D(e[0],e[1],ke)}function B(){this.evEl=xe,this.evWin=Ne,this.allow=!0,this.pressed=!1,w.apply(this,arguments)}function G(){this.evEl=Ge,this.evWin=Ve,w.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function V(){this.evTarget=qe,this.evWin=He,this.started=!1,w.apply(this,arguments)}function F(e,t){var r=_(e.touches),i=_(e.changedTouches);return t&(Ae|Se)&&(r=b(r.concat(i),"identifier",!0)),[r,i]}function q(){this.evTarget=ze,this.targetIds={},w.apply(this,arguments)}function H(e,t){var r=_(e.touches),i=this.targetIds;if(t&(be|Ee)&&1===r.length)return i[r[0].identifier]=!0,[r,r];var n,o,a=_(e.changedTouches),s=[],l=this.target;if(o=r.filter(function(e){return g(e.target,l)}),t===be)for(n=0;n<o.length;)i[o[n].identifier]=!0,n++;for(n=0;n<a.length;)i[a[n].identifier]&&s.push(a[n]),t&(Ae|Se)&&delete i[a[n].identifier],n++;return s.length?[b(o.concat(s),"identifier",!0),s]:void 0}function j(){w.apply(this,arguments);var e=u(this.handler,this);this.touch=new q(this.manager,e),this.mouse=new B(this.manager,e)}function z(e,t){this.manager=e,this.set(t)}function W(e){if(v(e,Qe))return Qe;var t=v(e,Ze),r=v(e,Je);return t&&r?Ze+" "+Je:t||r?t?Ze:Je:v(e,Xe)?Xe:Ke}function Y(e){this.id=A(),this.manager=null,this.options=l(e||{},this.defaults),this.options.enable=h(this.options.enable,!0),this.state=$e,this.simultaneous={},this.requireFail=[]}function K(e){return e&nt?"cancel":e&rt?"end":e&tt?"move":e&et?"start":""}function X(e){return e==Ce?"down":e==Ie?"up":e==Te?"left":e==Le?"right":""}function Q(e,t){var r=t.manager;return r?r.get(e):e}function Z(){Y.apply(this,arguments)}function J(){Z.apply(this,arguments),this.pX=null,this.pY=null}function $(){Z.apply(this,arguments)}function ee(){Y.apply(this,arguments),this._timer=null,this._input=null}function te(){Z.apply(this,arguments)}function re(){Z.apply(this,arguments)}function ie(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ne(e,t){return t=t||{},t.recognizers=h(t.recognizers,ne.defaults.preset),new oe(e,t)}function oe(e,t){t=t||{},this.options=l(t,ne.defaults),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=T(this),this.touchAction=new z(this,this.options.touchAction),ae(this,!0),a(t.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ae(e,t){var r=e.element;a(e.options.cssProps,function(e,i){r.style[E(r.style,i)]=t?e:""})}function se(e,r){var i=t.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=r,r.target.dispatchEvent(i)}var le=["","webkit","moz","MS","ms","o"],de=t.createElement("div"),ue="function",ce=Math.round,he=Math.abs,pe=Date.now,fe=1,ge=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in e,me=E(e,"PointerEvent")!==i,ye=ve&&ge.test(navigator.userAgent),_e=25,be=1,Ee=2,Ae=4,Se=8,we=1,Te=2,Le=4,Ie=8,Ce=16,Pe=Te|Le,Me=Ie|Ce,Re=Pe|Me,Oe=["x","y"],ke=["clientX","clientY"];w.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(S(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(S(this.element),this.evWin,this.domHandler)}};var De={mousedown:be,mousemove:Ee,mouseup:Ae},xe="mousedown",Ne="mousemove mouseup";d(B,w,{handler:function(e){var t=De[e.type];t&be&&0===e.button&&(this.pressed=!0),t&Ee&&1!==e.which&&(t=Ae),this.pressed&&this.allow&&(t&Ae&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var Ue={pointerdown:be,pointermove:Ee,pointerup:Ae,pointercancel:Se,pointerout:Se},Be={2:"touch",3:"pen",4:"mouse",5:"kinect"},Ge="pointerdown",Ve="pointermove pointerup pointercancel";e.MSPointerEvent&&(Ge="MSPointerDown",Ve="MSPointerMove MSPointerUp MSPointerCancel"),d(G,w,{handler:function(e){var t=this.store,r=!1,i=e.type.toLowerCase().replace("ms",""),n=Ue[i],o=Be[e.pointerType]||e.pointerType,a="touch"==o,s=y(t,e.pointerId,"pointerId");n&be&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):n&(Ae|Se)&&(r=!0),s<0||(t[s]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),r&&t.splice(s,1))}});var Fe={touchstart:be,touchmove:Ee,touchend:Ae,touchcancel:Se},qe="touchstart",He="touchstart touchmove touchend touchcancel";d(V,w,{handler:function(e){var t=Fe[e.type];if(t===be&&(this.started=!0),this.started){var r=F.call(this,e,t);t&(Ae|Se)&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}}});var je={touchstart:be,touchmove:Ee,touchend:Ae,touchcancel:Se},ze="touchstart touchmove touchend touchcancel";d(q,w,{handler:function(e){var t=je[e.type],r=H.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}}),d(j,w,{handler:function(e,t,r){var i="touch"==r.pointerType,n="mouse"==r.pointerType;if(i)this.mouse.allow=!1;else if(n&&!this.mouse.allow)return;t&(Ae|Se)&&(this.mouse.allow=!0),this.callback(e,t,r)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var We=E(de.style,"touchAction"),Ye=We!==i,Ke="auto",Xe="manipulation",Qe="none",Ze="pan-x",Je="pan-y";z.prototype={set:function(e){"compute"==e&&(e=this.compute()),Ye&&(this.manager.element.style[We]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return a(this.manager.recognizers,function(t){c(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),W(e.join(" "))},preventDefaults:function(e){if(!Ye){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,n=v(i,Qe),o=v(i,Je),a=v(i,Ze);return n||o&&r&Pe||a&&r&Me?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var $e=1,et=2,tt=4,rt=8,it=rt,nt=16;Y.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(o(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Q(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return o(e,"dropRecognizeWith",this)?this:(e=Q(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(o(e,"requireFailure",this))return this;var t=this.requireFail;return e=Q(e,this),-1===y(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(o(e,"dropRequireFailure",this))return this;e=Q(e,this);var t=y(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){r.manager.emit(r.options.event+(t?K(i):""),e)}var r=this,i=this.state;i<rt&&t(!0),t(),i>=rt&&t(!0)},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|$e)))return!1;e++}return!0},recognize:function(e){var t=s({},e);if(!c(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(it|nt|32)&&(this.state=$e),this.state=this.process(t),this.state&(et|tt|rt|nt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},d(Z,Y,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,i=t&(et|tt),n=this.attrTest(e);return i&&(r&Se||!n)?t|nt:i||n?r&Ae?t|rt:t&et?t|tt:et:32}}),d(J,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Re},getTouchAction:function(){var e=this.options.direction,t=[];return e&Pe&&t.push(Je),e&Me&&t.push(Ze),t},directionTest:function(e){var t=this.options,r=!0,i=e.distance,n=e.direction,o=e.deltaX,a=e.deltaY;return n&t.direction||(t.direction&Pe?(n=0===o?we:o<0?Te:Le,r=o!=this.pX,i=Math.abs(e.deltaX)):(n=0===a?we:a<0?Ie:Ce,r=a!=this.pY,i=Math.abs(e.deltaY))),e.direction=n,r&&i>t.threshold&&n&t.direction},attrTest:function(e){return Z.prototype.attrTest.call(this,e)&&(this.state&et||!(this.state&et)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=X(e.direction);t&&this.manager.emit(this.options.event+t,e),this._super.emit.call(this,e)}}),d($,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Qe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&et)},emit:function(e){if(this._super.emit.call(this,e),1!==e.scale){var t=e.scale<1?"in":"out";this.manager.emit(this.options.event+t,e)}}}),d(ee,Y,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Ke]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!i||!r||e.eventType&(Ae|Se)&&!o)this.reset();else if(e.eventType&be)this.reset(),this._timer=n(function(){this.state=it,this.tryEmit()},t.time,this);else if(e.eventType&Ae)return it;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===it&&(e&&e.eventType&Ae?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=pe(),this.manager.emit(this.options.event,this._input)))}}),d(te,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Qe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&et)}}),d(re,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Pe|Me,pointers:1},getTouchAction:function(){return J.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return r&(Pe|Me)?t=e.velocity:r&Pe?t=e.velocityX:r&Me&&(t=e.velocityY),this._super.attrTest.call(this,e)&&r&e.direction&&e.distance>this.options.threshold&&he(t)>this.options.velocity&&e.eventType&Ae},emit:function(e){var t=X(e.direction);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),d(ie,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Xe]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&be&&0===this.count)return this.failTimeout();if(i&&o&&r){if(e.eventType!=Ae)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||D(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=n(function(){this.state=it,this.tryEmit()},t.interval,this),et):it}return 32},failTimeout:function(){return this._timer=n(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==it&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ne.VERSION="2.0.4",ne.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[te,{enable:!1}],[$,{enable:!1},["rotate"]],[re,{direction:Pe}],[J,{direction:Pe},["swipe"]],[ie],[ie,{event:"doubletap",taps:2},["tap"]],[ee]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};oe.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var r,i=this.recognizers,n=t.curRecognizer;(!n||n&&n.state&it)&&(n=t.curRecognizer=null);for(var o=0;o<i.length;)r=i[o],2===t.stopped||n&&r!=n&&!r.canRecognizeWith(n)?r.reset():r.recognize(e),!n&&r.state&(et|tt|rt)&&(n=t.curRecognizer=r),o++}},get:function(e){if(e instanceof Y)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(o(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(o(e,"remove",this))return this;var t=this.recognizers;return e=this.get(e),t.splice(y(t,e),1),this.touchAction.update(),this},on:function(e,t){var r=this.handlers;return a(m(e),function(e){r[e]=r[e]||[],r[e].push(t)}),this},off:function(e,t){var r=this.handlers;return a(m(e),function(e){t?r[e].splice(y(r[e],t),1):delete r[e]}),this},emit:function(e,t){this.options.domEvents&&se(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](t),i++}},destroy:function(){this.element&&ae(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(ne,{INPUT_START:be,INPUT_MOVE:Ee,INPUT_END:Ae,INPUT_CANCEL:Se,STATE_POSSIBLE:$e,STATE_BEGAN:et,STATE_CHANGED:tt,STATE_ENDED:rt,STATE_RECOGNIZED:it,STATE_CANCELLED:nt,STATE_FAILED:32,DIRECTION_NONE:we,DIRECTION_LEFT:Te,DIRECTION_RIGHT:Le,DIRECTION_UP:Ie,DIRECTION_DOWN:Ce,DIRECTION_HORIZONTAL:Pe,DIRECTION_VERTICAL:Me,DIRECTION_ALL:Re,Manager:oe,Input:w,TouchAction:z,TouchInput:q,MouseInput:B,PointerEventInput:G,TouchMouseInput:j,SingleTouchInput:V,Recognizer:Y,AttrRecognizer:Z,Tap:ie,Pan:J,Swipe:re,Pinch:$,Rotate:te,Press:ee,on:p,off:f,each:a,merge:l,extend:s,inherit:d,bindFn:u,prefixed:E}),typeof define==ue&&define.amd?define("hammer",[],function(){return ne}):"undefined"!=typeof module&&module.exports?module.exports=ne:e.Hammer=ne}(window,document),function(){"use strict";var e=1;if(!Object.create)var t=function(){};var r=Array.prototype.slice,i={attributes:{},eventHandlers:{"-1":{}},guid:-1,addEvent:function(e){i.eventHandlers[e.guid][e.type]||(i.eventHandlers[e.guid][e.type]=[]),i.eventHandlers[e.guid][e.type].push({guid:e.guid,handler:e.handler,scope:e.scope,type:e.type,once:e.once})},addEventHandler:function(e,t,r,n){var o,a={};"string"==typeof e?(o=r||!1,a[e]=t):(o=t||!1,a=e);for(var s in a)for(var l=a[s],d=s.split(" "),u=0,c=d.length;u<c;u++){var h=d[u];i.addEvent.call(this,{guid:this._guid||this._.guid,handler:l,scope:o,type:h,once:n})}},addGuid:function(t,r){t._guid&&!r||(t._guid=e++,i.attributes[t._guid]={},i.eventHandlers[t._guid]={})},attr:function(e){return i.attributes[e]},clone:function(e){var t=i.typeOf(e);return"object"===t?i.extend({},e):"array"===t?e.slice(0):void 0},create:function(e){return Object.create?Object.create(e):(t.prototype=e,new t)},createSubclass:function(e,t){function r(){if(!(this instanceof r))throw new Error("Please use 'new' when initializing Stapes classes");this.on&&i.addGuid(this,!0),a.apply(this,arguments)}e=e||{},t=t||!1;var o=e.superclass.prototype,a=e.hasOwnProperty("constructor")?e.constructor:function(){};t&&i.extend(o,n),r.prototype=i.create(o),r.prototype.constructor=r,i.extend(r,{extend:function(){return i.extendThis.apply(this,arguments)},parent:o,proto:function(){return i.extendThis.apply(this.prototype,arguments)},subclass:function(e){return e=e||{},e.superclass=this,i.createSubclass(e)}});for(var s in e)"constructor"!==s&&"superclass"!==s&&(r.prototype[s]=e[s]);return r},emitEvents:function(e,t,n,o){n=n||!1,o=o||this._guid;for(var a=r.call(i.eventHandlers[o][e]),s=0,l=a.length;s<l;s++){var d=i.extend({},a[s]),u=d.scope?d.scope:this;n&&(d.type=n),d.scope=u,
d.handler.call(d.scope,t,d),d.once&&i.removeEventHandler.call(this,d.type,d.handler)}},extend:function(){for(var e=r.call(arguments),t=e.shift(),i=0,n=e.length;i<n;i++){var o=e[i];for(var a in o)t[a]=o[a]}return t},extendThis:function(){var e=r.call(arguments);return e.unshift(this),i.extend.apply(this,e)},makeUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},removeAttribute:function(e,t){t=t||!1;for(var r=i.trim(e).split(" "),n={},o=0,a=r.length;o<a;o++){var s=i.trim(r[o]);s&&(n.key=s,n.oldValue=i.attr(this._guid)[s],delete i.attr(this._guid)[s],t||(this.emit("change",s),this.emit("change:"+s),this.emit("mutate",n),this.emit("mutate:"+s,n),this.emit("remove",s),this.emit("remove:"+s)),delete n.oldValue)}},removeEventHandler:function(e,t){var r=i.eventHandlers[this._guid];if(e&&t){if(!(r=r[e]))return;for(var n,o=0,a=r.length;o<a;o++)(n=r[o].handler)&&n===t&&(r.splice(o--,1),a--)}else e?delete r[e]:i.eventHandlers[this._guid]={}},setAttribute:function(e,t,r){r=r||!1;var n=this.has(e),o=i.attr(this._guid)[e];if(t!==o&&(i.attr(this._guid)[e]=t,!r)){this.emit("change",e),this.emit("change:"+e,t);var a={key:e,newValue:t,oldValue:o||null};this.emit("mutate",a),this.emit("mutate:"+e,a);var s=n?"update":"create";this.emit(s,e),this.emit(s+":"+e,t)}},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},typeOf:function(e){return null===e||void 0===e?String(e):Object.prototype.toString.call(e).replace(/\[object |\]/g,"").toLowerCase()},updateAttribute:function(e,t,r){var n=this.get(e),o=i.typeOf(n);"object"!==o&&"array"!==o||(n=i.clone(n));var a=t.call(this,n,e);i.setAttribute.call(this,e,a,r||!1)}},n={emit:function(e,t){t=void 0===t?null:t;for(var r=e.split(" "),n=0,o=r.length;n<o;n++){var a=r[n];i.eventHandlers[-1].all&&i.emitEvents.call(this,"all",t,a,-1),i.eventHandlers[-1][a]&&i.emitEvents.call(this,a,t,a,-1),"number"==typeof this._guid&&(i.eventHandlers[this._guid].all&&i.emitEvents.call(this,"all",t,a),i.eventHandlers[this._guid][a]&&i.emitEvents.call(this,a,t))}},off:function(){i.removeEventHandler.apply(this,arguments)},on:function(){i.addEventHandler.apply(this,arguments)}};i.Module=function(){},i.Module.prototype={each:function(e,t){var r=i.attr(this._guid);for(var n in r){var o=r[n];e.call(t||this,o,n)}},extend:function(){return i.extendThis.apply(this,arguments)},filter:function(e){var t=[],r=i.attr(this._guid);for(var n in r)e.call(this,r[n],n)&&t.push(r[n]);return t},get:function(e){if("string"==typeof e){if(arguments.length>1){for(var t={},r=0,n=arguments.length;r<n;r++){var o=arguments[r];t[o]=this.get(o)}return t}return this.has(e)?i.attr(this._guid)[e]:null}if("function"==typeof e){var a=this.filter(e);return a.length?a[0]:null}},getAll:function(){return i.clone(i.attr(this._guid))},getAllAsArray:function(){var e=[],t=i.attr(this._guid);for(var r in t){var n=t[r];"object"!==i.typeOf(n)||n.id||(n.id=r),e.push(n)}return e},has:function(e){return void 0!==i.attr(this._guid)[e]},map:function(e,t){var r=[];return this.each(function(i,n){r.push(e.call(t||this,i,n))},t||this),r},push:function(e,t){if("array"===i.typeOf(e))for(var r=0,n=e.length;r<n;r++)i.setAttribute.call(this,i.makeUuid(),e[r],t||!1);else i.setAttribute.call(this,i.makeUuid(),e,t||!1);return this},remove:function(e,t){return void 0===e?(i.attributes[this._guid]={},this.emit("change remove")):"function"==typeof e?this.each(function(r,n){e(r)&&i.removeAttribute.call(this,n,t)}):i.removeAttribute.call(this,e,t||!1),this},set:function(e,t,r){if("object"==typeof e)for(var n in e)i.setAttribute.call(this,n,e[n],t||!1);else i.setAttribute.call(this,e,t,r||!1);return this},size:function(){var e=0,t=i.attr(this._guid);for(var r in t)e++;return e},update:function(e,t,r){return"string"==typeof e?i.updateAttribute.call(this,e,t,r||!1):"function"==typeof e&&this.each(function(t,r){i.updateAttribute.call(this,r,e)}),this}};var o={_:i,extend:function(){return i.extendThis.apply(i.Module.prototype,arguments)},mixinEvents:function(e){return e=e||{},i.addGuid(e),i.extend(e,n)},on:function(){i.addEventHandler.apply(this,arguments)},subclass:function(e,t){return t=t||!1,e=e||{},e.superclass=t?function(){}:i.Module,i.createSubclass(e,!t)},version:"0.8.1"};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.Stapes=o):"function"==typeof define&&define.amd?define("stapes",[],function(){return o}):window.Stapes=o}(),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("hls_lib",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Hls=e()}}(function(){return function e(t,r,i){function n(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return n(r||e)},u,u.exports,e,t,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(e,t,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,r,i,o,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(a(r))for(o=Array.prototype.slice.call(arguments,1),d=r.slice(),i=d.length,l=0;l<i;l++)d[l].apply(this,o);return!0},i.prototype.addListener=function(e,t){var r;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},i.prototype.removeListener=function(e,t){var r,i,o,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){var i=arguments[3],n=arguments[4],o=arguments[5],a=JSON.stringify;t.exports=function(e){for(var t,r=Object.keys(o),s=0,l=r.length;s<l;s++){var d=r[s],u=o[d].exports;if(u===e||u.default===e){t=d;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var c={},s=0,l=r.length;s<l;s++){var d=r[s];c[d]=d}n[t]=[Function(["require","module","exports"],"("+e+")(self)"),c]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[t]=t,n[h]=[Function(["require"],"var f = require("+a(t)+");(f.default ? f.default : f)(self);"),p];var f="("+i+")({"+Object.keys(n).map(function(e){return a(e)+":["+n[e][0]+","+a(n[e][1])+"]"}).join(",")+"},{},["+a(h)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(g.createObjectURL(new Blob([f],{type:"text/javascript"})))}},{}],3:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../helper/buffer-helper"),p=i(h),f=e("../errors"),g=e("../utils/logger"),v=e("./ewma-bandwidth-estimator"),m=i(v),y=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,d.default.FRAG_LOADING,d.default.FRAG_LOADED,d.default.ERROR));return r.lastLoadedFragLevel=0,r._autoLevelCapping=-1,r._nextAutoLevel=-1,r.hls=e,r.onCheck=r.abandonRulesCheck.bind(r),r}return a(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),c.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var t=this.hls,r=e.frag.level,i=t.levels[r].details.live,n=t.config,o=void 0,a=void 0;i?(o=n.abrEwmaFastLive,a=n.abrEwmaSlowLive):(o=n.abrEwmaFastVoD,a=n.abrEwmaSlowVoD),this.bwEstimator=new m.default(t,a,o)}var s=e.frag;s.trequest=performance.now(),this.fragCurrent=s}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(!r.loader||r.loader.stats&&r.loader.stats.aborted)return g.logger.warn("frag loader destroy or aborted, disarm abandonRulesCheck"),void this.clearTimer();if(t&&(!t.paused||!t.readyState)&&r.autoLevel&&r.level){var i=performance.now()-r.trequest;if(i>500*r.duration){var n=e.levels,o=Math.max(1,1e3*r.loaded/i),a=Math.max(r.loaded,Math.round(r.duration*n[r.level].bitrate/8)),s=t.currentTime,l=(a-r.loaded)/o,u=p.default.bufferInfo(t,s,e.config.maxBufferHole).end-s;if(u<2*r.duration&&l>u){var c=void 0,h=void 0;for(h=r.level-1;h>=0&&(c=r.duration*n[h].bitrate/(6.4*o),g.logger.log("fragLoadedDelay/bufferStarvationDelay/fragLevelNextLoadedDelay["+h+"] :"+l.toFixed(1)+"/"+u.toFixed(1)+"/"+c.toFixed(1)),!(c<u));h--);c<l&&(h=Math.max(0,h),e.nextLoadLevel=h,this.bwEstimator.sample(i,r.loaded),g.logger.warn("loading too slow, abort fragment loading and switch to level "+h),r.loader.abort(),this.clearTimer(),e.trigger(d.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.stats;void 0===t.aborted&&1===e.frag.loadCounter&&this.bwEstimator.sample(performance.now()-t.trequest,t.loaded),this.clearTimer(),this.lastLoadedFragLevel=e.frag.level,this._nextAutoLevel=-1}},{key:"onError",value:function(e){switch(e.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e,t,r=this.hls,i=r.levels,n=r.config;if(t=-1===this._autoLevelCapping&&i&&i.length?i.length-1:this._autoLevelCapping,-1!==this._nextAutoLevel)return Math.min(this._nextAutoLevel,t);var o=this.bwEstimator.getEstimate();for(e=0;e<=t;e++)if((e<=this.lastLoadedFragLevel?n.abrBandWidthFactor*o:n.abrBandWidthUpFactor*o)<i[e].bitrate)return Math.max(0,e-1);return e-1},set:function(e){this._nextAutoLevel=e}}]),t}(c.default);r.default=y},{"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":24,"../utils/logger":38,"./ewma-bandwidth-estimator":6}],4:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../utils/logger"),p=e("../errors"),f=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.BUFFER_RESET,d.default.BUFFER_APPENDING,d.default.BUFFER_CODECS,d.default.BUFFER_EOS,d.default.BUFFER_FLUSHING,d.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r}return a(t,e),s(t,[{key:"destroy",value:function(){c.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){h.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc);try{this.media.src="",this.media.removeAttribute("src")}catch(e){h.logger.warn("onMediaDetaching:"+e.message+" while unlinking video.src")}this.mediaSource=null,this.media=null,this.pendingTracks=null,this.sourceBuffer=null}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(d.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){h.logger.log("media source opened"),this.hls.trigger(d.default.MEDIA_ATTACHED,{media:this.media}),this.mediaSource.removeEventListener("sourceopen",this.onmso);var e=this.pendingTracks;e&&(this.onBufferCodecs(e),this.pendingTracks=null,this.doAppending())}},{key:"onMediaSourceClose",value:function(){h.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){h.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){this._needsFlush&&this.doFlush(),this._needsEos&&this.onBufferEos(),this.hls.trigger(d.default.BUFFER_APPENDED),this.doAppending()}},{key:"onSBUpdateError",value:function(e){h.logger.error("sourceBuffer error:"+e),this.hls.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;if(e){for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer=null}this.flushRange=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){var t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this.pendingTracks=e);if(!this.sourceBuffer){var r={};for(var i in e){var n=e[i],o=n.levelCodec||n.codec,a=n.container+";codecs="+o;h.logger.log("creating sourceBuffer with mimeType:"+a);var s=r[i]=t.addSourceBuffer(a);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe)}this.sourceBuffer=r}}},{key:"onBufferAppending",value:function(e){this.segments?this.segments.push(e):this.segments=[e],this.doAppending()}},{key:"onBufferAppendFail",value:function(e){h.logger.error("sourceBuffer error:"+e.event),this.hls.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;t&&"open"===t.readyState&&(e.audio&&e.audio.updating||e.video&&e.video.updating?this._needsEos=!0:(h.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment"),t.endOfStream(),this._needsEos=!1))}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){if(null!==this._levelDuration){var e=this.media,t=this.mediaSource;if(e&&t&&0!==e.readyState&&"open"===t.readyState){for(var r in t.sourceBuffers)if(t.sourceBuffers[r].updating)return;null===this._msDuration&&(this._msDuration=t.duration),this._levelDuration>this._msDuration&&(h.logger.log("Updating mediasource duration to "+this._levelDuration),t.duration=this._levelDuration,this._msDuration=this._levelDuration)}}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;if(r)for(var i in r)t+=r[i].buffered.length;this.appended=t,this.hls.trigger(d.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(t){if(this.media.error)return r=[],void h.logger.error("trying to append although a media error occured, flush segment and abort");for(var i in t)if(t[i].updating)return;if(r.length){var n=r.shift();try{t[n.type].appendBuffer(n.data),this.appendError=0,this.appended++}catch(t){h.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var o={type:p.ErrorTypes.MEDIA_ERROR};if(22===t.code)return this.segments=[],o.details=p.ErrorDetails.BUFFER_FULL_ERROR,void e.trigger(d.default.ERROR,o);if(this.appendError?this.appendError++:this.appendError=1,o.details=p.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return h.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],o.fatal=!0,void e.trigger(d.default.ERROR,o);o.fatal=!1,e.trigger(d.default.ERROR,o)}}}}},{key:"flushBuffer",value:function(e,t){var r,i,n,o,a,s;if(this.flushBufferCounter<this.appended&&this.sourceBuffer)for(var l in this.sourceBuffer){if(r=this.sourceBuffer[l],r.updating)return h.logger.warn("cannot flush, sb updating in progress"),!1;for(i=0;i<r.buffered.length;i++)if(n=r.buffered.start(i),o=r.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(a=e,s=t):(a=Math.max(n,e),s=Math.min(o,t)),Math.min(s,o)-a>.5)return this.flushBufferCounter++,h.logger.log("flush "+l+" ["+a+","+s+"], of ["+n+","+o+"], pos:"+this.media.currentTime),r.remove(a,s),!1}else h.logger.warn("abort flushing too many retries");return h.logger.log("buffer flushed"),!0}}]),t}(c.default);r.default=f},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":38}],5:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=function(e){function t(e){return n(this,t),o(this,Object.getPrototypeOf(t).call(this,e,d.default.MEDIA_ATTACHING,d.default.MANIFEST_PARSED))}return a(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){this.hls.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,this.hls.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;e&&(this.hls.autoLevelCapping=this.getMaxLevel(e-1),this.hls.autoLevelCapping>this.autoLevelCapping&&this.hls.streamController.nextLevelSwitch(),this.autoLevelCapping=this.hls.autoLevelCapping)}}},{key:"getMaxLevel",value:function(e){var t=void 0,r=void 0,i=void 0,n=this.mediaWidth,o=this.mediaHeight,a=0,s=0;for(r=0;r<=e&&(i=this.levels[r],t=r,a=i.width,s=i.height,!(n<=a||o<=s));r++);return t}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}},{key:"mediaWidth",get:function(){var e=void 0;return this.media&&(e=this.media.width||this.media.clientWidth||this.media.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0;return this.media&&(e=this.media.height||this.media.clientHeight||this.media.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(c.default);r.default=h},{"../event-handler":22,"../events":23}],6:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/ewma"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,r,n){i(this,e),this.hls=t,this.defaultEstimate_=5e5,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new a.default(r),this.fast_=new a.default(n)}return n(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var r=8e3*t/e,i=e/1e3;this.fast_.sample(i,r),this.slow_.sample(i,r)}},{key:"getEstimate",value:function(){return!this.fast_||this.fast_.getTotalWeight()<this.minWeight_?this.defaultEstimate_:Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}},{key:"destroy",value:function(){}}]),e}();r.default=s},{"../utils/ewma":37}],7:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../utils/logger"),p=e("../errors"),f=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,d.default.MANIFEST_LOADED,d.default.LEVEL_LOADED,d.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=r._autoLevelCapping=-1,r}return a(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0,this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r,i=[],n=[],o={},a=!1,s=!1,l=this.hls;if(e.levels.forEach(function(e){e.videoCodec&&(a=!0),e.audioCodec&&(s=!0);var t=o[e.bitrate];void 0===t?(o[e.bitrate]=i.length,e.url=[e.url],e.urlId=0,i.push(e)):i[t].url.push(e.url)}),a&&s?i.forEach(function(e){e.videoCodec&&n.push(e)}):n=i,n=n.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||function(e){return MediaSource.isTypeSupported("audio/mp4;codecs="+e)}(t))&&(!r||function(e){return MediaSource.isTypeSupported("video/mp4;codecs="+e)}(r))}),n.length){for(t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n,r=0;r<n.length;r++)if(n[r].bitrate===t){this._firstLevel=r,h.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}l.trigger(d.default.MANIFEST_PARSED,{levels:this._levels,firstLevel:this._firstLevel,stats:e.stats})}else l.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:l.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level=e,h.logger.log("switching to level "+e),this.hls.trigger(d.default.LEVEL_SWITCH,{level:e});var r=t[e];if(void 0===r.details||!0===r.details.live){h.logger.log("(re)loading playlist for level "+e);var i=r.urlId;this.hls.trigger(d.default.LEVEL_LOADING,{url:r.url[i],level:e,id:i})}}else this.hls.trigger(d.default.ERROR,{type:p.ErrorTypes.OTHER_ERROR,details:p.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,r=this.hls,i=void 0,n=void 0,o=!1;switch(t){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:i=e.frag.level;break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:i=e.level,o=!0}if(void 0!==i)if(n=this._levels[i],n.urlId<n.url.length-1)n.urlId++,n.details=void 0,h.logger.warn("level controller,"+t+" for level "+i+": switching to redundant stream id "+n.urlId);else{var a=-1===this._manualLevel&&i;a?(h.logger.warn("level controller,"+t+": emergency switch-down for next fragment"),r.abrController.nextAutoLevel=0):n&&n.details&&n.details.live?(h.logger.warn("level controller,"+t+" on live stream, discard"),o&&(this._level=void 0)):t!==p.ErrorDetails.FRAG_LOAD_ERROR&&t!==p.ErrorDetails.FRAG_LOAD_TIMEOUT&&(h.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,r.trigger(d.default.ERROR,e))}}}},{key:"onLevelLoaded",value:function(e){if(e.level===this._level){var t=e.details;if(t.live){var r=1e3*t.targetduration,i=this._levels[e.level],n=i.details;n&&t.endSN===n.endSN&&(r/=2,h.logger.log("same live playlist, reload twice faster")),r-=performance.now()-e.stats.trequest,r=Math.max(1e3,Math.round(r)),h.logger.log("live playlist, reload in "+r+" ms"),this.timer=setTimeout(this.ontick,r)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],r=t.urlId;this.hls.trigger(d.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){return void 0===this._startLevel?this._firstLevel:this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(c.default);r.default=f},{"../errors":21,"../event-handler":22,"../events":23,"../utils/logger":38}],8:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}
Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../demux/demuxer"),d=i(l),u=e("../events"),c=i(u),h=e("../event-handler"),p=i(h),f=e("../utils/logger"),g=e("../utils/binary-search"),v=i(g),m=e("../helper/buffer-helper"),y=i(m),_=e("../helper/level-helper"),b=i(_),E=e("../errors"),A={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR"},S=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,c.default.MEDIA_ATTACHED,c.default.MEDIA_DETACHING,c.default.MANIFEST_LOADING,c.default.MANIFEST_PARSED,c.default.LEVEL_LOADED,c.default.KEY_LOADED,c.default.FRAG_LOADED,c.default.FRAG_LOAD_EMERGENCY_ABORTED,c.default.FRAG_PARSING_INIT_SEGMENT,c.default.FRAG_PARSING_DATA,c.default.FRAG_PARSED,c.default.ERROR,c.default.BUFFER_APPENDED,c.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r.ontick=r.tick.bind(r),r}return a(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),p.default.prototype.destroy.call(this),this.state=A.STOPPED}},{key:"startLoad",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];if(this.levels){var t=this.media,r=this.lastCurrentTime;this.stopLoad(),this.demuxer=new d.default(this.hls),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,t&&r?(f.logger.log("configure startPosition @"+r),this.lastPaused||(f.logger.log("resuming video"),t.play()),this.state=A.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=A.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else f.logger.warn("cannot start loading as manifest not parsed yet"),this.state=A.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.STOPPED}},{key:"tick",value:function(){1===++this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,r,i=this.hls,n=i.config,o=this.media,a=o&&o.seeking;switch(this.state){case A.ERROR:case A.PAUSED:break;case A.STARTING:var s=i.startLevel;-1===s&&(s=0,this.fragBitrateTest=!0),this.level=i.nextLoadLevel=s,this.state=A.WAITING_LEVEL,this.loadedmetadata=!1;break;case A.IDLE:if(!o&&(this.startFragRequested||!n.startFragPrefetch))break;e=this.loadedmetadata?o.currentTime:this.nextLoadPosition,t=i.nextLoadLevel;var l,d=y.default.bufferInfo(o,e,n.maxBufferHole),u=d.len,h=d.end,p=this.fragPrevious;if(this.levels[t].hasOwnProperty("bitrate")?(l=Math.max(8*n.maxBufferSize/this.levels[t].bitrate,n.maxBufferLength),l=Math.min(l,n.maxMaxBufferLength)):l=n.maxBufferLength,u<l){if(i.nextLoadLevel=t,this.level=t,void 0===(r=this.levels[t].details)||r.live&&this.levelLastLoaded!==t){this.state=A.WAITING_LEVEL;break}var g=r.fragments,m=g.length,_=g[0].start,b=g[m-1].start+g[m-1].duration,S=void 0;if(r.live){var w=void 0!==n.liveMaxLatencyDuration?n.liveMaxLatencyDuration:n.liveMaxLatencyDurationCount*r.targetduration;if(h<Math.max(_,b-w)){var T=void 0!==n.liveSyncDuration?n.liveSyncDuration:n.liveSyncDurationCount*r.targetduration,L=_+Math.max(0,r.totalduration-T);f.logger.log("buffer end: "+h+" is located too far from the end of live sliding playlist, reset currentTime to : "+L.toFixed(3)),h=L,o&&o.readyState&&o.duration>L&&(o.currentTime=L)}if(r.PTSKnown&&h>b)break;if(this.startFragRequested&&!r.PTSKnown){if(p){var I=p.sn+1;I>=r.startSN&&I<=r.endSN&&(S=g[I-r.startSN],f.logger.log("live playlist, switching playlist, load frag with next SN: "+S.sn))}S||(S=g[Math.min(m-1,Math.round(m/2))],f.logger.log("live playlist, switching playlist, unknown, load middle frag : "+S.sn))}}else h<_&&(S=g[0]);if(S||function(){var e=n.maxFragLookUpTolerance;h<b?((h>b-e||a)&&(e=0),S=v.default.search(g,function(t){return t.start+t.duration-e<=h?1:t.start-e>h?-1:0})):S=g[m-1]}(),S){if(_=S.start,p&&S.level===p.level&&S.sn===p.sn){if(!(S.sn<r.endSN)){r.live||(this.hls.trigger(c.default.BUFFER_EOS),a||(this.state=A.ENDED));break}var C=p.deltaPTS,P=S.sn-r.startSN;C&&C>n.maxBufferHole?(S=g[P-1],f.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),p.loadCounter--):(S=g[P+1],f.logger.log("SN just loaded, load next one: "+S.sn))}if(null!=S.decryptdata.uri&&null==S.decryptdata.key)f.logger.log("Loading key for "+S.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t),this.state=A.KEY_LOADING,i.trigger(c.default.KEY_LOADING,{frag:S});else{if(f.logger.log("Loading "+S.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t+", currentTime:"+e+",bufferEnd:"+h.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,S.loadCounter){S.loadCounter++;var M=n.fragLoadingLoopThreshold;if(S.loadCounter>M&&Math.abs(this.fragLoadIdx-S.loadIdx)<M)return void i.trigger(c.default.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:S})}else S.loadCounter=1;S.loadIdx=this.fragLoadIdx,this.fragCurrent=S,this.startFragRequested=!0,S.autoLevel=i.autoLevelEnabled,i.trigger(c.default.FRAG_LOADING,{frag:S}),this.state=A.FRAG_LOADING}}}break;case A.WAITING_LEVEL:t=this.levels[this.level],t&&t.details&&(this.state=A.IDLE);break;case A.FRAG_LOADING_WAITING_RETRY:var R=performance.now(),O=this.retryDate;(!O||R>=O||a)&&(f.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=A.IDLE)}this._checkBuffer(),this._checkFragmentChanged()}},{key:"getBufferRange",value:function(e){var t,r,i=this.bufferRange;if(i)for(t=i.length-1;t>=0;t--)if(r=i[t],e>=r.start&&e<=r.end)return r;return null}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"isBuffered",value:function(e){var t=this.media;if(t)for(var r=t.buffered,i=0;i<r.length;i++)if(e>=r.start(i)&&e<=r.end(i))return!0;return!1}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&!1===r.seeking&&(t=r.currentTime,t>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),this.isBuffered(t)?e=this.getBufferRange(t):this.isBuffered(t+.1)&&(e=this.getBufferRange(t+.1)),e)){var i=e.frag;i!==this.fragPlaying&&(this.fragPlaying=i,this.hls.trigger(c.default.FRAG_CHANGED,{frag:i}))}}},{key:"immediateLevelSwitch",value:function(){f.logger.log("immediateLevelSwitch"),this.immediateSwitch||(this.immediateSwitch=!0,this.previouslyPaused=this.media.paused,this.media.pause());var e=this.fragCurrent;e&&e.loader&&e.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.PAUSED,this.hls.trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})}},{key:"immediateLevelSwitchEnd",value:function(){this.immediateSwitch=!1;var e=this.media;e&&e.readyState&&(e.currentTime-=1e-4,this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,r=void 0,i=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,r=this.getBufferRange(e.currentTime),r&&r.start>1&&(this.state=A.PAUSED,this.hls.trigger(c.default.BUFFER_FLUSHING,{startOffset:0,endOffset:r.start-1})),e.paused)t=0;else{var n=this.hls.nextLoadLevel,o=this.levels[n],a=this.fragLastKbps;t=a&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*a)+1:0}if((i=this.getBufferRange(e.currentTime+t))&&(i=this.followingBufferRange(i))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.state=A.PAUSED,this.hls.trigger(c.default.BUFFER_FLUSHING,{startOffset:i.start,endOffset:Number.POSITIVE_INFINITY})}}}},{key:"onMediaAttached",value:function(e){var t=this.media=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended),this.levels&&this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(f.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){if(this.state===A.FRAG_LOADING){if(0===y.default.bufferInfo(this.media,this.media.currentTime,this.config.maxBufferHole).len){f.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load");var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.state=A.IDLE}}else this.state===A.ENDED&&(this.state=A.IDLE);this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaSeeked",value:function(){this.tick()}},{key:"onMediaEnded",value:function(){f.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){f.logger.log("trigger BUFFER_RESET"),this.hls.trigger(c.default.BUFFER_RESET),this.bufferRange=[],this.stalled=!1}},{key:"onManifestParsed",value:function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&f.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1,this.config.autoStartLoad&&this.hls.startLoad()}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,i=this.levels[r],n=t.totalduration,o=0;if(f.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),this.levelLastLoaded=r,t.live){var a=i.details;a?(b.default.mergeDetails(a,t),o=t.fragments[0].start,t.PTSKnown?f.logger.log("live playlist sliding:"+o.toFixed(3)):f.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,f.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(i.details=t,this.hls.trigger(c.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(t.live){var s=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;this.startPosition=Math.max(0,o+n-s)}this.nextLoadPosition=this.startPosition}this.state===A.WAITING_LEVEL&&(this.state=A.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===A.KEY_LOADING&&(this.state=A.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===A.FRAG_LOADING&&t&&e.frag.level===t.level&&e.frag.sn===t.sn)if(f.logger.log("Loaded  "+t.sn+" of level "+t.level),!0===this.fragBitrateTest)this.state=A.IDLE,this.fragBitrateTest=!1,this.startFragRequested=!1,e.stats.tparsed=e.stats.tbuffered=performance.now(),this.hls.trigger(c.default.FRAG_BUFFERED,{stats:e.stats,frag:t});else{this.state=A.PARSING,this.stats=e.stats;var r=this.levels[this.level],i=r.details,n=i.totalduration,o=void 0!==t.startDTS?t.startDTS:t.start,a=t.level,s=t.sn,l=r.audioCodec||this.config.defaultAudioCodec;this.audioCodecSwap&&(f.logger.log("swapping playlist audio codec"),void 0===l&&(l=this.lastAudioCodec),l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingAppending=0,f.logger.log("Demuxing "+s+" of ["+i.startSN+" ,"+i.endSN+"],level "+a);var d=this.demuxer;d&&d.push(e.payload,l,r.videoCodec,o,t.cc,a,s,n,t.decryptdata)}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){if(this.state===A.PARSING){var t,r,i=e.tracks;if(r=i.audio){var n=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();n&&this.audioCodecSwap&&(f.logger.log("swapping playlist audio codec"),n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===o.indexOf("firefox")&&(n="mp4a.40.5"),-1!==o.indexOf("android")&&(n="mp4a.40.2",f.logger.log("Android: force audio codec to"+n)),r.levelCodec=n}if(r=i.video,r&&(r.levelCodec=this.levels[this.level].videoCodec),e.unique){var a={codec:"",levelCodec:""};for(t in e.tracks)r=i[t],a.container=r.container,a.codec&&(a.codec+=",",a.levelCodec+=","),r.codec&&(a.codec+=r.codec),r.levelCodec&&(a.levelCodec+=r.levelCodec);i={audiovideo:a}}this.hls.trigger(c.default.BUFFER_CODECS,i);for(t in i){r=i[t],f.logger.log("track:"+t+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var s=r.initSegment;s&&(this.pendingAppending++,this.hls.trigger(c.default.BUFFER_APPENDING,{type:t,data:s}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this;if(this.state===A.PARSING){this.tparse2=Date.now();var r=this.levels[this.level],i=this.fragCurrent;f.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb);var n=b.default.updateFragPTSDTS(r.details,i.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),o=this.hls;o.trigger(c.default.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:n}),[e.data1,e.data2].forEach(function(r){r&&(t.pendingAppending++,o.trigger(c.default.BUFFER_APPENDING,{type:e.type,data:r}))}),this.nextLoadPosition=e.endPTS,this.bufferRange.push({type:e.type,start:e.startPTS,end:e.endPTS,frag:i}),this.tick()}else f.logger.warn("not in PARSING state but "+this.state+", ignoring FRAG_PARSING_DATA event")}},{key:"onFragParsed",value:function(){this.state===A.PARSING&&(this.stats.tparsed=performance.now(),this.state=A.PARSED,this._checkAppendedParsed())}},{key:"onBufferAppended",value:function(){switch(this.state){case A.PARSING:case A.PARSED:this.pendingAppending--,this._checkAppendedParsed()}}},{key:"_checkAppendedParsed",value:function(){if(this.state===A.PARSED&&0===this.pendingAppending){var e=this.fragCurrent,t=this.stats;e&&(this.fragPrevious=e,t.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*t.length/(t.tbuffered-t.tfirst)),this.hls.trigger(c.default.FRAG_BUFFERED,{stats:t,frag:e}),f.logger.log("media buffered : "+this.timeRangesToString(this.media.buffered)),this.state=A.IDLE),this.tick()}}},{key:"onError",value:function(e){switch(e.details){case E.ErrorDetails.FRAG_LOAD_ERROR:case E.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var t=this.fragLoadError;if(t?t++:t=1,t<=this.config.fragLoadingMaxRetry){this.fragLoadError=t,e.frag.loadCounter=0;var r=Math.min(Math.pow(2,t-1)*this.config.fragLoadingRetryDelay,64e3);f.logger.warn("mediaController: frag loading failed, retry in "+r+" ms"),this.retryDate=performance.now()+r,this.state=A.FRAG_LOADING_WAITING_RETRY}else f.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(c.default.ERROR,e),this.state=A.ERROR}break;case E.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case E.ErrorDetails.LEVEL_LOAD_ERROR:case E.ErrorDetails.LEVEL_LOAD_TIMEOUT:case E.ErrorDetails.KEY_LOAD_ERROR:case E.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==A.ERROR&&(this.state=e.fatal?A.ERROR:A.IDLE,f.logger.warn("mediaController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case E.ErrorDetails.BUFFER_FULL_ERROR:this.state!==A.PARSING&&this.state!==A.PARSED||(this.config.maxMaxBufferLength/=2,f.logger.warn("reduce max buffer length to "+this.config.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.IDLE)}}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,r=e.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;var i=this.startPosition;if(!t&&t!==i&&i){f.logger.log("target start position:"+i);var n=r.start(0),o=r.end(0);(i<n||i>o)&&(i=n,f.logger.log("target start position not buffered, seek to buffered.start(0) "+n)),f.logger.log("adjust currentTime from "+t+" to "+i),e.currentTime=i}}else{var a=y.default.bufferInfo(e,t,0),s=!(e.paused||e.ended||0===e.buffered.length),l=.4,d=t>e.playbackRate*this.lastCurrentTime;if(this.stalled&&d&&(this.stalled=!1,f.logger.log("playback not stuck anymore @"+t)),s&&a.len<=l&&(d?(l=0,this.seekHoleNudgeDuration=0):this.stalled?this.seekHoleNudgeDuration+=this.config.seekHoleNudgeDuration:(this.seekHoleNudgeDuration=0,f.logger.log("playback seems stuck @"+t),this.hls.trigger(c.default.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1}),this.stalled=!0),a.len<=l)){var u=a.nextStart,h=u-t;if(u&&h<this.config.maxSeekHole&&h>0){f.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+u+" + nudge "+this.seekHoleNudgeDuration);var p=u+this.seekHoleNudgeDuration-e.currentTime;e.currentTime=u+this.seekHoleNudgeDuration,this.hls.trigger(c.default.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:p})}}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=A.IDLE,this.tick()}},{key:"onBufferFlushed",value:function(){var e,t,r=[];for(t=0;t<this.bufferRange.length;t++)e=this.bufferRange[t],this.isBuffered((e.start+e.end)/2)&&r.push(e);this.bufferRange=r,this.immediateSwitch&&this.immediateLevelSwitchEnd(),this.state=A.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"timeRangesToString",value:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i)+","+e.end(i)+"]";return t}},{key:"currentLevel",get:function(){if(this.media){var e=this.getBufferRange(this.media.currentTime);if(e)return e.frag.level}return-1}},{key:"nextBufferRange",get:function(){return this.media?this.followingBufferRange(this.getBufferRange(this.media.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}}]),t}(p.default);r.default=S},{"../demux/demuxer":17,"../errors":21,"../event-handler":22,"../events":23,"../helper/buffer-helper":24,"../helper/level-helper":25,"../utils/binary-search":35,"../utils/logger":38}],9:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../utils/cea-708-interpreter"),p=i(h),f=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,d.default.MEDIA_ATTACHING,d.default.MEDIA_DETACHING,d.default.FRAG_PARSING_USERDATA,d.default.MANIFEST_LOADING,d.default.FRAG_LOADED));return r.hls=e,r.config=e.config,r.config.enableCEA708Captions&&(r.cea708Interpreter=new p.default),r}return a(t,e),s(t,[{key:"destroy",value:function(){c.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;this.cea708Interpreter.attach(t)}},{key:"onMediaDetaching",value:function(){this.cea708Interpreter.detach()}},{key:"onManifestLoading",value:function(){this.lastPts=Number.POSITIVE_INFINITY}},{key:"onFragLoaded",value:function(e){var t=e.frag.start;t<=this.lastPts&&this.cea708Interpreter.clear(),this.lastPts=t}},{key:"onFragParsingUserdata",value:function(e){for(var t=0;t<e.samples.length;t++)this.cea708Interpreter.push(e.samples[t].pts,e.samples[t].bytes)}}]),t}(c.default);r.default=f},{"../event-handler":22,"../events":23,"../utils/cea-708-interpreter":36}],10:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],this._precompute();var r,n,o,a,s,l=this._tables[0][4],d=this._tables[1],u=t.length,c=1;if(4!==u&&6!==u&&8!==u)throw new Error("Invalid aes key size="+u);for(a=t.slice(0),s=[],this._key=[a,s],r=u;r<4*u+28;r++)o=a[r-1],(r%u==0||8===u&&r%u==4)&&(o=l[o>>>24]<<24^l[o>>16&255]<<16^l[o>>8&255]<<8^l[255&o],r%u==0&&(o=o<<8^o>>>24^c<<24,c=c<<1^283*(c>>7))),a[r]=a[r-u]^o;for(n=0;r;n++,r--)o=a[3&n?r:r-4],s[n]=r<=4||n<4?o:d[0][l[o>>>24]]^d[1][l[o>>16&255]]^d[2][l[o>>8&255]]^d[3][l[255&o]]}return n(e,[{key:"_precompute",value:function(){var e,t,r,i,n,o,a,s,l,d=this._tables[0],u=this._tables[1],c=d[4],h=u[4],p=[],f=[];for(e=0;e<256;e++)f[(p[e]=e<<1^283*(e>>7))^e]=e;for(t=r=0;!c[t];t^=i||1,r=f[r]||1)for(a=r^r<<1^r<<2^r<<3^r<<4,a=a>>8^255&a^99,c[t]=a,h[a]=t,o=p[n=p[i=p[t]]],l=16843009*o^65537*n^257*i^16843008*t,s=257*p[a]^16843008*a,e=0;e<4;e++)d[e][t]=s=s<<24^s>>>8,u[e][a]=l=l<<24^l>>>8;for(e=0;e<5;e++)d[e]=d[e].slice(0),u[e]=u[e].slice(0)}},{key:"decrypt",value:function(e,t,r,i,n,o){var a,s,l,d,u=this._key[1],c=e^u[0],h=i^u[1],p=r^u[2],f=t^u[3],g=u.length/4-2,v=4,m=this._tables[1],y=m[0],_=m[1],b=m[2],E=m[3],A=m[4];for(d=0;d<g;d++)a=y[c>>>24]^_[h>>16&255]^b[p>>8&255]^E[255&f]^u[v],s=y[h>>>24]^_[p>>16&255]^b[f>>8&255]^E[255&c]^u[v+1],l=y[p>>>24]^_[f>>16&255]^b[c>>8&255]^E[255&h]^u[v+2],f=y[f>>>24]^_[c>>16&255]^b[h>>8&255]^E[255&p]^u[v+3],v+=4,c=a,h=s,p=l;for(d=0;d<4;d++)n[(3&-d)+o]=A[c>>>24]<<24^A[h>>16&255]<<16^A[p>>8&255]<<8^A[255&f]^u[v++],a=c,c=h,h=p,p=f,f=a}}]),e}();r.default=o},{}],11:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("./aes"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,r){i(this,e),this.key=t,this.iv=r}return n(e,[{key:"ntoh",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"doDecrypt",value:function(e,t,r){var i,n,o,s,l,d,u,c,h,p=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),f=new a.default(Array.prototype.slice.call(t)),g=new Uint8Array(e.byteLength),v=new Int32Array(g.buffer);for(i=~~r[0],n=~~r[1],o=~~r[2],s=~~r[3],h=0;h<p.length;h+=4)l=~~this.ntoh(p[h]),d=~~this.ntoh(p[h+1]),u=~~this.ntoh(p[h+2]),c=~~this.ntoh(p[h+3]),f.decrypt(l,d,u,c,v,h),v[h]=this.ntoh(v[h]^i),v[h+1]=this.ntoh(v[h+1]^n),v[h+2]=this.ntoh(v[h+2]^o),v[h+3]=this.ntoh(v[h+3]^s),i=l,n=d,o=u,s=c;return g}},{key:"localDecrypt",value:function(e,t,r,i){var n=this.doDecrypt(e,t,r);i.set(n,e.byteOffset)}},{key:"decrypt",value:function(e){var t=new Int32Array(e),r=new Uint8Array(e.byteLength),i=0,n=this.key,o=this.iv;for(this.localDecrypt(t.subarray(i,i+32e3),n,o,r),i=32e3;i<t.length;i+=32e3)o=new Uint32Array([this.ntoh(t[i-4]),this.ntoh(t[i-3]),this.ntoh(t[i-2]),this.ntoh(t[i-1])]),this.localDecrypt(t.subarray(i,i+32e3),n,o,r);return r}}]),e}();r.default=s},{"./aes":10}],12:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("./aes128-decrypter"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=e("../errors"),l=e("../utils/logger"),d=function(){function e(t){i(this,e),this.hls=t;try{var r=window?window.crypto:crypto;this.subtle=r.subtle||r.webkitSubtle,this.disableWebCrypto=!this.subtle}catch(e){this.disableWebCrypto=!0}}return n(e,[{key:"destroy",value:function(){}},{key:"decrypt",value:function(e,t,r,i){this.disableWebCrypto&&this.hls.config.enableSoftwareAES?this.decryptBySoftware(e,t,r,i):this.decryptByWebCrypto(e,t,r,i)}},{key:"decryptByWebCrypto",value:function(e,t,r,i){var n=this;l.logger.log("decrypting by WebCrypto API"),this.subtle.importKey("raw",t,{name:"AES-CBC",length:128},!1,["decrypt"]).then(function(o){n.subtle.decrypt({name:"AES-CBC",iv:r.buffer},o,e).then(i).catch(function(o){n.onWebCryptoError(o,e,t,r,i)})}).catch(function(o){n.onWebCryptoError(o,e,t,r,i)})}},{key:"decryptBySoftware",value:function(e,t,r,i){l.logger.log("decrypting by JavaScript Implementation");var n=new DataView(t.buffer),o=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]);n=new DataView(r.buffer);var s=new Uint32Array([n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12)]);i(new a.default(o,s).decrypt(e).buffer)}},{key:"onWebCryptoError",value:function(e,t,r,i,n){this.hls.config.enableSoftwareAES?(l.logger.log("disabling to use WebCrypto API"),this.disableWebCrypto=!0,this.decryptBySoftware(t,r,i,n)):(l.logger.error("decrypting error : "+e.message),this.hls.trigger(Event.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}}]),e}();r.default=d},{"../errors":21,"../utils/logger":38,"./aes128-decrypter":11}],13:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("./adts"),s=i(a),l=e("../utils/logger"),d=e("../demux/id3"),u=i(d),c=function(){function e(t,r){n(this,e),this.observer=t,this.remuxerClass=r,this.remuxer=new this.remuxerClass(t),this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0}}return o(e,[{key:"push",value:function(e,t,r,i,n,o,a,d){var c,h,p,f,g,v,m,y,_,b=this._aacTrack,E=new u.default(e),A=90*E.timeStamp;for(g=E.length,y=e.length;g<y-1&&(255!==e[g]||240!=(240&e[g+1]));g++);for(b.audiosamplerate||(c=s.default.getAudioConfig(this.observer,e,g,t),b.config=c.config,b.audiosamplerate=c.samplerate,b.channelCount=c.channelCount,b.codec=c.codec,b.duration=d,l.logger.log("parsed codec:"+b.codec+",rate:"+c.samplerate+",nb channel:"+c.channelCount)),f=0,p=9216e4/b.audiosamplerate;g+5<y&&(v=1&e[g+1]?7:9,h=(3&e[g+3])<<11|e[g+4]<<3|(224&e[g+5])>>>5,(h-=v)>0&&g+v+h<=y);)for(m=A+f*p,_={unit:e.subarray(g+v,g+v+h),pts:m,dts:m},b.samples.push(_),b.len+=h,g+=h+v,f++;g<y-1&&(255!==e[g]||240!=(240&e[g+1]));g++);this.remuxer.remux(this._aacTrack,{samples:[]},{samples:[{pts:A,dts:A,unit:E.payload}]},{samples:[]},i)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,i=new u.default(e);if(i.hasTimeStamp)for(t=i.length,r=e.length;t<r-1;t++)if(255===e[t]&&240==(240&e[t+1]))return!0;return!1}}]),e}();r.default=c},{"../demux/id3":19,"../utils/logger":38,"./adts":14}],14:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/logger"),a=e("../errors"),s=function(){function e(){i(this,e)}return n(e,null,[{key:"getAudioConfig",value:function(e,t,r,i){var n,s,l,d,u,c=navigator.userAgent.toLowerCase(),h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return n=1+((192&t[r+2])>>>6),(s=(60&t[r+2])>>>2)>h.length-1?void e.trigger(Event.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(d=(1&t[r+2])<<2,d|=(192&t[r+3])>>>6,o.logger.log("manifest codec:"+i+",ADTS data:type:"+n+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+d),-1!==c.indexOf("firefox")?s>=6?(n=5,u=new Array(4),l=s-3):(n=2,u=new Array(2),l=s):-1!==c.indexOf("android")?(n=2,u=new Array(2),l=s):(n=5,u=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&s>=6?l=s-3:((i&&-1!==i.indexOf("mp4a.40.2")&&s>=6&&1===d||!i&&1===d)&&(n=2,u=new Array(2)),l=s)),u[0]=n<<3,u[0]|=(14&s)>>1,u[1]|=(1&s)<<7,u[1]|=d<<3,5===n&&(u[1]|=(14&l)>>1,u[2]=(1&l)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:h[s],channelCount:d,codec:"mp4a.40."+n})}}]),e}();r.default=s},{"../errors":21,"../utils/logger":38}],15:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("../events"),s=i(a),l=e("../errors"),d=e("../demux/aacdemuxer"),u=i(d),c=e("../demux/tsdemuxer"),h=i(c),p=e("../remux/mp4-remuxer"),f=i(p),g=e("../remux/passthrough-remuxer"),v=i(g),m=function(){function e(t,r){n(this,e),this.hls=t,this.typeSupported=r}return o(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,i,n,o,a,d){var c=this.demuxer;if(!c){var p=this.hls;if(h.default.probe(e))c=!0===this.typeSupported.mp2t?new h.default(p,v.default):new h.default(p,f.default);else{if(!u.default.probe(e))return void p.trigger(s.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});c=new u.default(p,f.default)}this.demuxer=c}c.push(e,t,r,i,n,o,a,d)}}]),e}();r.default=m},{"../demux/aacdemuxer":13,"../demux/tsdemuxer":20,"../errors":21,"../events":23,"../remux/mp4-remuxer":32,"../remux/passthrough-remuxer":33}],16:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("../demux/demuxer-inline"),o=i(n),a=e("../events"),s=i(a),l=e("events"),d=i(l),u=function(e){var t=new d.default;t.trigger=function(e){
for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.emit.apply(t,[e,e].concat(i))},t.off=function(e){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];t.removeListener.apply(t,[e].concat(i))},e.addEventListener("message",function(r){var i=r.data;switch(i.cmd){case"init":e.demuxer=new o.default(t,i.typeSupported);break;case"demux":e.demuxer.push(new Uint8Array(i.data),i.audioCodec,i.videoCodec,i.timeOffset,i.cc,i.level,i.sn,i.duration)}}),t.on(s.default.FRAG_PARSING_INIT_SEGMENT,function(t,r){e.postMessage({event:t,tracks:r.tracks,unique:r.unique})}),t.on(s.default.FRAG_PARSING_DATA,function(t,r){var i={event:t,type:r.type,startPTS:r.startPTS,endPTS:r.endPTS,startDTS:r.startDTS,endDTS:r.endDTS,data1:r.data1.buffer,data2:r.data2.buffer,nb:r.nb};e.postMessage(i,[i.data1,i.data2])}),t.on(s.default.FRAG_PARSED,function(t){e.postMessage({event:t})}),t.on(s.default.ERROR,function(t,r){e.postMessage({event:t,data:r})}),t.on(s.default.FRAG_PARSING_METADATA,function(t,r){var i={event:t,samples:r.samples};e.postMessage(i)}),t.on(s.default.FRAG_PARSING_USERDATA,function(t,r){var i={event:t,samples:r.samples};e.postMessage(i)})};r.default=u},{"../demux/demuxer-inline":15,"../events":23,events:1}],17:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("../events"),s=i(a),l=e("../demux/demuxer-inline"),d=i(l),u=e("../demux/demuxer-worker"),c=i(u),h=e("../utils/logger"),p=e("../crypt/decrypter"),f=i(p),g=function(){function t(r){n(this,t),this.hls=r;var i={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:r.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t")};if(r.config.enableWorker&&"undefined"!=typeof Worker){h.logger.log("demuxing in webworker");try{var o=e("webworkify");this.w=o(c.default),this.onwmsg=this.onWorkerMessage.bind(this),this.w.addEventListener("message",this.onwmsg),this.w.postMessage({cmd:"init",typeSupported:i})}catch(e){h.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),this.demuxer=new d.default(r,i)}}else this.demuxer=new d.default(r,i);this.demuxInitialized=!0}return o(t,[{key:"destroy",value:function(){this.w?(this.w.removeEventListener("message",this.onwmsg),this.w.terminate(),this.w=null):(this.demuxer.destroy(),this.demuxer=null),this.decrypter&&(this.decrypter.destroy(),this.decrypter=null)}},{key:"pushDecrypted",value:function(e,t,r,i,n,o,a,s){this.w?this.w.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:r,timeOffset:i,cc:n,level:o,sn:a,duration:s},[e]):this.demuxer.push(new Uint8Array(e),t,r,i,n,o,a,s)}},{key:"push",value:function(e,t,r,i,n,o,a,s,l){if(e.byteLength>0&&null!=l&&null!=l.key&&"AES-128"===l.method){null==this.decrypter&&(this.decrypter=new f.default(this.hls));var d=this;this.decrypter.decrypt(e,l.key,l.iv,function(e){d.pushDecrypted(e,t,r,i,n,o,a,s)})}else this.pushDecrypted(e,t,r,i,n,o,a,s)}},{key:"onWorkerMessage",value:function(e){var t=e.data;switch(t.event){case s.default.FRAG_PARSING_INIT_SEGMENT:var r={};r.tracks=t.tracks,r.unique=t.unique,this.hls.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,r);break;case s.default.FRAG_PARSING_DATA:this.hls.trigger(s.default.FRAG_PARSING_DATA,{data1:new Uint8Array(t.data1),data2:new Uint8Array(t.data2),startPTS:t.startPTS,endPTS:t.endPTS,startDTS:t.startDTS,endDTS:t.endDTS,type:t.type,nb:t.nb});break;case s.default.FRAG_PARSING_METADATA:this.hls.trigger(s.default.FRAG_PARSING_METADATA,{samples:t.samples});break;case s.default.FRAG_PARSING_USERDATA:this.hls.trigger(s.default.FRAG_PARSING_USERDATA,{samples:t.samples});break;default:this.hls.trigger(t.event,t.data)}}}]),t}();r.default=g},{"../crypt/decrypter":12,"../demux/demuxer-inline":15,"../demux/demuxer-worker":16,"../events":23,"../utils/logger":38,webworkify:2}],18:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/logger"),a=function(){function e(t){i(this,e),this.data=t,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return n(e,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,t=new Uint8Array(4),r=Math.min(4,this.bytesAvailable);if(0===r)throw new Error("no bytes available");t.set(this.data.subarray(e,e+r)),this.word=new DataView(t.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&o.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r,i=8,n=8;for(t=0;t<e;t++)0!==n&&(r=this.readEG(),n=(i+r+256)%256),i=0===n?i:n}},{key:"readSPS",value:function(){var e,t,r,i,n,o,a,s=0,l=0,d=0,u=0,c=1;if(this.readUByte(),e=this.readUByte(),this.readBits(5),this.skipBits(3),this.readUByte(),this.skipUEG(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var h=this.readUEG();if(3===h&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean())for(o=3!==h?8:12,a=0;a<o;a++)this.readBoolean()&&(a<6?this.skipScalingList(16):this.skipScalingList(64))}this.skipUEG();var p=this.readUEG();if(0===p)this.readUEG();else if(1===p)for(this.skipBits(1),this.skipEG(),this.skipEG(),t=this.readUEG(),a=0;a<t;a++)this.skipEG();if(this.skipUEG(),this.skipBits(1),r=this.readUEG(),i=this.readUEG(),n=this.readBits(1),0===n&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(s=this.readUEG(),l=this.readUEG(),d=this.readUEG(),u=this.readUEG()),this.readBoolean()&&this.readBoolean()){var f=void 0;switch(this.readUByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()]}f&&(c=f[0]/f[1])}return{width:Math.ceil((16*(r+1)-2*s-2*l)*c),height:(2-n)*(i+1)*16-(n?2:4)*(d+u)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();r.default=a},{"../utils/logger":38}],19:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/logger"),a=function(){function e(t){i(this,e),this._hasTimeStamp=!1;for(var r,n,a,s,l,d,u,c,h=0;;)if(u=this.readUTF(t,h,3),h+=3,"ID3"===u)h+=3,r=127&t[h++],n=127&t[h++],a=127&t[h++],s=127&t[h++],l=(r<<21)+(n<<14)+(a<<7)+s,d=h+l,this._parseID3Frames(t,h,d),h=d;else{if("3DI"!==u)return h-=3,void((c=h)&&(this.hasTimeStamp||o.logger.warn("ID3 tag found, but no timestamp"),this._length=c,this._payload=t.subarray(0,c)));h+=7,o.logger.log("3DI footer found, end: "+h)}}return n(e,[{key:"readUTF",value:function(e,t,r){var i="",n=t,o=t+r;do{i+=String.fromCharCode(e[n++])}while(n<o);return i}},{key:"_parseID3Frames",value:function(e,t,r){for(var i,n;t+8<=r;)switch(i=this.readUTF(e,t,4),t+=4,e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],e[t++]<<8+e[t++],t,i){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var a=1&e[t++];this._hasTimeStamp=!0,n=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,a&&(n+=47721858.84),n=Math.round(n),o.logger.trace("ID3 timestamp found: "+n),this._timeStamp=n}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();r.default=a},{"../utils/logger":38}],20:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("./adts"),s=i(a),l=e("../events"),d=i(l),u=e("./exp-golomb"),c=i(u),h=e("../utils/logger"),p=e("../errors"),f=function(){function e(t,r){n(this,e),this.observer=t,this.remuxerClass=r,this.lastCC=0,this.remuxer=new this.remuxerClass(t)}return o(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,nbNalu:0},this._aacTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcNaluState=0,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,r,i,n,o,a,s){var l,u,c,f,g,v,m,y=e.length,_=this.remuxer.passthrough,b=!1;this.audioCodec=t,this.videoCodec=r,this.timeOffset=i,this._duration=s,this.contiguous=!1,n!==this.lastCC&&(h.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=n),o!==this.lastLevel?(h.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=o):a===this.lastSN+1&&(this.contiguous=!0),this.lastSN=a;var E=this.pmtParsed,A=this._avcTrack.id,S=this._aacTrack.id,w=this._id3Track.id;for(y-=y%188,f=0;f<y;f+=188)if(71===e[f]){if(g=!!(64&e[f+1]),v=((31&e[f+1])<<8)+e[f+2],(48&e[f+3])>>4>1){if((m=f+5+e[f+4])===f+188)continue}else m=f+4;if(E)if(v===A){if(g){if(l&&(this._parseAVCPES(this._parsePES(l)),_&&this._avcTrack.codec&&(-1===S||this._aacTrack.codec)))return void this.remux(e);l={data:[],size:0}}l&&(l.data.push(e.subarray(m,f+188)),l.size+=f+188-m)}else if(v===S){if(g){if(u&&(this._parseAACPES(this._parsePES(u)),_&&this._aacTrack.codec&&(-1===A||this._avcTrack.codec)))return void this.remux(e);u={data:[],size:0}}u&&(u.data.push(e.subarray(m,f+188)),u.size+=f+188-m)}else v===w&&(g&&(c&&this._parseID3PES(this._parsePES(c)),c={data:[],size:0}),c&&(c.data.push(e.subarray(m,f+188)),c.size+=f+188-m));else g&&(m+=e[m]+1),0===v?this._parsePAT(e,m):v===this._pmtId?(this._parsePMT(e,m),E=this.pmtParsed=!0,A=this._avcTrack.id,S=this._aacTrack.id,w=this._id3Track.id,b&&(h.logger.log("reparse from beginning"),b=!1,f=-188)):(h.logger.log("unknown PID found before PAT/PMT"),b=!0)}else this.observer.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});l&&this._parseAVCPES(this._parsePES(l)),u&&this._parseAACPES(this._parsePES(u)),c&&this._parseID3PES(this._parsePES(c)),this.remux(null)}},{key:"remux",value:function(e){this.remuxer.remux(this._aacTrack,this._avcTrack,this._id3Track,this._txtTrack,this.timeOffset,this.contiguous,e)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){this._pmtId=(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t){var r,i,n,o;for(r=(15&e[t+1])<<8|e[t+2],i=t+3+r-4,n=(15&e[t+10])<<8|e[t+11],t+=12+n;t<i;){switch(o=(31&e[t+1])<<8|e[t+2],e[t]){case 15:this._aacTrack.id=o;break;case 21:this._id3Track.id=o;break;case 27:this._avcTrack.id=o;break;default:h.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}}},{key:"_parsePES",value:function(e){var t,r,i,n,o,a,s,l,d=0,u=e.data;if(t=u[0],1===(t[0]<<16)+(t[1]<<8)+t[2]){for(i=(t[4]<<8)+t[5],r=t[7],192&r&&(a=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,a>4294967295&&(a-=8589934592),64&r?(s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592):s=a),n=t[8],l=n+9,e.size-=l,o=new Uint8Array(e.size);u.length;){t=u.shift();var c=t.byteLength;if(l){if(l>c){l-=c;continue}t=t.subarray(l),c-=l,l=0}o.set(t,d),d+=c}return{data:o,pts:a,dts:s,len:i}}return null}},{key:"_parseAVCPES",value:function(e){var t,r,i,n,o=this,a=this._avcTrack,s=a.samples,l=this._parseAVCNALu(e.data),d=[],u=!1,p=0;if(0===l.length&&s.length>0){var f=s[s.length-1],g=f.units.units[f.units.units.length-1],v=new Uint8Array(g.data.byteLength+e.data.byteLength);v.set(g.data,0),v.set(e.data,g.data.byteLength),g.data=v,f.units.length+=e.data.byteLength,a.len+=e.data.byteLength}e.data=null;var m="",y=function(){d.length&&((!0===u||a.sps&&(s.length||this.contiguous))&&(r={units:{units:d,length:p},pts:e.pts,dts:e.dts,key:u},s.push(r),a.len+=p,a.nbNalu+=d.length),d=[],p=0)}.bind(this);l.forEach(function(r){switch(r.type){case 1:i=!0;break;case 5:i=!0,u=!0;break;case 6:i=!0,t=new c.default(r.data),t.readUByte();if(4===t.readUByte()){var s=0;do{s=t.readUByte()}while(255===s);if(181===t.readUByte()){if(49===t.readUShort()){if(1195456820===t.readUInt()){if(3===t.readUByte()){var l=t.readUByte(),h=t.readUByte(),f=31&l,g=[l,h];for(n=0;n<f;n++)g.push(t.readUByte()),g.push(t.readUByte()),g.push(t.readUByte());o._txtTrack.samples.push({type:3,pts:e.pts,bytes:g})}}}}}break;case 7:if(i=!0,!a.sps){t=new c.default(r.data);var v=t.readSPS();a.width=v.width,a.height=v.height,a.sps=[r.data],a.duration=o._duration;var _=r.data.subarray(1,4),b="avc1.";for(n=0;n<3;n++){var E=_[n].toString(16);E.length<2&&(E="0"+E),b+=E}a.codec=b}break;case 8:i=!0,a.pps||(a.pps=[r.data]);break;case 9:i=!1,y();break;default:i=!1,m+="unknown NAL "+r.type+" "}i&&(d.push(r),p+=r.data.byteLength)}),m.length&&h.logger.log(m),y()}},{key:"_parseAVCNALu",value:function(e){for(var t,r,i,n,o,a,s=0,l=e.byteLength,d=this.avcNaluState,u=[];s<l;)switch(t=e[s++],d){case 0:0===t&&(d=1);break;case 1:d=0===t?2:0;break;case 2:case 3:if(0===t)d=3;else if(1===t&&s<l){if(n=31&e[s],o)i={data:e.subarray(o,s-d-1),type:a},u.push(i);else{var c=this.avcNaluState;if(c&&s<=4-c){var h=this._avcTrack,p=h.samples;if(p.length){var f=p[p.length-1],g=f.units.units,v=g[g.length-1];v.state&&(v.data=v.data.subarray(0,v.data.byteLength-c),f.units.length-=c,h.len-=c)}}if((r=s-d-1)>0){var m=this._avcTrack,y=m.samples;if(y.length){var _=y[y.length-1],b=_.units.units,E=b[b.length-1],A=new Uint8Array(E.data.byteLength+r);A.set(E.data,0),A.set(e.subarray(0,r),E.data.byteLength),E.data=A,_.units.length+=r,m.len+=r}}}o=s,a=n,d=0}else d=0}return o&&(i={data:e.subarray(o,l),type:a,state:d},u.push(i),this.avcNaluState=d),u}},{key:"_parseAACPES",value:function(e){var t,r,i,n,o,a,l,u,c,f=this._aacTrack,g=e.data,v=e.pts,m=this._duration,y=this.audioCodec,_=this.aacOverFlow,b=this.aacLastPTS;if(_){var E=new Uint8Array(_.byteLength+g.byteLength);E.set(_,0),E.set(g,_.byteLength),g=E}for(o=0,u=g.length;o<u-1&&(255!==g[o]||240!=(240&g[o+1]));o++);if(o){var A,S;if(o<u-1?(A="AAC PES did not start with ADTS header,offset:"+o,S=!1):(A="no ADTS header found in AAC PES",S=!0),this.observer.trigger(d.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:S,reason:A}),S)return}if(f.audiosamplerate||(t=s.default.getAudioConfig(this.observer,g,o,y),f.config=t.config,f.audiosamplerate=t.samplerate,f.channelCount=t.channelCount,f.codec=t.codec,f.duration=m,h.logger.log("parsed codec:"+f.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)),n=0,i=9216e4/f.audiosamplerate,_&&b){var w=b+i;Math.abs(w-v)>1&&(h.logger.log("AAC: align PTS for overlapping frames by "+Math.round((w-v)/90)),v=w)}for(;o+5<u&&(a=1&g[o+1]?7:9,r=(3&g[o+3])<<11|g[o+4]<<3|(224&g[o+5])>>>5,(r-=a)>0&&o+a+r<=u);)for(l=v+n*i,c={unit:g.subarray(o+a,o+a+r),pts:l,dts:l},f.samples.push(c),f.len+=r,o+=r+a,n++;o<u-1&&(255!==g[o]||240!=(240&g[o+1]));o++);_=o<u?g.subarray(o,u):null,this.aacOverFlow=_,this.aacLastPTS=l}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();r.default=f},{"../errors":21,"../events":23,"../utils/logger":38,"./adts":14,"./exp-golomb":18}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"},r.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException"}},{}],22:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("./utils/logger"),s=e("./errors"),l=e("./events"),d=function(e){return e&&e.__esModule?e:{default:e}}(l),u=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return o(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===n(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var r=function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)};try{r.call(this,e,t).call()}catch(t){a.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(d.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();r.default=u},{"./errors":21,"./events":23,"./utils/logger":38}],23:[function(e,t,r){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded"}},{}],24:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return n(e,null,[{key:"bufferInfo",value:function(e,t,r){if(e){var i,n=e.buffered,o=[];for(i=0;i<n.length;i++)o.push({start:n.start(i),end:n.end(i)});return this.bufferedInfo(o,t,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,r){var i,n,o,a,s,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),s=0;s<e.length;s++){var d=l.length;if(d){var u=l[d-1].end;e[s].start-u<r?e[s].end>u&&(l[d-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,i=0,n=o=t;s<l.length;s++){var c=l[s].start,h=l[s].end;if(t+r>=c&&t<h)n=c,o=h,i=o-t;else if(t+r<c){a=c;break}}return{len:i,start:n,end:o,nextStart:a}}}]),e}();r.default=o},{}],25:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/logger"),a=function(){function e(){i(this,e)}return n(e,null,[{key:"mergeDetails",value:function(t,r){var i,n=Math.max(t.startSN,r.startSN)-r.startSN,a=Math.min(t.endSN,r.endSN)-r.startSN,s=r.startSN-t.startSN,l=t.fragments,d=r.fragments,u=0;if(a<n)return void(r.PTSKnown=!1);for(var c=n;c<=a;c++){var h=l[s+c],p=d[c];u=h.cc-p.cc,isNaN(h.startPTS)||(p.start=p.startPTS=h.startPTS,p.endPTS=h.endPTS,p.duration=h.duration,i=p)}if(u)for(o.logger.log("discontinuity sliding from playlist, take drift into account"),c=0;c<d.length;c++)d[c].cc+=u;if(i)e.updateFragPTSDTS(r,i.sn,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else if(s>=0&&s<l.length){var f=l[s].start;for(c=0;c<d.length;c++)d[c].start+=f}r.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,r,i,n,o,a){var s,l,d,u;if(r<t.startSN||r>t.endSN)return 0;if(s=r-t.startSN,l=t.fragments,d=l[s],!isNaN(d.startPTS)){var c=Math.abs(d.startPTS-i);isNaN(d.deltaPTS)?d.deltaPTS=c:d.deltaPTS=Math.max(c,d.deltaPTS),i=Math.min(i,d.startPTS),n=Math.max(n,d.endPTS),o=Math.min(o,d.startDTS),a=Math.max(a,d.endDTS)}var h=i-d.start;for(d.start=d.startPTS=i,d.endPTS=n,d.startDTS=o,d.endDTS=a,d.duration=n-i,u=s;u>0;u--)e.updatePTS(l,u,u-1);for(u=s;u<l.length-1;u++)e.updatePTS(l,u,u+1);return t.PTSKnown=!0,h}},{key:"updatePTS",value:function(e,t,r){var i=e[t],n=e[r],a=n.startPTS;isNaN(a)?n.start=r>t?i.start+i.duration:i.start-n.duration:r>t?(i.duration=a-i.start,i.duration<0&&o.logger.error("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&o.logger.error("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();r.default=a},{"../utils/logger":38}],26:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("./events"),s=i(a),l=e("./errors"),d=e("./loader/playlist-loader"),u=i(d),c=e("./loader/fragment-loader"),h=i(c),p=e("./controller/abr-controller"),f=i(p),g=e("./controller/buffer-controller"),v=i(g),m=e("./controller/cap-level-controller"),y=i(m),_=e("./controller/stream-controller"),b=i(_),E=e("./controller/level-controller"),A=i(E),S=e("./controller/timeline-controller"),w=i(S),T=e("./utils/logger"),L=e("./utils/xhr-loader"),I=i(L),C=e("events"),P=i(C),M=e("./loader/key-loader"),R=i(M),O=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n(this,e);var r=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in r)i in t||(t[i]=r[i]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,T.enableLogs)(t.debug),this.config=t;var o=this.observer=new P.default;o.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];o.emit.apply(o,[e,e].concat(r))},o.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];o.removeListener.apply(o,[e].concat(r))},this.on=o.on.bind(o),this.off=o.off.bind(o),this.trigger=o.trigger.bind(o),this.playlistLoader=new u.default(this),this.fragmentLoader=new h.default(this),this.levelController=new A.default(this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.streamController=new t.streamController(this),this.timelineController=new t.timelineController(this),this.keyLoader=new R.default(this)}return o(e,null,[{key:"isSupported",value:function(){return window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,debug:!1,capLevelToPlayerSize:!1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,appendErrorMaxRetry:3,loader:I.default,fLoader:void 0,pLoader:void 0,abrController:f.default,bufferController:v.default,capLevelController:y.default,streamController:b.default,timelineController:w.default,enableCEA708Captions:!0,enableMP2TPassThrough:!1,abrEwmaFastLive:5,abrEwmaSlowLive:9,abrEwmaFastVoD:4,abrEwmaSlowVoD:15,abrBandWidthFactor:.8,abrBandWidthUpFactor:.7}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),o(e,[{key:"destroy",value:function(){T.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.streamController.destroy(),this.timelineController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){T.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){T.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){T.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];T.logger.log("startLoad"),this.levelController.startLoad(),this.streamController.startLoad(e)}},{key:"stopLoad",value:function(){T.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad()}},{key:"swapAudioCodec",value:function(){T.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){T.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){T.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){T.logger.log("set nextLevel:"+e),
this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){T.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return this.levelController.firstLevel},set:function(e){T.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){T.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){T.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}}]),e}();r.default=O},{"./controller/abr-controller":3,"./controller/buffer-controller":4,"./controller/cap-level-controller":5,"./controller/level-controller":7,"./controller/stream-controller":8,"./controller/timeline-controller":9,"./errors":21,"./events":23,"./loader/fragment-loader":28,"./loader/key-loader":29,"./loader/playlist-loader":30,"./utils/logger":38,"./utils/xhr-loader":40,events:1}],27:[function(e,t,r){"use strict";t.exports=e("./hls.js").default},{"./hls.js":26}],28:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../errors"),p=function(e){function t(e){return n(this,t),o(this,Object.getPrototypeOf(t).call(this,e,d.default.FRAG_LOADING))}return a(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),c.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;this.frag=t,this.frag.loaded=0;var r=this.hls.config;t.loader=this.loader=void 0!==r.fLoader?new r.fLoader(r):new r.loader(r),this.loader.load(t.url,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),r.fragLoadingTimeOut,1,0,this.loadprogress.bind(this),t)}},{key:"loadsuccess",value:function(e,t){var r=e.currentTarget.response;t.length=r.byteLength,this.frag.loader=void 0,this.hls.trigger(d.default.FRAG_LOADED,{payload:r,frag:this.frag,stats:t})}},{key:"loaderror",value:function(e){this.loader&&this.loader.abort(),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:this.frag,response:e})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(e,t){this.frag.loaded=t.loaded,this.hls.trigger(d.default.FRAG_LOAD_PROGRESS,{frag:this.frag,stats:t})}}]),t}(c.default);r.default=p},{"../errors":21,"../event-handler":22,"../events":23}],29:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../errors"),p=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e,d.default.KEY_LOADING));return r.decryptkey=null,r.decrypturl=null,r}return a(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),c.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=this.frag=e.frag,r=t.decryptdata,i=r.uri;if(i!==this.decrypturl||null===this.decryptkey){var n=this.hls.config;t.loader=this.loader=new n.loader(n),this.decrypturl=i,this.decryptkey=null,t.loader.load(i,"arraybuffer",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),n.fragLoadingTimeOut,n.fragLoadingMaxRetry,n.fragLoadingRetryDelay,this.loadprogress.bind(this),t)}else this.decryptkey&&(r.key=this.decryptkey,this.hls.trigger(d.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e){var t=this.frag;this.decryptkey=t.decryptdata.key=new Uint8Array(e.currentTarget.response),t.loader=void 0,this.hls.trigger(d.default.KEY_LOADED,{frag:t})}},{key:"loaderror",value:function(e){this.loader&&this.loader.abort(),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:this.frag,response:e})}},{key:"loadtimeout",value:function(){this.loader&&this.loader.abort(),this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:this.frag})}},{key:"loadprogress",value:function(){}}]),t}(c.default);r.default=p},{"../errors":21,"../event-handler":22,"../events":23}],30:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=e("../events"),d=i(l),u=e("../event-handler"),c=i(u),h=e("../errors"),p=e("../utils/url"),f=i(p),g=e("../utils/attr-list"),v=i(g),m=function(e){function t(e){return n(this,t),o(this,Object.getPrototypeOf(t).call(this,e,d.default.MANIFEST_LOADING,d.default.LEVEL_LOADING))}return a(t,e),s(t,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null),this.url=this.id=null,c.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,null)}},{key:"onLevelLoading",value:function(e){this.load(e.url,e.level,e.id)}},{key:"load",value:function(e,t,r){var i,n,o,a=this.hls.config;if(this.loading&&this.loader){if(this.url===e&&this.id===t&&this.id2===r)return;this.loader.abort()}this.url=e,this.id=t,this.id2=r,null===this.id?(i=a.manifestLoadingMaxRetry,n=a.manifestLoadingTimeOut,o=a.manifestLoadingRetryDelay):(i=a.levelLoadingMaxRetry,n=a.levelLoadingTimeOut,o=a.levelLoadingRetryDelay),this.loader=void 0!==a.pLoader?new a.pLoader(a):new a.loader(a),this.loading=!0,this.loader.load(e,"",this.loadsuccess.bind(this),this.loaderror.bind(this),this.loadtimeout.bind(this),n,i,o)}},{key:"resolve",value:function(e,t){return f.default.buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){for(var r=[],i=void 0,n=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;null!=(i=n.exec(e));){var o={},a=o.attrs=new v.default(i[1]);o.url=this.resolve(i[2],t);var s=a.decimalResolution("RESOLUTION");s&&(o.width=s.width,o.height=s.height),o.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),o.name=a.NAME;var l=a.CODECS;if(l){l=l.split(",");for(var d=0;d<l.length;d++){var u=l[d];-1!==u.indexOf("avc1")?o.videoCodec=this.avc1toavcoti(u):o.audioCodec=u}}r.push(o)}return r}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"parseLevelPlaylist",value:function(e,t,r){var i,n,o,a,s=0,l=0,d={url:t,fragments:[],live:!0,startSN:0},u={method:null,key:null,iv:null,uri:null},c=0,h=null,p=null;for(n=/(?:#EXT-X-(MEDIA-SEQUENCE):(\d+))|(?:#EXT-X-(TARGETDURATION):(\d+))|(?:#EXT-X-(KEY):(.*))|(?:#EXT(INF):([\d\.]+)[^\r\n]*([\r\n]+[^#|\r\n]+)?)|(?:#EXT-X-(BYTERANGE):([\d]+[@[\d]*)]*[\r\n]+([^#|\r\n]+)?|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.*)[\r\n]+([^#|\r\n]+)?)/g;null!==(i=n.exec(e));)switch(i.shift(),i=i.filter(function(e){return void 0!==e}),i[0]){case"MEDIA-SEQUENCE":s=d.startSN=parseInt(i[1]);break;case"TARGETDURATION":d.targetduration=parseFloat(i[1]);break;case"ENDLIST":d.live=!1;break;case"DIS":c++;break;case"BYTERANGE":var f=i[1].split("@");a=1===f.length?o:parseInt(f[1]),o=parseInt(f[0])+a,p&&!p.url&&(p.byteRangeStartOffset=a,p.byteRangeEndOffset=o,p.url=this.resolve(i[2],t));break;case"INF":var g=parseFloat(i[1]);if(!isNaN(g)){var m,y=s++;if(u.method&&u.uri&&!u.iv){m=this.cloneObj(u);for(var _=new Uint8Array(16),b=12;b<16;b++)_[b]=y>>8*(15-b)&255;m.iv=_}else m=u;p={url:i[2]?this.resolve(i[2],t):null,duration:g,start:l,sn:y,level:r,cc:c,byteRangeStartOffset:a,byteRangeEndOffset:o,decryptdata:m,programDateTime:h},d.fragments.push(p),l+=g,a=null,h=null}break;case"KEY":var E=i[1],A=new v.default(E),S=A.enumeratedString("METHOD"),w=A.URI,T=A.hexadecimalInteger("IV");S&&(u={method:null,key:null,iv:null,uri:null},w&&"AES-128"===S&&(u.method=S,u.uri=this.resolve(w,t),u.key=null,u.iv=T));break;case"PROGRAM-DATE-TIME":h=new Date(Date.parse(i[1])),p&&!p.url&&i.length>=3&&(p.url=this.resolve(i[2],t),p.programDateTime=h)}return p&&!p.url&&(d.fragments.pop(),l-=p.duration),d.totalduration=l,d.endSN=s-1,d}},{key:"loadsuccess",value:function(e,t){var r,i=e.currentTarget,n=i.responseText,o=i.responseURL,a=this.id,s=this.id2,l=this.hls;if(this.loading=!1,void 0===o&&(o=this.url),t.tload=performance.now(),t.mtime=new Date(i.getResponseHeader("Last-Modified")),0===n.indexOf("#EXTM3U"))if(n.indexOf("#EXTINF:")>0)if(null===this.id)l.trigger(d.default.MANIFEST_LOADED,{levels:[{url:o}],url:o,stats:t});else{var u=this.parseLevelPlaylist(n,o,a);t.tparsed=performance.now(),l.trigger(d.default.LEVEL_LOADED,{details:u,level:a,id:s,stats:t})}else r=this.parseMasterPlaylist(n,o),r.length?l.trigger(d.default.MANIFEST_LOADED,{levels:r,url:o,stats:t}):l.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no level found in manifest"});else l.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:o,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e){var t,r;null===this.id?(t=h.ErrorDetails.MANIFEST_LOAD_ERROR,r=!0):(t=h.ErrorDetails.LEVEL_LOAD_ERROR,r=!1),this.loader&&this.loader.abort(),this.loading=!1,this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:t,fatal:r,url:this.url,loader:this.loader,response:e.currentTarget,level:this.id,id:this.id2})}},{key:"loadtimeout",value:function(){var e,t;null===this.id?(e=h.ErrorDetails.MANIFEST_LOAD_TIMEOUT,t=!0):(e=h.ErrorDetails.LEVEL_LOAD_TIMEOUT,t=!1),this.loader&&this.loader.abort(),this.loading=!1,this.hls.trigger(d.default.ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:e,fatal:t,url:this.url,loader:this.loader,level:this.id,id:this.id2})}}]),t}(c.default);r.default=m},{"../errors":21,"../event-handler":22,"../events":23,"../utils/attr-list":34,"../utils/url":39}],31:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return n(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=o,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,a,l,a,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,o=n;n--;)i+=r[n].byteLength;for(t=new Uint8Array(i),t[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),n=0,i=8;n<o;n++)t.set(r[n],i),i+=r[n].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){return r*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))}},{key:"moov",value:function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))}},{key:"mvhd",value:function(t,r){r*=t;var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,i)}},{key:"sdtp",value:function(t){var r,i,n=t.samples||[],o=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)r=n[i].flags,o[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,o)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,i,n,o=[],a=[];for(r=0;r<t.sps.length;r++)i=t.sps[r],n=i.byteLength,o.push(n>>>8&255),o.push(255&n),o=o.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)i=t.pps[r],n=i.byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(i));var s=e.box(e.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|t.sps.length].concat(o).concat([t.pps.length]).concat(a))),l=t.width,d=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"stsd",value:function(t){return"audio"===t.type?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,i=t.duration*t.timescale,n=t.width,o=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,r){var i=e.sdtp(t),n=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),e.trun(t,i.length+16+16+8+16+8+8),i)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var i,n,o,a,s,l,d=t.samples||[],u=d.length,c=12+16*u,h=new Uint8Array(c);for(r+=8+c,h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<u;i++)n=d[i],o=n.duration,a=n.size,s=n.flags,l=n.cts,h.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,h)}},{key:"initSegment",value:function(t){e.types||e.init();var r,i=e.moov(t);return r=new Uint8Array(e.FTYP.byteLength+i.byteLength),r.set(e.FTYP),r.set(i,e.FTYP.byteLength),r}}]),e}();r.default=o},{}],32:[function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),a=e("../events"),s=i(a),l=e("../utils/logger"),d=e("../remux/mp4-generator"),u=i(d),c=e("../errors"),h=function(){function e(t){n(this,e),this.observer=t,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return o(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,i,n,o){this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated&&(t.samples.length&&this.remuxVideo(t,n,o),e.samples.length&&this.remuxAudio(e,n,o)),r.samples.length&&this.remuxID3(r,n),i.samples.length&&this.remuxText(i,n),this.observer.trigger(s.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,r){var i,n,o=this.observer,a=e.samples,d=t.samples,h=this.PES_TIMESCALE,p={},f={tracks:p,unique:!1},g=void 0===this._initPTS;g&&(i=n=1/0),e.config&&a.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&function(){e.timescale=e.audiosamplerate/function e(t,r){return r?e(r,t%r):t}(e.audiosamplerate,1024)}(),l.logger.log("audio mp4 timescale :"+e.timescale),p.audio={container:"audio/mp4",codec:e.codec,initSegment:u.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(i=n=a[0].pts-h*r)),t.sps&&t.pps&&d.length&&(t.timescale=this.MP4_TIMESCALE,p.video={container:"video/mp4",codec:t.codec,initSegment:u.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(i=Math.min(i,d[0].pts-h*r),n=Math.min(n,d[0].dts-h*r))),Object.keys(p).length?(o.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,f),this.ISGenerated=!0,g&&(this._initPTS=i,this._initDTS=n)):o.trigger(s.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r){var i,n,o,a,d,c,h,p,f,g,v,m,y,_,b,E=8,A=this.PES_TIMESCALE,S=this.PES2MP4SCALEFACTOR,w=[],T=e.samples.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);for(T<0&&l.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(T/90)+" ms to overcome this issue"),c=new Uint8Array(e.len+4*e.nbNalu+8),i=new DataView(c.buffer),i.setUint32(0,c.byteLength),c.set(u.default.types.mdat,4);e.samples.length;){for(n=e.samples.shift(),a=0;n.units.units.length;)d=n.units.units.shift(),i.setUint32(E,d.data.byteLength),E+=4,c.set(d.data,E),E+=d.data.byteLength,a+=4+d.data.byteLength;if(v=n.pts-this._initDTS,m=n.dts-this._initDTS+T,m=Math.min(v,m),void 0!==g){y=this._PTSNormalize(v,g),_=this._PTSNormalize(m,g);var L=(_-g)/S;L<=0&&(l.logger.log("invalid sample duration at PTS/DTS: "+n.pts+"/"+n.dts+":"+L),L=1),o.duration=L}else{var I=void 0,C=void 0;I=r?this.nextAvcDts:t*A,y=this._PTSNormalize(v,I),_=this._PTSNormalize(m,I),C=Math.round((_-I)/90),r&&C&&(C>1?l.logger.log("AVC:"+C+" ms hole between fragments detected,filling it"):C<-1&&l.logger.log("AVC:"+-C+" ms overlapping between fragments detected"),_=I,y=Math.max(y-C,_),l.logger.log("Video/PTS/DTS adjusted: "+y+"/"+_+",delta:"+C)),p=Math.max(0,y),f=Math.max(0,_)}o={size:a,duration:0,cts:(y-_)/S,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0}},b=o.flags,!0===n.key?(b.dependsOn=2,b.isNonSync=0):(b.dependsOn=1,b.isNonSync=1),w.push(o),g=_}var P=0;w.length>=2&&(P=w[w.length-2].duration,o.duration=P),this.nextAvcDts=_+P*S,e.len=0,e.nbNalu=0,w.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(b=w[0].flags,b.dependsOn=2,b.isNonSync=0),e.samples=w,h=u.default.moof(e.sequenceNumber++,f/S,e),e.samples=[],this.observer.trigger(s.default.FRAG_PARSING_DATA,{data1:h,data2:c,startPTS:p/A,endPTS:(y+S*P)/A,startDTS:f/A,endDTS:this.nextAvcDts/A,type:"video",nb:w.length})}},{key:"remuxAudio",value:function(e,t,r){var i,n,o,a,d,c,h,p,f,g,v,m,y,_=8,b=this.PES_TIMESCALE,E=e.timescale,A=b/E,S=1024*e.timescale/e.audiosamplerate,w=[],T=[];for(e.samples.sort(function(e,t){return e.pts-t.pts}),T=e.samples;T.length;){if(n=T.shift(),a=n.unit,g=n.pts-this._initDTS,v=n.dts-this._initDTS,void 0!==f)m=this._PTSNormalize(g,f),y=this._PTSNormalize(v,f),o.duration=(y-f)/A,Math.abs(o.duration-S)>S/10&&l.logger.log("invalid AAC sample duration at PTS "+Math.round(g/90)+",should be 1024,found :"+Math.round(o.duration*e.audiosamplerate/e.timescale)),o.duration=S,m=y=S*A+f;else{var L=void 0,I=void 0;if(L=r?this.nextAacPts:t*b,m=this._PTSNormalize(g,L),y=this._PTSNormalize(v,L),I=Math.round(1e3*(m-L)/b),r&&I){if(I>0)l.logger.log(I+" ms hole between AAC samples detected,filling it");else if(I<-12){l.logger.log(-I+" ms overlapping between AAC samples detected, drop frame"),e.len-=a.byteLength;continue}m=y=L}if(h=Math.max(0,m),p=Math.max(0,y),!(e.len>0))return;d=new Uint8Array(e.len+8),i=new DataView(d.buffer),i.setUint32(0,d.byteLength),d.set(u.default.types.mdat,4)}d.set(a,_),_+=a.byteLength,o={size:a.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},w.push(o),f=y}var C=0,P=w.length;P>=2&&(C=w[P-2].duration,o.duration=C),P&&(this.nextAacPts=m+A*C,e.len=0,e.samples=w,c=u.default.moof(e.sequenceNumber++,p/A,e),e.samples=[],this.observer.trigger(s.default.FRAG_PARSING_DATA,{data1:c,data2:d,startPTS:h/b,endPTS:this.nextAacPts/b,startDTS:p/b,endDTS:(y+A*C)/b,type:"audio",nb:P}))}},{key:"remuxID3",value:function(e,t){var r,i=e.samples.length;if(i){for(var n=0;n<i;n++)r=e.samples[n],r.pts=(r.pts-this._initPTS)/this.PES_TIMESCALE,r.dts=(r.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(s.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var r,i=e.samples.length;if(i){for(var n=0;n<i;n++)r=e.samples[n],r.pts=(r.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(s.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}},{key:"passthrough",get:function(){return!1}}]),e}();r.default=h},{"../errors":21,"../events":23,"../remux/mp4-generator":31,"../utils/logger":38}],33:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../events"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){i(this,e),this.observer=t,this.ISGenerated=!1}return n(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,i,n,o){var s=this.observer;if(!this.ISGenerated){var l={},d={tracks:l,unique:!0},u=t,c=u.codec;c&&(d.tracks.video={container:u.container,codec:c,metadata:{width:u.width,height:u.height}}),u=e,c=u.codec,c&&(d.tracks.audio={container:u.container,codec:c,metadata:{channelCount:u.channelCount}}),this.ISGenerated=!0,s.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,d)}s.trigger(a.default.FRAG_PARSING_DATA,{data1:o,startPTS:n,startDTS:n,type:"audiovideo",nb:1})}},{key:"passthrough",get:function(){return!0}}]),e}();r.default=s},{"../events":23}],34:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r])}return n(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=/^(\d+)x(\d+)$/.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){for(var t,r=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,i={};null!==(t=r.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i}}]),e}();r.default=o},{}],35:[function(e,t,r){"use strict";var i={search:function(e,t){for(var r=0,i=e.length-1,n=null,o=null;r<=i;){n=(r+i)/2|0,o=e[n];var a=t(o);if(a>0)r=n+1;else{if(!(a<0))return o;i=n-1}}return null}};t.exports=i},{}],36:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(){i(this,e)}return n(e,[{key:"attach",value:function(e){this.media=e,this.display=[],this.memory=[]}},{key:"detach",value:function(){this.clear()}},{key:"destroy",value:function(){}},{key:"_createCue",value:function(){var e=window.VTTCue||window.TextTrackCue,t=this.cue=new e(-1,-1,"");t.text="",t.pauseOnExit=!1,t.startTime=Number.MAX_VALUE,t.endTime=Number.MAX_VALUE,this.memory.push(t)}},{key:"clear",value:function(){var e=this._textTrack;if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"push",value:function(e,t){this.cue||this._createCue();for(var r,i,n,o,a,s=31&t[0],l=2,d=0;d<s;d++)if(r=t[l++],i=127&t[l++],n=127&t[l++],o=0!=(4&r),a=3&r,(0!==i||0!==n)&&o&&0===a){if(32&i||64&i)this.cue.text+=this._fromCharCode(i)+this._fromCharCode(n);else if((17===i||25===i)&&n>=48&&n<=63)switch(n){case 48:this.cue.text+="®";break;case 49:this.cue.text+="°";break;case 50:this.cue.text+="½";break;case 51:this.cue.text+="¿";break;case 52:this.cue.text+="™";break;case 53:this.cue.text+="¢";break;case 54:this.cue.text+="";break;case 55:this.cue.text+="£";break;case 56:this.cue.text+="♪";break;case 57:this.cue.text+=" ";break;case 58:this.cue.text+="è";break;case 59:this.cue.text+="â";break;case 60:this.cue.text+="ê";break;case 61:this.cue.text+="î";break;case 62:this.cue.text+="ô";break;case 63:this.cue.text+="û"}if((20===i||28===i)&&n>=32&&n<=47)switch(n){case 32:this._clearActiveCues(e);break;case 33:this.cue.text=this.cue.text.substr(0,this.cue.text.length-1);break;case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;case 41:this._clearActiveCues(e);break;case 42:case 43:break;case 44:this._clearActiveCues(e);break;case 45:break;case 46:this._text="";break;case 47:this._flipMemory(e)}}}},{key:"_fromCharCode",value:function(e){switch(e){case 42:case 2:return"á";case 2:return"é";case 4:
return"í";case 5:return"ó";case 6:return"ú";case 3:return"ç";case 4:return"÷";case 5:return"Ñ";case 6:return"ñ";case 7:return"█";default:return String.fromCharCode(e)}}},{key:"_flipMemory",value:function(e){this._clearActiveCues(e),this._flushCaptions(e)}},{key:"_flushCaptions",value:function(e){this._has708||(this._textTrack=this.media.addTextTrack("captions","English","en"),this._has708=!0);var t=!0,r=!1,i=void 0;try{for(var n,o=this.memory[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var a=n.value;a.startTime=e,this._textTrack.addCue(a),this.display.push(a)}}catch(e){r=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw i}}this.memory=[],this.cue=null}},{key:"_clearActiveCues",value:function(e){var t=!0,r=!1,i=void 0;try{for(var n,o=this.display[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){n.value.endTime=e}}catch(e){r=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw i}}this.display=[]}},{key:"_clearBufferedCues",value:function(){}}]),e}();r.default=o},{}],37:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(t){i(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return n(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();r.default=o},{}],38:[function(e,t,r){"use strict";function i(){}function n(e,t){return t="["+e+"] > "+t}function o(e){var t=window.console[e];return t?function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];i[0]&&(i[0]=n(e,i[0])),t.apply(window.console,i)}:i}function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];r.forEach(function(t){d[t]=e[t]?e[t].bind(e):o(t)})}Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},l={trace:i,debug:i,log:i,warn:i,info:i,error:i},d=l;r.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":s(e))){a(e,"debug","log","info","warn","error");try{d.log()}catch(e){d=l}}else d=l},r.logger=d},{}],39:[function(e,t,r){"use strict";var i={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var r=null,n=null,o=/^([^#]*)(.*)$/.exec(t);o&&(n=o[2],t=o[1]);var a=/^([^\?]*)(.*)$/.exec(t);a&&(r=a[2],t=a[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);var l=/^([^\?]*)(.*)$/.exec(e);l&&(e=l[1]);var d=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(e);if(!d)throw new Error("Error trying to parse base URL.");var u=d[2]||"",c=d[1]||"",h=d[4],p=null;return p=/^\/\//.test(t)?u+"//"+i.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?c+"/"+i.buildAbsolutePath("",t.substring(1)):i.buildAbsolutePath(c+h,t),r&&(p+=r),n&&(p+=n),p},buildAbsolutePath:function(e,t){for(var r,i,n=t,o="",a=e.replace(/[^\/]*$/,n.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;(i=a.indexOf("/../",s))>-1;s=i+r)r=/^\/(?:\.\.\/)*/.exec(a.slice(i))[0].length,o=(o+a.substring(s,i)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(r-1)/3+"}$"),"/");return o+a.substr(s)}};t.exports=i},{}],40:[function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=e("../utils/logger"),a=function(){function e(t){i(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return n(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader,t=this.timeoutHandle;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),t&&window.clearTimeout(t)}},{key:"load",value:function(e,t,r,i,n,o,a,s){var l=arguments.length<=8||void 0===arguments[8]?null:arguments[8],d=arguments.length<=9||void 0===arguments[9]?null:arguments[9];this.url=e,!d||isNaN(d.byteRangeStartOffset)||isNaN(d.byteRangeEndOffset)||(this.byteRange=d.byteRangeStartOffset+"-"+(d.byteRangeEndOffset-1)),this.responseType=t,this.onSuccess=r,this.onProgress=l,this.onTimeout=n,this.onError=i,this.stats={trequest:performance.now(),retry:0},this.timeout=o,this.maxRetry=a,this.retryDelay=s,this.loadInternal()}},{key:"loadInternal",value:function(){var e;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onloadend=this.loadend.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",this.url,!0),this.byteRange&&e.setRequestHeader("Range","bytes="+this.byteRange),e.responseType=this.responseType;var t=this.stats;t.tfirst=0,t.loaded=0,this.xhrSetup&&this.xhrSetup(e,this.url),this.timeoutHandle=window.setTimeout(this.loadtimeout.bind(this),this.timeout),e.send()}},{key:"loadend",value:function(e){var t=e.currentTarget,r=t.status,i=this.stats;i.aborted||(r>=200&&r<300?(window.clearTimeout(this.timeoutHandle),i.tload=Math.max(i.tfirst,performance.now()),this.onSuccess(e,i)):i.retry<this.maxRetry?(o.logger.warn(r+" while loading "+this.url+", retrying in "+this.retryDelay+"..."),this.destroy(),window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64e3),i.retry++):(window.clearTimeout(this.timeoutHandle),o.logger.error(r+" while loading "+this.url),this.onError(e)))}},{key:"loadtimeout",value:function(e){o.logger.warn("timeout while loading "+this.url),this.onTimeout(e,this.stats)}},{key:"loadprogress",value:function(e){var t=this.stats;0===t.tfirst&&(t.tfirst=Math.max(performance.now(),t.trequest)),t.loaded=e.loaded,this.onProgress&&this.onProgress(e,t)}}]),e}();r.default=a},{"../utils/logger":38}]},{},[27])(27)}),define("playerlogger",[],function(){function e(e){return typeof console!==s&&(void 0!==console[e]?t(console,e):void 0!==console.log?t(console,"log"):a)}function t(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function r(e,t){return function(){typeof console!==s&&(i(t),o[e].apply(o,arguments))}}function i(e){for(var t=0;t<l.length;t++){var r=l[t];o[r]=t<e?a:o.methodFactory(r,e)}}function n(e){var t=(l[e]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=t)}catch(e){}try{window.document.cookie="loglevel="+t+";"}catch(e){}}var o={},a=function(){},s="undefined",l=["trace","debug","info","warn","error","time","timeEnd"];o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=function(t,i){return e(t)||r(t,i)},o.setLevel=function(e){if("string"==typeof e&&void 0!==o.levels[e.toUpperCase()]&&(e=o.levels[e.toUpperCase()]),!("number"==typeof e&&e>=0&&e<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(n(e),i(e),typeof console===s&&e<o.levels.SILENT)return"No console available for logging"},o.enableAll=function(){o.setLevel(o.levels.TRACE)},o.disableAll=function(){o.setLevel(o.levels.SILENT)};var d=typeof window!==s?window.log:void 0;return o.noConflict=function(){return typeof window!==s&&window.log===o&&(window.log=d),o},function(){var e;try{e=window.localStorage.loglevel}catch(e){}if(typeof e===s)try{e=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(e){}void 0===o.levels[e]&&(e="WARN"),o.setLevel(o.levels[e])}(),window.DebugMode&&DebugMode.on?o.enableAll():o.disableAll(),o}),define("zeus_constants",[],function(){return window.ZeusConstants={PLAYWIRE_GA:"UA-19528293-3",FLASHVERSION:"11",Ad:{QUEUE_WAIT:500,PLAYER_ID_PREFIX:"ad_",VPAID_SHIM:window.zeusBaseUrl+"/swf/zeusvpaidplayer-2079610333.swf",IMA_SHIM:window.zeusBaseUrl+"/swf/zeusima.swf",APPNEXUS_DI:DebugMode.spotxDev?"2dbcc.3c35f.67b9":"11702.af1c6.9304",AMAZON_DI:DebugMode.spotxDev?"2dbcc.3b9eb.41d4":"11702.ad9cd.793d",RUBICON_DI:DebugMode.spotxDev?"2dbcc.813c6.2697":"11702.ae5f9.3dba",Type:{FLASH_VPAID:"flash-vpaid",JS_VPAID:"js-vpaid",VAST:"vast",GOOGLE:"google",STATIC_IMAGE:"static-image",THREE_TWO_FIFTY:"video300x250",OVERLAY:"overlay",GOOGLE_DCM_VPAID:"google-dcm-vpaid"},Provider:{CELTRA:"celtra",COULL:"coull",LIVERAIL:"liverail",YUME:"yume",GOOGLE:"google",ADOTUBE:"adotube",AOL:"aol",SPOTX:"spotx",ADAP:"adap",MOAT:"moat",INNOVID:"innovid",PUBMATIC:"pubmatic",SIZMEK:"sizmek"},Server:{INTERGI:"adtech-intergi",DFP:"dfp-intergi",SPOTX:"spotx-playwire",SPOTX_SDK:"spotx-playwire-sdk",GENERIC_VAST:"generic-vast",GENERIC_GOOGLE:"generic-google"},Event:{TAG_NOT_AVAILABLE:"adTagNotAvailable",CLICKED:"adClicked",CLOSED:"adClosed",COMPLETED:"adCompleted",FAILED:"adFailed",REMAINING_TIME_CHANGED:"adRemainingTimeChanged",REQUESTED:"adRequested",SKIPPED:"adSkipped",STARTED:"adStarted",LINEAR_CHANGED:"linearChanged",EXPANDED_CHANGED:"expandedChanged",READY:"adReady",CONTENT_PAUSE_REQUESTED:"contentPauseRequested",CONTENT_RESUME_REQUESTED:"contentResumeRequested",CUEPOINT:"adCuepoint",ABORTED:"adAborted",SESSION_START:"adSessionStart",SESSION_END:"adSessionEnd",SESSION_FAIL:"adSessionFail",SESSION_ABORT:"adSessionAbort",SESSION_AD_LOADED:"adSessionAdLoaded",SESSION_BLOCKED:"adSessionBlocked",REQUEST_START:"adRequestStart",REQUEST_FAIL:"adRequestFail",REQUEST_ABORT:"adRequestAbort",REQUEST_SUCCESS:"adRequestSuccess",VMAP_CUEPOINTS_CHANGED:"VMAPCuepointsChanged",QUEUED:"adQueued",SS_REQUESTED:"ssRequested",SS_FAILED:"ssFailed",SS_LOADED:"ssLoaded",SS_BACKFILL_REQUESTED:"ssBackfillRequested",SS_BACKFILL_SUCCESS:"ssBackfillSuccess",SS_BACKFILL_FAILED:"ssBackfillFailed",SS_IMPRESSION:"ssImpression"},IMA_ENABLED:!1},Player:{ID_PREFIX:"video_",SKIN_ID_PREFIX:"skin_",SWFROOT:window.zeusBaseUrl+"/swf",FLASH_SHIM:window.zeusBaseUrl+"/swf/zeusplayer-9298ef2f7b.swf",CORS_SHIM:window.zeusBaseUrl+"/swf/zeuscorsshim-b9284c11b6.swf",VIDEO_SHIM:window.zeusBaseUrl+"/swf/zeusvideoplayer-0b5569794a.swf",SWF_PLAYER:window.zeusBaseUrl+"/swf/zeusswfplayer-61b9b07fd4.swf",Event:{CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",CONTENT_CHANGED:"contentChanged",ENTER_FULLSCREEN:"enterFullscreen",EXIT_FULLSCREEN:"exitFullscreen",QUALITY_CHANGED:"qualityChanged",READY:"playerReady",REMOVED:"removed",SIZE_CHANGED:"sizeChanged",VIEW_READY:"viewReady",VIEW_REMOVED:"viewRemoved",CONFIG_CHANGED:"configChanged",CONFIG_NOT_FOUND:"configNotFound",FATAL_ERROR:"fatalError",LOADED:"playerLoaded"}},Media:{Event:{DURATION_CHANGE:"media_durationchange",EMPTIED:"media_emptied",ENDED:"media_ended",FIRSTQUARTILE:"media_firstQuartile",LOAD_PROGRESS:"media_loadProgress",LOAD_START:"media_loadstart",LOADED:"media_loaded",METADATA:"media_metadataLoaded",MIDPOINT:"media_midpoint",MUTED:"media_muted",PAUSED:"media_pause",PLAY:"media_play",PLAYING:"media_playing",RESUME:"media_resume",SEEKED:"media_seeked",SEEKING:"media_seeking",START_TIME_CHANGED:"media_startTimeChanged",STOPPED:"media_stopped",THIRDQUARTILE:"media_thirdQuartile",TIME_UPDATE:"media_timeupdate",UNMUTED:"media_unmuted",VOLUME_CHANGED:"media_volumechanged",WAITING:"media_waiting",NOT_FOUND:"media_NotFound",NOT_SUPPORTED:"media_NotSupported"}},ERROR:"error",VALUE_CHANGED:"valueChanged",Mime:{"3GP":"video/3gpp","3GP2":"video/3gpp2",F4M:"application/f4m",FLV:"video/x-flv",MOV:"video/mov",MP4:"video/mp4",MPEG:"video/mpeg",OGG:"video/ogg",WEBM:"video/webm",SWF:"application/x-shockwave-flash",XJS:"application/x-javascript",JS:"application/javascript",M3U8:"application/vnd.apple.mpegurl"},UI:{AD_CUEPOINTS_CONTAINER:"cuepoints-container",AD_TITLE:"ad-title",AGE_GATE_DAY_INPUT:"age-gate-day-input",AGE_GATE_FORM:"age-gate-form",AGE_GATE_FORM_SUBMIT:"age-gate-form-submit",AGE_GATE_LAYER:"age-gate-layer",AGE_GATE_MONTH_INPUT:"age-gate-month-input",AGE_GATE_YEAR_INPUT:"age-gate-year-input",AGE_GATE_FAILED_MESSAGE:"age-gate-failed-message",AGE_GATE_INPUT_ERROR:"age-gate-input-error",BIG_PLAY:"big-play-layer",CONTENT:"content",EMBED_CODE_CONTAINER:"embed-code-container",EMBED_CODE_INPUT:"embed-code-input",ERROR_CONTAINER:"error-container",SHARING_CODE_CONTAINER:"sharing-code-container",SHARING_CODE_INPUT:"sharing-code-input",SOCIAL_SHARE_CONTAINER:"social-share-container",MAIN_VIDEO_CONTAINER:"main-video-container",AD_CONTAINER:"ad-container",BRANDING:"branding",CONTROLBAR:"control-bar",CUEPOINT:"cuepoint",FULLSCREEN_BTN:"fullscreen-btn",LOADING_INDICATOR:"loading-indicator",MIN_TIME_TO_SHOW_AD_DURATION:1,MUTED_ICON:"muted-icon",PAUSE_ICON:"pause-icon",PLAY_ICON:"play-icon",PLAY_PAUSE_BTN:"play-pause-btn",PLAYLIST:"playlist",PLAYLIST_BTN:"playlist-btn",POSTER:"poster-container",RELATED_VIDEOS:"related-videos",RELATED_CONTAINER:"related-container",RELATED_AUTOPLAYER_PANE:"related-autoplayer-pane",RELATED_AUTOPLAYER:"related-autoplayer",RELATED_FIRST_GRID_PANE:"related-first-grid-pane",RELATED_FIRST_GRID:"related-first-grid",RELATED_SECOND_GRID_PANE:"related-second-grid-pane",RELATED_SECOND_GRID:"related-second-grid",RELATED_CANCEL_LINK:"related-cancel-link",RELATED_PLAY_NEXT_BUTTON:"related-play-next-button",RELATED_FETCH_TIME_BEFORE_VID_ENDS:5,SCRUBBER:"scrubber",SCRUBBER_TOOLTIP_CONTAINER:"scrubber-tooltip-container",SETTINGS_BTN:"settings-btn",SETTINGS_MENU:"settings-menu",SHARING_BTN:"sharing-btn",SHARING_MENU:"sharing-menu",SKIP_AD_BTN:"skip-ad-btn",SOUND_BTN:"sound-btn",SOUND_ICON:"sound-icon",STATIC_AD_CONTAINER:"static-ad-container",SUBTITLE_TEXT:"subtitle-text",SUBTITLE_BTN:"subtitle-btn",SUBTITLE_MENU:"subtitle-menu",TIME_TEXT:"time-text",TIMERAIL:"timerail",TIMERAIL_BUFFER:"timerail-buffer-bar",TIMERAIL_INTERACTIVE:"timerail-interactive",TIMERAIL_PROGRESS:"timerail-progress-bar",TITLE_TEXT:"title-text",TITLE_BAR:"title-bar",UI_DISABLED_CLASS:"bolt-disabled",UI_ENABLED_CLASS:"bolt-enabled",UI_HIGHLIGHT_CLASS:"bolt-hover-highlight",UNMUTE_BTN_OVERLAY:"unmute-btn-overlay",VIDEO_AD_CONTAINER:"video-ad-container",VIDEO_CONTAINER:"video-container",VIDEO_OVERLAY:"video-overlay",VOLUME_CONTROL:"volume-control",WATERMARK:"watermark",WATERMARK_IMG:"watermark-img",TOOLTIP_DELAY:1e3,Event:{PLAYER_CHANGED:"playerChanged",AGE_GATE_FAILED:"ageGateFailed",AGE_GATE_PASSED:"ageGatePassed",PLAYLIST_ITEM_SELECTED:"playlistItemSelected",PLAYPAUSE:"playpause",REQUEST_QUALITY:"requestQuality",RELATED_VIDEO_SELECTED:"relatedVideoSelected",REPLAY:"replay",SUBTITLE_SELECTED:"subtitleSelected",SEEK:"seek",TOGGLE_MUTE:"toggleMute",MOUSE_OUT:"mouseOut",MOUSE_OVER:"mouseOver",MOUSE_CLICK:"mouseClick",CHANGE_VOLUME:"changeVolume",REQUEST_FULLSCREEN_CHANGE:"requestFullscreenChange",APPEARANCE_SETTINGS_CHANGED:"appearanceChanged",INITIAL_APPEARANCE_SETTINGS_LOADED:"initialAppearanceSettingsLoaded"}}},window.ZeusConstants}),define("zeus_utils",["playerlogger","zeus_constants"],function(e,t){var r=window.BENCHMARK;Array.prototype.find||(Array.prototype.find=function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,r=Object(this),i=r.length>>>0,n=arguments[1],o=0;o<i;o++)if(t=r[o],e.call(n,t,o,r))return t}),Array.prototype.includes=Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return!1;for(var n=0|t,o=Math.max(n>=0?n:i-Math.abs(n),0);o<i;){if(function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}(r[o],e))return!0;o++}return!1}});var i={athenaFriendlyTimestamp:function(e){var t,r,i,n,o,a,s,l;return t=new Date(e),isNaN(t)&&(t=new Date("2000-01-01")),r=t.getUTCFullYear(),i=t.getUTCMonth()+1,n=t.getUTCDate(),o=t.getUTCHours(),a=t.getUTCMinutes(),s=t.getUTCSeconds(),l=t.getUTCMilliseconds(),i=("0"+i).slice(-2),n=("0"+n).slice(-2),o=("0"+o).slice(-2),a=("0"+a).slice(-2),s=("0"+s).slice(-2),r+"-"+i+"-"+n+" "+o+":"+a+":"+s+"."+l},hashCode:function(e){var t,r=0,i=0,n=e.length;if(0===n)return r;for(;i<n;i++)t=e.charCodeAt(i),r=(r<<5)-r+t,r&=r;return Math.abs(r)},makeSuperUniqueUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},splitHostName:function(e){var t={},r=new RegExp("([a-z-0-9]{2,63}).([a-z.]{2,5})$"),i=r.exec(e);return t.domain=i[1],t.type=i[2],t.subdomain=e.replace(t.domain+"."+t.type,"").slice(0,-1),t},objectPropExists:function(e){for(var t=Array.prototype.slice.call(arguments,1),r=0;r<t.length;r++){if(!e||!e.hasOwnProperty(t[r]))return!1;e=e[t[r]]}return!0},getCurrentVideoOwnerId:function(){var e=window.CurrentVideoConfig;return e["pregame"===e.settings.playerType?"id":"publisherId"]},getScreenPosition:function(e){for(var t=0,r=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,r+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:r}},toHHMMSS:function(e){var t=window.parseInt(e,10),r=Math.floor(t/3600),i=Math.floor((t-3600*r)/60),n=t-3600*r-60*i;r>0&&i<10&&(i="0"+i),n<10&&(n="0"+n);var o=r+":"+i+":"+n;return 0===window.parseInt(r,10)&&(o=i+":"+n),o},fastSeekEnabled:function(e){return!window.client.system.iphone&&(!/.m3u8/.test(e)&&/^https?:\/\/cdn(\..+?)?.(playwire|intergi).com/.test(e))},data:{sortNumericArray:function(e,t){return e.concat().sort(function(e,r){return e>r?t?-1:1:e<r?t?1:-1:0})},getUniqueArray:function(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t}},ad:{filterAdMedia:function(e){var r=window.client,i={};for(var n in e){var o=e[n];n===t.Mime.FLV||n===t.Mime.SWF?r.hasFlash&&"streaming"!=o.delivery&&(i[n]=o):n===t.Mime.MP4&&-1!=r.supportedVideoTypes.indexOf("mp4")?i[n]=o:n===t.Mime.OGG&&-1!=r.supportedVideoTypes.indexOf("ogg")?i[n]=o:n===t.Mime.WEBM&&-1!=r.supportedVideoTypes.indexOf("webm")?i[n]=o:"video/3gpp"===n&&-1!=r.supportedVideoTypes.indexOf("3gpp")?i[n]=o:n===t.Mime.M3U8&&-1!=r.supportedVideoTypes.indexOf("m3u8")?i[n]=o:"VPAID"!==o.apiFramework||"application/javascript"!==n&&"application/x-javascript"!==n||(i[n]=o)}return i},getBestMedia:function(e,t){if(!e||0===Object.keys(e).length)return i.log.warn("No supported media found"),null;var r;console.group("Finding best media"),i.log.info("supported media",e),i.log.info("priority",t);for(var n=0;n<t.length;n++){var o=t[n];if(e.hasOwnProperty(o)){r=e[o];break}}return i.log.info("BEST MEDIA",r),console.groupEnd(),r}},getPlayableMediaWithQuality:function(e,r,i){var n=t.Mime.MP4;r.indexOf(".webm")>-1?n=t.Mime.WEBM:r.indexOf(".flv")>-1?n=t.Mime.FLV:r.indexOf(".mov")>-1?n=t.Mime.MOV:r.indexOf(".swf")>-1?n=t.Mime.SWF:r.indexOf(".ogg")>-1?n=t.Mime.OGG:r.indexOf(".m3u8")>-1&&(n=t.Mime.M3U8);var o,a=null!=e[i]?i:"sd",s=e[a];for(var l in s)if(l===n){o=s[l];break}if(o)return{source:o,quality:a};if(LOG.warn("cannot find ",a,"source of type ",n,". Trying to find another video type."),o=this.selectSourceFile(s))return{source:o,quality:a};throw LOG.error("cannot find ",a,"video."),new Error("Cannot find media file with "+a+" quality")},selectSourceFile:function(e){var r,i,n=this,o=document.body,a=window.client,s=window.client.supportedVideoTypes;LOG.info("available media",e),LOG.info("supported video types",s);for(var l in e){r=e[l],i=l;var d=!1;if(i===t.Mime.M3U8?(d=s.indexOf("m3u8")>-1,d?n.css.removeClass(o,"m3u8_not_supported"):n.css.addClass(o,"m3u8_not_supported")):i===t.Mime.MP4?(d=s.indexOf("mp4")>-1,d?a.isMobile?n.css.removeClass(o,"mp4_not_supported"):n.css.removeClass(o,"flash_required"):a.isMobile?n.css.addClass(o,"mp4_not_supported"):n.css.addClass(o,"flash_required")):i===t.Mime.WEBM?(d=s.indexOf("webm")>-1,d?n.css.removeClass(o,"webm_not_supported"):n.css.addClass(o,"webm_not_supported")):i===t.Mime.OGG?(d=s.indexOf("ogg")>-1,d?n.css.removeClass(o,"ogg_not_supported"):n.css.addClass(o,"ogg_not_supported")):"video/3gpp"===i?(d=s.indexOf("3gpp")>-1,!d&&o?n.css.addClass(o,"threegpp_not_supported"):n.css.removeClass(o,"thregpp_not_supported")):i===t.Mime.FLV&&(d=s.indexOf("flv")>-1,d?n.css.removeClass(o,"flv_not_supported"):a.isMobile?n.css.addClass(o,"flv_not_supported"):n.css.addClass(o,"flash_required")),d)return r}return null},processMediaConfig:function(e,t,n){var o;if(e.f4m){var a=e.f4m;a=i.normalizeProtocol(a);var s=function(e){r.end("bolt_coreJSLoaded_to_manifestLoaded"),o=i.f4m.createNormalizedMediaDictionary(e,n),t.call(null,o)};r.end("bolt_coreJSLoaded_to_manifestRequested"),i.xhr(a,"get",null,s,function(){throw new Error("Cannot load f4m manifest: "+a)},"text")}else{var l=Object.keys(e);!isNaN(l[0])?(o=i.transformMedia(e),t.call(null,o)):t.call(null,e)}},f4m:{parse:function(e,t){var r,n=new DOMParser,o=n.parseFromString(e,"application/xml"),a=o.getElementsByTagName("baseURL")[0].textContent.trim();window.site.isSecure&&(a=0===a.indexOf("//")?"https:"+a:a.replace("http:","https:"));var s=(o.getElementsByTagName("id")[0].textContent,parseFloat(o.getElementsByTagName("duration")[0].textContent),o.getElementsByTagName("media"));if(s.length>1)try{var l=[];for(r=0;r<s.length;r++)l.push(s[r]);s=l.sort(function(e,t){var r=parseInt(e.getAttribute("bitrate")),i=parseInt(t.getAttribute("bitrate"));return r<i?-1:r>i?1:0})}catch(e){throw new Error("Cannot process Media List")}var d={};for(t||(t=window.client.supportedVideoTypes),r=0;r<s.length;r++){var u=s[r],c=u.getAttribute("url"),h=/.(mp4|m4v|ogg|webm|m3u8)/i,p=c.match(h);if(p&&(p=p[1],t.indexOf(p)>-1)){var f=i.f4m.attrToObject(a,u,p);"m4v"===p&&(p="mp4",f.fileExtension="mp4"),d[p]||(d[p]={}),"m3u8"===p?c.indexOf("abr-hd")>-1?d[p].hd=f:c.indexOf("abr-non-hd")>-1?d[p].sd=f:d[p].hd?d[p].sd||c.indexOf("video-sd")>-1&&(d[p].sd=f):c.indexOf("video-hd")>-1&&(d[p].hd=f):c.indexOf("video-hd")>-1?d[p].hd=f:c.indexOf("video-sd")>-1?d[p].sd=f:c.indexOf("video-mobile")>-1?d[p].mobile=f:c.indexOf("-hd")>-1?d[p].hd=f:d[p].sd=f}}return d},createNormalizedMediaDictionary:function(e,r){var n,o,a=i.f4m.parse(e,r);a.m3u8?(n=t.Mime.M3U8,o=a.m3u8):a.mp4?(n=t.Mime.MP4,o=a.mp4):a.webm?(n=t.Mime.WEBM,o=a.webm):a.ogg&&(n=t.Mime.OGG,o=a.ogg),window.client.isMobile?o.hd&&o.mobile?(o.sd=o.mobile,delete o.mobile):!o.hd&&o.sd&&o.mobile&&(o.hd=o.sd,o.sd=o.mobile,delete o.mobile):o.mobile&&delete o.mobile;var s={};return o.sd&&(s.sd={},s.sd[n]=o.sd.url),o.hd&&(s.hd={},s.hd[n]=o.hd.url),s},attrToObject:function(e,t,r){var i=t.getAttribute("url");return 0!==i.indexOf("http")&&(i=e+"/"+i),{fileExtension:r,url:i,bitrate:window.parseInt(t.getAttribute("bitrate"),0),width:window.parseInt(t.getAttribute("width"),0),height:window.parseInt(t.getAttribute("height"),0)}}},transformMedia:function(e){var t={},r=Object.keys(e);if(r=r.sort(function(e,t){return parseInt(t)-parseInt(e)}),r.length>2?client.isMobile?(t.hd=e[r[0]],t.sd=e[r[r.length-1]]):(t.hd=e[r[0]],t.sd=e[r[1]]):2==r.length?(t.hd=e[r[0]],t.sd=e[r[1]]):t.sd=e[r[0]],t.hd)for(var n in t.hd)t.hd[n]=i.normalizeProtocol(t.hd[n]);if(t.sd)for(var n in t.hd)t.sd[n]=i.normalizeProtocol(t.sd[n]);return t},log:e,timeLog:function(e,t){LOG.info(e,"in",Date.now()-t,"ms")},getDomainAndParameters:function(e){var t=/^(http:|https:)?\/\/([a-z0-9\.\-_]+)(\/.*)/i,r=t.exec(e);return{protocol:r[1],domain:r[2],parameters:r[3]}},getProxiedURL:function(e){var t=e;if(DebugMode.forceHTTPSProxy||window.site.isSecure&&CurrentVideoConfig.advertising.HTTPSProxy&&!DebugMode.forceNoHTTPSProxy){var r=i.getDomainAndParameters(t);if(function(e){return!("http:"!==e.protocol||/^.*\/zeus\//i.test(e.parameters)||/^cdn\..*playwire.com/i.test(e.domain)||/^config\..*playwire\.com/i.test(e.domain)||/^ads.intergi.com/i.test(e.domain))}(r)){LOG.info("[Bolt3 HTTPS-Proxy] Original URL: ",e);var n=r.parameters+"?origin=http://"+r.domain;LOG.info("[Bolt3 HTTPS-Proxy] Proxy params: ",n),t="https://director.playwire.com/"+window.btoa(n),LOG.info("[Bolt3 HTTPS-Proxy] Proxy request: ",t)}}return t},xhr:function(e,t,r,n,o,a,s,l,d){var u=e;/\/\/ads\.intergi\.com\//.test(u)&&(u=i.normalizeProtocol(e),/;cors=yes/.test(u)||(i.log.info("Append ;cors=yes parameter to ",u),u+=";cors=yes")),LOG.info("calling server",t,u,r,a,s),u=i.getProxiedURL(u);var c=/director.playwire.com/i.test(u);c||(u=i.normalizeProtocol(u));var h=c||d||/https/.test(u)&&/(playwire|intergi)/i.test(u)&&!/(ad\.doubleclick\.net)/i.test(u)&&!/(ads\.intergi\.com)/i.test(u);if(window.client.hasFlash&&h&&LOG.info("bypass CORS swf: ",u,window.Cors),!h&&window.Cors)LOG.debug("calling via cors shim",u),window.Cors.send(u,t,r,function(e){n&&n(e,s)},function(){LOG.info("Flash Cors failed. Retrying with XHR"),i.xhr(u,t,r,n,o,a,s,l,!0)},a);else{var p;if(9===window.client.browser.ie)u=window.site.isSecure?u.replace(/http:/gi,"https:"):u.replace(/https:/gi,"http:"),p=new XDomainRequest,p.onload=function(){var e=p.responseText;n&&n(e,s)},p.onprogress=function(){},p.ontimeout=function(){},p.onerror=function(){},p.open(t,u),setTimeout(function(){p.send(r)},0);else{if(p=new XMLHttpRequest,p.onreadystatechange=function(e){if(4===p.readyState)if(200===p.status||204===p.status){var t=200===p.status?p.responseText:"";n&&n(t,s)}else o&&o(s)},l)for(var f in l)l.hasOwnProperty(f)&&p.setRequestHeader(f,l[f]);p.open(t,u,!0),p.send(r)}}},xmlToJson:function(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var r=0;r<e.attributes.length;r++){var n=e.attributes.item(r);t["@attributes"][n.nodeName]=n.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var a=e.childNodes.item(o),s=a.nodeName;if(void 0===t[s])t[s]=i.xmlToJson(a);else{if(void 0===t[s].push){var l=t[s];t[s]=[],t[s].push(l)}t[s].push(i.xmlToJson(a))}}return t},getVPIPriority:function(){try{var e=["VPAID_JS"];return client.isMobile?client.supportedVideoTypes.indexOf("mp4")>=0&&e.push("MP4"):(e.push("VPAID"),e.push("MP4")),e}catch(e){LOG.debug("[Spotx Adapter] - Error getting VPI (file type) ",e)}return[]},isUsingSyndicatedAdTag:function(e){var t=i.splitHostName(window.parentBaseUrl);return!Object.keys(e.tags).includes(t.domain+"."+t.type)},spotx:{getSpotxCampaignIdRemoveExtra:function(e){var t=/-(.*)/;try{return t.exec(e)[1]}catch(t){return e}},adjustSpotxHBCPMs:function(e){return e=Math.floor(window.parseInt(e,10)/100).toFixed(2),e=e.toString().replace(".","_")},appendSpotxTagParams:function(e){var t;if(e.selectedServer&&e.selectedServer._getSpotxChannelId()){var r="search.spotxchange.com/vast/",n=r.length+4,o=e.adTagUrl.substring(e.adTagUrl.indexOf(r)+n,e.adTagUrl.indexOf(r)+n+6);e.adTagUrl=e.adTagUrl.replace(o,e.selectedServer._getSpotxChannelId())}return e.adTagUrl+=i.substituteMacros("?VPAID=js&custom_skin=1&content_page_url=__WEB_URL__&player_width=__WIDTH__&player_height=__HEIGHT__"),window.client.hasFlash&&(e.adTagUrl+="&allow_flash_creative=1"),!1!==window.CurrentVideoConfig.settings.autoplay&&(e.adTagUrl+="&ad_volume=0"),i.objectPropExists(window.prebidWinner,"video","hb_vast")&&(t=BoltAdManager.adjustSpotxHBCPMs(window.prebidWinner.video.hb_val),e.adTagUrl+="&token[hb_vast]="+encodeURIComponent(window.prebidWinner.video.hb_vast.replace(/(^\w+:|^)\/\//,""))+"&token[hb_val]="+t+"&token[hb_bidder]="+window.prebidWinner.video.hb_bidder+"&token[hb_adid]="+window.prebidWinner.video.hb_adid+"&custom[hb_bidder]="+window.prebidWinner.video.hb_bidder+"&custom[hb_val]="+t,window.prebidWinner.video.hb_uuid&&(e.adTagUrl+="&token[hb_uuid]="+window.prebidWinner.video.hb_uuid)),window.postLogMessage("[Zeus Ad Manager] - Using SpotX Server [Raw] tag"),e.adTagUrl},appendSpotxTagCustomParams:function(e){var t,r=window.CurrentVideoConfig,n=window.client,o=i.getCurrentVideoOwnerId().toString(),a=r.hostingId?r.hostingId.toString():o,s="true";try{s=i.isUsingSyndicatedAdTag(e.selectedServer).toString()}catch(e){window.LOG.error("[Spotx Adapter] - Failed to determine site tag is syndicated or not",e)}for(e.adTagUrl+="&custom[campaign_id]="+(e.triedCampaigns.length?e.triedCampaigns[e.triedCampaigns.length-1]:"0.0")+"&custom[channel]="+e.selectedServer.spotxChannelId+"&custom[content_page_url]="+window.parentBaseUrl+"&custom[player_height]="+window.innerHeight.toString()+"px&custom[player_width]="+window.innerWidth.toString()+"px&custom[adunit]="+e.timing+"&custom[device_type]="+(n.isMobile?"mobile":"desktop")+"&custom[owning_pub_id]="+(a||"")+"&custom[player]=bolt&custom[pub_id]="+(o||"")+"&custom[synd]="+s+"&custom[secure]="+(window.location.protocol.indexOf("https")>=0?"true":"false")+"&custom[vid_id]="+(i.objectPropExists(r,"content","videoId")?r.content.videoId||"":"")+"&custom[vpi]="+i.getVPIPriority().join(",")+"&custom[ws_id]="+(i.objectPropExists(e.selectedServer.siteTags,"id")?e.selectedServer.siteTags.id.toString():""),t=1;t<6;t++)e.adTagUrl+="&custom[cust_pub_reporting_"+t+"]="+BoltAdManager.getCustomReportingVal(t.toString());if(i.objectPropExists(e.selectedServer.siteTags,"placementIds"))for(t=0;t<e.selectedServer.siteTags.placementIds.length;t++)e.adTagUrl+="&custom[placement][]="+e.selectedServer.siteTags.placementIds[t]+"&custom[cp_placement][]="+e.selectedServer.siteTags.placementIds[t];if(i.objectPropExists(r,"categories"))for(t=0;t<r.categories.length;t++)e.adTagUrl+="&custom[vidcont_cat][]="+r.categories[t];return e.adTagUrl},getCustomReportingVal:function(e){var t,r=window.CurrentVideoConfig;return i.objectPropExists(r,"settings","customReporting")&&(t=r.settings.customReporting,i.objectPropExists(t,"custom[cust_pub_reporting_"+e.toString()+"]"))?t["custom[cust_pub_reporting_"+e.toString()+"]"]:""}},substituteMacros:function(e,t){var r=window.ContentPlayer,n=document.getElementById(r.containerId),o=n.getAttribute("data-default-src"),a=window.CurrentVideoConfig,s=(window.uid,document.getElementById("ad_"+window.id)),l=encodeURIComponent(a.settings.title),d=a.content.videoId,u=a.keywords||"",c=a.categories||"",h=r.getSource()?encodeURIComponent(r.getSource()):encodeURIComponent(o),p=client.system.ios||client.system.android||client.system.mac||client.system.win,f=Math.round(Math.random()*Math.pow(10,15)),g=Math.round((new Date).getTime()/1e3),v=s.clientWidth>0?n.clientWidth:window.Skin.clientWidth,m=s.clientHeight>0?n.clientHeight:window.Skin.clientHeight,y=window.site.href,_=i.getVPIPriority().join(","),b=!!t&&i.isUsingSyndicatedAdTag(t);return u.length&&(u=u.map(function(e){return encodeURIComponent(e)}).join("+")),c.length&&(c=c.map(function(e){return encodeURIComponent(e)}).join("+")),
e.replace("__WEB_URL__",encodeURIComponent(y)).replace("[LR_URL]",encodeURIComponent(y)).replace("[VIDEO_DESCRIPTION]",encodeURIComponent(y)).replace("=VIDEO_DESCRIPTION","="+encodeURIComponent(y)).replace("$HOST",encodeURIComponent(y)).replace("__TIME__",g).replace("[timestamp]",g).replace("[TIMESTAMP]",g).replace("$TIMESTAMP",g).replace("__CONTENT_URL__",h).replace("[VIDEO_FILE_URL]",h).replace("=VIDEO_URL","="+h).replace("__WIDTH__",v).replace("__HEIGHT__",m).replace("_WIDTH_",v).replace("_HEIGHT_",m).replace("$PLAYER_WIDTH",v).replace("$PLAYER_HEIGHT",m).replace(/__RANDOM__/g,f).replace("__TITLE__",l).replace("[VIDEO_TITLE]",l).replace("=VIDEO_TITLE","="+l).replace("__MEDIA_ID__",d).replace("=VIDEO_ID","="+d).replace("__UA__",encodeURIComponent(client.raw)).replace("_UA_",encodeURIComponent(client.raw)).replace("$USER_AGENT",encodeURIComponent(client.raw)).replace("__OS__",encodeURIComponent(navigator.platform)).replace("__DEVICE__",encodeURIComponent(client.device)).replace("__MODEL__",encodeURIComponent(client.device)).replace("__OSVERSION__",p).replace(/__UNIQUE_ID__/g,"").replace(/__UNIQUEID__/g,"").replace("__KEYWORDS__",u).replace("__CATEGORIES__",c).replace("__CATEGORY__",c).replace("[cellcarrier]",client.network.carrier||"").replace("[networkconnectiontype]",client.network.connection||"wifi").replace(/\[RANDOM\]/g,f).replace("$REFERRER",encodeURIComponent(y)).replace("__DEVICE_TYPE__",client.isMobile?"mobile":"desktop").replace("__HTTPS__",window.location.protocol.indexOf("https")>=0).replace("__PLAYER__","bolt").replace("__SYND__",b).replace("__VPI__",_).replace("$REGS_GDPR",window.shouldReadGDPRConsents?1:0).replace("$USER_CONSENT",window.gdprConsents?1:0)},css:{classListEnabled:void 0,isClassListEnabled:function(){return void 0===i.css.classListEnabled&&(i.css.classListEnabled=!window.client.browser.ie&&"classList"in document.createElement("_")),i.css.classListEnabled},hasClass:function(e,t){return i.css.isClassListEnabled()?e.classList.contains(t):new RegExp(" "+t+" ").test(" "+e.className+" ")},addClass:function(e,t){i.css.isClassListEnabled()?e.classList.add(t):i.css.hasClass(e,t)||(e.className+=" "+t)},removeClass:function(e,t){if(i.css.isClassListEnabled())e.classList.remove(t);else{var r=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(i.css.hasClass(e,t)){for(;r.indexOf(" "+t+" ")>=0;)r=r.replace(" "+t+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}}},toggleClass:function(e,t){if(i.css.isClassListEnabled())e.classList.remove(t);else{var r=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(i.css.hasClass(e,t)){for(;r.indexOf(" "+t+" ")>=0;)r=r.replace(" "+t+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}else e.className+=" "+t}},injectStyleSheet:void 0,inject:function(e){e=e.trim();var t,r,n,o,a=e.substr(0,e.indexOf("}"));if(r=i.css.injectStyleSheet||function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),i.css.injectStyleSheet=e.sheet,e.sheet}(),n=r.cssRules.length,e.length>a.length+1)for(a=e.split("}"),t=a.length,o=t-2;o>=0;o--)r.insertRule(a[o].concat("}"),n);else r.insertRule(e,n)},addLink:function(e,t,r,n){var o=[].slice.call(document.styleSheets);r||o.forEach(function(e,r){if(e.title==t)try{e.ownerNode.parentNode.removeChild(e.ownerNode)}catch(e){}});var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href",i.normalizeProtocol(e)),a.setAttribute("title",t),document.getElementsByTagName("head")[0].appendChild(a),"function"==typeof n&&(a.onload=function(){n.call()})},injectTricolorGradient:function(e,t,r,n,o){var a=e+"{background:-webkit-linear-gradient("+t+","+r+","+n+","+o+") !important;background:   -moz-linear-gradient("+t+","+r+","+n+","+o+") !important;background:    -ms-linear-gradient("+t+","+r+","+n+","+o+") !important;background:     -o-linear-gradient("+t+","+r+","+n+","+o+") !important;background:        linear-gradient("+t+","+r+","+n+","+o+") !important;}";i.css.inject(a)},injectBicolorGradient:function(e,t,r,n){var o=e+"{background:-webkit-linear-gradient("+t+","+r+","+n+" ) !important;background:   -moz-linear-gradient("+t+","+r+","+n+" ) !important;background:    -ms-linear-gradient("+t+","+r+","+n+" ) !important;background:     -o-linear-gradient("+t+","+r+","+n+" ) !important;background:        linear-gradient("+t+","+r+","+n+" ) !important;}";i.css.inject(o)},getStyleSheetOfClass:function(e,t){var r,i=document.querySelector(e);i||(i=document.createElement("div"),i.setAttribute("style","width:1px;height:1px;position:absolute;bottom:0"),document.body.appendChild(i),r=i);var n=getComputedStyle(i)[t];return r&&document.body.removeChild(r),n},setUAClass:function(){var e=window.document.body,t=i.dom,r=i.css,n=window.client;n.isMobile?(r.addClass(e,"bolt-mobile"),t.removeElementsByClass("bolt-not-mobile")):(r.addClass(e,"bolt-desktop"),t.removeElementsByClass("not-desktop")),n.system.android?(r.addClass(e,"bolt-android"),t.removeElementsByClass("not-android"),n.browser.chrome||n.browser.opera||!n.engine.webkit||(r.addClass(e,"bolt-webkit"),r.addClass(e,"bolt-stock"))):n.system.ios&&(r.addClass(e,"bolt-ios"),r.addClass(e,"bolt-ios-"+n.system.ios.replace(/\./g,"_")),t.removeElementsByClass("not-ios"),n.system.iphone?(r.addClass(e,"bolt-iphone"),t.removeElementsByClass("not-iphone")):n.system.ipad&&(r.addClass(e,"bolt-ipad"),t.removeElementsByClass("not-ipad"))),n.system.win?(r.addClass(e,"bolt-windows"),r.addClass(e,"bolt-windows-"+n.system.win)):n.system.mac?(r.addClass(e,"bolt-mac"),r.addClass(e,"bolt-mac-"+n.system.mac.replace(/\./g,"_"))):n.system.x11&&!n.system.android&&r.addClass(e,"bolt-linux"),n.browser.ie&&(r.addClass(e,"bolt-ie"),n.browser.ie>=11?r.addClass(e,"bolt-ie-11"):10==n.browser.ie?r.addClass(e,"bolt-ie-10"):9==n.browser.ie?r.addClass(e,"bolt-ie-9"):n.browser.ie<9&&r.addClass(e,"bolt-ie-unsupported")),n.browser.chrome&&(r.addClass(e,"bolt-chrome"),r.addClass(e,"bolt-chrome-"+n.browser.chrome)),n.browser.firefox&&(r.addClass(e,"bolt-firefox"),r.addClass(e,"bolt-firefox-"+n.browser.firefox)),n.browser.safari&&!n.system.android&&(r.addClass(e,"bolt-safari"),r.addClass(e,"bolt-safari-"+n.browser.safari)),n.browser.opera&&(r.addClass(e,"bolt-opera"),r.addClass(e,"bolt-opera-"+n.browser.opera)),n.browser.konq&&(r.addClass(e,"bolt-konqueror"),r.addClass(e,"bolt-konqueror-"+n.browser.konq)),n.hasTouch&&r.addClass(e,"bolt-touch"),n.hasFlash&&r.addClass(e,"bolt-flash")},setSizeClass:function(e){var t=window.Skin,r=i.css;e<=400?r.addClass(t,"bolt-small"):r.removeClass(t,"bolt-small")},setFeatureClass:function(){for(var e in PlayerSettings){var t="bolt-"+e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),r=PlayerSettings[e];!1===r?(i.css.removeClass(Skin,t+"-enabled"),i.css.addClass(Skin,t+"-disabled")):!0===r&&(i.css.removeClass(Skin,t+"-disabled"),i.css.addClass(Skin,t+"-enabled"))}}},normalizeProtocol:function(e){if(!e)return e;if(0===e.indexOf("//")){var t=window.site.isSecure?"https:":"http:";e=t+e,LOG.debug("normalize relative protocol to "+t,e)}else window.site.isSecure&&0===e.indexOf("http:")&&(e=e.replace(/http:/gi,"https:"),LOG.debug("normalize http protocol to https",e));return e},extends:function(e,t){return(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e})(e,t)},mergeObject:function(e,t,r){function i(e,t,r){var n=Array.isArray(t),o=n&&[]||{};return n?(e=e||[],o=o.concat(e),t.forEach(function(t,n){void 0===o[n]?o[n]=t:"object"==typeof t?o[n]=i(e[n],t,r):-1===e.indexOf(t)&&o.push(t)})):(e&&"object"==typeof e&&Object.keys(e).forEach(function(t){o[t]=e[t]}),Object.keys(t).forEach(function(n){"object"==typeof t[n]&&t[n]?e[n]?"object"==typeof t[n]?o[n]=i(e[n],t[n],r):o[n]=e[n]?e[n]:t[n]:o[n]=t[n]:o[n]=r?t[n]:null!=t[n]?t[n]:e[n]})),o}return i(e,t,r)},mergeSettings:function(e,t){e.hasOwnProperty("defaultHD")&&(e.defaultHd=e.defaultHD,delete e.defaultHD);var r=i.mergeObject({},e),n=["scriptId","width","container","id","forceAds","onready","width","height","appearance","watermark","videoId","title","minAge","playlist","playlistPlaythrough"];return Object.keys(t).forEach(function(e){-1===n.indexOf(e)&&(r[e]=t[e],LOG.info("override video setting:",e,"with embed setting :",r[e]))}),t.appearance?r.appearance=i.mergeObject(e.appearance||{},t.appearance):e.appearance&&(r.appearance=e.appearance),t.appearance=r.appearance,t.watermark?r.watermark=i.mergeObject(e.watermark||{},t.watermark):e.watermark&&(r.watermark=e.watermark),t.watermark=r.watermark,LOG.info("new video settings",r,"playersettings",window.PlayerSettings),r},loadVideoConfig:function(e,t,r){i.xhr(e,"get",null,function(r,i){try{var n=JSON.parse(r);"off"===PlayerSettings.advertising&&(n.advertising.on=!1),t(n,i)}catch(t){throw LOG.error(t),new Error("Cannot parse video config: "+e)}},function(t){throw new Error("Cannot load video config: "+e)})},dom:{isEnabled:function(e){return!i.css.hasClass(e,t.UI.UI_DISABLED_CLASS)},isVisible:function(e){var t=this,r="string"==typeof e?t.getUI(e):e;return!!r&&!("none"===window.getComputedStyle(r,null).getPropertyValue("display"))},enableUI:function(e,r){var n=i.dom,o=i.css,a=t.UI,s=n.getUI(e);if(s){LOG.info("enable UI",e,r);var l=s.nextElementSibling;r?(o.addClass(s,a.UI_ENABLED_CLASS),o.removeClass(s,a.UI_DISABLED_CLASS),l&&o.hasClass(l,"bolt-separator")&&o.removeClass(l,a.UI_DISABLED_CLASS)):(o.removeClass(s,a.UI_ENABLED_CLASS),o.addClass(s,a.UI_DISABLED_CLASS),l&&o.hasClass(l,"bolt-separator")&&o.addClass(l,a.UI_DISABLED_CLASS)),client.isMobile||(r?o.addClass(s,a.UI_HIGHLIGHT_CLASS):o.removeClass(s,a.UI_HIGHLIGHT_CLASS)),s.setAttribute("data-bolt-ui-enabled",r)}},getUI:function(e){try{return document.getElementById(e)}catch(t){throw LOG.warn("cannot find UI ",e),new Error("Cannot find UI Element: "+e)}},hideElement:function(e,t){var r=i.dom,n="string"==typeof e?r.getUI(e):e;if(n){n.hasAttribute("data-bolt-original-display")||n.setAttribute("data-bolt-original-display",getComputedStyle(n).display);var o=n.getAttribute("data-bolt-original-display");n.style.display=0!=t?"none":o,n.hasAttribute("data-bolt-original-visibility")||n.setAttribute("data-bolt-original-visibility",getComputedStyle(n).visibility),n.style.visibility="hidden";var a=n.nextElementSibling;a&&i.css.hasClass(a,"bolt-separator")&&r.hideElement(a)}},showElement:function(e,t,r){var n=i.dom,o="string"==typeof e?n.getUI(e):e;if(o){var a=o.getAttribute("data-bolt-original-display");a||(a=getComputedStyle(o).display,o.setAttribute("data-bolt-original-display",a)),o.style.display=void 0===t?"none"!=a?a:"block":t;var s=o.getAttribute("data-bolt-original-visibility");s||(s=getComputedStyle(o).visibility,o.setAttribute("data-bolt-original-visibility",s)),o.style.visibility=void 0===r?"hidden"!=s?s:"visible":r;var l=o.nextElementSibling;l&&i.css.hasClass(l,"bolt-separator")&&n.showElement(l)}},removeElement:function(e){var t=i.dom,r=i.css,n="string"==typeof e?t.getUI(e):e;if(n){var o=n.nextElementSibling;o&&r.hasClass(o,"bolt-separator")&&t.removeElement(o);try{n.parentNode.removeChild(n)}catch(e){}}},removeElementsByClass:function(e){for(var t=window.Skin.querySelectorAll("*[class*='"+e+"']"),r=0;r<t.length;r++){var n=t[r];i.dom.removeElement(n)}}},animation:{events:{end:"AnimationEnd",start:"AnimationStart"},addListener:function(e,t,r){for(var i=["webkit","moz","MS","o",""],n=e,o=0;o<i.length;o++)i[o]||(n=n.toLowerCase()),t.addEventListener(i[o]+n,r,!1)},removeListener:function(e,t,r){for(var i=["webkit","moz","MS","o",""],n=e,o=0;o<i.length;o++)i[o]||(n=n.toLowerCase()),t.removeEventListener(i[o]+n,r,!1)}},stripProtocol:function(e){var t=e;try{t=/:\/\/(.[^\/]+)/.exec(e)[1]}catch(e){}return t}};return window.ZeusUtils=i,window.LOG=window.LOG||i.log,i}),define("zeus_eventdispatcher",["stapes"],function(e){var t=e.subclass({_dispatchEvent:function(e,t,r){var i=this;if("string"==typeof e)i.emit(e,{type:e,target:r||i,data:t});else if("object"==typeof e&&e.hasOwnProperty("type")){var n=e;i.emit(n.type,{target:n.target,type:n.type,data:n.data})}},addOnceEventListener:function(e,t,r){this.on(e,t,r,!0)},addEventListener:function(e,t,r){this.on(e,t,r)},removeEventListener:function(e,t){this.off(e,t)},removeAllListeners:function(e){this.off(e)}});return t.mixin=function(t){e.mixinEvents(t);var r;r=void 0!==t.prototype?t.prototype:t,r._dispatchEvent=function(e,r,i){if("string"==typeof e)t.emit(e,{type:e,target:i||t,data:r});else if("object"==typeof e&&e.hasOwnProperty("type")){var n=e;t.emit(n.type,{type:n.type,target:n.target,data:n.data})}},r.addOnceEventListener=function(e,r,i){t.on(e,r,i,!0)},r.addEventListener=function(e,r,i){t.on(e,r,i)},r.removeEventListener=function(e,r){t.off(e,r)},r.removeAllListeners=function(e){t.off(e)}},t}),define("viewability",["zeus_eventdispatcher"],function(e){return new(e.subclass({constructor:function(){this.data=null,this.autoPaused=!1,this.userDidPause=!1},update:function(e){var t=this,r=!0;t.data&&(r=t.data.top!=e.top||t.data.left!=e.left||t.data.right!=e.right||t.data.bottom!=e.bottom||t.data.percent!=e.percent),r&&(this.data=e,this._dispatchEvent("changed",this.data))},requestMetrics:function(){var e={type:"zeus_event",name:"requestViewabilityMetrics",id:window.id};window.parent.postMessage(JSON.stringify(e),"*")}}))}),define("zeus_controller",["zeus_utils","viewability"],function(e,t){var r,i,n,o,a,s,l,d,u=window,c=u.BENCHMARK,h=u.ZeusConstants,p=u.client,f=!1,g=e.dom,v=!0,m=null,y=null,_=null,b=null,E=null,A=function(){c.end("bolt_coreJSLoaded_to_controllerStartUp"),s=u.LOG,r=u.PlayerView,i=u.ContentPlayer,n=u.BoltAdManager,o=u.PlayerState,a=u.PlayerSettings,l=u.DebugMode,s.debug("START UP",p.isMobile?"MOBILE":"DESKTOP"),d=u.pageViews;var e=a.skips||0;if(v=d>e,v||u.postLogMessage("Preroll is disabled because the video has been viewed more than "+e+" times","warn"),s.info("pageviews",d,"to skip",e),a.pageviewForAds){for(var t=a.pageviewForAds.split(","),f=0;f<t.length;f++)t[f]=parseInt(t[f]);s.info("viewsForAds",t),v=t.indexOf(d)>-1}if(s.debug("preroll enabled",v),!v&&("pregame"===a.playerType||"precontent"===a.playerType))return void N();void 0!==document.visibilityState&&document.addEventListener("visibilitychange",X),r.addEventListener(h.Player.Event.VIEW_READY,function(e){p.showHideIframe&&Zeus.dispatchEvent("showiframe"),u.CurrentVideoConfig.settings.minAge>0?(o.state=o.AGE_GATE,r.addOnceEventListener(h.UI.Event.AGE_GATE_PASSED,function(){s.debug("Controller::age gate passed"),S()})):(s.debug("Controller::no age gate"),S())}),!0===a.adOnly?r.init(!1):require(["related_videos_helper","content_helper","playlist_helper","overlay_ad_cue_finder"],function(e,t,i,n){_=e,b=t,E=i,m=new n,r.init(u.CurrentVideoConfig.settings.minAge>0)})},S=function(){function r(){if(a.autoplay)if(a.minimumViewability){var e=a.minimumViewability;t.addOnceEventListener("changed",function(r){r.data.percent>=e?(s.info("[Bolt3 Controller] viewability metrics above threshold. Start autoplay."),k()):(s.info("[Bolt3 Controller] viewability metrics below threshold. Defer autoplay."),o.state=o.START),autoplayWhenViewabilityMetricsChanged=!0,t.addEventListener("changed",K)}),t.requestMetrics()}else k();else o.state=o.START,a.minimumViewability&&(t.requestMetrics(),t.addEventListener("changed",K))}function d(){!l.noPreroll&&n&&n.prefetchEnabled?(s.info("[Bolt3 controller] prefetch preroll"),o.state=o.WAITING,n.prefetchAds("preroll",r)):r()}if(s.debug("DO START UP"),n){n.addEventListener(h.Ad.Event.VMAP_CUEPOINTS_CHANGED,function(t){CurrentVideoConfig.advertising.cuepoints||(CurrentVideoConfig.advertising.cuepoints=[]),CurrentVideoConfig.advertising.cuepoints=CurrentVideoConfig.advertising.cuepoints.concat(t.data),CurrentVideoConfig.advertising.cuepoints=e.data.sortNumericArray(e.data.getUniqueArray(CurrentVideoConfig.advertising.cuepoints)),s.info("VMAP CUEPOINTS CHANGED, new cps",t.data,CurrentVideoConfig.advertising.cuepoints),i&&(i.adsCuepoints=CurrentVideoConfig.advertising.cuepoints.concat())});var c=u.CurrentVideoConfig.advertising.prefetch;l.forcePrefetch&&!l.noPreroll?c=!0:l.forceNoPrefetch&&(c=!1),n.prefetchEnabled=c}i.pseudoAdsCuepoints=[],i.videoAdRatio=void 0!==u.CurrentVideoConfig.advertising.videoAdRatio?u.CurrentVideoConfig.advertising.videoAdRatio:1,i.videoPlayCount=1,w(),u.readyCallback.call(null,i.containerId),p.hasFlash?require(["zeus_cors_shim"],function(e){window.Cors=new e(d)}):d()},w=function(){r.addEventListener(h.Media.Event.PLAY,T),r.addEventListener(h.Media.Event.PLAYING,T),r.addEventListener(h.Media.Event.PAUSED,T),r.addEventListener(h.Media.Event.RESUME,T),r.addEventListener(h.Media.Event.DURATION_CHANGE,T),r.addEventListener(h.Media.Event.ENDED,T),r.addEventListener(h.Media.Event.TIME_UPDATE,T),r.addEventListener(h.Media.Event.LOADED,T),r.addEventListener(h.Media.Event.MUTED,T),r.addEventListener(h.Media.Event.UNMUTED,T),r.addEventListener(h.Media.Event.VOLUME_CHANGED,T),r.addEventListener(h.Media.Event.WAITING,T),r.addEventListener(h.UI.Event.REPLAY,L),r.addEventListener(h.UI.Event.PLAYPAUSE,L),r.addEventListener(h.UI.Event.PLAYLIST_ITEM_SELECTED,L),r.addEventListener(h.UI.Event.TOGGLE_MUTE,L),r.addEventListener(h.UI.Event.CHANGE_VOLUME,L),r.addEventListener(h.UI.Event.SUBTITLE_SELECTED,L),r.addEventListener(h.UI.Event.SEEK,L),r.addEventListener(h.UI.Event.RELATED_VIDEO_SELECTED,L),r.addEventListener(h.UI.Event.REQUEST_QUALITY,L),r.addEventListener(h.UI.Event.AGE_GATE_FAILED,L)},T=function(e){var r=e.target;switch(e.type){case h.Media.Event.PLAY:s.debug("PlayerView media events",e.type,r.containerId),r.isAd()||o.delayedWaitingState(500);break;case h.Media.Event.PLAYING:o.state=o.PLAYING,a.minimumViewability&&(t.data.percent<a.minimumViewability&&t.userDidPause?s.info(["Bolt3 Controller::handleViewMediaEvents] Viewability below threshold. Pause."]):t.autoPaused=!1),r.isAd()||void 0===document.visibilityState||"hidden"!==document.visibilityState||G();break;case h.Media.Event.PAUSED:o.state=o.PAUSED;break;case h.Media.Event.RESUME:s.debug("PlayerView media events",e.type,r.containerId);break;case h.Media.Event.ENDED:s.debug("PlayerView media events",e.type,r.containerId),o.state=o.ENDED,r.isAd()||(n&&n.prefetchEnabled&&!l.noPostroll?n.prefetchAds("postroll",x):x());break;case h.Media.Event.DURATION_CHANGE:s.debug("PlayerView media events",e.type,r.containerId),o.data.duration=i.duration,!r.isAd()&&u.CurrentVideoConfig.advertising.on?(m.reset(!0,i.duration),n&&n.prefetchEnabled&&i.duration>=45&&n.prefetchAds("overlay"),I()):window.AdBlockDetected&&(m.reset(!0,i.duration),I());break;case h.Media.Event.TIME_UPDATE:r.playing&&!r.paused&&(o.state=o.PLAYING,o.data.currentTime=i.currentTime,M());break;case h.Media.Event.LOADED:s.debug("PlayerView media events",e.type,r.containerId);break;case h.Media.Event.WAITING:r.isAd()?o.state=o.WAITING:o.delayedWaitingState(500);break;case h.Media.Event.MUTED:o.data.muted=a.automute=!0;break;case h.Media.Event.UNMUTED:o.data.muted=a.automute=!1;break;case h.Media.Event.VOLUME_CHANGED:o.data.currentVolume=a.volume=e.data}},L=function(e){var t=r.currentPlayer;switch(e.type){case h.UI.Event.REPLAY:case h.UI.Event.PLAYPAUSE:V();break;case h.UI.Event.PLAYLIST_ITEM_SELECTED:E.loadPlaylistVideo(e.data,!0);break;case h.UI.Event.TOGGLE_MUTE:s.info(e.type,"volume",t.volume);var i=!t.muted;s.info("mute flag?",i),t.mute(i),!1===i&&0===t.volume&&t.setVolume(1);break;case h.UI.Event.CHANGE_VOLUME:s.info(e.type,e.data),t.setVolume(e.data),t.mute(0===e.data);break;case h.UI.Event.SEEK:R(e.data);break;case h.UI.Event.RELATED_VIDEO_SELECTED:t.autoplay=!0,_.loadSelectedRelatedVideo(e.data);break;case h.UI.Event.REQUEST_QUALITY:var n=""===t.getSource();b.loadVideoWithQuality(e.data,u.CurrentVideoConfig.content.media,n,!n);break;case h.UI.Event.AGE_GATE_FAILED:s.warn("age gate failed"),o.state=o.AGE_GATE;break;case h.UI.Event.AGE_GATE_PASSED:s.info("age gate passed"),o.state=o.START}},I=function(){if(s.info("Create ads cuepoints",u.CurrentVideoConfig.advertising.cuepoints,i.adsCuepoints),void 0===i.adsCuepoints||0===i.adsCuepoints.length){if(i.pseudoAdsCuepoints=null,"number"==typeof u.CurrentVideoConfig.advertising.secondsBetweenAds&&u.CurrentVideoConfig.advertising.secondsBetweenAds>0){s.info("Create pseudo cuepoints");for(var e=u.CurrentVideoConfig.advertising.secondsBetweenAds,t=e;t<i.duration;t+=e)i.pseudoAdsCuepoints||(i.pseudoAdsCuepoints=[]),i.pseudoAdsCuepoints.push(t)}}else window.AdBlockDetected||r.drawCuepoints()},C=function(){var e=r.currentPlayer;e.isAd()||(s.debug("ZeusController::replay",u.CurrentVideoConfig.settings.title),e.replay(),e.videoPlayCount++,m.reset(!1,e.duration))},P=function(e){function t(){window.AdSession.adLoaded()}function r(){window.AdSession.fail()}function i(){window.AdSession.abort()}function o(){window.AdSession.complete()}!function(){n.removeEventListener(h.Media.Event.LOADED,t),n.removeEventListener(h.Media.Event.ENDED,o),n.removeEventListener(h.Ad.Event.FAILED,r),n.removeEventListener(h.Ad.Event.ABORTED,i)}(),n.requestOverlay(m.lastVideoAdCuepoint,function(){n.addEventListener(h.Media.Event.LOADED,t),n.addEventListener(h.Media.Event.ENDED,o),n.addEventListener(h.Ad.Event.FAILED,r),n.addEventListener(h.Ad.Event.ABORTED,i)},function(){m.skip=!0})},M=function(){var e=r.currentPlayer;if(o.state=o.PLAYING,!e.isAd()){var t=e.currentTime,i=null,a=null,d=!1;if(n&&n.hasVMAPBreak(t))return s.info("AdManager has a VMAP break at "+t),void D(parseInt(t));if(e.adsCuepoints&&e.adsCuepoints.length>0?(a=e.adsCuepoints,d=!1):e.pseudoAdsCuepoints&&e.pseudoAdsCuepoints.length>0&&(a=e.pseudoAdsCuepoints,d=!0),!p.system.iphone&&!r.IPadNativeFullscreen&&(a&&(m.nextVideoAdCuepoint=a[0]),t>=15&&e.duration>45)){var c=u.Skin;if(!m.skip&&m.hasCueForTime(t,c.clientWidth,c.clientHeight))return void(u.CurrentVideoConfig.advertising.on&&!l.noOverlay?(s.info("Requesting an overlay ad @",t),P()):AdBlockDetected&&window.AdBlocked.track("overlay"))}if(!l.noMidroll&&a){for(var f=0;f<a.length;f++){if(a[f]<e.currentTime){i=a.shift(),d||e.hitAdCuepoint(i);break}}i&&(y=i,d||r.drawCuepoints(),m.lastVideoAdCuepoint=i,m.nextVideoAdCuepoint=a[0],s.debug("Controller:ontimeupdate playmidroll",i,"currentTime",e.currentTime),D())}e.currentTime>=e.duration-h.UI.RELATED_FETCH_TIME_BEFORE_VID_ENDS&&_.shouldAttemptPrefetch()&&(_.fetch({}),s.info("Fetch related videos "+h.UI.RELATED_FETCH_TIME_BEFORE_VID_ENDS+" before video ends"))}},R=function(e){var t=r.currentPlayer;if(!t.isAd()){var i=e;if(o.state=o.WAITING,!l.noMidroll&&u.CurrentVideoConfig.advertising.on){var n=t.adsCuepoints;if(n.length>0)for(var a=0;a<n.length;a++){var s=n[a];if(s<e){i=s;break}}}t.seek(i)}},O=function(t,l,d,u){function c(){n.removeEventListener(h.Media.Event.LOADED,v),n.removeEventListener(h.Media.Event.ENDED,m),n.removeEventListener(h.Ad.Event.FAILED,_),n.removeEventListener(h.Ad.Event.ABORTED,b),n.removeEventListener(h.Ad.Event.TAG_NOT_AVAILABLE,f)}function f(){c(),d()}function v(){window.AdSession.adLoaded(),n.removeEventListener(h.Media.Event.LOADED,v),s.debug("ZeusController::requestAd hit the ad loaded listener for a "+t),e.css.addClass(Skin,"bolt-ad-type-"+n.type);var o=null;n.type===h.Ad.Type.VAST||n.type===h.Ad.Type.FLASH_VPAID?o=n.adPlayer.adPlayer:n.type===h.Ad.Type.GOOGLE||n.type===h.Ad.Type.GOOGLE_DCM_VPAID?(s.debug(this,"GOOGLE AD LOADED"),o=n.adPlayer):o=n.adPlayer,s.debug("zeuscontroller :: got a linear ad",t),"preroll"===t||"midroll"===t?((p.system.iphone||r.IPadNativeFullscreen)&&i.addOnceEventListener(h.Media.Event.PAUSED,function(){s.debug("exiting fullscreen"),i.video.webkitExitFullscreen()}),s.debug("about to pause the player"),i.pause()):"postroll"===t&&(p.system.iphone||r.IPadNativeFullscreen)&&(s.debug("exiting fullscreen"),i.video.webkitExitFullscreen()),r.setCurrentPlayer(o),n.type!==h.Ad.Type.GOOGLE_DCM_VPAID&&n.type!==h.Ad.Type.GOOGLE&&o.type!==h.Ad.Type.FLASH_VPAID&&o.type!==h.Ad.Type.JS_VPAID&&o.play(),g.hideElement(h.UI.LOADING_INDICATOR),l()}function m(){window.AdSession.complete(),c(),s.debug("hit the ad completed listener for a "+t),e.css.removeClass(Skin,"bolt-ad-type-"+n.type),n.remove(),g.hideElement(h.UI.LOADING_INDICATOR),n.VMAPBreaksForCurrentAdTiming&&n.VMAPBreaksForCurrentAdTiming.length>0?O(t,l,d,u):"pregame"===a.playerType||"precontent"===a.playerType?N(i):(r.setCurrentPlayer(i),d())}function _(){window.AdSession.fail(),s.debug("hit the ad failed listener for a "+t),c(),n.remove(),r._dispatchEvent(h.Ad.Event.FAILED,{timing:t}),"pregame"===a.playerType||"precontent"===a.playerType?N(i):(r.setCurrentPlayer(i),g.hideElement(h.UI.LOADING_INDICATOR),d())}function b(){window.AdSession.abort(),e.log.warn("Ad aborted"),e.css.removeClass(Skin,"bolt-ad-type-"+n.type),c(),r.setCurrentPlayer(i)}function E(){n.requestAd(t,A,function(){g.showElement(h.UI.AD_CONTAINER,"block","hidden"),n.addEventListener(h.Media.Event.LOADED,v),n.addEventListener(h.Media.Event.ENDED,m),n.addEventListener(h.Ad.Event.FAILED,_),n.addEventListener(h.Ad.Event.ABORTED,b),n.addEventListener(h.Ad.Event.TAG_NOT_AVAILABLE,f)})}"midroll"!==t&&(o.state=o.WAITING);var A=y||("preroll"===t?-1:99999999999);"midroll"===t&&u&&(A=u),window.shouldReadGDPRConsents&&void 0===window.gdprConsents?(s.info("[zeuscontroller _requestAd] querying GDPR"),window.MessageChannel.sendRequest("gdprConsents",function(e){s.info("[zeuscontroller _requestAd] received GDPR consents:",e),window.gdprConsents=e,E()})):E()},k=function(t,r){if(AdBlockDetected&&window.AdBlocked.track("preroll"),o.state=o.PLAYING,u.CurrentVideoConfig.advertising.on||u.postLogMessage("Advertising is disabled for the current video","warn"),!l.noPreroll&&n&&v&&u.CurrentVideoConfig.advertising.on&&(i.videoPlayCount-1)%i.videoAdRatio==0){s.debug("[Zeus Controller] - playPrerollAd");var d=function(){},c=function(){if(s.info("[Zeus Controller] - Preroll finished callback"),a.adLoop)return s.info("[Zeus Controller] - Replaying preroll ads"),void h();if(n.prefetchEnabled){var e=u.CurrentVideoConfig.advertising.cuepoints||[];!l.noMidroll&&e.length>0&&n.prefetchAds("midroll")}p.isMobile?setTimeout(function(){"function"==typeof t?t():B()},500):"function"==typeof t?t():B()},h=function(){O("preroll",d,c)};if(n.prefetchEnabled&&!r)s.info("[Bolt3 controller] prefetch preroll"),o.state=o.WAITING,n.prefetchAds("preroll",h);else{var f=l.delayedPreroll;e.objectPropExists(n.selectedServer,"siteTags","delayedPreroll")&&(f=n.selectedServer.siteTags.delayedPreroll||l.delayedPreroll),s.info("[Zeus Controller] - Delayed Preroll "+(f?"Enabled":"Disabled")),f&&"pregame"!==a.playerType&&"precontent"!==a.playerType&&B(),h()}}else p.isMobile?setTimeout(function(){"function"==typeof t?t():B()},500):"function"==typeof t?t():B()},D=function(e){if(AdBlockDetected&&window.AdBlocked.track("midroll"),!l.noMidroll&&n&&u.CurrentVideoConfig.advertising.on&&(i.videoPlayCount-1)%i.videoAdRatio==0){O("midroll",function(){},function(){s.info("Midroll finished callback");var e=u.CurrentVideoConfig.advertising.cuepoints||[];if(e.length>0){n.prefetchEnabled&&(s.info("[Bolt3 controller] refill midroll pool"),n.prefetchAds("midroll",null,!0),i.duration>45e3&&(s.info("[Bolt3 controller] refill overlay pool"),n.prefetchAds("overlay",null,!0)));var t=e.length+1;t<10&&(t="0"+t);var r=i.previousCuepointIndex+2;r<10&&(r="0"+r)}F()},e)}},x=function(){if(AdBlockDetected&&window.AdBlocked.track("postroll"),s.debug("postroll","video play count",i.videoPlayCount,"videoAdRatio",i.videoAdRatio),o.state=o.WAITING,!l.noPostroll&&n&&u.CurrentVideoConfig.advertising.on&&(i.videoPlayCount-1)%i.videoAdRatio==0){var e=function(){},t=function(){s.info("Postroll finished callback");var e=!1;if(u.Playlist)return void E.processPlaylist();if(i.loop?e=!0:((p.system.iphone||r.IPadNativeFullscreen)&&i.video.webkitExitFullscreen(),i.show(!1)),s.debug("replay after postroll",e),e)var t=setTimeout(function(){clearTimeout(t),s.debug("postroll finished, auto replay"),k()},100);else u.CurrentVideoConfig.related?(o.state=o.WAITING,_.showRelatedVideosMenu()):o.state=o.START};u.Playlist&&u.CurrentPlaylistIndex!==u.Playlist.length-1?E.processPlaylist():(o.state=o.WAITING,O("postroll",e,t))}else u.Playlist?E.processPlaylist():i.loop?B():u.CurrentVideoConfig.related?(o.state=o.WAITING,_.showRelatedVideosMenu()):o.state=o.START},N=function(){var e=a.hiddenContainer||a.postAdContainer;e&&(s.info("showing post content container",e),Zeus.dispatchEvent("showHiddenContainer",{hcId:e}))},U=function(e,t,i){r.size(t,i)},B=function(){var e=r.currentPlayer;if(e)if(e.hasStarted)e.paused&&F();else if(e.ended)C();else{if(s.debug("ZeusController::_play"),o.delayedWaitingState(500),"native"!==e.type&&"hls_xt"!==e.type||e.preload(),e.play(),1===e.videoPlayCount){var t=u.CurrentVideoConfig.advertising.cuepoints||[];if(t.length>0){var i=t.length+1;i<10&&(i="0"+i)}}e.videoPlayCount++}},G=function(e){var i=r.currentPlayer;!i||i.isAd()&&!i.spotxScriptUrl||(s.debug("[Zeus Controller] - pause"),o.state=o.PAUSED,i.pause(),t.autoPaused=e,t.userDidPause||e||(t.userDidPause=!0),void 0!==document.visibilityState&&"hidden"!==document.visibilityState&&(f=!0))},V=function(){p.isMobile&&n&&!n.hasBeenTouched&&(s.debug("touching ad video element"),n.videoElement&&(n.videoElement.src="",n.videoElement.load()),n.hasBeenTouched=!0);var e=r.currentPlayer;if(e){if(s.debug("togglePlayPause",e,"hasStarted",e.hasStarted,"ended",e.ended,"paused",e.paused),p.isMobile&&!e.hasBeenTouched)try{e.touch()}catch(e){}e.hasStarted?e.paused?F():G():e.isAd()?B():k()}},F=function(){f=!1,r.currentPlayer&&(o.state=o.PLAYING,r.currentPlayer.resume())},q=function(){r.currentPlayer&&!r.currentPlayer.isAd()&&r.currentPlayer.stop()},H=function(e){r.currentPlayer&&r.currentPlayer.setVolume(e)},j=function(e){r.currentPlayer&&r.currentPlayer.mute(e)},z=function(){r.toggleFullscreen()},W=function(e){r.setFullscreen(e)},Y=function(e){t.update(e)},K=function(e){var i=e.data,n=a.minimumViewability;r.currentPlayer&&n&&(i.percent<n?o.state===o.PLAYING&&t.userDidPause&&s.info("[Bolt3 Controller] Viewability metrics below threshold. Pause."):o.state===o.PAUSED&&t.autoPaused?(s.info("[Bolt3 Controller] Viewability metrics above threshold. Resume."),F()):o.state===o.START&&autoplayWhenViewabilityMetricsChanged&&(s.info("[Bolt3 Controller] Viewability metrics above threshold. Starting autoplay"),autoplayWhenViewabilityMetricsChanged=!1,k()))},X=function(){s.info("[ZeusController handleVisibilityChange] ",document.visibilityState),r.currentPlayer.isAd()||o.state===o.START||("hidden"===document.visibilityState?G():f||B())};return{startUp:A,setSize:U,togglePlayPause:V,setFullscreen:W,toggleFullscreen:z,play:k,pause:G,stop:q,resume:F,setVolume:H,mute:j,seek:R,replay:V,updateViewabilityMetrics:Y}}),define("module_factory",["zeus_constants"],function(e){var t=function(e){var t;return window.themeConfig&&((t=window.themeConfig.modules[e])||window.themeConfig.addons&&window.themeConfig.addons[e]),t||e};return{buildTooltipManager:function(e){var r=t("tooltip_manager");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildLoadingIndicator:function(e){var r=t("loading_indicator");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildWatermark:function(e){var r=t("watermark");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildContent:function(e){var r=t("content");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),r.invalidate(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+module)})},buildVolume:function(e){var r=t("volume");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),r.invalidate(),e.call(null,r)},function(e){
throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildControlBar:function(e){var r=t("controlbar");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildTitleBar:function(e){var r=t("titlebar");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildPrerollScreen:function(e){var r=t("preroll_screen");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildScrubber:function(e){var r=t("scrubber");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildPlaylist:function(e,r){var i=t("playlist");require([i],function(t){var i=new t(window.ContentPlayer);i.init(r),e.call(null,i)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+i)})},buildRelatedVideos:function(e,r){var i=t("related_videos");require([i],function(t){var i=new t(window.ContentPlayer);i.init(r),e.call(null,i)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+i)})},buildSubtitles:function(e,r){var i=t("subtitles");require([i],function(t){var i=new t(window.ContentPlayer);i.init(r),e.call(null,i)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+i)})},buildSharingMenu:function(e){var r=t("sharing");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildAgeGate:function(e){var r=t("agegate");require([r],function(t){var r=new t(window.ContentPlayer);r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})},buildAppearanceManager:function(e){var r=t("appearance_manager");require([r],function(t){var r=new t;r.init(),e.call(null,r)},function(e){throw LOG.error(e.message),new Error("Failed to load module: "+r)})}}}),define("zeus_view",["zeus_eventdispatcher","module_factory","zeus_utils"],function(e,t){"use strict";function r(t){var r=this;e.mixin(r),this.IPadNativeFullscreen=!1,this._handleIPadFullscreenEvents=this._handleIPadFullscreenEvents.bind(this),this.cssClass=t,this._isReady=!1,this.mouseInput=null,this._playlistMenu=null,this._volumeControl=null,this._subtitleMenu=null,this._sharingMenu=null,this._relatedVideoMenu=null,this._content=null,this._prerollScreen=null,this._uiModules=[],this._ageGateHandler=null,this._watermark=null,this._coreModules=["_content","_controlbar","_scrubber","_watermark"],l.isMobile||(this._coreModules.push("_volumeControl"),this._coreModules.push("mouseInput")),this._defaultBoxModel=null,this.fullscreen=!1,this.currentPlayer=null,this._enableAgeGate=!1,window.addEventListener("resize",function(){var e=setTimeout(function(){clearTimeout(e),r.invalidate()},400)}),this.fixedControlbar=!1,this.fixedTitlebar=!1,this.fixedScrubber=!1,window.PlayerView=this}var i,n=window.BENCHMARK,o=ZeusUtils.dom,a=ZeusUtils.css,s=window.ZeusConstants,l=window.client;return r.prototype={},r.prototype.enableAgeGate=function(e){var r=this;PlayerSettings.preview&&(e?r.currentPlayer&&r.currentPlayer.playing&&r.currentPlayer.pause():PlayerState.state=PlayerState.START),e?(LOG.info("Enable age-gate"),r._ageGateHandler?(r._ageGateHandler.invalidate(),r._ageGateHandler.invalidateCookie()):t.buildAgeGate(function(e){r._ageGateHandler=e,r._ageGateHandler.addEventListener(s.UI.Event.AGE_GATE_PASSED,function(e){LOG.debug("AGE GATE PASSED"),r._dispatchEvent(e.type,e.data)}),r._ageGateHandler.addEventListener(s.UI.Event.AGE_GATE_FAILED,function(e){LOG.debug("AGE GATE FAILED"),r._dispatchEvent(e.type)}),r._ageGateHandler.invalidate(),r._ageGateHandler.invalidateCookie(),r._uiModules.push(r._ageGateHandler)})):(LOG.info("Disable age-gate"),r._ageGateHandler?r._ageGateHandler.close():o.hideElement(s.UI.AGE_GATE_LAYER),r._dispatchEvent(s.UI.Event.AGE_GATE_PASSED))},r.prototype.buildCaptionMenu=function(e){var r=this,i=r._subtitleMenu;LOG.info("build caption menu"),o.getUI(s.UI.SUBTITLE_MENU)&&!l.system.iphone&&e&&e.length>0?(a.removeClass(Skin,"bolt-subtitle-disabled"),a.addClass(Skin,"bolt-subtitle-enabled"),i?i.init(e):(LOG.info("build caption menu"),t.buildSubtitles(function(e){i=e,r._uiModules.push(i),r._subtitleMenu=i,i.init()},e))):(a.removeClass(Skin,"bolt-subtitle-enabled"),a.addClass(Skin,"bolt-subtitle-disabled"))},r.prototype.buildPlaylistMenu=function(e){var r=this,i=s.UI;e&&e.length>0&&o.getUI(i.PLAYLIST)&&(r._playlistMenu?r._playlistMenu.init(e):t.buildPlaylist(function(e){r._playlistMenu=e,r._playlistMenu.addEventListener(s.UI.Event.PLAYLIST_ITEM_SELECTED,function(e){LOG.debug(e),r._dispatchEvent(e.type,e.data)}),r._uiModules.push(r._playlistMenu)},e))},r.prototype.showRelatedVideosMenu=function(){var e=this;null!==e._relatedVideoMenu&&e._relatedVideoMenu.open()},r.prototype.setRelatedVideos=function(e){var r=this;e?r._relatedVideoMenu?r._relatedVideoMenu.init(e):t.buildRelatedVideos(function(e){r._relatedVideoMenu=e,r._relatedVideoMenu.addEventListener(s.UI.Event.RELATED_VIDEO_SELECTED,function(e){r._dispatchEvent(e.type,e.data)}),r._uiModules.push(r._relatedVideoMenu)},e):r._relatedVideoMenu&&r._relatedVideoMenu.close()},r.prototype.setRelatedVideosFetched=function(e){this._relatedVideosFetched=e},r.prototype.isRelatedVideoListFetched=function(){return this._relatedVideosFetched},r.prototype.enableControls=function(e){},r.prototype.toggleFullscreen=function(){LOG.debug("toggle fullscreen",this.fullscreen),this.setFullscreen(!this.fullscreen)},r.prototype.setFullscreen=function(e){LOG.debug("[Bolt:view]set fullscreen",e);var t=this;if(!1===PlayerSettings.fullscreen)return void LOG.debug("ZeusView:: Fullscreen is not allowed by the publisher");if(window.fullscreenEnabled&&(!1===e?window.exitFullscreen():window.enterFullscreen()),l.system.ios){if(!t.currentPlayer)return;if(l.system.ipad)return void(!1===e?t.IPadNativeFullscreen&&t.currentPlayer.video.webkitExitFullscreen():t.currentPlayer.metadata&&t.currentPlayer.video.webkitEnterFullscreen());if(l.system.iphone&&parseInt(l.system.ios)>=10)return void(!1===e?t.currentPlayer.video.webkitExitFullscreen():t.currentPlayer.video.webkitEnterFullscreen())}t._dispatchEvent(s.UI.Event.REQUEST_FULLSCREEN_CHANGE,!t.fullscreen)},r.prototype._handleIPadFullscreenEvents=function(e){LOG.info("[Bolt:view:handleIPadFullscreenEvent] event",e.type),"webkitendfullscreen"===e.type?this.IPadNativeFullscreen=!1:this.IPadNativeFullscreen=!0},r.prototype.isHD=function(e){e?(a.removeClass(Skin,"bolt-sd-on"),a.addClass(Skin,"bolt-hd-on")):(a.removeClass(Skin,"bolt-hd-on"),a.addClass(Skin,"bolt-sd-on"))},r.prototype.drawCuepoints=function(){var e=ContentPlayer.adsCuepoints,t=s.UI,r=o.getUI(t.AD_CUEPOINTS_CONTAINER);if(r){for(;o.getUI(t.CUEPOINT);)r.removeChild(o.getUI(t.CUEPOINT));if(ContentPlayer.duration<=0)return void LOG.debug("player duration <0, cannot draw cuepoints",e);LOG.debug("draw valid cuepoints",e);for(var i=0;i<e.length;i++){var n=e[i],a=100*n/ContentPlayer.duration+"%";LOG.debug("drawCuepoints",ContentPlayer.duration,n,a);var l='<svg data-bolt-ui="cuepoint" class="bolt-foreground bolt-cuepoint  cp_'+n+'" style="left:'+a+'" width="512px" height="512px" viewbox="0 0 512 512" xml:space="preserve"><circle cx="256" cy="256" r="256" /></svg>';r.insertAdjacentHTML("beforeend",l)}}},r.prototype.setCurrentPlayer=function(e){var t=s.UI,r=this;if(e===r.currentPlayer)return void LOG.debug("setCurrentPlayer:: not a new player. return");LOG.debug("setCurrentPlayer ",e),r.currentPlayer&&(r.currentPlayer.removeEventListener(s.Player.Event.CANPLAY,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Player.Event.CONTENT_CHANGED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Player.Event.QUALITY_CHANGED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Player.Event.CONFIG_CHANGED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.PLAY,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.PLAYING,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.DURATION_CHANGE,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.ENDED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.PAUSED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.RESUME,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.STOPPED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.TIME_UPDATE,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.LOAD_PROGRESS,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.WAITING,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.LOAD_START,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.LOADED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.START_TIME_CHANGED,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.NOT_FOUND,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.FIRSTQUARTILE,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.MIDPOINT,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.THIRDQUARTILE,r._handlePlayerEvents),r.currentPlayer.removeEventListener(s.Media.Event.MUTED,r._onMuted),r.currentPlayer.removeEventListener(s.Media.Event.UNMUTED,r._onUnmuted),r.currentPlayer.removeEventListener(s.Media.Event.VOLUME_CHANGED,r._onVolumeChanged),r.currentPlayer.removeEventListener(s.Ad.Event.CUEPOINT,r._handlePlayerEvents),l.system.ipad&&r.currentPlayer.video&&(r.currentPlayer.video.removeEventListener("webkitendfullscreen",r._handleIPadFullscreenEvents),r.currentPlayer.video.removeEventListener("webkitbeginfullscreen",r._handleIPadFullscreenEvents))),r._handlePlayerEvents=r._handlePlayerEvents.bind(this),e.addEventListener(s.Player.Event.CANPLAY,r._handlePlayerEvents),e.addEventListener(s.Player.Event.CONTENT_CHANGED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.PLAY,r._handlePlayerEvents),e.addEventListener(s.Media.Event.PLAYING,r._handlePlayerEvents),e.addEventListener(s.Media.Event.DURATION_CHANGE,r._handlePlayerEvents),e.addEventListener(s.Media.Event.ENDED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.PAUSED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.RESUME,r._handlePlayerEvents),e.addEventListener(s.Media.Event.STOPPED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.TIME_UPDATE,r._handlePlayerEvents),e.addEventListener(s.Media.Event.LOAD_PROGRESS,r._handlePlayerEvents),e.addEventListener(s.Media.Event.WAITING,r._handlePlayerEvents),e.addEventListener(s.Media.Event.LOAD_START,r._handlePlayerEvents),e.addEventListener(s.Media.Event.LOADED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.FIRSTQUARTILE,r._handlePlayerEvents),e.addEventListener(s.Media.Event.MIDPOINT,r._handlePlayerEvents),e.addEventListener(s.Media.Event.THIRDQUARTILE,r._handlePlayerEvents),r._onMuted=r._onMuted.bind(this),e.addEventListener(s.Media.Event.MUTED,r._onMuted),r._onUnmuted=r._onUnmuted.bind(this),e.addEventListener(s.Media.Event.UNMUTED,r._onUnmuted),r._onVolumeChanged=r._onVolumeChanged.bind(this),e.addEventListener(s.Media.Event.VOLUME_CHANGED,r._onVolumeChanged),e.isAd()?(a.addClass(Skin,"bolt-linear-ad-on"),a.removeClass(Skin,"bolt-content-on"),o.hideElement(t.TITLE_BAR),o.hideElement(t.SUBTITLE_TEXT),BoltAdManager.type==s.Ad.Type.STATIC_IMAGE&&BoltAdManager.type==s.Ad.Type.THREE_TWO_FIFTY||l.isMobile||r._volumeControl&&r._volumeControl.setPlayer(e),BoltAdManager.type===s.Ad.Type.FLASH_VPAID||BoltAdManager.type===s.Ad.Type.STATIC_IMAGE||BoltAdManager.type===s.Ad.Type.THREE_TWO_FIFTY?r.fixedControlbar=!0:r.fixedControlbar=!1):PlayerSettings.adOnly||(a.addClass(Skin,"bolt-content-on"),a.removeClass(Skin,"bolt-linear-ad-on"),e.addEventListener(s.Ad.Event.CUEPOINT,r._handlePlayerEvents),e.addEventListener(s.Player.Event.QUALITY_CHANGED,r._handlePlayerEvents),e.addEventListener(s.Player.Event.CONFIG_CHANGED,r._handlePlayerEvents),e.addEventListener(s.Media.Event.NOT_FOUND,r._handlePlayerEvents),e.addEventListener(s.Media.Event.START_TIME_CHANGED,r._handlePlayerEvents),o.hideElement(t.AD_CONTAINER),r.buildCaptionMenu(window.CurrentVideoConfig.content.captions),l.isMobile||r._volumeControl&&r._volumeControl.setPlayer(e),r.drawCuepoints(),r.fixedControlbar=!1===PlayerSettings.appearance.controlbar.autohide),r._showWatermark(!e.isAd()),l.isMobile?parseInt(l.system.ios)>=10||l.system.android?e.mute(PlayerSettings.automute):e.mute(!1):(e.setVolume(PlayerSettings.volume),e.mute(PlayerSettings.automute)),r.currentPlayer=e,l.system.ipad&&r.currentPlayer.video&&(r.currentPlayer.video.addEventListener("webkitendfullscreen",r._handleIPadFullscreenEvents),r.currentPlayer.video.addEventListener("webkitbeginfullscreen",r._handleIPadFullscreenEvents)),r._isReady?(r._dispatchEvent(s.UI.Event.PLAYER_CHANGED),r.invalidate()):r._waitForCoreModules()},r.prototype._waitForCoreModules=function(){var e=this;LOG.debug("CORE MODULES",e._coreModules),i||(i=setInterval(function(){if(e._coreModules.every(function(t){return LOG.debug("WAITING FOR MODULE",t),!!e[t]})){clearInterval(i),e._isReady=!0,LOG.info("view is ready"),window.Skin.style.visibility="visible",LOG.info("update appearance manager"),e.appearanceManager.updateColors(),e.appearanceManager.updateTextColors(),LOG.info("update modules appearance");for(var t=0;t<e._uiModules.length;t++){e._uiModules[t].updateAppearance()}e._dispatchEvent(s.UI.Event.PLAYER_CHANGED),e.invalidate(),e._dispatchEvent(s.Player.Event.VIEW_READY),e.enableAgeGate(e._enableAgeGate)}},100))},r.prototype._handlePlayerEvents=function(e){var t=this,r=e.target,i=s.UI;switch(e.type){case s.Player.Event.CONFIG_CHANGED:var d=window.CurrentVideoConfig;LOG.debug("PlayerView::Player config changed",d,r.config),d.settings.minAge>0?(LOG.debug("AGE GATED!",d),t.enableAgeGate(!0)):t.enableAgeGate(!1),t.buildCaptionMenu(d.content.captions),t._setTooltipText(o.getUI(i.PLAY_PAUSE_BTN),"Play"),Object.keys(d.content.media).length>1?(a.removeClass(Skin,"bolt-hd-disabled"),a.addClass(Skin,"bolt-hd-enabled")):(LOG.debug("showOrHideHDButton hide settings button"),a.removeClass(Skin,"bolt-hd-enabled"),a.addClass(Skin,"bolt-hd-disabled")),o.hideElement(i.ERROR_CONTAINER);break;case s.Media.Event.PLAY:LOG.debug("PlayerView::handlePlayerEvent",e.type,r.getSource()),r.isAd()||n.start("bolt_contentPlayRequested_to_contentPlaying");break;case s.Media.Event.PLAYING:LOG.debug("PlayerView::handlePlayerEvent",e.type,r.getSource()),r.isAd()||(n.end("bolt_contentPlayRequested_to_contentPlaying"),t._setTooltipText(o.getUI(i.PLAY_PAUSE_BTN),"Pause"));break;case s.Media.Event.PAUSED:LOG.debug("PlayerView::PAUSED",r.getSource()),t._setTooltipText(o.getUI(i.PLAY_PAUSE_BTN),"Play");break;case s.Media.Event.RESUME:LOG.debug("PlayerView::RESUME",r.getSource()),r.isAd()||l.isMobile&&ContentPlayer.show(!0);break;case s.Media.Event.STOPPED:LOG.debug("PlayerView::STOPPED",r.getSource()),t._setTooltipText(o.getUI(i.PLAY_PAUSE_BTN),"Play");break;case s.Media.Event.DURATION_CHANGE:LOG.debug("PlayerView::duration change",r.duration,r.getSource());break;case s.Media.Event.WAITING:LOG.debug("PlayerView::WAITING",r.getSource());break;case s.Media.Event.LOAD_PROGRESS:case s.Media.Event.TIME_UPDATE:break;case s.Media.Event.ENDED:r.isAd()?LOG.info("VIEW::ENDED Ad"):LOG.info("VIEW::ENDED",r.getSource()),t._setTooltipText(o.getUI(i.PLAY_PAUSE_BTN),"Replay");break;case s.Media.Event.START_TIME_CHANGED:LOG.debug("PlayerView::START_TIME_CHANGED",r.getSource());break;case s.Player.Event.CONTENT_CHANGED:case s.Media.Event.NOT_FOUND:break;case s.Media.Event.NOT_SUPPORTED:r.isAd()||t.showError("Flash Player 11+ is required to view this content.")}t._dispatchEvent(e)},r.prototype.showError=function(e){o.showElement(s.UI.ERROR_CONTAINER);var t=o.getUI(s.UI.ERROR_CONTAINER);if(t){t.firstElementChild.textContent=e}o.hideElement(s.UI.LOADING_INDICATOR)},r.prototype.init=function(e){var r=s.UI,i=this;LOG.debug("VIEW::init",window.ContentPlayer,"ageGateEnabled",e);var n=window.Skin;if(n.style.width="100%",n.style.height="100%",i.cssClass&&a.addClass(window.Skin,i.cssClass),a.setUAClass(),a.setFeatureClass(),i._coreModules.push("appearanceManager"),t.buildAppearanceManager(function(e){i.appearanceManager=e}),!1===PlayerSettings.branding&&o.removeElement(r.BRANDING),!1===PlayerSettings.bigButton?o.removeElement(s.UI.BIG_PLAY):o.getUI(r.BIG_PLAY)&&(i._coreModules.push("_prerollScreen"),i._buildPrerollScreen()),!1===PlayerSettings.fullscreen&&(LOG.info("Fullscreen disabled"),o.removeElement(r.FULLSCREEN_BTN)),PlayerSettings.adOnly)o.removeElement(r.SHARING_BTN),o.removeElement(r.PLAYLIST_BTN),o.removeElement(r.SETTINGS_BTN),o.removeElement(r.SUBTITLE_BTN),o.removeElement(r.TITLE_BAR),i.fixedControlbar=!0,a.addClass(window.Skin,"bolt-linear-ad-on");else{var d=o.getUI(r.TITLE_TEXT);!1===PlayerSettings.title?d&&d.parentNode.removeChild(d):o.getUI(r.TITLE_BAR)&&(i._coreModules.push("_titleBar"),i._buildTitleBar()),!1===PlayerSettings.share?(LOG.info("Sharing disabled"),o.removeElement(r.SHARING_BTN)):i._buildSharingMenu(),1===Object.keys(window.CurrentVideoConfig.content.media).length&&(PlayerSettings.defaultHd&&LOG.warn("The video has only SD media, defaultHd setting is omitted"),o.hideElement(r.SETTINGS_BTN)),window.Playlist?i.buildPlaylistMenu(window.Playlist):o.removeElement(s.UI.PLAYLIST_BTN),LOG.debug("agegate",e),i._enableAgeGate=e,i.isHD(!0===window.CurrentVideoConfig.settings.defaultHd),i.fixedControlbar=!1===PlayerSettings.appearance.controlbar.autohide,LOG.info("Fixed controlbar",i.fixedControlbar),i._coreModules.push("_loadingIndicator"),t.buildLoadingIndicator(function(e){i._loadingIndicator=e,i._uiModules.push(e)})}l.isMobile?(parseInt(l.system.ios)>=10||l.system.android?(i._buildVolumeControl(),PlayerSettings.adOnly||!PlayerSettings.automute||ZeusUtils.css.hasClass(document.body,"is-sticky-module")||i._buildUnmuteOverlay()):o.removeElement(s.UI.SOUND_BTN),a.addClass(document.body,"bolt-touch-input")):(i._buildVolumeControl(),PlayerSettings.adOnly||!PlayerSettings.automute||ZeusUtils.css.hasClass(document.body,"is-sticky-module")||i._buildUnmuteOverlay(),require(["zeus_mouseinput"],function(e){LOG.debug("LOAD MOUSE INPUT"),i.mouseInput=new e,i.mouseInput.on(s.UI.Event.MOUSE_OUT,function(){i.onMouseOut(window.Skin)}),i.mouseInput.on(s.UI.Event.MOUSE_OVER,function(){i.onMouseOver(window.Skin)}),LOG.info("mouse input ready")})),i._defaultBoxModel={width:n.style.width,height:n.style.height,marginTop:n.style.marginTop,marginLeft:n.style.marginLeft,marginBottom:n.style.marginBottom,marginRight:n.style.marginRight,paddingTop:n.style.paddingTop,paddingLeft:n.style.paddingLeft,paddingBottom:n.style.paddingBottom,paddingRight:n.style.paddingRight,zIndex:n.style.zIndex,position:n.style.position,top:n.style.top,right:n.style.right,bottom:n.style.bottom,left:n.style.left},l.isMobile||"normal"!==PlayerSettings.playerType||i._initTooltips(),i._setTooltipText(o.getUI(r.PLAY_PAUSE_BTN),"Play"),i._buildContent(),i._buildControlBar(),i._buildScrubber(),i._buildWatermark(),i.setCurrentPlayer(ContentPlayer)},r.prototype._buildUnmuteOverlay=function(){var e=this;require(["unmute_overlay"],function(t){var r=new t(window.ContentPlayer);e._uiModules.push(r),r.init(),e.unmuteOverlay=r})},r.prototype._buildContent=function(){var e=this;t.buildContent(function(t){e._uiModules.push(t),e._content=t,LOG.info("content ready",e._content)})},r.prototype._buildVolumeControl=function(){var e=this;e._volumeControl||t.buildVolume(function(t){e._uiModules.push(t),e._volumeControl=t,e._volumeControl.addEventListener(s.VALUE_CHANGED,function(t){e._dispatchEvent(s.UI.Event.CHANGE_VOLUME,t.data)}),LOG.info("Volume ready")})},r.prototype._buildScrubber=function(){var e=this;e._scrubber||t.buildScrubber(function(t){e._uiModules.push(t),e._scrubber=t,e._scrubber.on(s.UI.Event.SEEK,function(t){e._dispatchEvent(t)}),LOG.info("scrubber ready")})},r.prototype._buildControlBar=function(){var e=this;e._controlbar||t.buildControlBar(function(t){e._uiModules.push(t),e._controlbar=t,LOG.info("Controlbar ready")})},r.prototype._buildTitleBar=function(){var e=this;e._titleBar||t.buildTitleBar(function(t){e._uiModules.push(t),e._titleBar=t,LOG.info("Titlebar ready")})},r.prototype._buildPrerollScreen=function(){var e=this;e._prerollScreen||t.buildPrerollScreen(function(t){e._uiModules.push(t),e._prerollScreen=t,LOG.info("Preroll screen ready")})},r.prototype._buildSharingMenu=function(){var e=this;e._sharingMenu||t.buildSharingMenu(function(t){e._uiModules.push(t),e._sharingMenu=t,LOG.info("Sharing menu ready")})},r.prototype.hideTooltip=function(){this._tooltipManager&&this._tooltipManager.close()},r.prototype._setTooltipText=function(e,t){this._tooltipManager&&this._tooltipManager.setLabel(e,t)},r.prototype._isEnabled=function(e){return!a.hasClass(e,s.UI.UI_DISABLED_CLASS)},r.prototype._buildWatermark=function(){var e=this;t.buildWatermark(function(t){e._watermark=t,e._uiModules.push(e._watermark)})},r.prototype._showWatermark=function(e){this._watermark&&(e?this._watermark.open():this._watermark.close())},r.prototype._getModuleForElement=function(e){for(var t=this,r=0;r<t._uiModules.length;r++){var i=t._uiModules[r];if(i.UI===e)return i}return null},r.prototype.size=function(e,t){var r=this,i=e,n=t;-1==e.indexOf("%")&&-1==e.indexOf("px")&&(i=e+"px"),-1==t.indexOf("%")&&-1==t.indexOf("px")&&(n=t+"px"),r._defaultBoxModel.width=i,r._defaultBoxModel.height=n,r.invalidate()},r.prototype.onMouseOver=function(e){a.removeClass(Skin,"bolt-mouse-out"),a.addClass(Skin,"bolt-mouse-over"),this._dispatchEvent(s.UI.Event.MOUSE_OVER,null,e)},r.prototype.onMouseOut=function(e){a.removeClass(Skin,"bolt-mouse-over"),a.addClass(Skin,"bolt-mouse-out"),this._dispatchEvent(s.UI.Event.MOUSE_OUT,null,e)},r.prototype._initTooltips=function(){var e=this;t.buildTooltipManager(function(t){e._uiModules.push(t),e._tooltipManager=t})},r.prototype.invalidate=function(e){var t=this,r=(s.UI,t._uiModules);e&&(e.fullscreen!=t.fullscreen&&(t.fullscreen=e.fullscreen,t.mouseInput&&t.mouseInput.setFullscreen(t.fullscreen),LOG.debug("invalidate, fullscreen changed to ",t.fullscreen),t._controlbar.open()),e.customizer&&t.appearanceManager.update(e.customizer)),t.fixedScrubber?a.addClass(Skin,"bolt-static-scrubber"):a.removeClass(Skin,"bolt-static-scrubber"),t._scrubber.fixedValues(t.fixedScrubber),t._controlbar.allowAutoHide(!t.fixedControlbar),t._titleBar&&(t._titleBar.allowAutoHide(!t.fixedTitlebar),t.fixedTitlebar?(t._titleBar.open(),a.addClass(Skin,"bolt-static-title-bar")):a.removeClass(Skin,"bolt-static-title-bar")),t.fixedControlbar?(t._controlbar.open(),a.addClass(Skin,"bolt-static-control-bar")):a.removeClass(Skin,"bolt-static-control-bar"),t.currentPlayer.setFullscreen(t.fullscreen);for(var i=0;i<r.length;i++){r[i].invalidate()}!0===t._isReady&&(l.browser.ie>0?(t._controlbar.open(),t._titleBar&&t._titleBar.open()):window.Skin.style.visibility="visible"),a.setSizeClass(window.Skin.clientWidth)},r.prototype._onVolumeChanged=function(e){var t=this;LOG.info("volume changed",e),void 0!==e.data?t._dispatchEvent(e.type,e.data):LOG.warn("No volume data")},r.prototype._onMuted=function(e){var t=this,r=document.getElementById("pw-mini-mute-btn");a.removeClass(Skin,"bolt-automute-disabled"),a.addClass(Skin,"bolt-automute-enabled"),r&&a.addClass(r,"is-muted"),t._dispatchEvent(e.type)},r.prototype._onUnmuted=function(e){var t=this,r=document.getElementById("pw-mini-mute-btn");a.removeClass(Skin,"bolt-automute-enabled"),a.addClass(Skin,"bolt-automute-disabled"),r&&a.removeClass(r,"is-muted"),t._dispatchEvent(e.type)},r.prototype.getAppearanceSettings=function(){this.appearanceManager.getInitialSettings()},r.prototype.disableUnmuteOverlay=function(){LOG.info("[PlayerView] Disable unmute overlay"),this.unmuteOverlay&&this.unmuteOverlay.disable()},r}),define("zeus_mouseinput",["zeus_eventdispatcher","zeus_utils"],function(e,t){function r(){var t=this;t.type="mouse",t._isTouched=!1,t._mouseIdleTracker=new a,t._mouseIdleTracker.mouseIdleCallback=t._onMouseIdle.bind(t),t._mouseIdleTracker.mouseActiveCallback=t._onMouseActive.bind(t),e.mixin(t),t._init()}var i=window.ZeusConstants,n=window.PlayerView,o=t.css,a=function(){var e=this;e._mouseDown=!1,e.isTouched=!1,e._isActive=!1,e._hideTimeoutId=null,e._touchTimeout=null,e._mouseIdleTimer=null,e._mouseIdleDuration=0,e.mouseIdleCallback=null,e.mouseActiveCallback=null,e._onMouseLeave=e._onMouseLeave.bind(e),e._onMouseEnter=e._onMouseEnter.bind(e),e._onMouseMove=e._onMouseMove.bind(e),e._onMouseDown=e._onMouseDown.bind(e),e._onMouseUp=e._onMouseUp.bind(e),window.Skin.addEventListener("mousemove",e._onMouseMove),window.Skin.addEventListener("mousedown",e._onMouseDown,!0),window.Skin.addEventListener("mouseup",e._onMouseUp)};return a.prototype={get isActive(){return this._isActive},set isActive(e){var t=this;t._isActive=e,e?t.mouseActiveCallback():t.mouseIdleCallback()},_onMouseDown:function(e){LOG.info("mouse down"),this._mouseDown=!0,this._mouseIdleTimer&&clearInterval(this._mouseIdleTimer)},_onMouseUp:function(e){LOG.info("mouse up"),this._mouseDown=!1},_onMouseLeave:function(e){var t=this;t.isTouched||(t._mouseIdleTimer&&clearInterval(t._mouseIdleTimer),t._hideTimeoutId=setTimeout(function(){clearTimeout(t._hideTimeoutId),t._hideTimeoutId=null,t.isActive=!1},1e3)),t._mouseDown=!1,t.isTouched=!1},_onMouseEnter:function(e){var t=this;t._hideTimeoutId&&(clearTimeout(t._hideTimeoutId),t._hideTimeoutId=null),t._resetIdleTimer(),t.isActive=!0},_onMouseMove:function(e){var t=this;t.isActive=!0,t.isTouched||t._resetIdleTimer(),t.isTouched=!1},_resetIdleTimer:function(){var e=this;e._mouseIdleTimer&&clearInterval(e._mouseIdleTimer),e._mouseDown||(e._mouseIdleDuration=0,e._mouseIdleTimer=setInterval(function(){e._mouseIdleDuration+=500,e._mouseIdleDuration>=3e3&&(clearInterval(e._mouseIdleTimer),e._mouseDown=!1,e._isTouched=!1,e.isActive=!1)},500))},setFullscreen:function(e){var t=this;e?(window.Skin.removeEventListener("mouseleave",t._onMouseLeave),window.Skin.removeEventListener("mouseenter",t._onMouseEnter)):(window.Skin.addEventListener("mouseleave",t._onMouseLeave),window.Skin.addEventListener("mouseenter",t._onMouseEnter))}},r.prototype={get isTouched(){return this._isTouched},set isTouched(e){this._isTouched=e,this._mouseIdleTracker.isTouched=e,e?o.addClass(document.body,"bolt-touch-input"):o.removeClass(document.body,"bolt-touch-input")},_onMouseIdle:function(){this._dispatchEvent(i.UI.Event.MOUSE_OUT,null,window.Skin),this.isTouched=!1},_onMouseActive:function(){this._dispatchEvent(i.UI.Event.MOUSE_OVER,null,window.Skin),this.isTouched=!1},setFullscreen:function(e){this._mouseIdleTracker.setFullscreen(e)},_init:function(){var e=this;o.addClass(document.body,"bolt-mouse-input"),e.setFullscreen(n.fullscreen),PlayerState.on(PlayerState.STATE_CHANGED,function(){PlayerState.state===PlayerState.PLAYING&&(e._mouseIdleTracker.isActive||window.PlayerView.currentPlayer.isAd()||e._mouseIdleTracker._resetIdleTimer())})}},r}),define("playerstate",["stapes","zeus_utils"],function(e,t){function r(){this._data={},this._state=null,this._previousState=null,this._waitingStateDelay=null,e.mixinEvents(this),this.delayedWaitingState=this.delayedWaitingState.bind(this)}return r.prototype={STATE_CHANGED:"stateChanged",AGE_GATE:"age-gate",START:"start",WAITING:"waiting",PLAYING:"playing",PAUSED:"paused",ENDED:"ended",ERROR:"error",RELATED_VIDEOS:"related-videos",delayedWaitingState:function(e){var t=this;clearTimeout(t._waitingStateDelay),t._waitingStateDelay=setTimeout(function(){t.state=r.WAITING},e)},get previousState(){return this._previousState},get state(){return this._state},set state(e){if(e){e!=this._state&&(clearTimeout(this._waitingStateDelay),e===this.WAITING&&this._state===this.PLAYING||t.css.removeClass(window.Skin,"bolt-state-"+this._state),this._previousState=this._state,this._state=e,LOG.info("Player state:",this._state),t.css.addClass(window.Skin,"bolt-state-"+e),this.emit(this.STATE_CHANGED))}},get data(){return this._data},set data(e){this._data=e}},r}),define("base_appearance_manager",["stapes","zeus_utils","zeus_constants"],function(e,t,r){var i=t.dom,n=t.css;document;return e.subclass({constructor:function(){this.useGradient=!1},init:function(){},_normalizeRGBA:function(e){var t=e.match(/([0-9.]+)/g);return t.length>3&&t.pop(),"rgb("+t.join(",")+")"},_rgba:function(e,t){if(!/rgba/.test(e))return e=e.replace("rgb","rgba"),e=e.replace(")",", 0."+t+")")},getInitialSettings:function(){var e=this,o=i.getUI(r.UI.TITLE_TEXT),a=i.getUI(r.UI.SCRUBBER),s=i.getUI(r.UI.TIMERAIL_PROGRESS),l=i.getUI(r.UI.TIMERAIL_BUFFER),d=i.getUI(r.UI.PLAY_ICON),u=JSON.parse(JSON.stringify(window.CurrentVideoConfig.settings));u.appearance||(u.appearance={});var c,h,p,f=i.getUI(r.UI.CONTROLBAR),g=getComputedStyle(f),v=/gradient/i.test(g.backgroundImage);if(v){var m=g.backgroundImage,y=[];if(m.indexOf("#")>-1)c=!0,y=m.substring(m.indexOf("#"),m.lastIndexOf(")"));else if(m.indexOf("rgb")>-1)c=!1,p=!0,y=m.substring(m.indexOf("rgb"),m.lastIndexOf(")")),m.indexOf("rgba")>-1&&(h=!0,p=!1);else{!0;for(var _,b=/,\s?(\w+)/gi;_=b.exec(m);)_.index===b.lastIndex&&b.lastIndex++,y.push(_[1])}y&&(c?y=y.split(","):h&&(y=function(t){var r=t.match(/(rgba?\([0-9,.\s]*\))/g),i=r[0];i=e._normalizeRGBA(i);var n=r[1];return n=e._normalizeRGBA(n),[i,n]}(y)),p&&(y=function(e){var t=/(rgb\(+.*\)).*(rgb\(+.*\))/gi.exec(e);return[t[1],t[2]]}(y)))}var E=n.getStyleSheetOfClass("bolt-background","backgroundColor");/rgba/i.test(E)&&(E=e._normalizeRGBA(E));var A=/rgba/i.test(g.backgroundColor)?e._normalizeRGBA(g.backgroundColor):g.backgroundColor,S={colors:{background:E,foreground:getComputedStyle(d).color,active:n.getStyleSheetOfClass(".bolt-highlight","color")},text:{provider:null,font:getComputedStyle(o).fontFamily,color:getComputedStyle(o).color},scrubber:{backgroundColor:getComputedStyle(a).backgroundColor,opacity:getComputedStyle(a).opacity,buffer:{backgroundColor:getComputedStyle(l).backgroundColor,opacity:getComputedStyle(l).opacity},progress:{backgroundColor:getComputedStyle(s).backgroundColor,opacity:getComputedStyle(s).opacity}},controlbar:{corner:parseFloat(g.borderBottomLeftRadius)>0?"rounded":"sharp",position:parseFloat(g.bottom)>0?"floating":"docked",backgroundColor:{style:v?"gradient":"flat",primary:v?y[1]:A,secondary:v?y[0]:A},separator:{backgroundColor:{primary:n.getStyleSheetOfClass(".bolt-light-line","backgroundColor"),secondary:n.getStyleSheetOfClass(".bolt-dark-line","backgroundColor")},opacity:n.getStyleSheetOfClass(".bolt-separator","opacity")}},watermark:{position:"bottom-right",opacity:1}};u.appearance=t.mergeObject(S,u.appearance),window.CurrentVideoConfig.settings.appearance=u.appearance,PlayerView._dispatchEvent(r.UI.Event.INITIAL_APPEARANCE_SETTINGS_LOADED,{settings:u,related:window.CurrentVideoConfig.related})},updateTextColors:function(){var e=window.PlayerSettings.appearance,t=e.text.color;t&&(n.inject(".bolt-custom-text-color {color:"+t+" !important; }"),n.inject(".bolt-related-cancel-link { color: "+t+" !important; }"));var r=e.text.font;if(r)if("google"===e.text.provider){var i=r.replace(/\s/,"+");n.addLink("//fonts.googleapis.com/css?family="+i,"googlefont",!1,function(){n.inject('.bolt-custom-font {font-family:"'+r+'", sans-serif !important;}')})}else n.inject(".bolt-custom-font {font-family:"+r+", sans-serif !important; }");LOG.info("Appearance manager:: update text colors",t)},updateColors:function(){var e=window.PlayerSettings.appearance,t=e.colors.background;t&&(0==t.indexOf("0x")&&(t="#"+t.substr(2)),
n.inject(".bolt-background { background:"+t+"}"),n.inject(".bolt-background-alpha-50 { background: "+this._rgba(t,5)+"; }"));var r=e.colors.foreground;if(r){0==r.indexOf("0x")&&(r="#"+r.substr(2));try{for(var i=window.Skin.getElementsByClassName("bolt-logo-default")[0],o=i.getElementsByTagName("path"),a=0;a<o.length;a++){o[a].removeAttribute("fill")}}catch(e){}n.inject(".bolt-foreground { color:"+r+"; fill: "+r+"}")}var s=e.colors.active;s&&(0==s.indexOf("0x")&&(s="#"+s.substr(2)),n.inject(" .bolt-highlight,.bolt-hover-highlight:hover, .bolt-hover-highlight:hover .bolt-icon { color:"+s+" !important; fill: "+s+"!important;} .bolt-selected, .bolt-selected:hover .bolt-icon { color:"+s+" !important; fill: "+s+"!important;} .bolt-block-highlight { background:"+s+" !important}"),n.inject(".bolt-border-hover-highlight:hover { border-color: "+s+" !important; }"),n.inject(".bolt-related-video:hover > .bolt-related-play-next-button { background: "+this._rgba(s,5)+" !important; }"),n.inject(".bolt-related-cancel-link:hover { color: "+s+" !important; }")),LOG.info("update colors","bg:",t,", fg:",r,", active:",s)},preview:function(e,o){var a=this;switch(e){case"bigButton":o?(PlayerView._prerollScreen&&PlayerView._prerollScreen.open(),n.inject(".bolt-bigplay-layer .bolt-icon{ fill: "+window.PlayerSettings.appearance.colors.active+"!important }")):PlayerView._prerollScreen&&PlayerView._prerollScreen.close();break;case"ageGate":PlayerView._enableAgeGate=o,PlayerView.enableAgeGate(o);break;case"share":PlayerSettings.share=o,o?i.showElement(r.UI.SHARING_BTN):i.hideElement(r.UI.SHARING_BTN);break;case"related":var s=o,l=function(){PlayerView._relatedVideoMenu?PlayerView._relatedVideoMenu.open():PlayerView.setRelatedVideos(s)};o?window.CurrentVideoConfig.related?t.xhr(window.CurrentVideoConfig.related,"get",null,function(e){s=JSON.parse(e),l()}):l():PlayerView._relatedVideoMenu&&(PlayerView._relatedVideoMenu.close(),window.CurrentVideoConfig.settings.bigButton&&a.preview("bigButton",!0));break;case"subtitle":o?(n.removeClass(Skin,"bolt-subtitle-disabled"),n.addClass(Skin,"bolt-subtitle-enabled")):(n.removeClass(Skin,"bolt-subtitle-enabled"),n.addClass(Skin,"bolt-subtitle-disabled"))}},update:function(e){var i=this,n=e,o=window.PlayerSettings.appearance;void 0!==n.related?i.preview("related",n.related):n.settings?(window.PlayerSettings=t.mergeObject(window.PlayerSettings,n.settings,!0),void 0!==n.settings.bigButton?i.preview("bigButton",n.settings.bigButton):void 0!==n.settings.share?i.preview("share",n.settings.share):void 0!==n.settings.minAge?i.preview("ageGate",n.settings.minAge):n.settings.watermark&&(PlayerSettings.watermark||(PlayerSettings.watermark={}),PlayerSettings.watermark=t.mergeObject(window.CurrentVideoConfig.settings.watermark,n.settings.watermark,!0),PlayerView._watermark.create())):n.appearance&&(n.appearance.colors&&(o.colors=t.mergeObject(o.colors,n.appearance.colors),i.updateColors()),n.appearance.text&&(o.text=t.mergeObject(o.text,n.appearance.text),i.updateTextColors()),n.appearance.controlbar&&(o.controlbar=t.mergeObject(o.controlbar,n.appearance.controlbar)),n.appearance.scrubber&&(o.scrubber=t.mergeObject(o.scrubber,n.appearance.scrubber)),n.appearance.watermark&&(o.watermark.position=n.appearance.watermark.position||o.watermark.position,o.watermark.opacity=n.appearance.watermark.opacity||o.watermark.opacity)),PlayerView._dispatchEvent(r.UI.Event.APPEARANCE_SETTINGS_CHANGED)}})}),define("appearance_manager",["base_appearance_manager"],function(e){return e.subclass()}),define("kinesis",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,r){var i=function(t){e.mixin(this);var i=this;i.SAMPLING=10,i.DEBUG_MODE=/#zeusdebug.*;kinesis/i.test(parentUrl)||/#kinesisdebug/i.test(parentUrl),i.LOG_DEBUG=i.DEBUG_MODE||/#zeusdebug/i.test(parentUrl),i.isSampling=100*Math.random()<i.SAMPLING||i.DEBUG_MODE,i.isSampling||console.log("%c[Kinesis] %c[Player] %cNOT SAMPLING\n","color: yellow;","color: pink;","color: cyan;"),require(["aws_kinesis"],function(e){i._configureAwsKinesis(e)}),this.isProduction=/cdn.playwire.com/.test(window.zeusBaseUrl)&&!/devcdn.playwire.com/.test(window.zeusBaseUrl),this.IDENTITY_POOL_ID="us-east-1:0f5903e9-e76a-4d22-99f0-520c5f4aacd9",this.REGION="us-east-1",this.playerId=t.playerUUID||"",this.adSessionId=null,this.adRequestId=null,this.referrer_url=null,this.playerType=null,this.theme=null,this.appSession=null,this.headerbidAuction=null,this.headerbidAdUnit=null,this.headerbidHasBeenTracked=!1,this.publisherId=null,this.clientInfo=function(){var e=JSON.parse(JSON.stringify(window.client));for(var t in e.browser)e.browser[t]||delete e.browser[t];for(t in e.engine)e.engine[t]||delete e.engine[t];for(t in e.system)e.system[t]||delete e.system[t];return e}(),this.pipelines={app:{STREAM_NAME:this.isProduction?"apps-production":"apps-development",VERSION:"0.8.0",queue:[]},boltAds:{STREAM_NAME:this.isProduction?"bolt-ads-production":"bolt-ads-development",queue:[],VERSION:"0.4.0"},boltErrors:{STREAM_NAME:this.isProduction?"bolt-errors-production":"bolt-errors-development",queue:[],Version:"0.1.0"}},this.playerType="normal","reveal"===PlayerSettings.playerType?this.playerType="reveal":(PlayerSettings.hiddenContainer||PlayerSettings.postAdContainer)&&(this.playerType="pregame"),this.theme="classic",PlayerSettings.theme&&/orion/g.test(PlayerSettings.theme)?this.theme="orion":PlayerSettings.css&&/substance/g.test(PlayerSettings.css)?this.theme="substance":PlayerSettings.css&&/bluemoon/g.test(PlayerSettings.css)&&(this.theme="bluemoon"),this.referrer_url=document.referrer,""===this.referrer_url&&(this.referrer_url=null),this.referrer_url&&(this.referrer_hostname=r.stripProtocol(this.referrer_url))};return i.prototype._getBrowserInfo=function(e){for(var t in e)e[t]||delete e[t];return{browserName:Object.keys(e)[0],browserVersion:Object.values(e)[0],browserSemVersion:Object.values(e)[1]}},i.prototype._isLoggingEventType=function(e){return"app_sessions"===e||"video_plays"===e||this.isSampling},i.prototype.send=function(e,t,i){if(this._isLoggingEventType(e)){this._execKinesisQueue();var n=this.pipelines[i],o=this;if("boltAds"===i)switch(e){case"bolt_players":var a={browserName:null,browserVersion:null,browserSemVersion:null};try{a=o._getBrowserInfo(window.client.browser)}catch(e){}var s={event_type:"bolt_players",uuid:this.playerId,type:this.playerType,theme:this.theme,css:PlayerSettings.css,initial_width:parseFloat(document.body.offsetWidth.toFixed(2)),inital_height:parseFloat(document.body.offsetHeight.toFixed(2)),embed_script:embedCode,config_url:PlayerSettings.config,page_url:parentUrl,page_hostname:r.stripProtocol(parentBaseUrl),referrer_url:this.referrer_url,referrer_hostname:this.referrer_hostname,load_time:t.loadTime,build_timestamp:t.buildTime,build_branch:t.buildBranch,user_agent:client.raw,user_agent_data:{connection_downlink:navigator.connection?navigator.connection.downlink:null,connection_type:navigator.connection?navigator.connection.effectiveType:null,connection_rtt:navigator.connection?navigator.connection.rtt:null,browser_name:a.browserName,browser_version:a.browserVersion,browser_sem_version:a.browserSemVersion},device_type:client.deviceType,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Player] %cloaded\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_sessions":this.adSessionId=this.playerId+".s"+r.makeSuperUniqueUuid();var s={event_type:"bolt_ad_sessions",player_uuid:this.playerId,id:this.adSessionId,publisher_id:t.publisher_id,video_id:t.video_id,self_service:null,backfilled_ad_session_id:null,timing:t.timing,tag_type:t.tag_type,server_type:t.server_type,fullscreen:t.fullscreen,player_width:t.player_width,player_height:t.player_height,cuepoint:t.cuepoint,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(t.start_ts)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Session] %cstart\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_sessions_results":t.timestamp||(t.timestamp=new Date);var s={event_type:"bolt_ad_sessions_results",player_uuid:this.playerId,ad_session_id:this.adSessionId,result:t.resultType,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(t.timestamp)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Session] %c"+t.resultType+"\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_requests":this.adRequestId=this.adSessionId+".r"+t.daisy_chain_count;var s={event_type:"bolt_ad_requests",player_uuid:this.playerId,ad_session_id:this.adSessionId,id:this.adRequestId,tag:t.tag,third_party_tag:t.third_party_tag,daisy_chain_count:t.daisy_chain_count,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(t.start_ts)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Request] %cstart dc: "+t.daisy_chain_count+"\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_request_results":var s={event_type:"bolt_ad_request_results",player_uuid:this.playerId,ad_session_id:this.adSessionId,ad_request_id:this.adRequestId,ad_type:t.ad_type,campaign_id:t.campaign_id,media_src:t.media_src,mime_type:t.mime_type,network:t.network,result:t.resultType,details:t.info,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(t.timestamp)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Reqeust] %c"+t.resultType+"\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_playback_milestones":var s={event_type:"bolt_ad_playback_milestones",player_uuid:this.playerId,ad_session_id:this.adSessionId,ad_request_id:this.adRequestId,milestone:t.milestone,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(new Date)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Playback Milestone] %c"+t.milestone+"\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n);break;case"bolt_ad_clicks":var s={event_type:"bolt_ad_clicks",player_uuid:this.playerId,ad_session_id:this.adSessionId,ad_request_id:this.adRequestId,click_url:t.clickUrl,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(new Date)};this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Ad Playback Click]\n","color: yellow;","color: pink;",s),this._push(s,n)}else if("boltErrors"===i){var l=t.message;if(!this.playerId)return;this.LOG_DEBUG&&console.log("%c[Kinesis] %c[Player] %cerror\n","color: yellow;","color: pink;","color: cyan;",this.playerId,l);var d={player_id:this.playerId,player_type:this.playerType,theme:this.theme,page_url:this.parentUrl,page_hostname:this.parentBaseUrl,referrer_hostname:this.referrer_hostname,referrer_url:this.referrer_url,site_info:window.site,client_info:this.clientInfo,player_settings:window.PlayerSettings,video_config:window.CurrentVideoConfig,build_time:window.buildTime,build_branch:window.buildBranch,player_width:parseFloat(document.body.offsetWidth.toFixed(2)),player_height:parseFloat(document.body.offsetHeight.toFixed(2)),embed_script:window.embedCode,timestamp:r.athenaFriendlyTimestamp(Date.now()),version:this.STREAM_NAME,error_message:l};this._push(d,n)}else if("app"===i){var u=[];switch(e){case"app_sessions":o.publisherId=t.publisherId,o.siteId=t.websiteId,o.appSession={event_type:"app_sessions",id:o.playerId,publisher_id:o.publisherId,website_id:o.siteId,page_url:parentUrl,page_hostname:r.stripProtocol(parentBaseUrl),referrer_url:o.referrer_url,referrer_hostname:o.referrer_hostname,user_agent:window.client.raw,device_type:window.client.deviceType,app:{name:"bolt",build_timestamp:r.athenaFriendlyTimestamp(window.buildTime)},version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.LOG_DEBUG&&console.log("%c[Kinesis] %c[App] %cApp Session\n","color: yellow;","color: pink;","color: cyan;",o.appSession),u.push(o.appSession),o._push(u,n);break;case"hb_info":var c=function(e){return"pregame"===e?"precontent":"normal"===e||"sticky-tyche"===e?"preroll":e}(o.playerType);if(o.headerbidAdUnit={event_type:"ad_units",id:"unit_"+r.makeSuperUniqueUuid(),code:c,app_session_id:o.playerId,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.LOG_DEBUG&&console.log("%c[Kinesis] %c[HB] %cAd Unit\n","color: yellow;","color: pink;","color: cyan;",o.headerbidAdUnit),u.push(o.headerbidAdUnit),o.headerbidAuction={event_type:"ad_auctions",id:"auction_"+r.makeSuperUniqueUuid(),timeout:t.bidderTimeout,result:t.winner&&t.winner.video?"succeeded":"failed",unit_id:o.headerbidAdUnit.id,app_session_id:o.playerId,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.LOG_DEBUG&&console.log("%c[Kinesis] %c[HB] %cAd Auction\n","color: yellow;","color: pink;","color: cyan;",o.headerbidAuction),u.push(o.headerbidAuction),r.objectPropExists(t,"bids","video","bids"))for(var h=0;h<t.bids.video.bids.length;h++){var p=t.bids.video.bids[h];"appnexusAst"===p.bidder&&(p.bidder="appnexus");var f={event_type:"ad_bids",id:"bid_"+r.makeSuperUniqueUuid(),unit_id:o.headerbidAdUnit.id,auction_id:o.headerbidAuction.id,bidder:p.bidder,requests_count:1,response_time:p.timeToRespond,result:"Bid available"===p.statusMessage?"available":"unavailable",cpm:p.cpm,app_session_id:o.playerId,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())};t.winner&&t.winner.video&&t.winner.video.hb_adid===p.adId&&(o.headerbidAuction.winning_bid_id=f.id),o.LOG_DEBUG&&console.log("%c[Kinesis] %c[HB] %cAd Bid\n","color: yellow;","color: pink;","color: cyan;",f),u.push(f)}o._push(u,n);break;case"ad_impressions":if(o.headerbidAuction&&!o.headerbidHasBeenTracked){var g;t.bidder&&(g=o.headerbidAuction.id),s={event_type:"ad_impressions",id:"impression_"+r.makeSuperUniqueUuid(),app_session_id:o.playerId,auction_id:g,unit_id:o.headerbidAdUnit.id,bidder:t.bidder,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.headerbidHasBeenTracked=!0,o.LOG_DEBUG&&console.log("%c[Kinesis] %c[HB] %cAd Impression\n","color: yellow;","color: pink;","color: cyan;",s),o._push(s,n)}break;case"video_plays":s={event_type:"video_plays",id:"play_"+r.makeSuperUniqueUuid(),session_id:o.playerId,video_id:CurrentVideoConfig.content.videoId,video_owner_id:r.getCurrentVideoOwnerId(),version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.LOG_DEBUG&&console.log("%c[Kinesis] %c[Video] %cplay\n","color: yellow;","color: pink;","color: cyan;",s),o._push(s,n);break;case"benchmarks":s={event_type:"benchmarks",id:"benchmark_"+r.makeSuperUniqueUuid(),session_id:this.playerId,app:{name:"bolt",build_timestamp:r.athenaFriendlyTimestamp(window.buildTime)},type:t.type,duration:t.duration,version:n.VERSION,timestamp:r.athenaFriendlyTimestamp(Date.now())},o.LOG_DEBUG&&console.log("%c[Kinesis] %c[Benchmark] %c"+s.type+"\n","color: yellow;","color: pink;","color: cyan;",s),this._push(s,n)}}}},i.prototype._push=function(e,t){if(Array.isArray(e)){var r,i;for(r=0;r<e.length;r++)i=e[r],t.queue.push(this._removeNulls(i))}else t.queue.push(this._removeNulls(e));void 0!==this._awsKinesis&&this._sendQueueToKinesis(t)},i.prototype._execKinesisQueue=function(){if(window.kinesisPerfQueue&&window.kinesisPerfQueue.length)for(var e=0;e<window.kinesisPerfQueue.length;e++){var t=window.kinesisPerfQueue.shift();this.send(t.eventType,t.data,t.pipeline)}},i.prototype._stringifyData=function(e){return{Data:JSON.stringify(e)+"\n",PartitionKey:"pk-"+Math.floor(1e5*Math.random())}},i.prototype._sendQueueToKinesis=function(e){for(var t,r=[];e.queue.length>0;)t=this._stringifyData(e.queue.shift()),r.push(t);this._awsKinesis.putRecords({Records:r,StreamName:e.STREAM_NAME},function(e,t){this.DEBUG_MODE&&e&&console.error("%c[Kinesis] %c- Kinesis Send Error","color: yellow;","color: red;",e)})},i.prototype._configureAwsKinesis=function(){var e=this;void 0===e._awsKinesis&&"undefined"!=typeof AWS&&(e.LOG_DEBUG&&console.log("%c[Kinesis] - Identifying and Configuring Kinesis","color: yellow;"),AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:e.IDENTITY_POOL_ID}),AWS.config.region=e.REGION,e._awsKinesis=new AWS.Kinesis({apiVersion:e._API_VERSION})),e._execKinesisQueue()},i.prototype._removeNulls=function(e){-1===e.publisher_id&&(e.publisher_id=null),-1===e.video_id&&(e.video_id=null),-1===e.cuepoint&&(e.cuepoint=null);for(var t in e)void 0!==e[t]&&null!==e[t]||delete e[t];return e},i}),define("base_ui_module",["zeus_eventdispatcher","zeus_utils","zeus_constants"],function(e,t,r){var i=window.PlayerView,n=t.dom,o=e.subclass({constructor:function(e){i=window.PlayerView,this.UI=r.UI,this.player=e,this._container=null,this.isOpen=null,i.addEventListener(r.UI.Event.APPEARANCE_SETTINGS_CHANGED,function(){this.updateAppearance()},this)},init:function(e){},invalidate:function(){},updateAppearance:function(){},open:function(e){this.isOpen||(this._container&&n.showElement(this._container),this.isOpen=!0,"function"==typeof e&&e.call())},close:function(e){!1!==this.isOpen&&(this._container&&n.hideElement(this._container),this.isOpen=!1,"function"==typeof e&&e.call())}});return window.BaseUI=o,o}),define("base_controlbar",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,r,i){var n=window.PlayerView,o=r.dom,a=r.css;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.timeTextSeparator="/",this._mouseEnterTimeout=null,this.audioBtn=o.getUI(i.UI.SOUND_BTN),this.playBtn=o.getUI(i.UI.PLAY_PAUSE_BTN),this.qualityBtn=o.getUI(i.UI.SETTINGS_BTN),this.fullscreenBtn=o.getUI(i.UI.FULLSCREEN_BTN),this._container=o.getUI(i.UI.CONTROLBAR),this._timeText=o.getUI(i.UI.TIME_TEXT),this.setUpMediaEventListeners(),this.setUpPlayerEventListeners(),this.setUpUIEventListeners(),this._keepOpen=!1},onPlayPause:function(e){if("false"===e.target.getAttribute("data-bolt-ui-enabled"))return void LOG.warn("button is disabled");n.currentPlayer.ended?n._dispatchEvent(i.UI.Event.REPLAY):n._dispatchEvent(i.UI.Event.PLAYPAUSE)},init:function(){var e=this;if(e.updateAppearance(),e.playBtn)if(client.system.android)e.playBtn.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.onPlayPause(t)});else{var r=new t(e.playBtn);r.on("tap",function(t){LOG.info("playbutton tap",t),t.srcEvent.stopPropagation(),t.srcEvent.preventDefault(),e.onPlayPause(t)})}if(e.qualityBtn){var o=function(){!0!==n.currentPlayer.isAd()&&("sd"===ContentPlayer.currentQuality?n._dispatchEvent(i.UI.Event.REQUEST_QUALITY,"hd"):n._dispatchEvent(i.UI.Event.REQUEST_QUALITY,"sd"))};if(client.system.android)e.qualityBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),o()});else{new t(e.qualityBtn).on("tap",function(e){e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),o()})}}if(e.fullscreenBtn)if(client.system.android)e.fullscreenBtn.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),LOG.debug(this,"FULLSCREEN"),n.toggleFullscreen()});else{var a=new t(e.fullscreenBtn);a.on("tap",function(e){parseInt(client.system.ios)>=10&&PlayerSettings.autoplay&&n.currentPlayer.isAd()&&(ContentPlayer.metadata||ContentPlayer.touch()),LOG.debug(e,"FULLSCREEN"),e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),n.toggleFullscreen()})}PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.START:case PlayerState.PAUSED:e.open();break;case PlayerState.ENDED:case PlayerState.RELATED_VIDEOS:e.open()}},e),n.addEventListener(i.Player.Event.CONFIG_CHANGED,function(){e.updateTimeLabels(),e.open()})},setUpMediaEventListeners:function(){var e=this;i.UI;n.addEventListener(i.Media.Event.STOPPED,function(){this.updateTimeLabels()},this),n.addEventListener(i.Media.Event.TIME_UPDATE,function(){this.updateTimeLabels()},this),n.addEventListener(i.Media.Event.DURATION_CHANGE,function(){n.currentPlayer.sourceChanged&&this.updateTimeLabels()},this),n.addEventListener(i.Media.Event.PLAY,function(){LOG.info("media play"),n.currentPlayer.isAd()&&BoltAdManager.type!=i.Ad.Type.FLASH_VPAID&&e.open()}),n.addEventListener(i.Media.Event.RESUME,function(){}),n.addEventListener(i.Media.Event.STOPPED,function(){})},setUpPlayerEventListeners:function(){},setUpUIEventListeners:function(){n.addEventListener(i.UI.Event.MOUSE_OUT,function(e){e.target===window.Skin&&n.currentPlayer&&!n.currentPlayer.isAd()&&this.close()},this),n.addEventListener(i.UI.Event.MOUSE_OVER,function(e){this.open()},this)},allowAutoHide:function(e){var t=this;e?a.hasClass(t._container,"_hide-mouseout")&&(a.removeClass(t._container,"_hide-mouseout"),a.addClass(t._container,"bolt-hide-mouseout")):a.hasClass(t._container,"bolt-hide-mouseout")&&(a.removeClass(t._container,"bolt-hide-mouseout"),a.addClass(t._container,"_hide-mouseout")),t._keepOpen=!e,t._keepOpen&&t.open()},durationShouldHide:function(e){return!e.duration||0===e.duration||e.currentTime>e.duration||e.isAd()&&e.duration<=this.UI.MIN_TIME_TO_SHOW_AD_DURATION},updateTimeLabels:function(){var e,t=this,i=n.currentPlayer;t._timeText&&(PlayerState.state===PlayerState.START?"number"==typeof CurrentVideoConfig.duration?t._timeText.textContent="0:00"+t.timeTextSeparator+r.toHHMMSS((CurrentVideoConfig.duration/1e3).toString()):t._timeText.textContent="":t.durationShouldHide(i)?t._timeText.textContent="":(e=i.currentTime,e<0&&(e=0),t._timeText.textContent=r.toHHMMSS(e.toString())+t.timeTextSeparator+r.toHHMMSS(i.duration.toString())))},updateAppearance:function(){var e=PlayerSettings.appearance,t=e.controlbar.backgroundColor.primary,r=e.colors.background,i=e.controlbar.backgroundColor.style;t&&0==t.indexOf("0x")&&(t="#"+t.substr(2)),r&&0==r.indexOf("0x")&&(r="#"+r.substr(2)),"gradient"===i?t&&(r||(r=t),a.injectBicolorGradient(".bolt-top-bar,.bolt-control-bar","top",r,t),9===window.client.browser.ie&&a.inject('.bolt-top-bar,.bolt-control-bar { filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr="'+t+'",EndColorStr="'+r+'");}')):t&&(a.inject(".bolt-top-bar, .bolt-control-bar { background:"+t+" !important }"),9===window.client.browser.ie&&a.inject('.bolt-top-bar, .bolt-control-bar { filter:progid:DXImageTransform.Microsoft.Gradient(enabled="false");}')),LOG.info("update controlbar appearance:: style:"+i+", primary color:",t," secondary color:",r);var n=e.controlbar.opacity;n&&a.inject(".bolt-control-bar{ opacity:"+n+" !important; }")},close:function(){this._keepOpen||(e.prototype.close.call(this),this._container.style.visibility="hidden",this._container.style.display="block")},open:function(){e.prototype.open.call(this),this._container.style.visibility="visible",this._container.style.display="block",this.invalidate()},invalidate:function(){this.updateTimeLabels()}})}),define("base_scrubber",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,r,i){var n=window.client,o=window.PlayerView,a=r.css,s=r.dom;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.videoStartTime=0,this._container=s.getUI(i.UI.SCRUBBER),this._pixelTimeFactor=null,this._interactiveEl=s.getUI(i.UI.TIMERAIL_INTERACTIVE),this._bufferEl=s.getUI(i.UI.TIMERAIL_BUFFER),this._progressEl=s.getUI(i.UI.TIMERAIL_PROGRESS),this._fixedValues=null,n.isMobile||(this._updateTooltip=this._updateTooltip.bind(this),this._tooltip={element:null,pointer:null,label:null})},init:function(){var e=this;e.updateAppearance(),n.isMobile||e._initTooltip();var a=s.getUI(i.UI.TIMERAIL_INTERACTIVE);if(a){new t(a).on("tap",function(t){if(!(!s.isEnabled(t.target)||o.currentPlayer.isAd()||null===o.currentPlayer.duration||o.currentPlayer.duration<=0)){var n=o.fullscreen?t.pointers[0].pageX:t.pointers[0].pageX-r.getScreenPosition(a).x,l=n/a.clientWidth,d=l*o.currentPlayer.duration;e._dispatchEvent(i.UI.Event.SEEK,d)}})}o.addEventListener(i.Media.Event.DURATION_CHANGE,function(){o.currentPlayer.isAd()?s.enableUI(i.UI.TIMERAIL_INTERACTIVE,!1):s.enableUI(i.UI.TIMERAIL_INTERACTIVE,!0),o.currentPlayer.sourceChanged&&e.invalidate()}),o.addEventListener(i.Media.Event.CONFIG_CHANGED,function(){e.setVideoStartTime(0)}),o.addEventListener(i.Media.Event.START_TIME_CHANGED,function(){e.setVideoStartTime(0)}),o.addEventListener(i.Media.Event.LOAD_PROGRESS,function(){e.updateBuffer()}),o.addEventListener(i.Media.Event.LOAD_START,function(){e.updateBuffer()}),o.addEventListener(i.Media.Event.TIME_UPDATE,function(){e.updateProgress()}),o.addEventListener(i.Media.Event.STOPPED,function(){e.updateProgress()})},_initTooltip:function(){var e=this;e._tooltip.element=document.getElementsByClassName("bolt-scrubber-tooltip")[0],e._tooltip.label=e._tooltip.element.firstElementChild,e._tooltip.element&&e._tooltip.label&&(e._tooltip.pointer=document.createElement("div"),e._tooltip.pointer.style.position="absolute",e._tooltip.pointer.style.width=0,e._tooltip.pointer.style.height=0,e._tooltip.pointer.style.borderWidth="5px",e._tooltip.pointer.style.borderStyle="solid",e._tooltip.pointer.style.borderColor=getComputedStyle(this._tooltip.element).backgroundColor+" transparent transparent",e._tooltip.element.appendChild(e._tooltip.pointer),e._interactiveEl.addEventListener("mouseenter",e._updateTooltip),e._interactiveEl.addEventListener("mousemove",e._updateTooltip),e._interactiveEl.addEventListener("mouseleave",function(t){e._tooltip.element.style.display="none"}))},_updateTooltip:function(e){var t=this;if(!t._tooltip){var i=o.currentPlayer;if(0!==i.duration&&!0!==i.isAd()){var n=t._interactiveEl.clientWidth,a=i.fullscreen?e.pageX:e.pageX-r.getScreenPosition(t._interactiveEl).x,s=a/n,l=s*i.duration;t._tooltip.label.textContent=r.toHHMMSS(l),t._tooltip.element.style.display="block";var d=t._tooltip.element.clientWidth,u=0;u=a+d/2>n?n-d:a-d/2<0?0:a-d/2,t._tooltip.element.style.left=u+"px";var c=parseFloat(getComputedStyle(t._tooltip.element).borderRadius),h=2*parseFloat(t._tooltip.pointer.style.borderWidth),p=a-u-h/2;p+h+c>d?p=d-h-c:p<c&&(p=c),t._tooltip.pointer.style.left=p+"px"}}},setVideoStartTime:function(e){this.videoStartTime=e,this.invalidate()},invalidate:function(){var e=o.currentPlayer,t=this;e&&(t._pixelTimeFactor=e.duration/t._container.clientWidth),t.resetWidths(),o.currentPlayer.isAd()?s.enableUI(i.UI.TIMERAIL_INTERACTIVE,!1):s.enableUI(i.UI.TIMERAIL_INTERACTIVE,!0)},fixedValues:function(e){if(e){this._fixedValues=[25,50];var t=s.getUI(i.UI.TIMERAIL_BUFFER);t&&(t.style.width="50%");var r=s.getUI(i.UI.TIMERAIL_PROGRESS);r&&(r.style.width="25%")}else this._fixedValues=null},resetWidths:function(){var e=this;if(!e._fixedValues){var t=e.videoStartTime&&e._pixelTimeFactor!=1/0?e.videoStartTime/e._pixelTimeFactor*100/e._container.clientWidth+"%":0;e._progressEl&&(e._progressEl.style.width=t),e._bufferEl&&(e._bufferEl.style.width=t),e.updateBuffer(),e.updateProgress()}},updateBuffer:function(){var e=o.currentPlayer,t=this;if(!t._fixedValues){var r=e.buffered*e.duration/100,i=r/t._pixelTimeFactor;t._bufferEl.style.width=100*i/t._container.clientWidth+"%"}},updateProgress:function(){var e=o.currentPlayer,t=this;t._fixedValues||(t._progressEl.style.width=e.currentTime/t._pixelTimeFactor+"px")},updateAppearance:function(){var e=window.PlayerSettings.appearance,t=e.scrubber.backgroundColor;t&&(0==t.indexOf("0x")&&(t="#"+t.substr(2)),a.inject(".bolt-timebar{ background-color:"+t+" !important;}"));var r=e.scrubber.opacity;r&&a.inject(".bolt-timebar{opacity:"+r+";}");var i=e.scrubber.buffer.backgroundColor;i&&(0==i.indexOf("0x")&&(i="#"+i.substr(2)),a.inject(".bolt-loaded{ background-color:"+i+" !important;}"));var n=e.scrubber.buffer.opacity;n&&a.inject(".bolt-loaded{opacity:"+n+";}");var o=e.scrubber.progress.backgroundColor;o&&(0==o.indexOf("0x")&&(o="#"+i.substr(2)),a.inject(".bolt-progress{ background-color:"+o+" !important;}"));var s=e.scrubber.progress.opacity;s&&a.inject(".bolt-progress{opacity:"+s+";}")}})}),define("controlbar",["base_controlbar","hammer","zeus_utils","zeus_constants"],function(e,t,r,i){var n=r.css;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t)},init:function(){e.prototype.init.call(this)},updateAppearance:function(){e.prototype.updateAppearance.call(this);var t=window.PlayerSettings.appearance,r=t.controlbar.separator.backgroundColor.primary;r&&(0===r.indexOf("0x")&&(r="#"+r.substr(2)),n.inject(".bolt-separator .bolt-dark-line{ background-color:"+r+" !important;opacity:"+t.controlbar.separator.opacity+"}"));var i=t.controlbar.separator.backgroundColor.secondary;i&&(0===i.indexOf("0x")&&(i="#"+i.substr(2)),n.inject(".bolt-separator .bolt-light-line{ background-color:"+i+" !important; opacity:"+t.controlbar.separator.opacity+"}"));var o=t.controlbar.separator.opacity;o&&n.inject(".bolt-separator { opacity:"+o+";}");var a=t.controlbar.corner;"rounded"===a?(n.inject(".bolt-control-bar{ border-radius:0 0 5px 5px !important; }"),n.inject(".bolt-scrubber{ overflow:hidden; border-radius:5px 5px 0 0 !important; }")):"sharp"===a&&n.inject(".bolt-scrubber{ border-radius:0 !important; }");var s=t.controlbar.position;if("floating"===s){var l=100-2*parseFloat("3%")+"%";n.inject(".bolt-control-bar{ bottom:3% !important;left:3%;right:3%;width:"+l+"; }"),n.inject(".bolt-watermark-layer{ bottom:12% !important; }")}else"docked"===s&&(n.inject(".bolt-control-bar{ bottom:0 !important; left:0;right:0; width:100% }"),n.inject(".bolt-watermark-layer{ bottom:11% !important; }"))},close:function(){window.client.isMobile||e.prototype.close.call(this)}})}),define("preroll_screen",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,r,i){var n=window.PlayerView,o=r.dom,a=r.css;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._container=o.getUI(i.UI.BIG_PLAY)},init:function(){var e=this,r=function(e){if("false"===e.target.getAttribute("data-bolt-ui-enabled"))return void LOG.warn("button is disabled");n.currentPlayer.ended?n._dispatchEvent(i.UI.Event.REPLAY):n._dispatchEvent(i.UI.Event.PLAYPAUSE)};if(client.system.android||client.system.ipad)e._container.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),r(e)});else{new t(e._container).on("tap",function(e){e.srcEvent.stopPropagation(),e.srcEvent.preventDefault(),r(e)})}window.PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.START:this.open();break;case PlayerState.PAUSED:client.system.iphone?parseInt(client.system.ios)>=9&&this.open():this.open();break;default:this.close()}},this),n.addEventListener(i.Player.Event.PLAY,function(){e.close()})},updateAppearance:function(e){LOG.info("update big play appearance");var t=window.PlayerSettings.appearance,r=t.colors.active;r&&(0==r.indexOf("0x")&&(r="#"+r.substr(2)),a.inject(".bolt-bigplay-layer .bolt-icon { color:"+r+" !important; fill: "+r+"!important;}"))}})}),define("scrubber",["zeus_utils","zeus_constants","base_scrubber"],function(e,t,r){var i=(e.css,e.dom);return r.subclass({constructor:function(e){r.prototype.constructor.call(this,e)},init:function(){r.prototype.init.call(this),client.isMobile||this._initAnimation()},_initAnimation:function(){function r(e){if("in"===e){if(f&&(clearInterval(f),f=null),p||a.isAd())return;p=setInterval(function(){var e=l.clientHeight;if(e<u){var t=e+1;l.style.height=t+"px";var r=-t;l.style.marginTop=r+"px"}else clearInterval(p),p=null},50)}else if("out"===e){if(p&&(clearInterval(p),p=null),f)return;f=setInterval(function(){var e=l.clientHeight;if(e>c){var t=e-1;l.style.height=t+"px";var r=-t;l.style.marginTop=r+"px"}else clearInterval(f),f=null},50)}}var n=t.UI,o=this,a=PlayerView.currentPlayer,s=i.getUI(n.CONTROLBAR),l=o._container,d=window.Skin;if(l){var u=l.clientHeight,c=5,h=c;l.style.height=c+"px",l.style.marginTop=-h+"px";var p=null,f=null;d.addEventListener("mousemove",function(t){var i=t.pageY;e.getScreenPosition(l).y-i<20?l.clientHeight<u&&r("in"):l.clientHeight>c&&r("out")}),s.addEventListener("mouseenter",function(e){r("in")}),s.addEventListener("mouseleave",function(t){var i=t.pageY,n=e.getScreenPosition(l).y,o=n-i;o>0?o>20&&r("out"):r("out")})}}})}),define("content",["base_ui_module","hammer","zeus_utils","zeus_constants"],function(e,t,r,i){var n=window.PlayerView,o=r.dom
;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._cbar=o.getUI(i.UI.CONTROLBAR),this._container=o.getUI(i.UI.CONTENT),this._adContainer=window.Skin.querySelector(".bolt-ad-container"),this._defaultBoxModel={}},init:function(){var e=this._container;if(this._defaultBoxModel={position:e.style.position,top:e.style.top,right:e.style.right,left:e.style.left,bottom:e.style.bottom,width:e.style.width,height:e.style.height,marginTop:e.style.marginTop,marginBottom:e.style.marginBottom,marginLeft:e.style.marginLeft,marginRight:e.style.marginRight,paddingTop:e.style.paddingTop,paddingBottom:e.style.paddingBottom,paddingLeft:e.style.paddingLeft,paddingRight:e.style.paddingRight,zIndex:e.style.zIndex},this._adContainer){var r=this._container.clientHeight-this._cbar.clientHeight;this._adContainer.setAttribute("data-zeus-initial-width",this._container.clientWidth.toString()),this._adContainer.setAttribute("data-zeus-initial-height",r.toString())}else LOG.warn("[Bolt3 content] ad-container not found");var a=o.getUI(i.UI.MAIN_VIDEO_CONTAINER);if(a)if(client.isMobile)if(client.system.android||client.system.ipad)a.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),LOG.debug("main video clicked",e.target),n._dispatchEvent(i.UI.Event.PLAYPAUSE)});else{var s=new t(a);s.on("tap",function(e){LOG.debug("main video tapped",e.srcEvent),n._dispatchEvent(i.UI.Event.PLAYPAUSE)})}else if("native"===window.ContentPlayer.type){var l=new t(a);l.on("tap",function(){n._dispatchEvent(i.UI.Event.PLAYPAUSE)})}PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.AGE_GATE:this.setPoster(null);break;case PlayerState.START:case PlayerState.ENDED:this.setPoster(CurrentVideoConfig.content.poster);break;case PlayerState.PLAYING:this.setPoster(null)}},this),BoltAdManager&&BoltAdManager.addEventListener(i.Ad.Event.REQUESTED,function(){"preroll"===BoltAdManager.timing&&this.setPoster(CurrentVideoConfig.content.poster)},this)},setPoster:function(e){var t=o.getUI(i.UI.POSTER);if(!e)return LOG.debug("NO POSTER"),t.style.backgroundImage="",void o.hideElement(t);t&&(t.style.background='url("'+r.normalizeProtocol(e)+'") center center no-repeat !important',t.style.backgroundImage='url("'+r.normalizeProtocol(e)+'")',t.style.backgroundSize="contain",o.showElement(t))},invalidate:function(){var e=this._container;if(n.fullscreen?(e.style.position="absolute",e.style.top=0,e.style.bottom=0,e.style.left=0,e.style.right=0,e.style.margin="auto"):(e.style.position=this._defaultBoxModel.position,e.style.top=this._defaultBoxModel.top,e.style.bottom=this._defaultBoxModel.bottom,e.style.left=this._defaultBoxModel.left,e.style.right=this._defaultBoxModel.right,e.style.marginTop=this._defaultBoxModel.marginTop,e.style.marginLeft=this._defaultBoxModel.marginLeft,e.style.marginBottom=this._defaultBoxModel.marginBottom,e.style.marginRight=this._defaultBoxModel.marginRight,e.style.paddingTop=this._defaultBoxModel.paddingTop,e.style.paddingLeft=this._defaultBoxModel.paddingLeft,e.style.paddingBottom=this._defaultBoxModel.paddingBottom,e.style.paddingRight=this._defaultBoxModel.paddingRight,e.style.zIndex=this._defaultBoxModel.zIndex),this._adContainer){var t=window.BoltAdManager;if(t&&t.adPlayer)if(t.adPlayer.isLinear())if(this._adContainer.style.width="100%",n.currentPlayer.type===i.Ad.Type.FLASH_VPAID){var r=this._container.clientHeight-this._cbar.clientHeight;this._adContainer.style.height=r+"px"}else this._adContainer.style.height="100%";else t.adPlayer.updateLayout();else this._adContainer.style.width="100%",this._adContainer.style.height="100%"}}})}),function(e,t){"function"==typeof define&&define.amd?define("dragdealer",t):e.Dragdealer=t()}(this,function(){function e(e){var t="Webkit Moz ms O".split(" "),r=document.documentElement.style;if(void 0!==r[e])return e;e=e.charAt(0).toUpperCase()+e.substr(1);for(var i=0;i<t.length;i++)if(void 0!==r[t[i]+e])return t[i]+e}function t(e){u.backfaceVisibility&&u.perspective&&(e.style[u.perspective]="1000px",e.style[u.backfaceVisibility]="hidden")}var r=function(e,t){this.options=this.applyDefaults(t||{}),this.bindMethods(),this.wrapper=this.getWrapperElement(e),this.wrapper&&(this.handle=this.getHandleElement(this.wrapper,this.options.handleClass),this.handle&&(this.init(),this.bindEventListeners()))};r.prototype={defaults:{disabled:!1,horizontal:!0,vertical:!1,slide:!0,steps:0,snap:!1,loose:!1,speed:.1,xPrecision:0,yPrecision:0,handleClass:"handle",css3:!0,activeClass:"active",tapping:!0},init:function(){this.options.css3&&t(this.handle),this.value={prev:[-1,-1],current:[this.options.x||0,this.options.y||0],target:[this.options.x||0,this.options.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.dragStartPosition={x:0,y:0},this.change=[0,0],this.stepRatios=this.calculateStepRatios(),this.activity=!1,this.dragging=!1,this.tapping=!1,this.reflow(),this.options.disabled&&this.disable()},applyDefaults:function(e){for(var t in this.defaults)e.hasOwnProperty(t)||(e[t]=this.defaults[t]);return e},getWrapperElement:function(e){return"string"==typeof e?document.getElementById(e):e},getHandleElement:function(e,t){var r,i,n;if(e.getElementsByClassName){if(r=e.getElementsByClassName(t),r.length>0)return r[0]}else for(i=new RegExp("(^|\\s)"+t+"(\\s|$)"),r=e.getElementsByTagName("*"),n=0;n<r.length;n++)if(i.test(r[n].className))return r[n]},calculateStepRatios:function(){var e=[];if(this.options.steps>=1)for(var t=0;t<=this.options.steps-1;t++)this.options.steps>1?e[t]=t/(this.options.steps-1):e[t]=0;return e},setWrapperOffset:function(){this.offset.wrapper=d.get(this.wrapper)},calculateBounds:function(){var e={top:this.options.top||0,bottom:-(this.options.bottom||0)+this.wrapper.offsetHeight,left:this.options.left||0,right:-(this.options.right||0)+this.wrapper.offsetWidth};return e.availWidth=e.right-e.left-this.handle.offsetWidth,e.availHeight=e.bottom-e.top-this.handle.offsetHeight,e},calculateValuePrecision:function(){var e=this.options.xPrecision||Math.abs(this.bounds.availWidth),t=this.options.yPrecision||Math.abs(this.bounds.availHeight);return[e?1/e:0,t?1/t:0]},bindMethods:function(){"function"==typeof this.options.customRequestAnimationFrame?this.requestAnimationFrame=i(this.options.customRequestAnimationFrame,window):this.requestAnimationFrame=i(h,window),"function"==typeof this.options.customCancelAnimationFrame?this.cancelAnimationFrame=i(this.options.customCancelAnimationFrame,window):this.cancelAnimationFrame=i(p,window),this.animateWithRequestAnimationFrame=i(this.animateWithRequestAnimationFrame,this),this.animate=i(this.animate,this),this.onHandleMouseDown=i(this.onHandleMouseDown,this),this.onHandleTouchStart=i(this.onHandleTouchStart,this),this.onDocumentMouseMove=i(this.onDocumentMouseMove,this),this.onWrapperTouchMove=i(this.onWrapperTouchMove,this),this.onWrapperMouseDown=i(this.onWrapperMouseDown,this),this.onWrapperTouchStart=i(this.onWrapperTouchStart,this),this.onDocumentMouseUp=i(this.onDocumentMouseUp,this),this.onDocumentTouchEnd=i(this.onDocumentTouchEnd,this),this.onHandleClick=i(this.onHandleClick,this),this.onWindowResize=i(this.onWindowResize,this)},bindEventListeners:function(){n(this.handle,"mousedown",this.onHandleMouseDown),n(this.handle,"touchstart",this.onHandleTouchStart),n(document,"mousemove",this.onDocumentMouseMove),n(this.wrapper,"touchmove",this.onWrapperTouchMove),n(this.wrapper,"mousedown",this.onWrapperMouseDown),n(this.wrapper,"touchstart",this.onWrapperTouchStart),n(document,"mouseup",this.onDocumentMouseUp),n(document,"touchend",this.onDocumentTouchEnd),n(this.handle,"click",this.onHandleClick),n(window,"resize",this.onWindowResize),this.animate(!1,!0),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},unbindEventListeners:function(){o(this.handle,"mousedown",this.onHandleMouseDown),o(this.handle,"touchstart",this.onHandleTouchStart),o(document,"mousemove",this.onDocumentMouseMove),o(this.wrapper,"touchmove",this.onWrapperTouchMove),o(this.wrapper,"mousedown",this.onWrapperMouseDown),o(this.wrapper,"touchstart",this.onWrapperTouchStart),o(document,"mouseup",this.onDocumentMouseUp),o(document,"touchend",this.onDocumentTouchEnd),o(this.handle,"click",this.onHandleClick),o(window,"resize",this.onWindowResize),this.cancelAnimationFrame(this.interval)},onHandleMouseDown:function(e){l.refresh(e),a(e),s(e),this.activity=!1,this.startDrag()},onHandleTouchStart:function(e){l.refresh(e),s(e),this.activity=!1,this.startDrag()},onDocumentMouseMove:function(e){e.clientX-this.dragStartPosition.x==0&&e.clientY-this.dragStartPosition.y==0||(l.refresh(e),this.dragging&&(this.activity=!0,a(e)))},onWrapperTouchMove:function(e){if(l.refresh(e),!this.activity&&this.draggingOnDisabledAxis())return void(this.dragging&&this.stopDrag());a(e),this.activity=!0},onWrapperMouseDown:function(e){l.refresh(e),a(e),this.startTap()},onWrapperTouchStart:function(e){l.refresh(e),a(e),this.startTap()},onDocumentMouseUp:function(e){this.stopDrag(),this.stopTap()},onDocumentTouchEnd:function(e){this.stopDrag(),this.stopTap()},onHandleClick:function(e){this.activity&&(a(e),s(e))},onWindowResize:function(e){this.reflow()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,/\s?disabled/.test(this.handle.className)||(this.handle.className+=" disabled")},reflow:function(){this.setWrapperOffset(),this.bounds=this.calculateBounds(),this.valuePrecision=this.calculateValuePrecision(),this.updateOffsetFromValue()},getStep:function(){return[this.getStepNumber(this.value.target[0]),this.getStepNumber(this.value.target[1])]},getStepWidth:function(){return Math.abs(this.bounds.availWidth/this.options.steps)},getValue:function(){return this.value.target},setStep:function(e,t,r){this.setValue(this.options.steps&&e>1?(e-1)/(this.options.steps-1):0,this.options.steps&&t>1?(t-1)/(this.options.steps-1):0,r)},setValue:function(e,t,r,i){this.setTargetValue([e,t||0]),r&&(this.groupCopy(this.value.current,this.value.target),this.updateOffsetFromValue(),i||this.callAnimationCallback())},startTap:function(){!this.disabled&&this.options.tapping&&(this.tapping=!0,this.setWrapperOffset(),this.setTargetValueByOffset([l.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,l.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current))},startDrag:function(){this.disabled||(this.dragging=!0,this.setWrapperOffset(),this.dragStartPosition={x:l.x,y:l.y},this.offset.mouse=[l.x-d.get(this.handle)[0],l.y-d.get(this.handle)[1]],this.wrapper.className.match(this.options.activeClass)||(this.wrapper.className+=" "+this.options.activeClass),this.callDragStartCallback())},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var e=0===this.bounds.availWidth?0:(l.x-this.dragStartPosition.x)/this.bounds.availWidth,t=0===this.bounds.availHeight?0:(l.y-this.dragStartPosition.y)/this.bounds.availHeight,r=[e,t],i=this.groupClone(this.value.current);if(this.options.slide){var n=this.change;i[0]+=4*n[0],i[1]+=4*n[1]}this.setTargetValue(i),this.wrapper.className=this.wrapper.className.replace(" "+this.options.activeClass,""),this.callDragStopCallback(r)}},callAnimationCallback:function(){var e=this.value.current;this.options.snap&&this.options.steps>1&&(e=this.getClosestSteps(e)),this.groupCompare(e,this.value.prev)||("function"==typeof this.options.animationCallback&&this.options.animationCallback.call(this,e[0],e[1]),this.groupCopy(this.value.prev,e))},callTargetCallback:function(){"function"==typeof this.options.callback&&this.options.callback.call(this,this.value.target[0],this.value.target[1])},callDragStartCallback:function(){"function"==typeof this.options.dragStartCallback&&this.options.dragStartCallback.call(this,this.value.target[0],this.value.target[1])},callDragStopCallback:function(e){"function"==typeof this.options.dragStopCallback&&this.options.dragStopCallback.call(this,this.value.target[0],this.value.target[1],e)},animateWithRequestAnimationFrame:function(e){e?(this.timeOffset=this.timeStamp?e-this.timeStamp:0,this.timeStamp=e):this.timeOffset=25,this.animate(),this.interval=this.requestAnimationFrame(this.animateWithRequestAnimationFrame)},animate:function(e,t){if(!e||this.dragging){if(this.dragging){var r=this.groupClone(this.value.target),i=[l.x-this.offset.wrapper[0]-this.offset.mouse[0],l.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetValueByOffset(i,this.options.loose),this.change=[this.value.target[0]-r[0],this.value.target[1]-r[1]]}(this.dragging||t)&&this.groupCopy(this.value.current,this.value.target),(this.dragging||this.glide()||t)&&(this.updateOffsetFromValue(),this.callAnimationCallback())}},glide:function(){var e=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return!(!e[0]&&!e[1])&&(Math.abs(e[0])>this.valuePrecision[0]||Math.abs(e[1])>this.valuePrecision[1]?(this.value.current[0]+=e[0]*Math.min(this.options.speed*this.timeOffset/25,1),this.value.current[1]+=e[1]*Math.min(this.options.speed*this.timeOffset/25,1)):this.groupCopy(this.value.current,this.value.target),!0)},updateOffsetFromValue:function(){this.options.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.groupCompare(this.offset.current,this.offset.prev)||(this.renderHandlePosition(),this.groupCopy(this.offset.prev,this.offset.current))},renderHandlePosition:function(){var e="";if(this.options.css3&&u.transform)return this.options.horizontal&&(e+="translateX("+this.offset.current[0]+"px)"),this.options.vertical&&(e+=" translateY("+this.offset.current[1]+"px)"),void(this.handle.style[u.transform]=e);this.options.horizontal&&(this.handle.style.left=this.offset.current[0]+"px"),this.options.vertical&&(this.handle.style.top=this.offset.current[1]+"px")},setTargetValue:function(e,t){var r=t?this.getLooseValue(e):this.getProperValue(e);this.groupCopy(this.value.target,r),this.offset.target=this.getOffsetsByRatios(r),this.callTargetCallback()},setTargetValueByOffset:function(e,t){var r=this.getRatiosByOffsets(e),i=t?this.getLooseValue(r):this.getProperValue(r);this.groupCopy(this.value.target,i),this.offset.target=this.getOffsetsByRatios(i)},getLooseValue:function(e){var t=this.getProperValue(e);return[t[0]+(e[0]-t[0])/4,t[1]+(e[1]-t[1])/4]},getProperValue:function(e){var t=this.groupClone(e);return t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0),t[0]=Math.min(t[0],1),t[1]=Math.min(t[1],1),(!this.dragging&&!this.tapping||this.options.snap)&&this.options.steps>1&&(t=this.getClosestSteps(t)),t},getRatiosByOffsets:function(e){return[this.getRatioByOffset(e[0],this.bounds.availWidth,this.bounds.left),this.getRatioByOffset(e[1],this.bounds.availHeight,this.bounds.top)]},getRatioByOffset:function(e,t,r){return t?(e-r)/t:0},getOffsetsByRatios:function(e){return[this.getOffsetByRatio(e[0],this.bounds.availWidth,this.bounds.left),this.getOffsetByRatio(e[1],this.bounds.availHeight,this.bounds.top)]},getOffsetByRatio:function(e,t,r){return Math.round(e*t)+r},getStepNumber:function(e){return this.getClosestStep(e)*(this.options.steps-1)+1},getClosestSteps:function(e){return[this.getClosestStep(e[0]),this.getClosestStep(e[1])]},getClosestStep:function(e){for(var t=0,r=1,i=0;i<=this.options.steps-1;i++)Math.abs(this.stepRatios[i]-e)<r&&(r=Math.abs(this.stepRatios[i]-e),t=i);return this.stepRatios[t]},groupCompare:function(e,t){return e[0]==t[0]&&e[1]==t[1]},groupCopy:function(e,t){e[0]=t[0],e[1]=t[1]},groupClone:function(e){return[e[0],e[1]]},draggingOnDisabledAxis:function(){return!this.options.horizontal&&l.xDiff>l.yDiff||!this.options.vertical&&l.yDiff>l.xDiff}};for(var i=function(e,t){return function(){return e.apply(t,arguments)}},n=function(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on"+t,r)},o=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent&&e.detachEvent("on"+t,r)},a=function(e){e||(e=window.event),e.preventDefault&&e.preventDefault(),e.returnValue=!1},s=function(e){e||(e=window.event),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},l={x:0,y:0,xDiff:0,yDiff:0,refresh:function(e){e||(e=window.event),"mousemove"==e.type?this.set(e):e.touches&&this.set(e.touches[0])},set:function(e){var t=this.x,r=this.y;e.clientX||e.clientY?(this.x=e.clientX,this.y=e.clientY):(e.pageX||e.pageY)&&(this.x=e.pageX-document.body.scrollLeft-document.documentElement.scrollLeft,this.y=e.pageY-document.body.scrollTop-document.documentElement.scrollTop),this.xDiff=Math.abs(this.x-t),this.yDiff=Math.abs(this.y-r)}},d={get:function(e){var t={left:0,top:0};return void 0!==e.getBoundingClientRect&&(t=e.getBoundingClientRect()),[t.left,t.top]}},u={transform:e("transform"),perspective:e("perspective"),backfaceVisibility:e("backfaceVisibility")},c=["webkit","moz"],h=window.requestAnimationFrame,p=window.cancelAnimationFrame,f=0;f<c.length&&!h;++f)h=window[c[f]+"RequestAnimationFrame"],p=window[c[f]+"CancelAnimationFrame"]||window[c[f]+"CancelRequestAnimationFrame"];return h||(h=function(e){return setTimeout(e,25)},p=clearTimeout),r}),define("volume",["hammer","dragdealer","base_ui_module","zeus_utils","zeus_constants"],function(e,t,r,i,n){var o=window.client,a=window.PlayerView,s=i.dom,l=window.parseInt,d="background-color:#333;color:#fff;font-weight:bold;",u="background-color:default;color:default;";return r.subclass({constructor:function(e){r.prototype.constructor.call(this,e);var t=this;t._html='<div data-bolt-ui="volume-slider" id="volume-slider" class="bolt-volume-slider dragdealer"><div class="bolt-volume-slider-background"></div><div class="bolt-current-volume bolt-block-highlight"></div><div class="bolt-handle bolt-foreground"><svg class="bolt-volume-marker bolt-foreground" width="512px" height="512px" viewbox="0 0 512 512" xml:space="preserve"><circle cx="256" cy="256" r="256" /></svg></div></div>',t._container=s.getUI(n.UI.VOLUME_CONTROL),t.soundBtn=s.getUI(n.UI.SOUND_BTN),t._container&&(t._container.insertAdjacentHTML("beforeend",t._html),t._background=t._container.querySelector(".bolt-volume-slider-background"),t._handle=t._container.querySelector(".bolt-handle"),t._fill=t._container.querySelector(".bolt-current-volume"),t._fillMaxHeight=parseFloat(getComputedStyle(t._background).height),t._slider=null,t._tooltipTimeout=null,a.addEventListener(n.UI.Event.MOUSE_OVER,function(e){e.target===t.soundBtn&&(LOG.info("%c🔉 [Zeus Volume] %c- PlayerView mouse enter sound btn",d,u),t.open())}),a.addEventListener(n.UI.Event.MOUSE_OUT,function(e){e.target!==t.soundBtn&&e.target!=window.Skin||t.close()}))},init:function(){var r=this;if(r._container&&(r._slider=new t("volume-slider",{vertical:!0,horizontal:!1,top:0,bottom:-parseFloat(getComputedStyle(r._handle).height)/2,animationCallback:this._onSliderUpdate.bind(this),handleClass:"bolt-handle",css3:!1,speed:1,slide:!0}),r.setPlayer(r.player),o.browser.ie>9?r._container.addEventListener("pointerup",function(e){r._slider&&(r._slider.dragging=!1),e.stopPropagation()}):r._container.addEventListener("mouseup",function(e){r._slider&&(r._slider.dragging=!1),e.stopPropagation()})),r.soundBtn){r.soundBtn.addEventListener("mouseenter",function(){s.isEnabled(r.soundBtn)&&("8"!==o.system.win&&"8.1"!==o.system.win||!o.browser.chrome&&!o.browser.ie?a.onMouseOver(r.soundBtn):r._mouseEnterTimeout=setTimeout(function(){a.mouseInput&&!a.mouseInput.isTouched&&a.onMouseOver(r.soundBtn)},100))}),o.hasTouch||r.soundBtn.addEventListener("mouseleave",function(e){s.isEnabled(r.soundBtn)&&(LOG.debug("%c🔉 [Zeus Volume] %c- mouse leave, audio",d,u),e.stopPropagation(),a.onMouseOut(r.soundBtn),a.mouseInput&&(a.mouseInput.isTouched=!1))});var i=new e(r.soundBtn);if("8"!==o.system.win&&"8.1"!==o.system.win||!o.browser.chrome&&!o.browser.ie){if(r.soundBtn)if(o.isMobile)o.system.ios?i.on("tap",r._onTapMouseDownCb.bind(r)):r.soundBtn.addEventListener("touchstart",r._onTapMouseDownCb.bind(r));else{var c=r.soundBtn.querySelector(".bolt-handle");r.soundBtn.addEventListener("click",r._onTapMouseDownCb.bind(r)),c&&r.soundBtn.querySelector(".bolt-handle").addEventListener("mouseup",r._onHandleMouseUpCb.bind(r))}}else i.on("hammer.input",function(e){s.isEnabled(r.soundBtn)&&("touch"===e.pointerType?"touchstart"===e.srcEvent.type||"pointerdown"===e.srcEvent.type?(a.mouseInput&&(a.mouseInput.isTouched=!0),r._mouseEnterTimeout&&(clearTimeout(r._mouseEnterTimeout),r._mouseEnterTimeout=null)):"touchend"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&a._dispatchEvent(n.UI.Event.TOGGLE_MUTE):"mouseup"!==e.srcEvent.type&&"pointerup"!==e.srcEvent.type||e.isFinal&&a._dispatchEvent(n.UI.Event.TOGGLE_MUTE))})}a.addEventListener(n.UI.Event.PLAYER_CHANGED,function(){var e=n.UI;a.currentPlayer.isAd()?BoltAdManager.type===n.Ad.Type.STATIC_IMAGE||BoltAdManager.type===n.Ad.Type.THREE_TWO_FIFTY?s.enableUI(e.SOUND_BTN,!1):s.enableUI(e.SOUND_BTN,!0):PlayerSettings.adOnly||(!o.isMobile||l(o.system.ios,10)>=10||o.system.android)&&s.enableUI(e.SOUND_BTN,!0)})},_onTapMouseDownCb:function(e){var t,r=this;s.isEnabled(r.soundBtn)&&((l(o.system.ios,10)>=10||o.system.android)&&PlayerSettings.autoplay&&a.currentPlayer.isAd()&&(ContentPlayer.hasStarted||ContentPlayer.touch()),o.isMobile||!r._slider||(e.target.classList.contains("bolt-sound-btn")||e.target.parentNode.classList.contains("bolt-sound-btn"))&&!e.target.classList.contains("bolt-volume-container")?a._dispatchEvent(n.UI.Event.TOGGLE_MUTE):(t=1-r._slider.getValue()[1],r._dispatchEvent(n.VALUE_CHANGED,t)),r._slider&&r._slider.reflow(),r._onVolumeChanged(e))},_onHandleMouseUpCb:function(e){var t=this,r=1-t._slider.getValue()[1];parseFloat(r)>parseFloat(0)&&!t.player.muted&&e.target.classList.contains("bolt-sound-btn")||e.target.parentNode.classList.contains("bolt-sound-btn")?a._dispatchEvent(n.UI.Event.TOGGLE_MUTE):t._dispatchEvent(n.VALUE_CHANGED,r),t._slider.reflow()},_onVolumeChanged:function(e){var t=this;t._container&&e&&e.data&&(LOG.info("%c🔉 [Zeus Volume] %c- Volume changed "+e.data,d,u),t._slider&&!t._slider.dragging&&t._updateHandle(e.data),t._updateFill(e.data))},_onSliderUpdate:function(e,t){var r=this;if(r._tooltipTimeout&&clearTimeout(r._tooltipTimeout),r.soundBtn.setAttribute("data-zeus-tooltip","false"),a.hideTooltip(r.soundBtn),r._slider&&r._slider.dragging){LOG.info("%c🔉 [Zeus Volume] %c- disable volume button",d,u),r.soundBtn.setAttribute("data-bolt-ui-enabled","false");var i=setInterval(function(){r._slider.dragging||(clearInterval(i),r.soundBtn.setAttribute("data-bolt-ui-enabled","true"))},100)}r._slider&&LOG.info("%c🔉 [Zeus Volume] %c- slider val",d,u,r._slider.getValue()[1])},invalidate:function(){var e=this;e._container&&(e._fillMaxHeight=parseFloat(getComputedStyle(e._background).height),e._slider.reflow(),e._updateHandle(),e._updateFill())},_updateFill:function(e){var t=this._fill,r=i.getScreenPosition(this._handle),n=i.getScreenPosition(this._handle.parentNode),o=r.y-n.y,a=this.player.muted?0:this._fillMaxHeight-o+"px";parseFloat(a)<0&&1===e&&!this.player.muted&&(a=this._fillMaxHeight+"px"),t&&(t.style.height=a)},_updateHandle:function(e){var t=1-this.player.volume;!e&&this._slider&&(t=this._slider.getValue()[1]);var r=this.player.muted?1:t;this._slider.setValue(0,r,!0,!0)},open:function(){r.prototype.open.call(this);var e=this;e._tooltipTimeout&&clearTimeout(e._tooltipTimeout),e._tooltipTimeout=setTimeout(function(){e.soundBtn.setAttribute("data-zeus-tooltip","false")},1e3),e.invalidate()},close:function(){r.prototype.close.call(this),this._tooltipTimeout&&clearTimeout(this._tooltipTimeout),this.soundBtn.setAttribute("data-zeus-tooltip","true")},_onMediaMuted:function(e){LOG.info("%c🔉 [Zeus Volume] %c- media muted",d,u);var t=this;t._container&&(t._slider&&!t._slider.dragging&&t._updateHandle(!0),t._updateFill())},_onMediaUnmuted:function(e){LOG.info("%c🔉 [Zeus Volume] %c- media unmuted",d,u);var t=this;t._container&&(t._slider&&!t._slider.dragging&&t._updateHandle(!0),t._updateFill())},setPlayer:function(e){this.player=e,LOG.info("%c🔉 [Zeus Volume] %c- player volume",d,u,e.volume),e.addEventListener(n.Media.Event.VOLUME_CHANGED,this._onVolumeChanged.bind(this)),e.addEventListener(n.Media.Event.MUTED,this._onMediaMuted.bind(this)),e.addEventListener(n.Media.Event.UNMUTED,this._onMediaUnmuted.bind(this))}})}),define("watermark",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,r){var i=(window.PlayerView,t.dom),n=t.css;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this._container=i.getUI(r.UI.WATERMARK),this._imageEl=i.getUI(r.UI.WATERMARK_IMG)},init:function(){this.create()},create:function(){t.log.info("creating watermark");var e=this;try{for(;e._container.firstChild;)e._container.removeChild(e._container.firstChild)}catch(e){}var r=PlayerSettings.watermark?PlayerSettings.watermark.image:null,o=PlayerSettings.watermark?PlayerSettings.watermark.text:null;!r&&o&&/.gif|.png|.jpg|.jpeg/i.test(o)&&(r=o);var a=PlayerSettings.watermark?PlayerSettings.watermark.href:null;if(r||o){if(ContentPlayer.watermark={image:r,href:a,text:o},e.open(),r?(e._imageEl||(e._imageEl=document.createElement("t._imageEl")),e._imageEl.setAttribute("src",t.normalizeProtocol(r)),e._container.appendChild(e._imageEl)):i.hideElement(e._imageEl),a){var s=document.createElement("a");s.href=t.normalizeProtocol(a),s.target="_blank",n.addClass(s,"bolt-custom-font"),n.addClass(s,"bolt-custom-text-color"),e._container.appendChild(s),r&&e._imageEl?s.appendChild(e._imageEl):s.textContent=o,s.title=o}else if(!r&&o){var l=document.createElement("p");l.textContent=o,e._container.appendChild(l)}e.updateAppearance()}},updateAppearance:function(){for(var e=this,t=["bottom-left","bottom-right","top-left","top-right"],r=0;r<t.length;r++)n.removeClass(e._container,t[r]);"top-right"===PlayerSettings.appearance.watermark.position?n.addClass(e._container,"top-right"):"bottom-left"===PlayerSettings.appearance.watermark.position?n.addClass(e._container,"bottom-left"):"top-left"===PlayerSettings.appearance.watermark.position?n.addClass(e._container,"top-left"):n.addClass(e._container,"bottom-right"),PlayerSettings.appearance.watermark.opacity&&(e._container.style.opacity=PlayerSettings.appearance.watermark.opacity)}})}),define("loading_indicator",["base_ui_module","zeus_utils","zeus_constants"],function(e,t,r){var i=t.dom,n=function(){function e(e,t){var r,i=document.createElement(e||"div");for(r in t)i[r]=t[r];return i}function t(e){for(var t=1,r=arguments.length;t<r;t++)e.appendChild(arguments[t]);return e}function r(e,t,r,i){var n=["opacity",t,~~(100*e),r,i].join("-"),o=.01+r/i*100,a=Math.max(1-(1-e)/t*(100-o),e),s=l.substring(0,l.indexOf("Animation")).toLowerCase(),d=s&&"-"+s+"-"||"";return u[n]||(c.insertRule("@"+d+"keyframes "+n+"{0%{opacity:"+a+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",c.cssRules.length),u[n]=1),n}function i(e,t){var r,i,n=e.style,o=d.length;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<o;i++)if(r=d[i]+t,void 0!==n[r])return r;if(void 0!==n[t])return t}function n(e,t){for(var r in t)e.style[i(e,r)||r]=t[r];return e}function o(e){for(var t,r,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(r in t)void 0===e[r]&&(e[r]=t[r])}return e}function a(e,t){return"string"==typeof e?e:e[t%e.length]}function s(e){this.opts=o(e||{},s.defaults,h)}var l,d=["webkit","Moz","ms","O"],u={},c=function(){var r=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],r),r.sheet||r.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};s.defaults={},o(s.prototype,{spin:function(t){this.stop();var r=this,i=r.opts,o=r.el=n(e(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex});i.radius,i.length,i.width;if(t&&(t.insertBefore(o,t.firstChild||null),n(o,{left:i.left,top:i.top})),o.setAttribute("role","progressbar"),r.lines(o,r.opts),!l){var a,s=0,d=(i.lines-1)*(1-i.direction)/2,u=i.fps,c=u/i.speed,h=(1-i.opacity)/(c*i.trail/100),p=c/i.lines;!function e(){s++;for(var t=0;t<i.lines;t++)a=Math.max(1-(s+(i.lines-t)*p)%c*h,i.opacity),r.opacity(o,t*i.direction+d,a,i);r.timeout=r.el&&setTimeout(e,~~(1e3/u))}()}return r},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,o){function s(t,r){return n(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:r,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*u+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var d,u=0,c=(o.lines-1)*(1-o.direction)/2;u<o.lines;u++)d=n(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:l&&r(o.opacity,o.trail,c+u*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(d,n(s("#000","0 0 4px #000"),{top:"2px"})),t(i,t(d,s(a(o.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,r){t<e.childNodes.length&&(e.childNodes[t].style.opacity=r)}});var p=n(e("group"),{behavior:"url(#default#VML)"});return!i(p,"transform")&&p.adj?function(){function r(t,r){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',r)}c.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(e,i){function o(){return n(r("group",{coordsize:u+" "+u,coordorigin:-d+" "+-d}),{width:u,height:u})}function s(e,s,l){t(h,t(n(o(),{rotation:360/i.lines*e+"deg",left:~~s}),t(n(r("roundrect",{arcsize:i.corners}),{width:d,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),r("fill",{color:a(i.color,e),opacity:i.opacity}),r("stroke",{opacity:0}))))}var l,d=i.length+i.width,u=2*d,c=2*-(i.width+i.length)+"px",h=n(o(),{position:"absolute",top:c,left:c});if(i.shadow)for(l=1;l<=i.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2, makeshadow=1, shadowopacity=.3)");for(l=1;l<=i.lines;l++)s(l);return t(e,h)},s.prototype.opacity=function(e,t,r,i){var n=e.firstChild;i=i.shadow&&i.lines||0,n&&t+i<n.childNodes.length&&(n=n.childNodes[t+i],n=n&&n.firstChild,(n=n&&n.firstChild)&&(n.opacity=r))}}():l=i(p,"animation"),s}();return e.subclass({constructor:function(t){e.call(this,t),this._container=i.getUI(r.UI.LOADING_INDICATOR),this._spinner=null},init:function(){PlayerState.on(PlayerState.STATE_CHANGED,function(){switch(PlayerState.state){case PlayerState.WAITING:this.open();break;default:this.close()}},this),BoltAdManager&&BoltAdManager.addEventListener(r.Ad.Event.REQUESTED,function(){"preroll"===BoltAdManager.timing&&this.open()},this);var e={lines:9,length:0,width:5,radius:8,corners:0,rotate:0,direction:1,color:"#fff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};this._spinner=new n(e).spin(this._container),PlayerView.on(r.Media.Event.NOT_FOUND,function(){PlayerView.currentPlayer.isAd()||(LOG.error("Video not found"),this.close())},this)},open:function(){this.isOpen||(this.isOpen=!0,i.showElement(this._container),this.invalidate())},close:function(){this.isOpen&&(this.isOpen=!1,i.hideElement(this._container))}})}),define("zeus_video_base",["zeus_eventdispatcher","zeus_utils","zeus_controller","hls_lib"],function(e,t,r,i){var n=window.ZeusConstants,o=window.client,a=e.subclass({constructor:function(){this.video=null,this._poster=null,this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1,this._bufferedTime=0,this._source=null,this.fastSeekEnabled=!1,this._isEnabled=!0,this._isRemoved=!1,this.type="native",this.videoPlayCount=0,this.cors=null,
this.containerId=null,this.videoId=null,this.sourceChanged=!1,this._isAd=!1,this.buffered=0,this.ended=!1,this.paused=!1,this.muted=!1,this.fullscreen=!1,this.videoWidth=NaN,this.videoHeight=NaN,this.metadata=null,this.currentTime=0,this.duration=0,this.startTime=0,this.width=0,this.height=0,this.playing=!1,this.parent=null,this.canplay=!1,this.canplaythrough=!1,this.volume=1,this.loop=null,this.stopped=!1,this.hasStarted=!1,this.qualityChanged=!1,this.seekTime=null,this.adsCuepoints=[],this.previousCuepointIndex=-1,this.currentQuality=null,this.relatedVideos=[],this.autoplay=!1,this.waiting=!1,this._stalled=!1,this._originalSource=null,this._onLoadStart=this._onLoadStart.bind(this),this._onLoadedMetadata=this._onLoadedMetadata.bind(this),this._onLoadedData=this._onLoadedData.bind(this),this._onDurationChanged=this._onDurationChanged.bind(this),this._onPlay=this._onPlay.bind(this),this._onPause=this._onPause.bind(this),this._onSeeked=this._onSeeked.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onWaiting=this._onWaiting.bind(this),this._onPlaying=this._onPlaying.bind(this),this._onProgress=this._onProgress.bind(this),this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onVolumeChange=this._onVolumeChange.bind(this),this._onEnded=this._onEnded.bind(this),this._onEmptied=this._onEmptied.bind(this),this._onStalled=this._onStalled.bind(this),this._onError=this._onError.bind(this),this._onAbort=this._onAbort.bind(this)}});return a.prototype._init=function(e,r,i){if(this._isAd=i,this.containerId=e,this.videoId=r,this.video=document.getElementById(r),this.parent=this.video.parentNode,this._source=this.video.src,this.startTime=this.video.startTime||0,this.width=this.video.clientWidth,this.height=this.video.clientHeight,this.volume=this.video.getAttribute("volume")||1,this.muted=this.video.muted,this.videoHeight=this.video.clientHeight,this.videoWidth=this.video.clientWidth,!i){if(this.loop=window.CurrentVideoConfig.settings.loop,this._poster=window.CurrentVideoConfig.settings.poster,!this._poster){var n=window.CurrentVideoConfig.content.posterVersions;n?o.browser.chrome&&n.webp?this._poster=n.webp:n.optimized&&(this._poster=n.optimized):window.CurrentVideoConfig&&window.CurrentVideoConfig.content?this._poster=window.CurrentVideoConfig.content.poster:this._poster=this.video.poster}this._poster=t.normalizeProtocol(this._poster),LOG.debug("[Zeus Video Base] - poster",this._poster),this.currentQuality=CurrentVideoConfig.settings.defaultHd?"hd":"sd",this.onVideoConfigChanged()}},a.prototype.isAd=function(e){LOG.debug("[Zeus Video Base] - isAd() ABSTRACT METHOD")},a.prototype.preload=function(){var e=this,t=document.body.getAttribute("data-default-src");e._isAd||null!==e._source&&""!==e._source||e.setSource(t),LOG.debug("[Zeus Video Base] - ",e.containerId,"preload source = ",e._source,"autoplay",e.autoplay),e._isEnabled||e.enable(!0),e.hls&&e.hls.destroy(),e._source.indexOf(".m3u8")>-1&&!o.nativeHLS?(e.hls=new i,e.hls.attachMedia(e.video),e.hls.on(i.Events.MANIFEST_PARSED,e._onHLSManifestParsed.bind(e)),e.hls.loadSource(e._source)):(e.video.src=e._source,o.browser.firefox>0&&e.video.setAttribute("preload","metadata"),e.video.load())},a.prototype._playVideo=function(){var e=this,t=e.hasStarted,r=window.CurrentVideoConfig.settings.automute,i=e.video.play();void 0!==i&&i.then(function(){}).catch(function(i){if(t)LOG.error("[Zeus Video Base] - Error in video.play() promise: ",i);else{if(e.muted&&r)throw e.pause(),new Error("[Zeus Video Base] - Error in video.play() promise: ",i);e.muted=!0,e.video.muted=!0,e._dispatchEvent(n.Media.Event.MUTED),e._playVideo(),LOG.info("[Zeus Video Base] - Error in video.play() promise: ",i)}})},a.prototype._onHLSManifestParsed=function(e,t){LOG.info("[Zeus Video Base] - HLS manifest loaded, found "+t.levels.length+" quality level"),this._playVideo()},a.prototype.play=function(){LOG.debug("[Zeus Video Base] ",this.containerId,this.videoId,"play()",this._isEnabled,this.video.src,this.video.currentSrc),this.show(!0),this.ended?this.replay():(this._isEnabled||this.enable(!0),this._playVideo())},a.prototype.replay=function(){LOG.debug("[Zeus Video Base] ",this.containerId,"replay",this.video.src),this.ended=!1,this.fastSeekEnabled?(LOG.debug("[Zeus Video Base] ",this.containerId,"pseudostream replay"),LOG.debug("[Zeus Video Base] ",this.containerId,"startTime is ",this.startTime),this.startTime>0?(this.autoplay=!0,this.seek(0)):(this.stop(),this.play())):(this.autoplay=!0,this.seek(0))},a.prototype.pause=function(){LOG.debug("[Zeus Video Base] ",this.containerId,"pause",this.currentTime),this.paused=!0,this.video.pause()},a.prototype.resume=function(){this.playing||(LOG.debug("[Zeus Video Base] ",this.containerId,"resume",this.currentTime,this.video.currentTime),this.show(!0),this._playVideo())},a.prototype.stop=function(){this.stopped||(LOG.debug("[Zeus Video Base] ",this.containerId,"STOP",this.video.src),this.stopped=!0,this.video.pause(),this.video.currentTime=0)},a.prototype.seek=function(e){var t=this,r=e/t.duration*100;t._pastThirdQuartile=r>=75,t._pastMidpoint=r>=50||t._pastThirdQuartile,t._pastFirstQuartile=r>=25||t._pastMidpoint,t._pastFirstQuartile&&LOG.info("[Zeus Video Base] - seeking past first quartile"),t._pastMidpoint&&LOG.info("[Zeus Video Base] - seeking past midpoint"),t._pastThirdQuartile&&LOG.info("[Zeus Video Base] - seeking past third quartile")},a.prototype.mute=function(e){console.warn("[Zeus Video Base] - ABSTRACT METHOD NO OP")},a.prototype.setVolume=function(e){console.warn("[Zeus Video Base] - ABSTRACT METHOD NO OP")},a.prototype.remove=function(e){LOG.debug("[Zeus Video Base] ",this.containerId,"video",this.videoId,"REMOVE"),this._isRemoved=!0,this.video&&(this._disableVideoListeners(),this.video.pause(),this.video.src="",this.video.poster="",!0===e?(this.video.parentNode.removeChild(this.video),this.video=null):this._enableVideoListeners()),this._dispatchEvent(n.Player.Event.REMOVED),this.removeAllListeners()},a.prototype.setSource=function(e){e=t.normalizeProtocol(e),this._isRemoved=!1,this._originalSource=e,this.resetQuartiles(),this.metadata=null,this.playing=!1,this.hasStarted=!1,this.paused=!1,this.ended=!1,this.sourceChanged=!0,this.duration=0,this.buffered=0,this._bufferedTime=0,this.startTime=0,this.currentTime=0,this.waiting=!1,this._dispatchEvent(n.Media.Event.START_TIME_CHANGED,this.startTime),this._dispatchEvent(n.Player.Event.CONTENT_CHANGED),this.fastSeekEnabled=t.fastSeekEnabled(e),LOG.debug("[Zeus Video Base] ",this.containerId,"PSEUDO STREAMING ENABLED",this.fastSeekEnabled),this._enableVideoListeners(),this._updateVideoSource(e)},a.prototype.setQuality=function(e,t){e!==this.currentQuality&&(LOG.debug("[Zeus Video Base] ",this.containerId,"setQuality",e,t),this._originalSource=t,this.autoplay=!0,this.currentQuality=e,this.qualityChanged=!0,this._dispatchEvent(n.Player.Event.QUALITY_CHANGED,this.currentQuality),this._updateVideoSource(t))},a.prototype._updateVideoSource=function(e){console.warn("ABSTRACT METHOD NO OP")},a.prototype.getSource=function(){return this._source},a.prototype.size=function(e,t){this.video.setAttribute("width",e),this.video.setAttribute("height",t),this.width=this.video.clientWidth,this.height=this.video.clientHeight,this._dispatchEvent(n.Player.Event.SIZE_CHANGED)},a.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e)},a.prototype.show=function(e){!0===e&&"block"!==this.video.style.display?(LOG.debug("[Zeus Video Base] ",this.containerId,"show video"),this.video.style.display="block"):!1===e&&"none"!==this.video.style.display&&(LOG.debug("[Zeus Video Base] ",this.containerId,"hide video"),this.video.style.display="none")},a.prototype.hitAdCuepoint=function(e){this.previousCuepointIndex=window.CurrentVideoConfig.advertising.cuepoints.indexOf(e),this._dispatchEvent(n.Ad.Event.CUEPOINT,e)},a.prototype.unload=function(){var e=this;LOG.info("[Zeus Video Base] - unload video",this.video.currentSrc),e._isRemoved=!0,e._disableVideoListeners(),e.hls?e.hls.destroy():(e.video.src="",e.video.load())},a.prototype.enable=function(e){this._isEnabled=e,!0===e?(LOG.info("[Zeus Video Base] ",this.containerId,"ENABLE VIDEO",e,this.videoId,this._source,this.video.src),this._enableVideoListeners(),this.setSource(this._source)):(LOG.info("[Zeus Video Base] ",this.containerId,"DISABLE VIDEO",e,this.videoId,this._source,this.video.src),this.unload())},a.prototype._onDurationChanged=function(e){console.warn("ABSTRACT METHOD NO OP")},a.prototype._onPlay=function(e){this.stopped=!1,this.ended=!1,this.hasStarted?this.paused&&(this.paused=!1,this._dispatchEvent(n.Media.Event.RESUME)):(LOG.info("[Zeus Video Base] - dispatching play event"),this._dispatchEvent(n.Media.Event.PLAY),this.hasStarted=!0)},a.prototype._onPause=function(e){LOG.debug("[Zeus Video Base] ",this.containerId,"onPause",this.currentTime),this.paused=!0,this.playing=!1,this._dispatchEvent(n.Media.Event.PAUSED),this.stopped&&this._dispatchEvent(n.Media.Event.STOPPED)},a.prototype._onSeeked=function(e){LOG.info("[Zeus Video Base] - onSeeked",window.CurrentVideoConfig.settings.title,this.video.currentSrc),this.stopped||(this._dispatchEvent(n.Media.Event.SEEKED),this.autoplay&&this._playVideo()),this.seekTime=null},a.prototype._onTimeUpdate=function(e){if(!this.video)return void LOG.error(this.containerId,"video is null");if(this._stalled=!1,this.qualityChanged)return void LOG.info("[Zeus Video Base::_onTimeUpdate] - quality changed:",this.qualityChanged);if(this.currentTime=this.video.currentTime+this.startTime,this.currentTime>this.duration&&(this.currentTime=this.duration),this._dispatchEvent(n.Media.Event.TIME_UPDATE,this.currentTime),this._checkQuartiles(),o.system.android>0&&28===o.browser.chrome&&Math.floor(this.currentTime)===Math.floor(this.video.duration)){var t=new CustomEvent("ended");this.video.dispatchEvent(t)}},a.prototype._onWaiting=function(e){this.waiting=!0,this._dispatchEvent(n.Media.Event.WAITING)},a.prototype._onPlaying=function(e){LOG.debug("[Zeus Video Base] ",this.containerId,"onPlaying",this.currentTime,this.video.currentTime),this.playing=!0,this._dispatchEvent(n.Media.Event.PLAYING)},a.prototype._onProgress=function(e){try{var t=this.fastSeekEnabled?this.video.buffered.end(0)+this.startTime:this.video.buffered.end(0);t!==this._bufferedTime&&(t>this._bufferedTime&&(this._bufferedTime=t),this.buffered=Math.round(100*this._bufferedTime/this.duration),this.buffered>100&&(this.buffered=100))}catch(e){this.buffered=0,this._bufferedTime=0}this._dispatchEvent(n.Media.Event.LOAD_PROGRESS,this.buffered)},a.prototype._onLoadedMetadata=function(e){this.metadata||(this.metadata={duration:this.video.duration,videoWidth:this.video.videoWidth,videoHeight:this.video.videoHeight},LOG.debug("[Zeus Video Base] ",this.containerId,"video metadata",this.metadata,this.video.currentSrc),this._dispatchEvent(n.Media.Event.METADATA,this.metadata))},a.prototype._onCanPlay=function(e){LOG.debug("[Zeus Video Base] ",this.containerId,"onCanPlay",this.video.currentTime),this.waiting=!1,this.canplay=!0,this._dispatchEvent(n.Player.Event.CANPLAY),this._stalled&&(LOG.debug("[Zeus Video Base] ",this.containerId,"onCanPlay after stalled"),this._stalled=!1,this._playVideo())},a.prototype._onCanPlayThrough=function(e){this.canplaythrough=!0,this._dispatchEvent(n.Player.Event.CANPLAYTHROUGH)},a.prototype._onVolumeChange=function(e){this.volume=this.video.volume,LOG.info("[Zeus Video Base] - onVolumeChange",this.volume),this._dispatchEvent(n.Media.Event.VOLUME_CHANGED,this.volume)},a.prototype._onEnded=function(e){this._isAd||LOG.debug("[Zeus Video Base] ",this.containerId,"onEnded",window.CurrentVideoConfig.settings.title),this.ended=!0,this.playing=!1,this.paused=!1,this.hasStarted=!1,this._dispatchEvent(n.Media.Event.ENDED)},a.prototype._onEmptied=function(e){this._isRemoved||this.sourceChanged||(this._isAd||LOG.debug("[Zeus Video Base] ",this.containerId,"onEmptied",window.CurrentVideoConfig.settings.title,this.video.currentSrc),this._dispatchEvent(n.Media.Event.EMPTIED))},a.prototype._onStalled=function(e){this._isRemoved||(this._stalled=!0,this.playing&&(LOG.debug("[Zeus Video Base] ",this.containerId,"video stalled, calling play"),this._playVideo()))},a.prototype._onError=function(e){var t="";if(!this._isRemoved){if(this.video.error.code)switch(this.video.error.code){case 1:t="USER ABORT";break;case 2:t="NETWORK ERROR";break;case 3:t="DECODE ERROR";break;case 4:t="MEDIA NOT SUPPORTED"}LOG.error("[Zeus Video Base] ",this.containerId,"ZeusVideo::video error",this.video.error.code,":",t),4===this.video.error.code?o.browser.firefoxWithoutMp4&&this._source.indexOf(".mp4")>-1&&!o.hasFlash?this._dispatchEvent(n.Media.Event.NOT_SUPPORTED):this._dispatchEvent(n.Media.Event.NOT_FOUND):""===this.video.src||this._isRemoved||this.sourceChanged||this._dispatchEvent(n.ERROR)}},a.prototype._onLoadedData=function(e){this._isLoading=!1,LOG.debug("[Zeus Video Base] ",this.containerId,"onLoadedData"),this._dispatchEvent(n.Media.Event.LOADED)},a.prototype._onLoadStart=function(e){this.video&&(this._isLoading=!0,LOG.info("[Zeus Video Base] ",this.containerId,"onLoadStart",this.video.currentSrc,this.video.src),this._dispatchEvent(n.Media.Event.WAITING))},a.prototype._onAbort=function(e){LOG.info("[Zeus Video Base] ",this.containerId,"onAbort",this.videoId,this.video.src)},a.prototype._enableVideoListeners=function(){LOG.debug("[Zeus Video Base] - enable video listeners",this.videoId),this.video.addEventListener("loadstart",this._onLoadStart),this.video.addEventListener("loadedmetadata",this._onLoadedMetadata),this.video.addEventListener("loadeddata",this._onLoadedData),this.video.addEventListener("durationchange",this._onDurationChanged),this.video.addEventListener("play",this._onPlay),this.video.addEventListener("pause",this._onPause),this.video.addEventListener("seeked",this._onSeeked),this.video.addEventListener("timeupdate",this._onTimeUpdate),this.video.addEventListener("waiting",this._onWaiting),this.video.addEventListener("playing",this._onPlaying),this.video.addEventListener("progress",this._onProgress),this.video.addEventListener("canplay",this._onCanPlay),this.video.addEventListener("canplaythrough",this._onCanPlayThrough),this.video.addEventListener("volumechange",this._onVolumeChange),this.video.addEventListener("ended",this._onEnded),this.video.addEventListener("emptied",this._onEmptied),this.video.addEventListener("stalled",this._onStalled),this.video.addEventListener("error",this._onError),this.video.addEventListener("abort",this._onAbort)},a.prototype._disableVideoListeners=function(){LOG.debug("[Zeus Video Base] ",this.containerId,"disable video listeners"),this.video.removeEventListener("loadstart",this._onLoadStart),this.video.removeEventListener("loadedmetadata",this._onLoadedMetadata),this.video.removeEventListener("loadeddata",this._onLoadedData),this.video.removeEventListener("durationchange",this._onDurationChanged),this.video.removeEventListener("play",this._onPlay),this.video.removeEventListener("pause",this._onPause),this.video.removeEventListener("seeked",this._onSeeked),this.video.removeEventListener("timeupdate",this._onTimeUpdate),this.video.removeEventListener("waiting",this._onWaiting),this.video.removeEventListener("playing",this._onPlaying),this.video.removeEventListener("progress",this._onProgress),this.video.removeEventListener("canplay",this._onCanPlay),this.video.removeEventListener("canplaythrough",this._onCanPlayThrough),this.video.removeEventListener("volumechange",this._onVolumeChange),this.video.removeEventListener("ended",this._onEnded),this.video.removeEventListener("emptied",this._onEmptied),this.video.removeEventListener("stalled",this._onStalled),this.video.removeEventListener("error",this._onError),this.video.removeEventListener("abort",this._onAbort),this.video.removeEventListener("ended",this._onEnded)},a.prototype.onVideoConfigChanged=function(){(this.playing||this.paused)&&this.enable(!1);var e=window.CurrentVideoConfig;this._poster=e.content.poster,void 0===this.loop&&void 0===window.Playlist&&(this.loop=e?e.settings.loop:this.loop),this.adsCuepoints=void 0!==e.advertising.cuepoints?e.advertising.cuepoints.concat():[],this._dispatchEvent(n.Player.Event.CONFIG_CHANGED)},a.prototype.resetQuartiles=function(){this._pastFirstQuartile=!1,this._pastMidpoint=!1,this._pastThirdQuartile=!1},a.prototype._checkQuartiles=function(){if(this.currentTime&&this.duration){var e=this.currentTime/this.duration*100;!this._pastFirstQuartile&&e>=25?(this._pastFirstQuartile=!0,this._dispatchEvent(n.Media.Event.FIRSTQUARTILE,null)):!this._pastMidpoint&&e>=50?(this._pastMidpoint=!0,this._dispatchEvent(n.Media.Event.MIDPOINT,null)):!this._pastThirdQuartile&&e>=75&&(this._pastThirdQuartile=!0,this._dispatchEvent(n.Media.Event.THIRDQUARTILE,null))}},a}),define("ss_tracker",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,r){var i=function(){e.mixin(this),this.videoId=null,this.publisherId=null,this.tag=null,this.timing=null,this.started=!1,this.aborted=!1,this.loaded=!1,this.failed=!1,this.data={}};return i.prototype={start:function(e){return e.timing&&e.tag&&e.serverType?this.started?void LOG.warn("SSTRacker has already been started"):(this.started=!0,this.tag=e.tag,void(this.data={timing:e.timing,tag:e.tag,vmap:e.vmap,publisher_id:r.getCurrentVideoOwnerId()||-1,video_id:CurrentVideoConfig.content.videoId||-1,start_ts:new Date,server_type:e.serverType})):void LOG.error("Invalid SS tracker data")},fail:function(){return this.tag?this.started?(this.failed=!0,void LOG.info("Self-service Tracker event: failed")):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},success:function(){return this.tag?this.started?(this.loaded=!0,void LOG.info("Self-service Tracker event: success")):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfill:function(e){return this.tag?this.started?this.failed?void(this.data.backfiller_tag=e):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfillSuccess:function(e){return this.tag?this.started?this.failed?void(this.data.backfiller_tag=e||this.data.backfiller_tag):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},backfillFail:function(e){return this.tag?this.started?this.failed?void(this.data.backfiller_tag=e||this.data.backfiller_tag):void LOG.error("Self-service Tracker did not fail"):void LOG.error("Self-service Tracker has not started"):void LOG.warn("No self-service tag")},reset:function(){LOG.debug("Self-service Tracker reset"),this.tag=null,this.timing=null,this.started=!1,this.aborted=!1,this.loaded=!1,this.failed=!1,this.data={}},recordImpression:function(){this.data.timing,this.data.video_id,this.data.publisher_id,this.data.tag,this.data.vmap,this.data.server_type,this.data.start_ts}},i}),define("ad_blocked",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,r){var i=function(){e.mixin(this)};return i.prototype={track:function(e){var i=this._getTag(e);if(i){var n={publisher_id:r.getCurrentVideoOwnerId()||-1,video_id:CurrentVideoConfig.content.videoId,timing:e,tag:i.url,server_type:i.type,domain:window.site.hostname,page_url:window.site.href};LOG.warn("Missed ad opportunity because of ad blocker",n),this._dispatchEvent(t.Ad.Event.SESSION_BLOCKED,n)}},_getTag:function(e){for(var t,r,i,n,o,a=window.site,s=window.client,l=CurrentVideoConfig.advertising,d=0;d<l.servers.length;d++){var u=l.servers[d];if("adtech-intergi"!==u.type){r=u;break}r=u}try{for(var c in r.tags){if(c===a.hostname){t=c;break}if(c===a.tld||c==="*."+a.tld){t=c;break}}t||(t="default"),i=r.tags[t],s.hasFlash&&i.standard?n="overlay"===e?i.standard.overlay:i.standard[e]:i.html5&&(s.isMobile&&i.html5.mobile?n="overlay"===e?i.html5.mobile.overlay:i.html5.mobile[e]:i.html5.desktop&&(n="overlay"===e?i.html5.desktop.overlay:i.html5.desktop[e])),LOG.info("Blocked tag",n,i),o={url:n,type:r.type}}catch(e){}return o}},i}),define("moat_analytics_adapter",["zeus_utils"],function(e){function t(e,t,r,i,n,o){var a=document.createElement("script"),s=[];t={adData:{ids:t,duration:r,url:n},dispatchEvent:function(e){this.sendEvent?(s&&(s.push(e),e=s,s=!1),this.sendEvent(e)):s.push(e)}},r="_moatApi"+Math.floor(1e8*Math.random());var l,d;try{l=e.ownerDocument,d=l.defaultView||l.parentWindow}catch(e){l=document,d=window}return d[r]=t,a.type="text/javascript",e&&e.insertBefore(a,e.childNodes[0]||null),a.onload=function(){LOG.info("[Bolt3 Moat Analytics] SDK loaded"),o()},a.src="https://z.moatads.com/"+i+"/moatvideo.js#"+r,t}return{ids:null,partnerCode:null,api:null,container:null,configure:function(e){this.ids={level1:e.level1,level2:e.level2,level3:e.level3,level4:e.level4,slicer1:e.slicer1,slicer2:e.slicer2},this.partnerCode=e.partnerCode},init:function(e,r){var i=e.duration,n=e.videoUrl;this.api=t(this.container,this.ids,i,this.partnerCode,n,r)},track:function(e,t){var r={type:e,adVolume:t};LOG.info("[Bolt3 Moat Analytics] track event:",e,", vol:",t),this.api.dispatchEvent(r)}}}),define("ad_session",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,r){var i=function(){e.mixin(this),this._startData=null,this._started=!1,this._completed=!1,this._failed=!1,this._aborted=!1,this._adloaded=!1};return i.prototype={reset:function(){LOG.info("%c[AdSession] reset","color:black;background:yellow"),this._startData=null,this._started=!1,this._completed=!1,this._failed=!1,this._aborted=!1,this._adloaded=!1},getElapsedSecondsSinceStart:function(e){try{var t=(e.getTime()-this._startData.start_ts.getTime())/1e3;return parseFloat(t.toFixed(1))}catch(e){return-1}},start:function(e){LOG.info("%c[AdSession start] is backfilling? "+e,"color:black;background:lime");var i=this;i._started&&LOG.warn("[AdSession start] Previous session is still active"),i._started=!0;var n=window.BoltAdManager;i._startData={timing:n&&n.timing,publisher_id:r.getCurrentVideoOwnerId()||-1,video_id:CurrentVideoConfig.content.videoId||-1,player_width:parseFloat(Skin.clientWidth.toFixed(2)),player_height:parseFloat(Skin.clientHeight.toFixed(2)),fullscreen:PlayerView.fullscreen,start_ts:new Date,cuepoint:n&&n.cuepoint,server_type:n&&n.selectedServer.type,tag_type:n&&n.selectedServer.tagType,backfilling:e},this._dispatchEvent(t.Ad.Event.SESSION_START,this._startData)},adLoaded:function(){var e=this;if(this._started&&!this._adloaded){LOG.info("[AdSession adLoaded]"),this._adloaded=!0;var r=new Date,i={timestamp:r,et_session_start:e.getElapsedSecondsSinceStart(r)};this._dispatchEvent(t.Ad.Event.SESSION_AD_LOADED,i)}},abort:function(){var e=this;if(this._started&&!this._aborted){LOG.info("[AdSession abort]"),this._aborted=!0;var r=new Date,i={timestamp:r,et_session_start:e.getElapsedSecondsSinceStart(r)};this._dispatchEvent(t.Ad.Event.SESSION_ABORT,i),this.reset()}},fail:function(){var e=this;if(this._started&&!this._failed){LOG.info("%c[AdSession fail]","color:red;background:pink"),this._failed=!0;var r=new Date,i={timestamp:r,et_session_start:e.getElapsedSecondsSinceStart(r)};this._dispatchEvent(t.Ad.Event.SESSION_FAIL,i),this.reset()}},complete:function(){LOG.info("%c[AdSession complete]","color:white;background:black;");var e=this;if(this._started&&!this._completed){this._completed=!0;var r=new Date,i={timestamp:r,et_session_start:e.getElapsedSecondsSinceStart(r)};this._dispatchEvent(t.Ad.Event.SESSION_END,i),this.reset()}}},i}),define("ad_request",["zeus_eventdispatcher","zeus_constants"],function(e,t){var r=function(){e.mixin(this),this.failed=!1,this.data={}};return r.prototype={setMedia:function(e,t){this.data.media_src=e,this.data.mime_type=t},start:function(e,r,i,n){var o=this,a=o.data.campaign_id;o.reset(),o.data={campaign_id:a,tag:e,third_party_tag:r,daisy_chain_count:i,start_ts:new Date,amazon_bid:n&&"amazon"===n.source?n.status:null},this._dispatchEvent(t.Ad.Event.REQUEST_START,o.data)},getElapsedSecondsSinceStart:function(e){try{var t=(e.getTime()-this.data.start_ts.getTime())/1e3;return parseFloat(t.toFixed(1))}catch(e){return-1}},success:function(){var e=this,r=new Date,i={timestamp:r,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,amazon_bid:e.data.amazon_bid,et_request_start:e.getElapsedSecondsSinceStart(r),et_session_start:window.AdSession.getElapsedSecondsSinceStart(r)};this._dispatchEvent(t.Ad.Event.REQUEST_SUCCESS,i)},fail:function(e){var r=this,i=new Date;if(!r.failed){r.failed=!0;var n={timestamp:i,media_src:r.data.media_src,mime_type:r.data.mime_type,ad_type:r.data.ad_type,info:e,network:r.data.network,campaign_id:r.data.campaign_id,amazon_bid:r.data.amazon_bid,et_request_start:r.getElapsedSecondsSinceStart(i),et_session_start:window.AdSession.getElapsedSecondsSinceStart(i)};r._dispatchEvent(t.Ad.Event.REQUEST_FAIL,n)}},abort:function(){var e=this,r=new Date,i={timestamp:r,media_src:e.data.media_src,mime_type:e.data.mime_type,ad_type:e.data.ad_type,network:e.data.network,campaign_id:e.data.campaign_id,amazon_bid:e.data.amazon_bid,et_request_start:e.getElapsedSecondsSinceStart(r),et_session_start:window.AdSession.getElapsedSecondsSinceStart(r)};e._dispatchEvent(t.Ad.Event.REQUEST_ABORT,i)},reset:function(){var e;this.data&&this.data.campaign_id&&(e=this.data.campaign_id),this.failed=!1,this.data={},BoltAdManager.selectedServer&&BoltAdManager.selectedServer.isSpotxRaw&&(this.data.campaign_id=e)},get adType(){return this.data.ad_type},set adType(e){this.data.ad_type=e},get network(){return this.data.network},set network(e){this.data.network=e},get campaignId(){return this.data.campaign_id},set campaignId(e){try{this.data.campaign_id=e}catch(e){}LOG.info("CAMPAIGN ID",this.data.campaign_id)}},r}),define("vmap_adapter",["zeus_eventdispatcher","vastvmap","zeus_constants","zeus_utils"],function(e,t,r,i){return e.subclass({constructor:function(){},init:function(e,t,r){var n=this;n.primaryTag=e,n.xml=null,n.breaks=[],n.successCb=t,n.errorCb=r,n.contentDuration=0,n.cuepoints=[],i.xhr(this.primaryTag,"get",null,function(e){n.parse(e)},function(){r.call(null)})},parse:function(e){var r=this;r.xml=e,r.breaks=[],r.cuepoints=[];for(var i=new DOMParser,n=i.parseFromString(e,"text/xml"),o=n.getElementsByTagNameNS("*","AdBreak"),a=0;a<o.length;a++){var s=o.item(a);if("linear"==s.getAttribute("breakType")){console.log("AdBreak",s);var l={position:s.getAttribute("timeOffset"),positionInSeconds:function(e){var t=e.split(":"),r=parseInt(t[2]),i=parseInt(t[1]);return 3600*parseInt(t[0])+60*i+r}(s.getAttribute("timeOffset")),breakId:s.getAttribute("breakId"),sourceId:s.getElementsByTagNameNS("*","AdSource")[0].getAttribute("id"),trackingEvents:null,adXML:null,adURI:null};try{var d=s.getElementsByTagNameNS("*","TrackingEvents")[0];d&&(LOG.info("VMAP TrackingEvents",d),l.trackingEvents=new t.TrackingEvents(d,null))}catch(e){}var u=s.getElementsByTagNameNS("*","VASTAdData")[0];if(u){var c=u.getElementsByTagNameNS("*","VAST")[0];c&&(l.adXML=c)}else{var h=s.getElementsByTagNameNS("*","AdTagURI")[0];h&&(l.adURI=h.textContent.trim())}(l.adURI||l.adXML)&&("number"!=typeof l.positionInSeconds||isNaN(l.positionInSeconds)||r.cuepoints.push(l.positionInSeconds),r.breaks.push(l))}}r.breaks.length>0?(r.contentDuration>0&&r.updatePercentagePosition(r.contentDuration),r.successCb.call(null,r.breaks)):(LOG.error("[VMAP] No ad breaks found"),r.errorCb.call(null))},getBreaks:function(e){var t=this,r=[];if(!t.breaks||0===t.breaks.length)return null;for(var i=t.breaks.concat();i.length>0;){var n=i.shift();"preroll"===e?"start"===n.position&&r.push(n):"postroll"===e?"end"===n.position&&r.push(n):n.positionInSeconds===Math.floor(e)&&r.push(n)}return r.length>0?r:null},setContentDuration:function(e,t){this.contentDuration=e,this.breaks&&this.breaks.length>0&&(this.updatePercentagePosition(e),t&&t.call(null,this.cuepoints))},updatePercentagePosition:function(e){var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks.forEach(function(t){t.position.indexOf("%")>-1&&(t.positionInSeconds=Math.floor(e*parseFloat(t.position)/100),LOG.info("Updated break position",t.position,"of",e,"=",t.positionInSeconds))}),t.validateBreakTimings(e))},validateBreakTimings:function(e){LOG.info("Validate VMAP break timings");var t=this;e&&t.breaks&&t.breaks.length>0&&(t.breaks=t.breaks.filter(function(t){return"start"===t.position||"end"===t.position||e-t.positionInSeconds>30}),t.updateCuepoints())},updateCuepoints:function(){var e=this;e.breaks&&e.breaks.length>0&&e.breaks.forEach(function(t){"number"!=typeof t.positionInSeconds||isNaN(t.positionInSeconds)||e.cuepoints.push(t.positionInSeconds)}),e.cuepoints=i.data.sortNumericArray(i.data.getUniqueArray(e.cuepoints)),LOG.info("VMAP CUEPOINTS",e.cuepoints)},reset:function(){this.breaks=null,this.successCb=null,this.errorCb=null,this.primaryTag=null,this.xml=null,this.contentDuration=0,this.cuepoints=null}})}),define("ad_server",["zeus_constants"],function(e){"use strict";var t=window.client,r=function(t){this.type=t.type,this.tags=t.tags,this.type===e.Ad.Server.INTERGI?this.maxAttempts=3:this.type===e.Ad.Server.SPOTX?this.maxAttempts=3:(this.type,e.Ad.Server.DFP,this.maxAttempts=1),this.tagType=this._findTagTypeForSite(),this.tagType?"syndication"===this.tagType?this.siteTags=this.tags.default:this.siteTags=this.tags[this.tagType]:this.siteTags=null,this.type===e.Ad.Server.SPOTX&&(this.spotxChannelId=this._getSpotxChannelId(),window.spotxChannelId=this.spotxChannelId)};return r.prototype.selectTag=function(e){var r=null;try{LOG.info("[bolt3] search",e,"tag from",this.siteTags),this.siteTags&&(t.hasFlash&&this.siteTags.standard?r=this.siteTags.standard[e]:this.siteTags.html5&&(t.isMobile&&this.siteTags.html5.mobile?r=this.siteTags.html5.mobile[e]:this.siteTags.html5.desktop&&(r=this.siteTags.html5.desktop[e])))}catch(e){}return r},r.prototype._findTagTypeForSite=function(){var e=window.site.hostname,t=null;if(!this.tags)return null;try{var r=window.site.tld;if(PlayerSettings.forceAds&&(LOG.debug("[bolt3] Forcing Ads for",r),window.postLogMessage("Forcing Ads for: "+r)),"playwire.com"===r&&"support.playwire.com"!==e&&!PlayerSettings.forceAds&&"devcdn.playwire.com"!==e)return LOG.warn("[bolt3] TLD is "+r+". Ads disabled"),window.postLogMessage("TLD is "+r+". Ads disabled","warn"),null;for(var i in this.tags){if(i===e){t=i;break}if(i===r||i==="*."+r){t=i;break}}}catch(e){}return t?(LOG.debug("[bolt3] Found site-specific "+this.type+" tags",this.tags[t]),window.postLogMessage("Found site-specific "+this.type+" tags matching "+e),t):(LOG.debug("[bolt3] No site-specific "+this.type+" tags match "+e+". Using syndication tags."),window.postLogMessage("No site-specific "+this.type+" tags match "+e+". Using syndication tags."),"syndication")},r.prototype._getSpotxChannelId=function(){try{return/#zeusdebug.*;spotxchannelid=([\d]*)/gi.exec(window.parentUrl)[1]}catch(e){}try{if(this.siteTags){if(t.hasFlash&&this.siteTags.standard)return this.siteTags.standard.channelId;if(this.siteTags.html5){if(t.isMobile&&this.siteTags.html5.mobile)return LOG.info("[Ad Server] Found SpotX ChannelID",this.siteTags.html5.mobile.channelId),this.siteTags.html5.mobile.channelId;if(this.siteTags.html5.desktop)return LOG.info("[Ad Server] Found SpotX ChannelID",this.siteTags.html5.mobile.channelId),this.siteTags.html5.desktop.channelId}}}catch(e){return null}},r}),define("ad_pool",["zeus_constants","zeus_utils","vastvmap"],function(e,t,r){"use strict";var i=0,n=function(t,r,i){var n=this;n.name="overlay"===t?"Overlay":"Linear",n.timing=t,n.doneCallback=i,n.campaignId=null;var o,a=new DOMParser;n.xml=a.parseFromString(r,"text/xml");try{o=n.xml.getElementsByTagName("Ad")[0],
o?n.campaignId=o.id:(o=n.xml.getElementsByTagName("BoltAdTemplate")[0])&&"google"===o.getAttribute("source")&&(n.campaignId=o.getAttribute("adid"))}catch(e){}if(!o)return void n.done();var s=n.xml.getElementsByTagName("VAST")[0]||n.xml.getElementsByTagName("vast")[0];s?(n.type=e.Ad.Type.VAST,n.handleVAST()):(s=n.xml.getElementsByTagName("BoltAdTemplate")[0])&&(n.type=e.Ad.Type.GOOGLE,n.handleGoogleTemplate())};n.prototype={handleVAST:function(){var t=this,n=t.xml.getElementsByTagName("Ad")[0],o=n.getElementsByTagName("VASTAdTagURI")[0],a="true"===n.getAttribute("overlay");if("overlay"===t.timing){if(!a)return LOG.warn("[Bolt3 "+t.name+" AdPool] Requested overlay ads but received non-overlay tag"),window.postLogMessage("["+t.name+" AdPool] Requested overlay ads but received non-overlay tag","error"),void t.done();t.type=e.Ad.Type.OVERLAY}if(t.campaignId=n.id,o){var s=o.textContent;if(-1!==s.indexOf("adotube.com")&&"preroll"!==t.timing)return LOG.warn("[Bolt3 "+t.name+" AdPool] Received Adotube tag not in preroll. Try to daisy-chain."),window.postLogMessage("["+t.name+" AdPool] Received Adotube tag not in preroll. Try to daisy-chain.","warn"),t.xml=null,void t.done();if(-1!==s.indexOf("delivery.vidible.tv")&&"preroll"!==t.timing)return LOG.warn("[Bolt3 "+t.name+" AdPool] Received AOL tag not in preroll. Try to daisy-chain."),window.postLogMessage("["+t.name+" AdPool] Received AOL tag not in preroll. Try to daisy-chain.","warn"),t.xml=null,void t.done();if(s.indexOf("coull.com")>-1&&s.indexOf("ad_type=ov")>-1&&i>0)return t.xml=null,void t.done()}else LOG.info("[Bolt3 "+t.name+" AdPool] Received a direct-campaign VAST"),window.postLogMessage("["+t.name+" AdPool] Received a direct-campaign VAST");LOG.info("[Bolt3 "+t.name+" AdPool] Processing VAST XML",n),new r.VASTAds(t.xml,function(e,r){if(void 0===e||null===e)return t.xml=null,void t.done();t.cpm=r,t.ad=e,LOG.info("[Bolt3 "+t.name+" AdPool] VAST Ad ",t.ad),t.done()})},handleGoogleTemplate:function(e){var t=this;LOG.info("[Bolt3 "+t.name+" AdPool] Received google template "),window.postLogMessage("["+t.name+" AdPool] Received a Google Template"),t.ad=t.xml,this.done()},done:function(){var e=this;e.doneCallback.call(null,{campaignId:e.campaignId,xml:e.xml,type:e.type,ad:e.ad,cpm:e.cpm})}};var o=function(e){var t=this;t.name=e?"Overlay":"Linear",t.isOverlay=e,t._ads=[],t._triedCampaigns=[],t._size=3,t._timing=null,t._drained=!0,t._timer=null,t._timeout=!1,t._attempts=0,t.serverType=null,t.syndication=!0};return o.prototype={updateCoullOverlayCount:function(e){this.isOverlay&&(i=e)},fill:function(r,i,o){var a=this;if(a.syndication=a.serverType===e.Ad.Server.INTERGI,a._timing!==i&&(LOG.info("[Bolt3 "+a.name+" AdPool] Ad timing changed "+a._timing+"->"+i+". Drain the pool."),a.drain(),a._timing=i),a._drained=!1,a._timeout||a._ads.length===a._size||10===a._attempts)return void a.done(o);a._attempts++,LOG.info("[Bolt3 "+a.name+" AdPool] Prefetch ",i,"| syndication:",a.syndication,"| attempt: ",a._attempts);var s=t.substituteMacros(r);if(a.syndication&&(s+=";acao=*",PlayerSettings.customReporting&&(s+=function(){var e="";for(var t in PlayerSettings.customReporting)e+="&"+t+"="+PlayerSettings.customReporting[t];return e}()),a._triedCampaigns.length>0)){a._triedCampaigns=t.data.getUniqueArray(a._triedCampaigns),s=s.replace(/\;key=\d+/,"");var l=s.indexOf("ADTECH;")+"ADTECH;".length;s=l>=0?s.slice(0,l)+"key="+a._triedCampaigns.join("+")+";"+s.slice(l+Math.abs(0)):s+";key="+a._triedCampaigns.join("+")}var d=function(){LOG.info("[Bolt3 "+a.name+" AdPool] Empty response in attempt #",a._attempts),window.postLogMessage("[Bolt3 "+a.name+" AdPool] No ad from "+r+"."),a.done(o)},u=function(){if(!a._drained)if(LOG.info("[Bolt3 "+a.name+" AdPool] Retry tag "+r),"midroll"===a._timing)var e=setTimeout(function(){if(a._drained)return void clearTimeout(e);a.fill(r,i,o)},5e3);else a.fill(r,i,o)},c=function(){if(window.postLogMessage("["+a.name+" AdPool] Fetching "+s),LOG.info("[Bolt3 "+a.name+" AdPool] Fetching "+s),"preroll"!==a._timing&&"postroll"!==a._timing||a._timer||(a._timer=setTimeout(function(){a._timeout=!0},1e4)),a.serverType===e.Ad.Server.GENERIC_GOOGLE){var o={type:e.Ad.Type.GOOGLE,ad:r};a._ads.push(o),u()}else t.xhr(s,"get",null,function(t){a._drained||(t&&t.length>0?new n(i,t,function(t){if(!a._drained){if(t.campaignId&&a._triedCampaigns.push(t.campaignId),a.syndication&&!t.ad)return void d();t.type===e.Ad.Type.VAST?t.ad.getAd(!0)&&a._ads.push(t):t.type===e.Ad.Type.GOOGLE&&t.xml&&a._ads.push(t),u()}}):a.syndication?d():u())},function(){LOG.info("[Bolt3 "+a.name+" AdPool] Request failed."),u()})};a.syndication&&"preroll"===i?MessageChannel.sendRequest("prebid",function(e){LOG.info("[Bolt3 "+a.name+" AdPool] Headerbid data",e),e&&e.hasOwnProperty("hb_adid")&&e.hasOwnProperty("hb_bidder")&&e.hasOwnProperty("hb_val")&&e.hasOwnProperty("hb_vast")&&(s+=";kvhb_adid="+e.hb_adid,s+=";kvhb_bidder="+e.hb_bidder,s+=";kvhb_val="+e.hb_val,s+=";sub1="+e.hb_vast),c()}):c()},drain:function(){this._drained=!0,this._ads=[],this._triedCampaigns=[],this._timing=null,this._timeout=!1,this._timer&&(clearTimeout(this._timer),this._timer=null),this._attempts=0},refill:function(e,t){var r=this;r._triedCampaigns=[],r._timeout=!1,r._timer&&(clearTimeout(r._timer),r._timer=null),r._attempts=0,r.fill(e,r._timing,t)},getAd:function(){return this._ads.shift()},setSize:function(e){var t=this;LOG.info("[Bolt3 "+t.name+" AdPool] server type:"+t.serverType+". Pool size: ",e),window.postLogMessage("[Bolt3 "+t.name+" AdPool] server type:"+t.serverType+" . Pool size: "+e),t._size=e},prioritizeAds:function(){for(var e=this,t=[],r=0,i=e._ads.length;r<i;r++)e._ads[r].cpm&&t.push(e._ads[r]);return t&&e._ads.length===t.length?t.sort(function(e,t){return t.cpm-e.cpm}):e._ads},done:function(t){var r=this;r.serverType===e.Ad.Server.INTERGI&&(r._ads=r.prioritizeAds()),LOG.info("[Bolt3 "+r.name+" AdPool] Prefetch is done after",r._attempts,r._ads),window.postLogMessage("["+r.name+" AdPool] Prefetch is done after "+r._attempts+" attempts. We have "+r._ads.length+" ads"),clearTimeout(r._timer),t()},hasAds:function(){return this._ads.length>0}},o}),define("zeus_ad_manager",["zeus_eventdispatcher","zeus_utils","zeus_constants","vmap_adapter","ad_server","ad_pool"],function(e,t,r,i,n,o){"use strict";function a(t,n){e.mixin(this),this.linearAdPool=new o,this.overlayAdPool=new o(!0),this.prefetchEnabled=!1,this.containerId=n,this.container=document.getElementById(this.containerId),LOG.info("AD container",this.container),this.triedCampaigns=[],this.status="none",this.aborted=!1,this.type=null,this.bestMedia=null,this.ad=null,this._dcTimeout=null,this._dcStartTime=null,this._dcTimeoutReached=!1,d=t&&"number"==typeof t?t:d,this.timeout=d,LOG.info("[Bolt3 AdManager] Ad timeout set to",d/1e3," seconds"),window.postLogMessage("Ad timeout set to "+d/1e3+" seconds","info"),this._isLinear=!0,this.selectedServer=null,this.addEventListener(r.Media.Event.ENDED,function(){this.selectedVMAPBreak&&this.trackVMAPEvent("breakEnd"),this.remove()},this),this.addOnceEventListener(r.Ad.Event.READY,this._onAdReady,this),this._onAdError=this._onAdError.bind(this),this._onAdMediaLoaded=this._onAdMediaLoaded.bind(this),this.hasBeenTouched=!1,s.isMobile&&(this._createVideoElement(),window.ContentPlayer.show(!1)),this._selectedTag=null,this.intergiServer=null,this.dfpServer=null,this.spotxServer=null,this.spotxSdkServer=null,this.genericServer=null,this._backfilling=!1,this.timing=null,this.VMAPAdapter=new i,this.VMAPBreaksForCurrentAdTiming=null,this.selectedVMAPBreak=null,this.processedVMAPSecond=null,this._currentRequestId=null,this.bid=null,this.MoatAnalytics=null,this.pixelsContainer=document.createElement("div"),this.pixelsContainer.id="bolt_trackingpixels",this.pixelsContainer.setAttribute("class","position:absolute;bottom:0;left:0;visibility:hidden;width:1px;height:1px;"),document.body.appendChild(this.pixelsContainer),PlayerView.addEventListener(r.Media.Event.DURATION_CHANGE,function(){var e=this;PlayerView.currentPlayer.isAd()||e.VMAPAdapter.setContentDuration(ContentPlayer.duration,function(t){e._dispatchEvent(r.Ad.Event.VMAP_CUEPOINTS_CHANGED,t)})},this)}var s=window.client,l=window.parseInt,d=3e4,u=function(e){var t=function(e,t){var r;return t.headerBidding&&(r=s.isMobile?t.headerBidding.mobile.order:t.headerBidding.desktop.order),Array.isArray(r)&&r.length>0?r.indexOf(e):-1},r={},i=e.headerBidParams;!function(r,i,n){var o=t("amazon",i);(e.amazonHeaderBidding||o>-1)&&(r.amazon={__index:o})}(r,e),function(e,r,i){var n=t("appnexus",r);(r.appnexusHeaderBidding||n>-1)&&(e.appnexus={},i&&i.appnexus&&(e.appnexus=i.appnexus),e.appnexus.__index=n,e.appnexus.placementId||(e.appnexus.placementId="9753885"))}(r,e,i),function(e,r,i){var n=t("rubicon",r);(r.rubiconHeaderBidding||n>-1)&&(e.rubicon={accountId:"12556",siteId:function(e){return e||(s.isMobile?"143022":"143146")}(window.DebugMode.rubiconSiteIdOverride),zoneId:function(e){return e||(s.isMobile?"664152":s.hasFlash?"664698":"665946")}(window.DebugMode.rubiconZoneIdOverride),video:{playerWidth:640,playerHeight:480,size_id:201}},i&&i.rubicon&&(e.rubicon.video=i.rubicon.video),r.language&&!e.rubicon.video.language&&(e.rubicon.video.language=r.language),e.rubicon.video.playerWidth||(e.rubicon.video.playerWidth=640),e.rubicon.video.playerHeight||(e.rubicon.video.playerHeight=480),e.rubicon.video.size_id||(e.rubicon.video.size_id=201),e.rubicon.__index=n)}(r,e,i),function(e,r,i){var n=t("indexExchange",r);(r.indexExchangeHeaderBidding||n>-1)&&(i&&i.indexExchange?e.indexExchange=i.indexExchange:e.indexExchange={id:241978,siteID:241978,video:{siteID:241978,playerType:"HTML5",protocols:["VAST2","VAST3"],maxduration:300,minduration:5,mimes:["video/mp4","video/webm"]}},e.indexExchange.__index=n)}(r,e,i);var n=!0===e.coppa;return Object.keys(r).length>0&&!n?{enabled:!0,providers:r,hbTimeout:function(e){var t;if(e.headerBidding)if(s.isMobile)try{t=e.headerBidding.mobile.timeout}catch(e){t=1e3}else try{t=e.headerBidding.desktop.timeout}catch(e){t=3e3}return t}(e),hasHBOrder:function(e){return!!e.headerBidding&&(s.isMobile?Array.isArray(e.headerBidding.mobile.order)&&e.headerBidding.mobile.order.length>0:Array.isArray(e.headerBidding.desktop.order)&&e.headerBidding.desktop.order.length>0)}(e)}:{enabled:!1}};return a.prototype.init=function(e){LOG.info("Init Ad Manager");var t=this;t.resetStatus(),t.linearAdPool.drain(),t.overlayAdPool.drain(),t.processedVMAPSecond=null,t.VMAPBreaksForCurrentAdTiming=null,t.VMAPAdapter.reset(),t.selectedVMAPBreak=null,t.isUsingVMAP=!1,t.config=window.PlayerSettings.embedAds||window.CurrentVideoConfig.advertising,t.config===window.PlayerSettings.embedAds&&LOG.info("Using embed ad settings",t.config),t.selectServer(),window.postLogMessage("Checking if VMAP is used");var r=t.selectedServer&&t.selectedServer.selectTag("vmap");r?t.VMAPAdapter.init(r,function(){LOG.info("Using VMAP"),window.postLogMessage("Found VMAP:"+r),t.isUsingVMAP=!0,e()},function(){window.postLogMessage("VMAP error","error"),e()}):(window.postLogMessage("Not using VMAP"),e())},a.prototype._createVideoElement=function(){return l(s.system.ios,10)>=10&&PlayerSettings.autoplay?(this.container.innerHTML="<video playsinline muted id='"+r.Ad.PLAYER_ID_PREFIX+this.containerId+"'></video>",this.hasBeenTouched=!0):this.container.innerHTML="<video id='"+r.Ad.PLAYER_ID_PREFIX+this.containerId+"'></video>",this.videoElement=this.container.firstElementChild,this.videoElement.setAttribute("style","position:absolute;width:100%;height:100%;top:0;left:0;bottom:0;right:0;visibility:hidden"),this.videoElement},a.prototype.resetStatus=function(){LOG.debug("[Bolt3 AdManager] reset ad manager"),this.status="none",this.container.style.display="none",this.container.style.visibility="hidden",this.adPlayer=null,this.VMAPAdapter.breaks||(this.selectedServer=null),this.adtechGoogleAdCount=null,this.provider=null,this.triedCampaigns=[],this._backfilling=!1,this.timing=null,this._currentRequestId=null,this.type=null,this.bestMedia=null,this._isLinear=null,this._dcTimeout&&(clearTimeout(this._dcTimeout),this._dcTimeout=null),this.bid=null,this.VMAPBreaksForCurrentAdTiming&&0===this.VMAPBreaksForCurrentAdTiming.length&&(this.VMAPBreaksForCurrentAdTiming=null),this.selectedVMAPBreak=null,this._selectedTag=null,this.container.style.width="100%",this.container.style.height=this.container.getAttribute("data-zeus-initial-height")+"px",this.container.style.bottom=0,this.container.style.top=0,this.container.style.left=0,this.container.style.right=0,this.container.style.backgroundColor="",this.MoatAnalytics=null},a.prototype.clearTrackingImages=function(){if(this.pixelsContainer&&this.pixelsContainer.firstElementChild)for(;this.pixelsContainer.firstElementChild;)this.pixelsContainer.removeChild(this.pixelsContainer.firstElementChild)},a.prototype.getSelectedServer=function(e){var t,i,o,a=this;try{for(t=0,o=a.config.servers.length;t<o;t++)if(i=new n(a.config.servers[t]),void 0!==e&&(i.type=e),i.type===r.Ad.Server.INTERGI?a.intergiServer=i:i.type===r.Ad.Server.DFP?a.dfpServer=i:i.type===r.Ad.Server.SPOTX?a.spotxServer=i:i.type===r.Ad.Server.SPOTX_SDK?a.spotxSdkServer=i:a.genericServer=i,void 0!==e)return i;return a.genericServer?a.genericServer:a.dfpServer||a.spotxServer||a.spotxSdkServer||a.intergiServer}catch(e){}},a.prototype.selectServer=function(e){var t=this;return t.selectedServer&&!e?t.selectedServer:(t.intergiServer=null,t.dfpServer=null,t.spotxServer=null,t.spotxSdkServer=null,t.genericServer=null,t.selectedServer=t.getSelectedServer(e),t.selectedServer&&(t.selectedServer.attempts=0),t.selectedServer)},a.prototype.hasVMAPBreak=function(e){var t=this;if(Math.floor(e)===t.processedVMAPSecond)return!1;var r=t.VMAPAdapter.getBreaks(e);return r&&LOG.info("Found VMAP ad break at ",e,"s"),!!r},a.prototype.prefetchAds=function(e,t,i){var n=this;if(n.selectServer(),n.selectedServer)try{var o=n.selectedServer.selectTag(e);if(o){var a="overlay"===e?n.overlayAdPool:n.linearAdPool;a.serverType=n.selectedServer.type,a.serverType!==r.Ad.Server.INTERGI&&a.serverType!==r.Ad.Server.SPOTX&&a.serverType!==r.Ad.Server.SPOTX_SDK?a.setSize(1):a.setSize(3),i?a.refill(o,function(){t&&t()}):a.fill(o,e,function(){t&&t()})}else t&&t()}catch(e){LOG.error(e),t&&t()}else LOG.info("[Bolt3 AdManager]  no",e," tag to prefetch"),t&&t()},a.prototype.requestAd=function(e,t,r){var i=this;if("overlay"===i.timing&&(window.AdSession.complete(),i.remove()),!i._prepareForAdRequest(e,t,r))return null;i._backfilling=!1,i.timeout=d,i.container.style.display="block",i.VMAPAdapter.breaks&&(i.VMAPBreaksForCurrentAdTiming||(i.VMAPBreaksForCurrentAdTiming="midroll"===e?i.VMAPAdapter.getBreaks(t):i.VMAPAdapter.getBreaks(e))),i._start()},a.prototype.requestOverlay=function(e,t,r){var i=this;if(!i._prepareForAdRequest("overlay",e,t))return null;i.timeout=15e3,LOG.info("Requesting overlay ad"),window.postLogMessage("Requesting overlay ad"),i._start(r)},a.prototype._prepareForAdRequest=function(e,t,r){return"none"!==this.status?(LOG.warn("[Bolt3 AdManager] Currently requesting ad, skipping the new request ("+e+", "+t+"s)"),window.postLogMessage("Currently requesting ad, skipping the new request","warn"),!1):(LOG.debug("Preparing to make new ad request ("+e+", "+t+"s)"),this.clearTrackingImages(),this.selectedServer||this.selectServer(),this.timing=e,this.cuepoint=t,this.aborted=!1,this.status="requesting",window.AdSession.reset(),window.AdRequest.reset(),window.SSTracker.reset(),"function"==typeof r&&r(),!0)},a.prototype._start=function(e){var i=this;if(i._selectedTag=null,i.type=null,window.AdRequest.reset(),!i.aborted){if(!i.selectedServer)return"function"==typeof e&&e.call(null),i.resetStatus(),void i._dispatchEvent(r.Ad.Event.TAG_NOT_AVAILABLE);if(i._backfilling&&window.postLogMessage("Starting backfill."),i.isUsingVMAP&&!i._backfilling&&"overlay"!==i.timing?(LOG.info("Trying to find a VMAP break"),window.postLogMessage("Looking for a VMAP break"),i.VMAPBreaksForCurrentAdTiming&&i.VMAPBreaksForCurrentAdTiming.length>0&&(i.processedVMAPSecond=i.cuepoint,LOG.info("Using VMAP Breaks :",i.VMAPBreaksForCurrentAdTiming),window.postLogMessage("Found a VMAP break @"+i.cuepoint+"s"),i.selectedVMAPBreak=i.VMAPBreaksForCurrentAdTiming.shift(),i._selectedTag=i.selectedVMAPBreak?i.selectedVMAPBreak.adURI:null,i._selectedTag&&/doubleclick.net/i.test(i._selectedTag)&&(i.type=r.Ad.Type.GOOGLE,i.provider=r.Ad.Provider.GOOGLE))):i._selectedTag=i.selectedServer.selectTag(i.timing),!i._selectedTag)return i.isUsingVMAP&&"overlay"!==i.timing?(LOG.error("[Bolt3 AdManager] No "+i.timing+" VMAP break found"),window.postLogMessage("No "+i.timing+" VMAP break found","error")):(LOG.error("[Bolt3 AdManager] No "+i.timing+" tag in config"),window.postLogMessage("No "+i.timing+" tag in config","error")),"function"==typeof e&&e.call(null),i.resetStatus(),void i._dispatchEvent(r.Ad.Event.TAG_NOT_AVAILABLE);i._dispatchEvent(r.Ad.Event.REQUESTED);var n=function(e){var t=new Date;LOG.info("[Bolt3 AdManager] Ad request starts at ",t),window.postLogMessage("Ad request starts at "+t),i._dcTimeoutReached=!1,i._dcTimeout&&(clearTimeout(i._dcTimeout),i._dcTimeout=null),i._dcStartTime=t.getTime(),i._dcTimeout=setTimeout(function(){var e=new Date;LOG.warn("[Bolt3 AdManager] Ad request timeout reached ",e),window.postLogMessage("Ad request timeout reached "+e,"error"),i._dcTimeoutReached=!0,i._fail()},e||i.timeout)},o=function(){PlayerSettings.customReporting&&i.selectedServer.type===r.Ad.Server.INTERGI&&(i.src+=function(){var e="";for(var t in PlayerSettings.customReporting)e+="&"+t+"="+PlayerSettings.customReporting[t];return e}()),i.src=t.substituteMacros(i.src,i.selectedServer),i.selectedServer.attempts=0,i._dcTimeout||n(),window.AdSession.start(i._backfilling),i._backfilling?window.SSTracker.backfill(i._selectedTag):i.selectedServer.type!==r.Ad.Server.INTERGI&&i.selectedServer.type!==r.Ad.Server.SPOTX_SDK&&window.SSTracker.start({tag:i._selectedTag,timing:i.timing,serverType:i.selectedServer.type,vmap:i.isUsingVMAP?i.VMAPAdapter.primaryTag:null}),i.daisyChain()};if(i.src=i._selectedTag.concat(),i.prefetchEnabled)o();else if(i.selectedServer.type===r.Ad.Server.INTERGI||i.selectedServer.type===r.Ad.Server.SPOTX)if(i.selectedServer.type===r.Ad.Server.INTERGI&&(i.src=i.src+";acao=*"),"preroll"===i.timing){var a=window.videoConfigChanged?u(i.selectedServer.siteTags):null;LOG.info("[Bolt AdManager] prebid settings",a),a&&!a.enabled?o():MessageChannel.sendRequest("prebid",function(e){e&&e.hasOwnProperty("hb_adid")&&e.hasOwnProperty("hb_bidder")&&e.hasOwnProperty("hb_val")&&e.hasOwnProperty("hb_vast")&&i.selectedServer.type===r.Ad.Server.INTERGI&&(i.src+=";kvhb_adid="+e.hb_adid,i.src+=";kvhb_bidder="+e.hb_bidder,i.src+=";kvhb_val="+e.hb_val,i.src+=";sub1="+e.hb_vast,LOG.info("Prebid:tag "+i.src)),o()},a)}else o();else i.selectedServer.type===r.Ad.Server.DFP?i.initGoogleDFPSDK(i._currentRequestId):i.selectedServer.type===r.Ad.Server.SPOTX_SDK?i.initSpotxSDK(i._currentRequestId):o()}},a.prototype.daisyChain=function(){var e,t=this;if(t.adtechGoogleAdCount=null,t.bestMedia=null,t.provider=null,window.AdRequest.reset(),t.removeAllListeners("clicked"),t.removeEventListener(r.Media.Event.LOADED,t._onAdMediaLoaded),t.adPlayer&&t.adPlayer.removeEventListener(r.ERROR,t._onAdError),!t.aborted){if(t._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Timeout.",new Date),void window.postLogMessage("Timeout","error");if(t.selectedServer||t.getSelectedServer(),t.selectedServer.attempts++,t.selectedServer.attempts>1&&(t.bid=null),t.selectedServer.attempts>t.selectedServer.maxAttempts)return LOG.error("[Bolt3 AdManager] Max ad attempts "+t.selectedServer.maxAttempts+" exhausted"),window.postLogMessage("Max ad attempts "+t.selectedServer.maxAttempts+" exhausted.","error"),t._fail(),null;if(LOG.info("[Bolt3 AdManager] Ad attempt #"+t.selectedServer.attempts+" of "+t.selectedServer.maxAttempts),window.postLogMessage("Attempt #"+t.selectedServer.attempts+" of "+t.selectedServer.maxAttempts),t._backfilling||(t.selectedServer.type===r.Ad.Server.GENERIC_GOOGLE||t.isUsingVMAP)&&window.AdRequest.start(t._selectedTag,null,t.selectedServer.attempts),e=!t.SpotxSdk&&t.selectedServer.spotxChannelId&&(t.selectedServer.type===r.Ad.Server.SPOTX_SDK||t.isUsingVMAP&&t.type===r.Ad.Type.SPOTX),t._currentRequestId=Date.now(),t.selectedServer.type===r.Ad.Server.GENERIC_GOOGLE||t.isUsingVMAP&&t.type===r.Ad.Type.GOOGLE)if(t.prefetchEnabled){var i="overlay"===t.timing?t.overlayAdPool:t.linearAdPool,n=i.getAd();n&&n.ad?(t.src=n.ad,t.processCustomGoogleAd()):t._fail()}else t.processCustomGoogleAd();else e?t.initSpotxSDK(t._currentRequestId):t.SpotxSdk?t._spotxSdkPlayer(t._playCb):t._loadNewTag()}},a.prototype._excludeAdCampaignKeys=function(){var e=this;if(e.triedCampaigns.length>0){if(e.triedCampaigns=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])}(e.triedCampaigns),e.selectedServer.type!==r.Ad.Server.INTERGI||e.selectedServer.isSpotxRaw)e.selectedServer.type===r.Ad.Server.SPOTX?e.src=e.src+"&ads_to_block[]="+e.triedCampaigns.join("&ads_to_block[]="):e.selectedServer.isSpotxRaw&&(e.src=e.thirdPartyTag+"&ads_to_block[]="+e.triedCampaigns.join("&ads_to_block[]="));else{e.src=e.src.replace(/\;key=\d+/,"");var t=e.src.indexOf("ADTECH;")+"ADTECH;".length;e.src=t>=0?e.src.slice(0,t)+"key="+e.triedCampaigns.join("+")+";"+e.src.slice(t+Math.abs(0)):e.src+";key="+e.triedCampaigns.join("+")}}},a.prototype.getCustomReportingVal=function(e){var r;return t.objectPropExists(CurrentVideoConfig,"settings","customReporting")&&(r=CurrentVideoConfig.settings.customReporting,t.objectPropExists(r,"custom[cust_pub_reporting_"+e.toString()+"]"))?r["custom[cust_pub_reporting_"+e.toString()+"]"]:""},a.prototype.appendSpotxTagParams=function(e){var r=this;if(r.selectedServer&&r.selectedServer._getSpotxChannelId()){var i="search.spotxchange.com/vast/",n=i.length+4,o=e.substring(e.indexOf(i)+n,e.indexOf(i)+n+6);e=e.replace(o,r.selectedServer._getSpotxChannelId())}return e+=t.substituteMacros("?VPAID=js&custom_skin=1&content_page_url=__WEB_URL__&player_width=__WIDTH__&player_height=__HEIGHT__"),window.client.hasFlash&&(e+="&allow_flash_creative=1"),!1!==window.CurrentVideoConfig.settings.autoplay&&(e+="&ad_volume=0"),e},a.prototype.appendSpotxHBParams=function(e){var r,i,n=this;return t.objectPropExists(window.prebidWinner,"video","hb_vast")&&(r=window.prebidWinner.video.hb_vast,i=n.adjustSpotxHBCPMs(window.prebidWinner.video.hb_val),e+="&token[hb_vast]="+encodeURIComponent(r.replace(/(^\w+:|^)\/\//,""))+"&token[hb_val]="+i+"&token[hb_bidder]="+window.prebidWinner.video.hb_bidder+"&token[hb_adid]="+window.prebidWinner.video.hb_adid+"&custom[hb_bidder]="+window.prebidWinner.video.hb_bidder+"&custom[hb_val]="+i,window.prebidWinner.video.hb_uuid&&(e+="&token[hb_uuid]="+window.prebidWinner.video.hb_uuid)),e},a.prototype.appendSpotxGDPRMacros=function(e){var r=e;if(void 0!==window.gdprConsents)if(/\$(REGS_GDPR|USER_CONSENT)/.test(r))r=t.substituteMacros(r);else{var i=/&regs\[gdpr\]=\d{1}/,n=/&user\[consent\]=\d{1}/,o=window.shouldReadGDPRConsents?1:0,a=window.gdprConsents?1:0;i.test(r)?r=r.replace(i,"&regs[gdpr]="+o):r+="&regs[gdpr]="+o,o&&(n.test(r)?r=r.replace(n,"&user[consent]="+a):r+="&user[consent]="+a)}return r},a.prototype.getCustomReportingVal=function(e){var r;return t.objectPropExists(CurrentVideoConfig,"settings","customReporting")&&(r=CurrentVideoConfig.settings.customReporting,t.objectPropExists(r,"custom[cust_pub_reporting_"+e.toString()+"]"))?r["custom[cust_pub_reporting_"+e.toString()+"]"]:""},a.prototype.getSpotxCampaignIdRemoveExtra=function(e){var t=/-(.*)/;try{return t.exec(e)[1]}catch(t){return e}},a.prototype.adjustSpotxHBCPMs=function(e){return e=Math.floor(window.parseInt(e,10)/100).toFixed(2),e=e.toString().replace(".","_")},a.prototype.appendSpotxTagCustomParams=function(e){var r,i=this,n=window.CurrentVideoConfig,o=window.client,a=t.getCurrentVideoOwnerId().toString(),s=n.hostingId?n.hostingId.toString():a,l="true",d="pregame"===PlayerSettings.playerType||"precontent"===PlayerSettings.playerType;try{l=t.isUsingSyndicatedAdTag(i.selectedServer).toString()}catch(e){window.LOG.error("[Spotx Adapter] - Failed to determine site tag is syndicated or not",e)}for(e+="&custom[campaign_id]="+(i.triedCampaigns.length?i.triedCampaigns[i.triedCampaigns.length-1]:"0.0")+"&custom[channel]="+i.selectedServer.spotxChannelId+"&custom[content_page_url]="+window.parentBaseUrl+"&custom[player_height]="+window.innerHeight.toString()+"px&custom[player_width]="+window.innerWidth.toString()+"px&custom[adunit]="+(d?"pregame":i.timing)+"&custom[device_type]="+(o.isMobile?"mobile":"desktop")+"&custom[owning_pub_id]="+(a||"")+"&custom[player]=bolt&custom[pub_id]="+(s||"")+"&custom[synd]="+l+"&custom[secure]="+(window.location.protocol.indexOf("https")>=0?"true":"false")+"&custom[vid_id]="+(t.objectPropExists(n,"content","videoId")?n.content.videoId||"":"")+"&custom[vpi]="+t.getVPIPriority().join(","),t.objectPropExists(i.selectedServer.siteTags,"id")&&(e+="&custom[ws_id]="+i.selectedServer.siteTags.id.toString()),r=1;r<6;r++)e+="&custom[cust_pub_reporting_"+r+"]="+i.getCustomReportingVal(r.toString());if(t.objectPropExists(i.selectedServer.siteTags,"placementIds"))for(r=0;r<i.selectedServer.siteTags.placementIds.length;r++)t.objectPropExists(i.selectedServer,"siteTags","coppa")&&i.selectedServer.siteTags.coppa?e+="&custom[cp_placement][]="+i.selectedServer.siteTags.placementIds[r]:e+="&custom[placement][]="+i.selectedServer.siteTags.placementIds[r];if(t.objectPropExists(n,"categories"))for(r=0;r<n.categories.length;r++)e+="&custom[vidcont_cat][]="+n.categories[r];var u=[],c=null;if(t.objectPropExists(i.selectedServer.siteTags,"categories"))for(r=0;r<i.selectedServer.siteTags.categories.length;r++)c=i.selectedServer.siteTags.categories[r],-1===u.indexOf(c)&&u.push(c);return t.objectPropExists(i.selectedServer.siteTags,"category")&&(c=i.selectedServer.siteTags.category,-1===u.indexOf(c)&&u.push(c)),u.length>0&&u.map(function(t){e+="&custom[sitecont_cat][]="+t}),e},a.prototype._loadNewTag=function(){var e=this;e.aborted||(e.adLoadTimeStart=Date.now(),window.LOG.time("[Zeus Ad Manager] - Ad load time"),function(){if(1===e.selectedServer.attempts?window.AdRequest.start(e.src,e.thirdPartyTag||null,e.selectedServer.attempts,e.bid):window.AdRequest.start(e.src,e.thirdPartyTag||null,e.selectedServer.attempts),e.prefetchEnabled&&!e._backfilling){var i="overlay"===e.timing?e.overlayAdPool:e.linearAdPool,n=i.getAd();n&&n.ad?(e.type=n.type,window.AdRequest.campaignId=n.campaignId,n.type===r.Ad.Type.VAST||n.type===r.Ad.Type.OVERLAY?(LOG.info("[Bolt3 AdManager]  Using cached VAST ad from "+e.timing+" "+i.name+" pool"),window.postLogMessage("[Bolt3 AdManager]  Using cached VAST ad from "+e.timing+" "+i.name+" pool"),e.successfulVASTResponse(n.ad,e._currentRequestId)):(LOG.info("[Bolt3 AdManager]  Using cached Google template from "+e.timing+" "+i.name+" pool"),window.postLogMessage("[Bolt3 AdManager]  Using cached Google template from "+e.timing+" "+i.name+" pool"),e.successfulGoogleResponse(t.xmlToJson(n.xml),n.xml,e._currentRequestId))):(LOG.info("[Bolt3 AdManager]  No ad from "+e.timing+" "+i.name+" pool"),e._retryAdRequest("No ad in "+e.timing+" "+i.name+" pool"))}else e.selectedServer.type===r.Ad.Server.SPOTX&&e.spotxServer&&1===e.selectedServer.attempts&&(e.src=e.appendSpotxTagParams(e.src),e.src=e.appendSpotxTagCustomParams(e.src),e.src=e.appendSpotxHBParams(e.src),e.src=e.appendSpotxGDPRMacros(e.src)),(e.selectedServer.type===r.Ad.Server.INTERGI&&e.intergiServer||e.selectedServer.type===r.Ad.Server.SPOTX&&e.spotxServer)&&e._excludeAdCampaignKeys(),LOG.debug("[Bolt3 AdManager] Loading tag: "+e.src),window.postLogMessage("Loading tag: "+e.src),t.xhr(e.src,"get",null,function(t,r){var i,n;if(!t||"string"==typeof t&&0===t.trim().length)LOG.error("[Zeus Ad Manager] - Empty response from ad server"),e._retryAdRequest("Empty response.");else try{n=new DOMParser,i=n.parseFromString(t,"text/xml"),e.handleResponse(i,r)}catch(t){LOG.error(t),e._retryAdRequest("Bad response.")}},function(t){e._retryAdRequest("Network error")},"text",e._currentRequestId)}(e._currentRequestId))},a.prototype._retryAdRequest=function(e){var t="string"==typeof e?e:"Error.";window.AdRequest.fail(t),window.postLogMessage(t+" Retrying.","warn"),this.status="failed",this.daisyChain()},a.prototype._fail=function(){var e=this;if(e.adtechGoogleAdCount=null,e.adPlayer&&(e.adPlayer.remove(),e.adPlayer.removeEventListener(r.ERROR,e._onAdError),e.adPlayer=null),e.removeEventListener(r.Media.Event.LOADED,e._onAdMediaLoaded),!e.aborted)return!e.selectedServer||e._dcTimeoutReached?(e.resetStatus(),void e._dispatchEvent(r.Ad.Event.FAILED)):void(e.selectedServer.type!==r.Ad.Server.INTERGI&&e.selectedServer.type!==r.Ad.Server.SPOTX&&e.selectedServer.type!==r.Ad.Server.SPOTX_SDK&&e.selectedServer.type!==r.Ad.Server.DFP?(e._selectedTag&&window.SSTracker.fail(),e.config===window.PlayerSettings.embedAds&&(e.config=window.CurrentVideoConfig.advertising,e.getSelectedServer()),e.intergiServer||e.dfpServer||e.spotxServer||e.spotxSdkServer?(LOG.warn("[Bolt3 AdManager] custom tag failed."),window.postLogMessage("Self-service tag failed.","warn"),e._backfilling=!0,e.triedCampaigns=[],e.selectedServer=e.intergiServer||e.dfpServer||e.spotxServer||e.spotxSdkServer,window.AdSession.fail(),setTimeout(function(){LOG.info("%c[Bolt3 AdManager] Starting a new ad session","color: white;background-color:green"),e._start()},100)):(e._selectedTag&&e.recordCustomAdImpression(),LOG.warn("[Bolt3 AdManager] No Ad",new Date),window.postLogMessage("No Ad","error"),e.resetStatus(),e._dispatchEvent(r.Ad.Event.FAILED))):"overlay"===e.timing?(e._backfilling&&(e.recordCustomAdImpression(),window.SSTracker.backfillFail(e._selectedTag)),e.resetStatus(),LOG.error("[Bolt3 AdManager] No overlay Ad"),window.postLogMessage("No overlay Ad","error"),e._dispatchEvent(r.Ad.Event.FAILED)):"video300x250"===e.timing||window.PlayerView.IPadNativeFullscreen?(e._backfilling&&(e.recordCustomAdImpression(),window.SSTracker.backfillFail(e._selectedTag)),LOG.warn("[Bolt3 AdManager] No Ad",new Date),window.postLogMessage("No Ad","error"),e.resetStatus(),e._dispatchEvent(r.Ad.Event.FAILED)):e.threeTwoFiftyFrame())},a.prototype.handleResponse=function(e,i){var n=this;if(i===n._currentRequestId&&!n.aborted){if(n.selectedServer.type===r.Ad.Server.SPOTX_SDK)return n.type=r.Ad.Type.VAST,void n._parseVAST(e,i);if(n._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Received a response from ad server but timeout limit has been reached, exit."),window.postLogMessage("Received a response from ad server but timeout limit has been reached, exit.","error"),void window.AdRequest.fail("Daisy-chain timeout");if(null===e)return void n._retryAdRequest("Bad response");window.zeus_ad_xml=e;var o=t.xmlToJson(e);if(null===o?n.type="unknown":void 0!==o.VAST?n.type=r.Ad.Type.VAST:void 0!==o.BoltAdTemplate&&"google"===o.BoltAdTemplate["@attributes"].source?n.type=r.Ad.Type.GOOGLE:void 0!==o["adserver-response"]&&"img"===o["adserver-response"]["@attributes"].rettype?n.type=r.Ad.Type.STATIC_IMAGE:n.type="unknown",LOG.debug("[Bolt3 AdManager] Received a response",e),window.postLogMessage("Received a response","success"),n.type===r.Ad.Type.VAST){var a=e.getElementsByTagName("VASTAdTagURI")[0],l=function(e){var t;try{t=e.getElementsByTagName("Ad")[0]}catch(e){}return t}(e),d=!1;if(void 0!==l){if(d="true"===l.getAttribute("overlay"),"overlay"===n.timing){if(n.selectedServer.type===r.Ad.Server.INTERGI&&!d)return LOG.warn("Requested overlay ads but received non-overlay tag"),window.postLogMessage("Requested overlay ads but received non-overlay tag","error"),void n._retryAdRequest("Overlay tag expected");n.type=r.Ad.Type.OVERLAY}if(n.campaignId=l.id,
n.campaignId&&(n.selectedServer.type===r.Ad.Server.SPOTX||n.selectedServer.isSpotxRaw?(n.triedCampaigns.push(n.getSpotxCampaignIdRemoveExtra(n.campaignId)),window.AdRequest.campaignId=n.getSpotxCampaignIdRemoveExtra(n.campaignId)):(n.triedCampaigns.push(n.campaignId),window.AdRequest.campaignId=n.campaignId)),a){var u=a.textContent;try{n.thirdPartyTag=t.substituteMacros(u)}catch(e){LOG.info("%c[Kinesis] %c[Player] %cError %cFailed to get textContent of VASTAdTagURI.\n","color: yellow;","color: pink;","color: #f00;","color: cyan;",e)}if(-1!==u.indexOf("adotube.com")&&"preroll"!==n.timing)return LOG.warn("[Bolt3 AdManager] Received Adotube tag not in preroll. Retrying."),void n._retryAdRequest("Received Adotube tag, but not in a preroll.");if(-1!==u.indexOf("delivery.vidible.tv")&&"preroll"!==n.timing)return LOG.warn("[Bolt3 AdManager] Received AOL tag not in preroll. Retrying."),void n._retryAdRequest("Received AOL tag, but not in a preroll.");if(u.indexOf("coull.com")>-1&&u.indexOf("ad_type=ov")>-1)return void n._retryAdRequest("[Bolt3 AdManager] COULL overlay is no longer supported")}else LOG.info("Received a direct-campaign VAST"),window.postLogMessage("Received a direct-campaign VAST");"true"===l.getAttribute("moatAnalytics")?(LOG.info("[Bolt3 AdManager]  Found MOAT analytics switch"),window.postLogMessage("MOAT analytics is enabled"),require(["moat_analytics_adapter"],function(e){n.MoatAnalytics=e,n.MoatAnalytics.container=n.container,n.MoatAnalytics.configure({level1:l.getAttribute("moatAdvertiser"),level2:l.getAttribute("moatCampaign"),level3:l.getAttribute("moatLineItem"),level4:l.getAttribute("moatCreative"),slicer1:l.getAttribute("moatSite"),slicer2:l.getAttribute("moatPlacement"),partnerCode:l.getAttribute("moatPartnerCode")})})):(n.MoatAnalytics=null,n._parseVAST(e,i))}else LOG.warn("[Bolt3 AdManager] Empty VAST document."),n.selectedServer.type===r.Ad.Server.SPOTX||n.selectedServer.isSpotxRaw?(n.selectedServer.isSpotxRaw=!1,n._fail()):n._retryAdRequest("Bad response")}else n.type===r.Ad.Type.GOOGLE?(LOG.debug("[Bolt3 AdManager] found google"),window.postLogMessage("Received a Google tag"),s.isMobile&&n.videoElement&&(n.videoElement.style.display="none"),n.successfulGoogleResponse(o,e,i)):n.type===r.Ad.Type.STATIC_IMAGE?(LOG.debug("[Bolt3 AdManager] found static image"),window.postLogMessage("Received a static image ad tag"),s.isMobile&&n.videoElement&&(n.videoElement.style.display="none"),n.successfulStaticImageResponse(o,e,i)):(LOG.warn("[Bolt3 AdManager] bad response from ad server"),n._retryAdRequest("Bad response"))}},a.prototype._parseVAST=function(e,t){var r=this;require(["vastvmap"],function(i){LOG.info("[Bolt3 AdManager] Processing VAST XML",e),window.postLogMessage("Processing VAST XML"),new i.VASTAds(e,function(e,i){r.successfulVASTResponse(e,t)})})},a.prototype.successfulVASTResponse=function(e,i){window.postLogMessage("VAST XML has been processed"),LOG.info("VAST XML has been processed");var n=this;if(i===n._currentRequestId&&!n.aborted){if(n._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Received a VAST ad but timeout limit has been reached, exit."),window.postLogMessage("Received a VAST ad but timeout limit has been reached, exit.","error"),void window.AdRequest.fail("Timeout");if(void 0===e||null===e)LOG.warn("[Bolt3 AdManager] empty vast document"),n._retryAdRequest("Empty VAST document.");else if(n.ad=e.getAd(!0),n.type===r.Ad.Type.OVERLAY){if(n.ad.properties.hasOwnProperty("AdSystem")&&"string"==typeof n.ad.properties.AdSystem&&"coull"===n.ad.properties.AdSystem.toLowerCase())return void n._retryAdRequest("[Bolt3 AdManager] COULL overlay is no longer supported")}else{var o=n.ad.linear.getAllMediaAsObject(),a=[r.Mime.SWF,r.Mime.JS,r.Mime.XJS,r.Mime.MP4,r.Mime.WEBM,r.Mime.OGG,r.Mime.FLV];s.hasFlash||(a=[r.Mime.JS,r.Mime.XJS,r.Mime.MP4,r.Mime.WEBM,r.Mime.OGG]),n.bestMedia=t.ad.getBestMedia(t.ad.filterAdMedia(o),a),null!==n.bestMedia?(n.status="media_located",LOG.info("[Bolt3 AdManager] Found a playable ad media file",n.bestMedia),/dcm/i.test(n.ad.properties.AdSystem)||/googleapis.com\/.*\/vpaid_adapter.js$/.test(n.bestMedia.src)?(window.postLogMessage("Found a Google DCM VAST/VPAID"),n.provider=r.Ad.Provider.GOOGLE,n.type=r.Ad.Type.GOOGLE_DCM_VPAID):(window.postLogMessage("Found a playable ad media file :"+n.bestMedia.src),n.bestMedia.type===r.Mime.JS||n.bestMedia.type===r.Mime.XJS?(n.type=r.Ad.Type.JS_VPAID,n.bestMedia.src.indexOf("LiveRail.AdManager")>-1?n.provider=r.Ad.Provider.LIVERAIL:n.bestMedia.src.indexOf("yume_vpaid.js")>-1?n.provider=r.Ad.Provider.YUME:n.bestMedia.src.indexOf("vidible.tv")>-1?n.provider=r.Ad.Provider.AOL:/spotxcdn.com/.test(n.bestMedia.src)?n.provider=r.Ad.Provider.SPOTX:/redir.adap.tv/.test(n.bestMedia.src)?n.provider=r.Ad.Provider.ADAP:/moatwrapper.js/.test(n.bestMedia.src)?n.provider=r.Ad.Provider.MOAT:/s-static.innovid.com/i.test(n.bestMedia.src)?n.provider=r.Ad.Provider.INNOVID:/ds.serving-sys.com\/.*\/VPAIDAPI.js$/i.test(n.bestMedia.src)?(n.provider=r.Ad.Provider.SIZMEK,n.type=r.Ad.Type.GOOGLE_DCM_VPAID):/ads.celtra.com/i.test(n.bestMedia.src)?n.provider=r.Ad.Provider.CELTRA:n.provider="generic",n.config.useIMAForVPAID&&(window.postLogMessage("Playing JS VPAID with IMA SDK"),n.type=r.Ad.Type.GOOGLE_DCM_VPAID)):n.bestMedia.type===r.Mime.SWF&&(LOG.info("Found flash swf"),n.type=r.Ad.Type.FLASH_VPAID,n.provider="generic",n.bestMedia.src.indexOf("liverail.com")>-1?n.provider=r.Ad.Provider.LIVERAIL:n.bestMedia.src.indexOf("adotube.com")>-1&&(n.provider=r.Ad.Provider.ADOTUBE))),n._dispatchEvent(r.Ad.Event.READY),n.MoatAnalytics?n.MoatAnalytics.init({duration:n.ad.linear.getDuration(),videoUrl:n.bestMedia},function(){n.playAd()}):n.playAd()):(LOG.error("[Bolt3 AdManager] No playable ad media"),n._retryAdRequest("No playable ad media."))}}},a.prototype.processCustomGoogleAd=function(){var e=this;if(!e.aborted){if(e._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] About to process custom google ad but timeout limit has been reached."),void window.postLogMessage("About to process custom google ad but timeout limit has been reached","error");e.videoElement&&(e.videoElement.style.display="none"),e.type=r.Ad.Type.GOOGLE,e.playAd()}},a.prototype.successfulGoogleResponse=function(e,t,i){var n=this;if(i===n._currentRequestId&&!n.aborted){if(n._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Received google ad template from AdTech but timeout limit has been reached"),void window.postLogMessage("Received google ad template from AdTech but timeout limit has been reached","error");n.googleChannel=e.BoltAdTemplate["@attributes"].channel,n.googlePublisherId=e.BoltAdTemplate["@attributes"].publisherId,n.googleAdId=e.BoltAdTemplate["@attributes"].adid,n.googleSlotname=e.BoltAdTemplate["@attributes"].slotname||1758784393,window.postLogMessage("Google Ad Channel : "+n.googleChannel),window.postLogMessage("Google Ad Publisher Id : "+n.googlePublisherId),window.postLogMessage("Google Ad Id : "+n.googleAdId),window.postLogMessage("Google Ad Slotname : "+n.googleSlotname),n.campaignId=n.googleAdId,n.campaignId&&(n.triedCampaigns.push(n.campaignId),window.AdRequest.campaignId=n.campaignId),n.videoElement&&(n.videoElement.style.visibility="hidden"),n.adtechGoogleAdCount=t.firstChild.childNodes[1].childNodes[0].nodeValue,n.provider=r.Ad.Provider.GOOGLE,n.playAd()}},a.prototype.initSpotxSDK=function(e){var t=this;if(!t.aborted)return t._dcTimeoutReached?(LOG.error("[Zeus Ad Manager] - About to initialize SpotX SDK ad but timeout limit has been reached."),void window.postLogMessage("[Zeus Ad Manager] - About to initialize SpotX SDK ad but timeout limit has been reached.","error")):void require(["spotx_sdk_initiator","//js.spotx.tv/directsdk/v1/"+t.selectedServer.spotxChannelId+".js"],function(r,i){t.SpotxSdk=new r,t.SpotxSdk.getVASTAd().then(function(r){var i;t.campaignId=r.getElementsByTagName("Ad")[0].id||"",window.AdSession.start(t._backfilling),t.ad=r,t.handleResponse(t.ad,e);try{i=decodeURIComponent(t.src)}catch(e){i=t.src}LOG.info("[Zeus Ad Manager] - Processing VAST XML from SpotxSDK",t.ad),LOG.debug("[Zeus Ad Manager] -  Loading SpotX SDK tag: "+i),window.postLogMessage("[Zeus Ad Manager] - Loading SpotX SDK tag: "+i)},function(e){LOG.error("[Zeus Ad Manager] - SpotX getVASTAd() error",e),t._fail()})})},a.prototype.initGoogleDFPSDK=function(e){var t=this;if(!t.aborted){if(t._dcTimeoutReached)return LOG.error("[Zeus Ad Manager] - About to initialize Google IMA SDK for DFP but timeout limit has been reached."),void window.postLogMessage("[Zeus Ad Manager] - About to initialize Google IMA SDK for DFP but timeout limit has been reached.","error");window.AdSession.start(),window.postLogMessage("[Zeus Ad Manager] - Google DFP ad"),t.selectedServer.attempts=t.selectedServer.attempts||1,1===t.selectedServer.attempts?window.AdRequest.start(t.src,null,t.selectedServer.attempts,t.bid):window.AdRequest.start(t.src,null,t.selectedServer.attempts),window.AdRequest.campaignId=t.campaignId,require(["googleAdsPlayer"],function(e){t.provider=r.Ad.Provider.GOOGLE,t.type=r.Ad.Type.GOOGLE_DCM_VPAID,t.adPlayer=new e,t._playCb()})}},a.prototype.successfulStaticImageResponse=function(e,i,n){var o=this;if(n===o._currentRequestId&&!o.aborted){if(o._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Received a static image ad but timeout limit has been reached","error"),void window.postLogMessage("Received a static image ad but timeout limit has been reached","error");window.postLogMessage("Received a static image ad"),o._dispatchEvent(r.Ad.Event.READY),o.staticImage={};try{o.staticImage.src=e["adserver-response"]["banner-info"].creative["@attributes"].url,o.staticImage.clickthrough=t.substituteMacros(e["adserver-response"]["banner-info"].link["@attributes"].url),o.staticImage.width=e["adserver-response"]["banner-info"].creative["@attributes"].width,o.staticImage.height=e["adserver-response"]["banner-info"].creative["@attributes"].height,o.playAd()}catch(e){o._retryAdRequest("Static image ad failed to load.")}var a;try{a=i.firstChild.childNodes[3].childNodes[5].firstChild.nodeValue}catch(e){LOG.error("Impression URL is missing ",i),window.postLogMessage("Impression URL is not found in the static image ad XML","warn")}a&&t.xhr(a,"get",null,function(){LOG.info("[Bolt3 AdManager] ADTECH adcount for static image ad has been fired",a),window.postLogMessage("ADTECH adcount for static image ad has been fired "+a,"success")},function(){LOG.error("[Bolt3 AdManager] Failed to fire ADTECH adcount for static image ad",a),window.postLogMessage("Failed to fire ADTECH adcount for static image ad"+a,"error")})}},a.prototype.threeTwoFiftyFrame=function(){var e=this;if(!e.aborted){if(e.timing="video300x250",e._dcTimeoutReached)return LOG.error("[Bolt3 AdManager] Got a 300x250 ad but timeout limit has been reached, exit."),window.postLogMessage("Received a 300x250 ad but timeout limit has been reached","error"),window.AdRequest.fail("Timeout"),void e._fail();e._selectedTag=e.selectedServer.selectTag(e.timing),e.container.clientHeight<280||e.container.clientWidth<350?(LOG.warn("[Bolt3 AdManager] Player too small for 300x250 playback"),window.postLogMessage("Player too small for 300x250 ad playback","error"),e._fail()):e._selectedTag&&""!==e._selectedTag?(LOG.debug("[Bolt3 AdManager] 300x250 tag",e._selectedTag),window.postLogMessage("300x250 tag "+e._selectedTag),e._dispatchEvent(r.Ad.Event.READY),e.type=r.Ad.Type.THREE_TWO_FIFTY,e.bestMedia={src:e._selectedTag,type:e.type},e.playAd()):(LOG.error("[Bolt3 AdManager] 300x250 tag is empty"),window.postLogMessage("300x250 tag is empty","error"),window.AdRequest.fail("Empty tag"),e._fail())}},a.prototype._onAdMediaLoaded=function(){var e=this;if(e._killDCTimeout(),e.adPlayer){if(e._isLinear=e.adPlayer.isLinear(),e._isLinear?e.container.style.backgroundColor="#000":(e.container.style.display="block",e.container.style.backgroundColor="rgba(0,0,0,0)"),LOG.info("[Bolt3 AdManager] ",e._isLinear?"Linear":"Non-Linear Ad media fully loaded, "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),window.postLogMessage("Ad media fully loaded, "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),e.type===r.Ad.Type.GOOGLE&&window.AdRequest.setMedia(e.adPlayer.getSource()),window.AdRequest.success(),window.prebidWinner&&!window.kinesis.headerbidHasBeenTracked){var t=window.prebidWinner.video.hb_bidder,i={};"amazon"===t&&/amazon-adsystem.com/.test(window.prebidWinner.video.hb_vast)?i.bidder="amazon":"rubicon"===t&&/rubicon(-project)?.com/.test(window.prebidWinner.video.hb_vast)&&(i.bidder="rubicon"),window.kinesis.send("ad_impressions",i,"app")}e.selectedServer.type!==r.Ad.Server.INTERGI&&e.selectedServer.type!==r.Ad.Server.SPOTX&&e.selectedServer.type!==r.Ad.Server.SPOTX_SDK?(e.recordCustomAdImpression(),window.SSTracker.success()):e._backfilling&&window.SSTracker.backfillSuccess(e._selectedTag)}},a.prototype.trackVMAPEvent=function(e){this.selectedVMAPBreak.trackingEvents&&(LOG.info("tracking vmap event",e),window.postLogMessage("Tracking vmap "+e),this.selectedVMAPBreak.trackingEvents.track(e))},a.prototype._onAdReady=function(e){if("pregame"===window.PlayerSettings.playerType||"precontent"===window.PlayerSettings.playerType){var t={type:"zeus_event",name:"boltSetIframeVisibility",id:window.id,isAd:!0,data:{visibilityVal:"visible"}};return void window.parent.postMessage(JSON.stringify(t),"*")}},a.prototype._onAdError=function(e){var t=this,r="string"==typeof e.data?e.data:"Ad Error.";LOG.error("[Bolt3 AdManager] ",t.type+" Ad error"),t._retryAdRequest(r)},a.prototype._killDCTimeout=function(){var e=this;e._dcTimeout&&(LOG.debug("[Bolt3 AdManager] kill dc timeout"),clearTimeout(e._dcTimeout),e._dcTimeout=null)},a.prototype._spotxSdkPlayer=function(e){var t=this;require(["spotx_sdk_player"],function(r){t.selectedServer.attempts=t.selectedServer.attempts||1,1===t.selectedServer.attempts?window.AdRequest.start(t.src,null,t.selectedServer.attempts,t.bid):window.AdRequest.start(t.src,null,t.selectedServer.attempts),window.AdRequest.campaignId=t.campaignId,t.adPlayer=new r(t.bestMedia,t.ad.linear.parameters),"function"==typeof e&&e.call(t)})},a.prototype._playCb=function(){var e=this;if(!e.aborted){LOG.debug("[Bolt3 AdManager] Trying to play the ad in "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),window.postLogMessage("Trying to play the ad in "+(Date.now()-e._dcStartTime)/1e3+" secs after daisy-chain began"),e.selectedServer.type!==r.Ad.Server.DFP&&(e.selectedServer.type===r.Ad.Server.GENERIC_GOOGLE||e.isUsingVMAP&&e.type===r.Ad.Type.GOOGLE||e.selectedServer.type===r.Ad.Server.DFP?e.adPlayer.customTag=e.src:e.type===r.Ad.Type.GOOGLE_DCM_VPAID&&(e.adPlayer.customTag=e.src.replace(";acao=*",""),LOG.info("[Bolt3 AdManager] Tag for Google Player ",e.adPlayer.customTag))),e.adPlayer.addOnceEventListener(r.ERROR,e._onAdError),e.addOnceEventListener(r.Media.Event.LOADED,e._onAdMediaLoaded),e.adPlayer.playAd();try{window.kinesis.send("benchmarks",{type:"ads_loadNewTag_to_playCb",duration:Date.now()-e.adLoadTimeStart},"app")}catch(e){throw new Error("[Zeus Ad Manager] - Kinesis erorr on ad load time & benchmarks")}e.adLoadTimeStart=null,window.LOG.timeEnd("[Zeus Ad Manager] - Ad load time")}},a.prototype.playAd=function(){var e,t=this;try{e=JSON.parse(t.ad.linear.parameters).ad_id}catch(e){LOG.debug("[Zeus Ad Manager] - Unable to JSON parse creative data inside spotx adapter")}if(!t.aborted)if(window.AdRequest.adType=t.type,window.AdRequest.network=t.provider,t.type!==r.Ad.Type.GOOGLE&&window.AdRequest.setMedia(t.bestMedia.src,t.bestMedia.type),t.container.style.visibility="visible",t.type===r.Ad.Type.VAST||t.type===r.Ad.Type.FLASH_VPAID)require(["vastAdsPlayer"],function(e){t.adPlayer=new e,t._playCb()});else if(t.type===r.Ad.Type.JS_VPAID)LOG.info("Playing JS VPAID ",t.provider),t.provider===r.Ad.Provider.LIVERAIL?require(["zeus_liverail_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia),t._playCb()}):t.provider===r.Ad.Provider.YUME?require(["yume_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia),t._playCb()}):t.provider===r.Ad.Provider.AOL?require(["aol_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia),t._playCb()}):t.provider===r.Ad.Provider.SPOTX||t.selectedServer.isSpotxRaw?t.selectedServer.type===r.Ad.Server.SPOTX_SDK&&t.selectedServer.spotxChannelId?t._spotxSdkPlayer(t._playCb):require(["spotx_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}):t.provider===r.Ad.Provider.ADAP?require(["adap_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}):t.provider===r.Ad.Provider.MOAT?require(["moat_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}):t.provider===r.Ad.Provider.CELTRA?require(["celtra_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}):t.provider===r.Ad.Provider.INNOVID?require(["innovid_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}):require(["linear_jsvpaid"],function(e){t.adPlayer=new e(t.bestMedia,t.ad.linear.parameters),t._playCb()}),e&&window.postLogMessage("[Zeus Ad Manager] - Attempting to try Campaign ID: <strong><u>"+e+"</u></strong>");else if(t.type===r.Ad.Type.GOOGLE||t.type===r.Ad.Type.GOOGLE_DCM_VPAID)if("overlay"===t.timing)require(["google_html_overlay"],function(e){t.adPlayer=new e,t._playCb()});else if(s.isMobile)if(window.MobileIMAPlayer)t.adPlayer=window.MobileIMAPlayer,t._playCb();else var i=setInterval(function(){window.MobileIMAPlayer&&(clearInterval(i),t.adPlayer=window.MobileIMAPlayer,t._playCb())},10);else LOG.info("[Bolt3 AdManager] Requiring google ads player"),require(["googleAdsPlayer"],function(e){t.adPlayer=new e,t._playCb()});else t.type===r.Ad.Type.STATIC_IMAGE?require(["staticImageAdsPlayer"],function(e){t.adPlayer=new e,t._playCb()}):t.type===r.Ad.Type.THREE_TWO_FIFTY?require(["threeTwoFiftyAdsPlayer"],function(e){t.adPlayer=new e,t._playCb()}):t.type===r.Ad.Type.OVERLAY&&t.provider===r.Ad.Provider.COULL&&t._retryAdRequest("[Bolt3 AdManager] COULL overlay is no longer supported")},a.prototype.getDuration=function(){return this.adPlayer.getDuration()},a.prototype.getCurrentTime=function(){var e=this.adPlayer.getCurrentTime();return void 0===e&&(e=0),e},a.prototype.getPercentPlayed=function(){var e=this;return null!==e.getCurrentTime()&&null!==e.getDuration()?e.getCurrentTime()/e.getDuration()*100:null},a.prototype.getVolume=function(){return this.adPlayer.getVolume()},a.prototype.pause=function(){this.adPlayer.pause()},a.prototype.resume=function(){this.adPlayer.resume()},a.prototype.setVolume=function(e){LOG.debug("[Bolt3 AdManager] setting volume to "+e),this.adPlayer.setVolume(e),this.currentVolume=e},a.prototype.mute=function(){this.currentVolume=this.getVolume(),this.adPlayer.setVolume(0),this._dispatchEvent(r.Media.Event.MUTED)},a.prototype.unmute=function(){this.adPlayer.setVolume(this.currentVolume),this._dispatchEvent(r.Media.Event.UNMUTED)},a.prototype.remove=function(){this.adPlayer&&(LOG.debug("[Bolt3 AdManager] Ad player removed"),window.postLogMessage("Ad player removed"),this.adPlayer.remove()),this.resetStatus()},a.prototype.abort=function(){"none"===this.status||this.aborted||(this.aborted=!0,LOG.warn("Ad aborted"),window.AdRequest.abort(),this.linearAdPool.drain(),this.overlayAdPool.drain(),this._dispatchEvent(r.Ad.Event.ABORTED),this.remove())},a.prototype.isLinear=function(){return this._isLinear},a.prototype.recordCustomAdImpression=function(){window.SSTracker.recordImpression()},a.prototype.dispatchQueueEvent=function(e){this._dispatchEvent(r.Ad.Event.QUEUED),e&&setTimeout(function(){LOG.info("[BoltAdManager dispatchQueueEvent] invoking callback after",r.Ad.QUEUE_WAIT),e()},r.Ad.QUEUE_WAIT)},a}),define("staticImageAdsPlayer",["zeus_eventdispatcher","zeus_utils"],function(e){function t(){r=window.BoltAdManager,e.mixin(this),this._isAd=!0,this.containerId=r.containerId,this.container=r.container,this._isLinear=!0,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this.type=i.Ad.Type.STATIC_IMAGE,this.startTime=0,this.currentTime=0,this.duration=n}var r,i=window.ZeusConstants,n=10;return t.prototype.isAd=function(){return this._isAd},t.prototype.isLinear=function(){return this._isLinear},t.prototype.playAd=function(){var e=this;e.imgElement=document.createElement("img"),e.imgElement.setAttribute("src",r.staticImage.src);var t="bolt_image_"+Math.floor(1e9*Math.random()+1);e.imgElement.setAttribute("id",t),e.imgElement.setAttribute("width",r.staticImage.width),e.imgElement.setAttribute("height",r.staticImage.height),e.container.appendChild(e.imgElement),e.containerWidth=e.container.offsetWidth,e.containerHeight=e.container.offsetHeight,e.centerAd(),r._dispatchEvent(i.Media.Event.LOADED),e._dispatchEvent(i.Media.Event.PLAY),r._dispatchEvent(i.Media.Event.PLAYING),e._dispatchEvent(i.Media.Event.PLAYING),e._sizeTrackerInterval=setInterval(function(){e.centerAd()},100)},t.prototype.play=function(){function e(){r._dispatchEvent(i.Ad.Event.CLICKED,a),window.open(a,"_bolt_advertiser").focus()}var t=this,o=setInterval(function(){t.currentTime>n+.5?(clearInterval(o),LOG.info("StaticImageAds::ended"),t.imgElement&&(t.imgElement.parentNode.removeChild(t.imgElement),t.imgElement.removeEventListener("mousedown",e,!1)),t._dispatchEvent(i.Media.Event.ENDED),r._dispatchEvent(i.Media.Event.ENDED)):(t.currentTime+=.01,t._dispatchEvent(i.Media.Event.TIME_UPDATE,t.currentTime),r._dispatchEvent(i.Media.Event.TIME_UPDATE,t.currentTime))},10),a=r.staticImage.clickthrough;t.handleClicks=e,t.imgElement&&(t.imgElement.addEventListener("mousedown",e,!1),t.imgElement.style.cursor="pointer")},t.prototype.handleClicks=function(){r._dispatchEvent("clicked"),window.open(r.staticImage.clickthrough,"_bolt_advertiser").focus()},t.prototype.getDuration=function(){return n},t.prototype.remove=function(){var e=this;e.container.style.display="none",r._dispatchEvent(i.Player.Event.REMOVED),clearTimeout(e.timeout),clearInterval(e.timer),clearInterval(e._sizeTrackerInterval),e.removeAllListeners()},t.prototype.enterFullscreen=function(){this.setFullscreen(!0)},t.prototype.exitFullscreen=function(){this.setFullscreen(!1)},t.prototype.resize=function(e,t){LOG.debug("[bolt3] STATIC IMAGE AD RESIZE",e,t);var r=this;r.container.style.width=e,r.container.style.height=t,r.containerWidth=r.container.offsetWidth,r.containerHeight=r.container.offsetHeight,r.centerAd()},t.prototype.setFullscreen=function(e){var t=this;LOG.info("[bolt3] static image set fullscreen",e),t.fullscreen=e},t.prototype.getVolume=function(){return null},t.prototype.setVolume=function(){return null},t.prototype.getCurrentTime=function(){return this.currentTime/1e3},t.prototype.pause=function(){},t.prototype.resume=function(){},t.prototype.mute=function(){},t.prototype.centerAd=function(){var e=this;e.imgElement.setAttribute("style","margin-left:"+(e.container.offsetWidth-r.staticImage.width)/2+"px;margin-top:"+(e.container.offsetHeight-r.staticImage.height)/2+"px",!1)},t.prototype.getSource=function(){return this.imgElement.src},t}),define("base_ad_player",["zeus_eventdispatcher","zeus_constants","zeus_utils"],function(e,t,r){"use strict";var i;r.dom;return Stapes.subclass({constructor:function(){i=window.BoltAdManager,this.container=i.container,this.containerId=i.containerId,this.containerInitialStyles=this.container?getComputedStyle(this.container):null,this.type=null,this.fullscreen=!1,this._volume=0,this._duration=0,this._currentTime=0,this._isLinear=!0,e.mixin(this)},isAd:function(){return!0},isLinear:function(){return this._isLinear},playAd:function(){},resume:function(){},pause:function(){},getDuration:function(){return this._duration},getCurrentTime:function(){return this._currentTime},setVolume:function(e){},getVolume:function(){return this._volume},mute:function(e){},setFullscreen:function(e){},getSource:function(){return i.bestMedia},end:function(){i._dispatchEvent(t.Media.Event.ENDED)},remove:function(){},updateLayout:function(){}})}),define("googleAdsPlayer",["zeus_utils","zeus_constants","base_ad_player"],function(e,t,r){var i=window.PlayerView,n=window.site.protocol+"//imasdk.googleapis.com/js/sdkloader/ima3.js",o=window.client,a=r.subclass({constructor:function(){r.prototype.constructor.call(this),this.customTag=null,this.type="google",this.timing=BoltAdManager.timing,this.video=BoltAdManager.videoElement,this.hasStarted=!1,this.metadata=null,this._isAd=!0,this._isLinear=!1,this.fullscreen=!1,this.volume=1,this.muted=!1,this.buffered=0,this.currentTime=0,this.duration=0,this._intervalId=null,this.startTime=0,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this._nonLinearPseudoDuration=15,this._nonLinearCountdown=null,this._nonLinearPseudoTime=0,this.sdkAdsManager=null,this.onAdsManagerLoaded=this.onAdsManagerLoaded.bind(this),this.onAdError=this.onAdError.bind(this),this.onContentPauseRequested=this.onContentPauseRequested.bind(this),this.onContentPauseRequested=this.onContentPauseRequested.bind(this),this.onAdEvent=this.onAdEvent.bind(this),this._checkTime=this._checkTime.bind(this),o.system.ipad&&(this._handleIPadFullscreenEvents=this._handleIPadFullscreenEvents.bind(this),this.video.addEventListener("webkitEnterFullscreen",this._handleIPadFullscreeEvents),this.video.addEventListener("webkitExitFullscreen",this._handleIPadFullscreenEvents))}});return a.prototype._handleIPadFullscreenEvents=function(e){LOG.info("[Bolt3 Google::_handleIPadFullscreen]",e.type),e.type},a.prototype.playAd=function(){function e(){LOG.debug("[Bolt3 Google] Create ima"),r.setUpIMAContainer(),r.createAdsLoader(),r.resize("100%","100%")}var r=this;r.hasStarted=!0,r.paused=!1,"undefined"==typeof google||void 0===google.ima?function(e,t){if(e&&"string"==typeof e){LOG.info("[Bolt3 Google] loading IMA script");var r=document.createElement("script");r.onload=function(){LOG.info("[Bolt3 Google] IMA Script loaded"),t&&t()},r.src=e,document.getElementsByTagName("head")[0].appendChild(r)}}(n,function(){LOG.debug("[Bolt3 Google] loaded IMA for first time!"),t.Ad.IMA_ENABLED=!0,e(),r.requestAd()}):(LOG.debug("[Bolt3 Google] IMA already loaded!"),e(),r.requestAd())},a.prototype.setUpIMAContainer=function(){LOG.debug("[Bolt3 Google] setupIMAContainer");var e=this;e.container.style.display="block",e.container.style.visibility="hidden",google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),e.adDisplayContainer=new google.ima.AdDisplayContainer(e.container,e.video),e.adDisplayContainer.initialize()},a.prototype.createAdsLoader=function(){var e=this;if(e.adDisplayContainer)LOG.debug("[Bolt3 Google] create ads loader"),e.adsLoader=new google.ima.AdsLoader(e.adDisplayContainer),e.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e.onAdsManagerLoaded,!1),e.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e.onAdError,!1);else var t=setInterval(function(){e.adDisplayContainer&&(clearInterval(t),e.createAdsLoader())},100)},a.prototype.substituteMacros=function(e,t,r){var i=encodeURIComponent(window.site.href),n=e.concat();return n=n.replace("[referrer_url]",i),n=n.replace("[description_url]",i),n=n.replace("[ad_type]",t.adType),n=n.replace("[timestamp]",Math.round(Date.now()/1e3).toString()),r&&(/&tfcd=1/i.test(n)||(n+="&tfcd=1")),LOG.info("[Bolt3 Google] Tag "+n),n},a.prototype.requestAd=function(){var e=this;if(e.adsLoader){var r={maxAdDuration:3e4,viewMode:"FULLSCREEN",overlay:0},n=[],a=BoltAdManager.selectedServer.siteTags,s=o.isMobile?a.html5.mobile:a.html5.desktop;LOG.info("[Bolt3 Google] tags",s),s&&void 0!==s.adTypes&&((void 0===s.adTypes.linear||s.adTypes.linear)&&(!1!==a.trueView&&"preroll"===e.timing?0===window.GoogleTrueViewPlayCount&&1===window.ContentPlayer.videoPlayCount?n.push("skippablevideo"):(LOG.info("[Bolt3 Google] Skippable ad has been played once, requesting standardvideo"),window.postLogMessage("[Google] Trueview ad has been played once. Requesting standard video."),n.push("standardvideo")):n.push("standardvideo")),(void 0===s.adTypes.nonlinear||s.adTypes.nonlinear)&&n.push("image")),0===n.length&&(n=!1!==a.trueView&&"preroll"===e.timing&&1===window.ContentPlayer.videoPlayCount&&0===window.GoogleTrueViewPlayCount?["skippablevideo","image"]:["standardvideo","image"]),o.isMobile&&(o.system.iphone||i.IPadNativeFullscreen)&&(n=["standardvideo"]),n.indexOf("skippablevideo")>-1?LOG.info("[Bolt3 Google] Trueview requested"):LOG.info("[Bolt3 Google] Trueview not requested"),r.adType=n.join("_"),e.adsRequest=new google.ima.AdsRequest;var l=encodeURIComponent(window.site.href),d=!0===a.coppa;if(d&&LOG.info("[Bolt3 Google] COPPA compliance required"),BoltAdManager.selectedServer.type===t.Ad.Server.DFP){var u="";e.adsRequest.adTagUrl=e.substituteMacros(BoltAdManager.src,r,d),"undefined"!=typeof prebidWinner&&(u+="&cust_params=hb_bidder="+prebidWinner.video.hb_bidder+"%26hb_val="+(parseFloat(prebidWinner.video.hb_val)/100).toFixed(2)+"%26hb_uuid="+prebidWinner.video.hb_uuid),e.adsRequest.adTagUrl+=u,e.adsRequest.setAdWillAutoPlay(CurrentVideoConfig.settings.autoplay),e.adsRequest.setAdWillPlayMuted(CurrentVideoConfig.settings.automute)}else{if(e.customTag)e.adsRequest.adTagUrl=e.substituteMacros(BoltAdManager.thirdPartyTag||BoltAdManager.src,r,d);else{var c="http://googleads.g.doubleclick.net/pagead/ads?&max_ad_duration="+r.maxAdDuration+"&ad_type="+r.adType+"&description_url="+l+"&overlay="+r.overlay+"&client="+BoltAdManager.googlePublisherId+"&videoad_start_delay=0";d&&(c+="&tfcd=1"),LOG.info("[Bolt3 Google] Tag "+c),e.adsRequest.adTagUrl=c}/mpt=playwire/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpt=playwire"),/mpv=3\.2/.test(e.adsRequest.adTagUrl)||(e.adsRequest.adTagUrl+="&mpv=3.2")}window.postLogMessage("[Google] Loading Tag: "+e.adsRequest.adTagUrl),LOG.info("[Bolt3 Google] Loading Tag "+e.adsRequest.adTagUrl),e.adsRequest.linearAdSlotWidth=e.container.clientWidth,e.adsRequest.linearAdSlotHeight=e.container.clientHeight,e.adsRequest.nonLinearAdSlotWidth=e.container.clientWidth,e.adsRequest.nonLinearAdSlotHeight=e.container.clientHeight;try{e.adsLoader.requestAds(e.adsRequest)}catch(t){e.onAdError()}}else var h=setInterval(function(){e.adsLoader&&(clearInterval(h),e.requestAd())},100)},a.prototype.onAdsManagerLoaded=function(e){LOG.debug("[Bolt3 Google] onAdsManagerLoaded");var r=this,i=new google.ima.AdsRenderingSettings;i.enablePreloading=!0,i.loadVideoTimeout=3e4,i.autoAlign=!1,i.useStyledNonLinearAds=!1,i.restoreCustomPlaybackStateOnAdBreakComplete=!0,o.isMobile?r.sdkAdsManager=e.getAdsManager(r.video,i):r.sdkAdsManager=e.getAdsManager(r.container,i),BoltAdManager.GoogleSdk={},BoltAdManager.GoogleSdk.stickyResize=r.stickyResize.bind(r),r.sdkAdsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,r.onAdError),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,r.onContentPauseRequested),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,r.onContentResumeRequested),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.LOADED,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.STARTED,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.CLICK,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,r.onAdEvent),r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,r.onAdEvent),
r.sdkAdsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,r.onAdEvent);try{var n=r.container.clientWidth,a=r.container.clientHeight;LOG.debug("[Bolt3 Google] init ads manager size",n,a),r.sdkAdsManager.init(n,a,google.ima.ViewMode.FULLSCREEN),BoltAdManager.dispatchQueueEvent(function(){r.sdkAdsManager.start(),LOG.debug("[Bolt3 Google] Starting google ads manager"),BoltAdManager._dispatchEvent(t.Ad.Event.READY)}),r.initialWidth=n,r.initialHeight=a,window.addEventListener("resize",function(){LOG.info("[Bolt:GoogleAdsPlayer on window resize]"),r.resize()})}catch(e){LOG.debug("[Bolt3 Google] Google ads manager did not start"),window.postLogMessage("[Google] Google ads manager did not start","error"),r.onAdError()}},a.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e,LOG.info("[Bolt:GoogleAdsPlayer setFullscreen] ",e))},a.prototype.getDuration=function(){return this._isLinear?this.ad.getDuration():this._nonLinearPseudoDuration},a.prototype.getCurrentTime=function(){var e=this;return e.sdkAdsManager?e._isLinear?e.getDuration()-e.sdkAdsManager.getRemainingTime():e.currentTime:0},a.prototype.getVolume=function(){var e=this;return void 0!==e.sdkAdsManager?e.sdkAdsManager.getVolume():null},a.prototype.setVolume=function(e){var r=this;o.isMobile||void 0===r.sdkAdsManager||(LOG.debug("[Bolt3 Google] IMA setvolume",e),r.sdkAdsManager.setVolume(e),this.volume=e,r._dispatchEvent(t.Media.Event.VOLUME_CHANGED))},a.prototype.mute=function(e){!o.isMobile&&this.sdkAdsManager?(this.muted=!!e,LOG.info("Google mute",this.muted),e?(this.sdkAdsManager.setVolume(0),this._dispatchEvent(t.Media.Event.MUTED)):(this.sdkAdsManager.setVolume(this.volume),this._dispatchEvent(t.Media.Event.UNMUTED))):(parseInt(o.system.ios)>=10||o.system.android)&&(this.muted=!!e,LOG.info("Google mute",this.muted),this.video.muted=this.muted,e?(this.sdkAdsManager.setVolume(0),this._dispatchEvent(t.Media.Event.MUTED)):(this.sdkAdsManager.setVolume(1),this._dispatchEvent(t.Media.Event.UNMUTED)))},a.prototype.pause=function(){var e=this;void 0!==e.sdkAdsManager&&e.sdkAdsManager.pause()},a.prototype.resume=function(){var e=this;void 0!==e.sdkAdsManager&&(e.sdkAdsManager.resume(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING))},a.prototype.stickyResize=function(e,t){var r=this;try{r.sdkAdsManager&&r.sdkAdsManager.resize(e,t,google.ima.ViewMode.NORMAL)}catch(e){LOG.error("[GoogleAdsPlayer::stickyResize error]",e)}},a.prototype.resize=function(e,t){var r=this,i=e||r.container.clientWidth,n=t||r.container.clientHeight;if(r.adContainerInnerDiv=r.container.querySelector("div"),r.adContainerInnerIFrame=r.container.querySelector("iframe"),r.adContainerInnerDiv&&r.adContainerInnerIFrame){LOG.info("[GoogleAdsPlayer::resize]",i,n);var o="px";"string"==typeof e&&(o=e.indexOf("px")>0?"px":e.indexOf("%")>0?"%":"px");var a="px";if("string"==typeof t&&(a=t.toString().indexOf("px")>0?"px":t.indexOf("%")>0?"%":"px"),r._isLinear)r.adContainerInnerDiv.style.width=parseFloat(i)+o,r.adContainerInnerDiv.style.height=parseFloat(n)+a;else{if(!r.ad)return;r.ad.getWidth()&&(r.adContainerInnerDiv.style.width=r.ad.getWidth()+"px",r.adContainerInnerDiv.style.left=(r.container.clientWidth-r.ad.getWidth())/2+"px"),r.ad.getHeight()&&(r.adContainerInnerDiv.style.height=r.ad.getHeight()+10+"px",r.adContainerInnerDiv.style.top=(r.container.clientHeight-(r.ad.getHeight()+10))/2+"px"),r.adContainerInnerIFrame.style.width="100%",r.adContainerInnerIFrame.style.height="100%"}}},a.prototype.remove=function(){var e=this;if(LOG.debug("[Bolt3 Google] Ad removed"),window.removeEventListener("resize",e.resize),clearInterval(e._intervalId),clearInterval(e._sizeTrackerInterval),clearInterval(e._checkControlbarHeightIntervalId),o.isMobile){try{e.adsLoader.destroy(),e.adDisplayContainer.destroy()}catch(e){}o.system.iphone?e.iphoneExit():o.system.ipad&&i.IPadNativeFullscreen&&e.video.webkitExitFullscreen()}else try{e.adsLoader.destroy(),e.adDisplayContainer.destroy()}catch(e){}e._resetNonLinearCountdown(),e.hasStarted=!1,e.container.style.visibility="hidden",BoltAdManager._dispatchEvent("removed")},a.prototype.iphoneExit=function(){var e=this;e._isLinear&&(e.video.pause(),e.video.webkitExitFullscreen())},a.prototype.onAdError=function(e){var r,i=this;if(e){var n=e.getError();r=n.getMessage(),LOG.error("[Bolt3 Google] AdError",n.getMessage(),n.getVastErrorCode())}i._dispatchEvent(t.ERROR,r)},a.prototype.onContentPauseRequested=function(){LOG.debug("GoogleAds::contentPauseRequested")},a.prototype.onContentResumeRequested=function(){LOG.debug("GoogleAds::contentResumeRequested")},a.prototype.onAdEvent=function(r){var i=this;switch(i.ad=r.getAd(),LOG.debug("[Bolt3 Google] Google ad event",r.type),i._isLinear=i.ad.isLinear(),r.type){case google.ima.AdEvent.Type.LOADED:if(o.isMobile&&(i.adContainerInnerDiv.style.zIndex="1"),BoltAdManager.adtechGoogleAdCount){var n=BoltAdManager.adtechGoogleAdCount;e.xhr(n,"get",null,function(){LOG.info("ADTECH adcount for Google HTML5 Ad has been fired",n),window.postLogMessage("[Google] ADTECH adcount for Google HTML5 ad has been fired "+n,"success")},function(){LOG.error("[Bolt3 Google] Failed to fire ADTECH adcount for Google HTML5 Ad ",n),window.postLogMessage("[Google] Failed to fire ADTECH adcount for Google HTML5 Ad "+n,"error")})}LOG.info("[Bolt3 Google] Got a skippable google ad?",i.ad.isSkippable()),i.customTag?window.postLogMessage("[Google] Got an ad from "+BoltAdManager.provider):window.postLogMessage("[Google] Got an ad from Google"),i.ad.isSkippable()&&(window.GoogleTrueViewPlayCount++,LOG.info("[Bolt3 Google] TrueView Ad played has now been played ",window.GoogleTrueViewPlayCount," times"),window.postLogMessage("[Google] TrueView Ad played is now playing "+window.GoogleTrueViewPlayCount," times")),i.duration=i.getDuration(),i.currentTime=0,i.startTime=0,i.metadata={duration:i.duration},BoltAdManager._dispatchEvent(t.Media.Event.LOADED),i._dispatchEvent(t.Media.Event.PLAY),i._dispatchEvent(t.Media.Event.DURATION_CHANGE),i._dispatchEvent(t.Media.Event.START_TIME_CHANGED),i.container.style.visibility="visible",i._isLinear?o.isMobile&&(BoltAdManager.videoElement.style.display="block",BoltAdManager.videoElement.style.visibility="visible"):(i._resetNonLinearCountdown(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING),i._nonLinearCountdown=setInterval(function(){i._nonLinearPseudoTime+=1,i.currentTime=i._nonLinearPseudoTime,i._dispatchEvent(t.Media.Event.TIME_UPDATE,i.currentTime),i._nonLinearPseudoTime>i._nonLinearPseudoDuration&&i.complete()},1e3));break;case google.ima.AdEvent.Type.STARTED:i.adContainerInnerDiv=i.container.querySelector("div"),i.adContainerInnerIFrame=i.container.querySelector("iframe"),i._isLinear&&(i._intervalId=setInterval(i._checkTime,100)),i._dispatchEvent(t.Media.Event.PLAYING);break;case google.ima.AdEvent.Type.COMPLETE:break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:i.complete();break;case google.ima.AdEvent.Type.SKIPPED:BoltAdManager._dispatchEvent(t.Ad.Event.SKIPPED),LOG.debug("[Bolt3 Google] Ad skipped"),window.postLogMessage("[Google] Google HTML5 Ad skipped"),i.end();break;case google.ima.AdEvent.Type.USER_CLOSE:BoltAdManager._dispatchEvent(t.Ad.Event.CLOSED),LOG.debug("[Bolt3 Google] Ad closed"),window.postLogMessage("[Google] Google HTML5 Ad closed"),i.end();break;case google.ima.AdEvent.Type.FIRST_QUARTILE:i._dispatchEvent(t.Media.Event.FIRSTQUARTILE);break;case google.ima.AdEvent.Type.MIDPOINT:i._dispatchEvent(t.Media.Event.MIDPOINT);break;case google.ima.AdEvent.Type.THIRD_QUARTILE:i._dispatchEvent(t.Media.Event.THIRDQUARTILE);break;case google.ima.AdEvent.Type.CLICK:BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED);break;case google.ima.AdEvent.Type.PAUSED:i.paused=!0,BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),i._dispatchEvent(t.Media.Event.PAUSED);break;case google.ima.AdEvent.Type.RESUMED:i.paused=!1,i._dispatchEvent(t.Media.Event.RESUME)}},a.prototype.complete=function(){LOG.info("Google Ad Complete");var e=this;setTimeout(function(){BoltAdManager._dispatchEvent(t.Ad.Event.COMPLETED),e.end()},500)},a.prototype.end=function(){var e=this;e._intervalId&&clearInterval(e._intervalId),BoltAdManager._dispatchEvent(t.Media.Event.ENDED),e.sdkAdsManager.destroy(),e.sdkAdsManager=null},a.prototype._resetNonLinearCountdown=function(){this._nonLinearCountdown&&(clearInterval(this._nonLinearCountdown),this._nonLinearCountdown=null,this._nonLinearPseudoTime=0)},a.prototype._removeInnerDiv=function(){var e=this;e.container&&(e.adContainerInnerDiv=e.container.querySelector("div"),e.adContainerInnerDiv&&e.adContainerInnerDiv.parentNode.removeChild(e.adContainerInnerDiv)),e.adContainerInnerDiv=null},a.prototype._checkTime=function(){if(this.ad){var e=this.getCurrentTime();e>this.currentTime&&(this.currentTime=e,this._dispatchEvent(t.Media.Event.TIME_UPDATE,this.currentTime))}},a.prototype.getSource=function(){return this.adsRequest?this.adsRequest.adTagUrl:null},a.prototype.isLinear=function(){return!0},a}),define("vastAdsPlayer",["zeus_utils","zeus_constants","hammer","base_ad_player"],function(e,t,r,i){var n=window.client,o=window.PlayerView,a=i.subclass({constructor:function(){i.prototype.constructor.call(this),this.paused=!1,void 0!==document.visibilityState&&(this._handleVisibilityChange=this._handleVisibilityChange.bind(this))}});return a.prototype._handleVisibilityChange=function(){var e=this;e.adPlayer&&(LOG.info("[LinearJSVPAID handleVisibilityChange] ",document.visibilityState),"hidden"===document.visibilityState?e.paused||e.adPlayer.pause():e.paused&&e.adPlayer.resume())},a.prototype.playAd=function(){function r(){i.adPlayer.hasBeenTouched=!0,i.adPlayer.isAd(!0),i.adPlayer.setSource(BoltAdManager.bestMedia.src),BoltAdManager.videoElement.style.visibility="visible",i.adPlayer.show(!0),i.initializeVastAd(),i.setClickthrough()}var i=this,o=e.getProxiedURL(BoltAdManager.bestMedia.src),a=t.Ad.PLAYER_ID_PREFIX+i.containerId;if(n.isMobile)n.system.android&&n.engine.webkit&&!n.browser.chrome&&!n.browser.opera?require(["zeus_android_webkit_video"],function(e){i.adPlayer=new e(i.containerId,a),r()}):n.system.ios?require(["ios_video"],function(e){i.adPlayer=new e(i.containerId,a),r()}):require(["zeus_mobile_video"],function(e){i.adPlayer=new e(i.containerId,a),r()});else{BoltAdManager.videoElement=document.createElement("video"),BoltAdManager.videoElement.setAttribute("id",a),i.containerWidth=i.container.clientWidth,i.containerHeight=i.container.clientHeight,BoltAdManager.videoElement.setAttribute("width","100%"),BoltAdManager.videoElement.setAttribute("height","100%"),BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;");var s=BoltAdManager.bestMedia.type===t.Mime.MP4&&n.browser.firefoxWithoutMp4||BoltAdManager.bestMedia.type===t.Mime.FLV||BoltAdManager.bestMedia.type===t.Mime.SWF;s&&(n.hasFlash?window.postLogMessage("Using Flash to play the ad"):window.postLogMessage("Flash is required to play the ad media","warn")),i.container.style.background="black",s?n.hasFlash?BoltAdManager.type===t.Ad.Type.FLASH_VPAID?(LOG.debug("[bolt3] Ad contains Flash VPAID. Setting VPAID up."),window.postLogMessage("Ad contains Flash VPAID. Setting VPAID up."),require(["zeus_vpaidshim"],function(e){window[a]&&delete window[a];var r=window[a]=new e(i.containerId,"window['"+a+"']");r.setAdData(BoltAdManager.ad),i.adPlayer=r,i.adPlayer.addEventListener(t.Ad.Event.CLICKED,function(){BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED)}),r.setSource(o),i.initializeVastAd(),i.initClickTrackers(),i.container.style.background="none"})):require(["zeus_flashshim"],function(e){window[a]&&delete window[a],i.container.appendChild(BoltAdManager.videoElement);var r=window[a]=new e(i.containerId,a,"window['"+a+"']");r.addOnceEventListener(t.Media.Event.NOT_FOUND,function(){BoltAdManager._dispatchEvent(t.Ad.Event.FAILED)}),r.isAd(!0),r.setSource(o),i.adPlayer=r,i.initializeVastAd(),i.setClickthrough()}):(window.postLogMessage("Flash is required to play the ad but it's not detected in your browser","error"),BoltAdManager._dispatchEvent(t.Ad.Event.FAILED)):require(["zeus_video"],function(e){i.container.appendChild(BoltAdManager.videoElement),i.adPlayer=new e(i.containerId,a),i.adPlayer.isAd(!0),i.adPlayer.setSource(o),i.initializeVastAd(),i.setClickthrough()})}},a.prototype.initializeVastAd=function(){var e=this;n.isMobile||e.adPlayer.addEventListener(t.Media.Event.LOADED,function(e){LOG.debug("[bolt3] Ad media loaded"),window.postLogMessage("Ad media loaded"),BoltAdManager._dispatchEvent(t.Media.Event.LOADED),BoltAdManager.ad.linear.trackImpressions()}),e.adPlayer.addEventListener(t.Media.Event.DURATION_CHANGE,function(r){e.duration=e.adPlayer.duration,BoltAdManager._dispatchEvent(t.Media.Event.DURATION_CHANGE)},!1),e.adPlayer.addEventListener(t.Media.Event.ENDED,function(r){BoltAdManager.ad.linear.track("complete"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVideoComplete",e.getVolume()),BoltAdManager._dispatchEvent(t.Media.Event.ENDED)},!1),e.adPlayer.addEventListener(t.Media.Event.PAUSED,function(r){BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),BoltAdManager.ad.linear.track("pause"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdPaused",e.getVolume()),e.paused=!0},!1),e.adPlayer.addEventListener(t.Media.Event.PLAYING,function(r){LOG.debug("[bolt3] tracking playing event"),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING),BoltAdManager.ad.linear.track("start"),BoltAdManager.ad.linear.track("creativeView"),BoltAdManager.MoatAnalytics&&(BoltAdManager.MoatAnalytics.track("AdVideoStart",e.getVolume()),BoltAdManager.MoatAnalytics.track("AdPlaying",e.getVolume())),e.paused=!1,void 0!==document.visibilityState&&(window.document.addEventListener("visibilitychange",e._handleVisibilityChange),"hidden"===window.document.visibilityState&&e.adPlayer.pauseAd())},!1),e.adPlayer.addEventListener(t.Player.Event.CANPLAY,function(e){BoltAdManager._dispatchEvent(t.Player.Event.CANPLAY)},!1),e.adPlayer.addEventListener(t.Media.Event.METADATA,function(r){e.duration=e.adPlayer.duration,BoltAdManager._dispatchEvent(t.Media.Event.METADATA)},!1),e.adPlayer.addEventListener(t.Media.Event.MUTED,function(e){BoltAdManager.ad.linear.track("mute"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVolumeChange",0),BoltAdManager._dispatchEvent(t.Media.Event.MUTED)}),e.adPlayer.addEventListener(t.Media.Event.UNMUTED,function(r){BoltAdManager.ad.linear.track("unmute"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVolumeChange",e.getVolume()),BoltAdManager._dispatchEvent(t.Media.Event.UNMUTED)}),e.adPlayer.addEventListener(t.ERROR,function(t){e._dispatchEvent(t)}),BoltAdManager.dispatchQueueEvent(function(){n.isMobile?(e.adPlayer.enable(!0),e.adPlayer.preload(),BoltAdManager._dispatchEvent(t.Media.Event.LOADED),BoltAdManager.ad.linear.trackImpressions()):("native"===e.adPlayer.type?e.adPlayer.preload():"flash"===e.adPlayer.type||e.adPlayer.type===t.Ad.Type.FLASH_VPAID&&(LOG.info("[BoltAdManager] Trying to play Flash ad"),e.adPlayer.play()),e.currentVolume=BoltAdManager.videoElement.volume),e.watchQuartiles(BoltAdManager,e.adPlayer)})},a.prototype.watchQuartiles=function(){var e=this,r=!1,i=!1,n=!1;if(BoltAdManager.type===t.Ad.Type.FLASH_VPAID)e.adPlayer.addEventListener(t.Media.Event.FIRSTQUARTILE,function(){BoltAdManager._dispatchEvent(t.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile"),r=!0}),e.adPlayer.addEventListener(t.Media.Event.MIDPOINT,function(){BoltAdManager._dispatchEvent(t.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint"),i=!0}),e.adPlayer.addEventListener(t.Media.Event.THIRDQUARTILE,function(){BoltAdManager._dispatchEvent(t.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile"),n=!0});else{var o=setInterval(function(){e.currentTime=e.adPlayer.currentTime,e.percentPlayed=100*e.currentTime/e.duration,e.percentPlayed>=25&&(r||(BoltAdManager._dispatchEvent(t.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVideoFirstQuartile",e.getVolume()),r=!0)),e.percentPlayed>=50&&(i||(BoltAdManager._dispatchEvent(t.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVideoMidpoint",e.getVolume()),i=!0)),e.percentPlayed>=75&&(n||(BoltAdManager._dispatchEvent(t.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile"),BoltAdManager.MoatAnalytics&&BoltAdManager.MoatAnalytics.track("AdVideoThirdQuartile",e.getVolume()),n=!0))},100);e.adPlayer.addEventListener(t.Media.Event.ENDED,function(e){clearInterval(o)})}},a.prototype.initClickTrackers=function(){var e=BoltAdManager.ad.linear,r=[];try{r=e.tracking.events.click}catch(e){}Array.isArray(r)&&BoltAdManager.addEventListener(t.Ad.Event.CLICKED,function(){BoltAdManager.ad.linear.track("click")})},a.prototype.setClickthrough=function(){function i(e){n.isMobile&&o.pause(),BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED,s),LOG.debug("[bolt3] opening "+s),window.postLogMessage("Opening "+s),window.open(s,"_bolt_advertiser").focus(),n.isMobile&&(o.clickElement.style.display="none",l.off("tap",i),o.adPlayer.addOnceEventListener(t.Media.Event.PLAYING,function(){setTimeout(function(){o.clickElement.style.display="block",l.on("tap",i)},500)}))}var o=this,a=BoltAdManager.ad.linear;if(void 0!==a&&null!==a.clickThrough){o.initClickTrackers();var s=e.substituteMacros(a.clickThrough);if(LOG.debug("[bolt3] set clickthrough to "+s),window.postLogMessage("Set clickthrough to "+s),o.clickElement=document.createElement("div"),o.clickElement.setAttribute("style","position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%;z-index:1"),o.clickElement.setAttribute("id","clickthrough_"+o.containerId),o.container.appendChild(o.clickElement),n.isMobile){var l=new r(o.clickElement);l.on("tap",i)}else o.clickElement.addEventListener("click",i,!1);o.clickElement.style.cursor="pointer"}},a.prototype.getDuration=function(){return this.duration},a.prototype.getVolume=function(){return this.adPlayer.muted?0:this.adPlayer.volume},a.prototype.getCurrentTime=function(){return this.currentTime},a.prototype.pause=function(){this.adPlayer.pause()},a.prototype.resume=function(){this.adPlayer.play()},a.prototype.setVolume=function(e){var t=this;"flash"===t.adPlayer.type||"flashvpaid"===t.adPlayer.type?this.adPlayer.setVolume(e):this.adPlayer.volume=e},a.prototype.end=function(){var e=this;void 0!==document.visibilityState&&window.document.removeEventListener("visibilitychange",e._handleVisibilityChange),e.adPlayer&&(LOG.debug("[bolt3] Vast ad ends"),n.isMobile?n.system.iphone||o.IPadNativeFullscreen?e.adPlayer.video.webkitExitFullScreen():e.adPlayer.show(!1):"flash"===e.adPlayer.type||BoltAdManager.type===t.Ad.Type.FLASH_VPAID?e.adPlayer.remove(!1):e.adPlayer.remove(!0)),void 0!==e.clickElement&&null!=e.clickElement.parentNode&&e.clickElement.parentNode.removeChild(e.clickElement),BoltAdManager._dispatchEvent(t.Player.Event.REMOVED)},a.prototype.remove=function(){this.end()},a.prototype.isLinear=function(){return!0},a}),define("linear_jsvpaid",["zeus_constants","zeus_utils","base_ad_player"],function(e,t,r){function i(e){LOG.info("JS playback");var t=this;t.loader=e,t.vpaid=e.vpaid,t._timer=null}function n(e){LOG.info("Native playback");var t=this;t.loader=e,t._onVideoMetadata=t._onVideoMetadata.bind(t),t._onVideoEnded=t._onVideoEnded.bind(t),t._onVideoTimeupdate=t._onVideoTimeupdate.bind(t),t._onVideoPaused=t._onVideoPaused.bind(t),t._onVideoPlaying=t._onVideoPlaying.bind(t),BoltAdManager.videoElement.addEventListener("loadeddata",t._onVideoMetadata),BoltAdManager.videoElement.addEventListener("ended",t._onVideoEnded),BoltAdManager.videoElement.addEventListener("pause",t._onVideoPaused),BoltAdManager.videoElement.addEventListener("playing",t._onVideoPlaying)}var o=window.client,a=window.PlayerView,s=t.dom;i.prototype={videoStarted:function(){},durationChanged:function(){var t=this;LOG.info("ad duration changed",t.vpaid.getAdRemainingTime(),t.vpaid.getAdDuration()),t.loader.duration<=0&&(t.loader.sourceChanged=!0,t.loader.duration=t.loader.vpaid.getAdDuration(),t.loader._dispatchEvent(e.Media.Event.DURATION_CHANGE,t.loader.duration),BoltAdManager._dispatchEvent(e.Media.Event.PLAYING),t._timer=setInterval(function(){t._updateTime()},50))},_updateTime:function(){var e=this;e.loader._setCurrentTime(e.getCurrentTime())},getCurrentTime:function(){return this.loader.duration>0?this.loader.duration-this.vpaid.getAdRemainingTime():0},setVolume:function(e){this.vpaid&&(this.vpaid.adVolume&&(this.vpaid.adVolume=e),this.vpaid.setAdVolume(e))},destroy:function(){clearInterval(this._timer)}},n.prototype={videoStarted:function(){var t=this;LOG.info("[Bolt:LinearJSVPAID] video started"),BoltAdManager.videoElement.style.visibility="visible",BoltAdManager.videoElement.style.display="block",t.loader.sourceChanged=!0,t.loader.duration=BoltAdManager.videoElement.duration,t.loader._dispatchEvent(e.Media.Event.DURATION_CHANGE,t.loader.duration),t.loader._dispatchEvent(e.Media.Event.PLAYING),BoltAdManager.videoElement.addEventListener("timeupdate",t._onVideoTimeupdate)},durationChanged:function(){},_onVideoMetadata:function(e){LOG.info("[bolt3] ad video metadata loaded");var t=this;BoltAdManager.videoElement.removeEventListener("loadedmetadata",t._onVideoMetadata),t.loader.metadata={duration:BoltAdManager.videoElement.duration}},_onVideoEnded:function(){},_onVideoPaused:function(){},_onVideoPlaying:function(){},_onVideoTimeupdate:function(){var e=this;e.loader._setCurrentTime(e.getCurrentTime())},getCurrentTime:function(){return BoltAdManager.videoElement.currentTime},setVolume:function(e){BoltAdManager.videoElement.volume=e},destroy:function(){var e=this;BoltAdManager.videoElement.removeEventListener("loadedmetadata",e._onVideoMetadata),BoltAdManager.videoElement.removeEventListener("ended",e._onVideoEnded),BoltAdManager.videoElement.removeEventListener("pause",e._onVideoPaused),BoltAdManager.videoElement.removeEventListener("playing",e._onVideoPlaying),BoltAdManager.videoElement.removeEventListener("timeupdate",e._onVideoTimeupdate),BoltAdManager.videoElement.src="",BoltAdManager.videoElement.load()}};var l=r.subclass({constructor:function(t,i){r.prototype.constructor.call(this,t);var n=this;n.video=BoltAdManager.videoElement,n.type=e.Ad.Type.JS_VPAID,n.creativeData=i,n.paused=!1,n.frame=null,n.vpaid=null,n.duration=n.currentTime=0,n.sourceChanged=!1,n.fullscreen=!1,n.volume=0,n.muted=!1,n.hasStarted=!1,n.timer=null,n._firstQuartile=n._midpoint=n._thirdQuartile=!1,n._error=!1,n._adHandler=null,n.provider=null,n._nativePlayback=!1,n._setNativePlayback=n._setNativePlayback.bind(n),void 0!==document.visibilityState&&(n._handleVisibilityChange=n._handleVisibilityChange.bind(n)),n._onAdLoaded=n._onAdLoaded.bind(n),n._onAdStarted=n._onAdStarted.bind(n),n._onAdStopped=n._onAdStopped.bind(n),n._onAdError=n._onAdError.bind(n),n._onAdLog=n._onAdLog.bind(n),n._onAdClick=n._onAdClick.bind(n),n._onAdVideoStart=n._onAdVideoStart.bind(n),n._onAdDurationChanged=n._onAdDurationChanged.bind(n),n._onAdPaused=n._onAdPaused.bind(n),n._onAdPlaying=n._onAdPlaying.bind(n),n._onAdFirstQuartile=n._onAdFirstQuartile.bind(n),n._onAdMidpoint=n._onAdMidpoint.bind(n),n._onAdThirdQuartile=n._onAdThirdQuartile.bind(n),n._onAdSkipped=n._onAdSkipped.bind(n)}});return l.prototype._setNativePlayback=function(){var e=this;e._nativePlayback=!0,BoltAdManager.videoElement.removeEventListener("loadstart",e._setNativePlayback)},l.prototype._handleVisibilityChange=function(){var e=this;LOG.info("[LinearJSVPAID handleVisibilityChange] ",document.visibilityState),"hidden"===document.visibilityState?e.paused||e.vpaid.pauseAd():e.paused&&e.vpaid.resumeAd()},l.prototype.playAd=function(){var t=this;LOG.info("[bolt3] "+t.provider+" JS VPAID"),window.postLogMessage("Loading "+t.provider+" JS VPAID");var r=BoltAdManager.container,i=e.Ad.PLAYER_ID_PREFIX+BoltAdManager.containerId;o.isMobile?(BoltAdManager.videoElement||LOG.error("Video element is undefined"),t._nativePlayback=!0):(BoltAdManager.videoElement=document.createElement("video"),BoltAdManager.videoElement.setAttribute("id",i),BoltAdManager.videoElement.setAttribute("width","100%"),BoltAdManager.videoElement.setAttribute("height","100%"),BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;"),t.containerWidth=t.container.clientWidth,t.containerHeight=t.container.clientHeight,r.appendChild(BoltAdManager.videoElement),BoltAdManager.videoElement.addEventListener("loadstart",t._setNativePlayback)),t._createVPAID()},l.prototype.stickyResize=function(e,t,r){var i=this,n=i.container.querySelector("iframe"),o=i.container.querySelector("video");e=e.toString(),t=t.toString(),i.container&&(i.container.style.width=e+"px",i.container.style.height=t+"px"),n&&(n.style.width=e+"px",n.style.height=t+"px",n.width=e,n.height=t),o&&(o.style.width=e+"px",o.style.height=t+"px",o.width=e,o.height=t)},l.prototype._createVPAID=function(){var e=this,r=e.container;e.frame=document.createElement("iframe"),e.frame.setAttribute("allow","autoplay; fullscreen"),e.frame.frameBorder=0,e.frame.allowfullscreen=!0,e.frame.style.display="none",e.frame.onload=function(){var r=e.frame.contentWindow.document.createElement("script");r.src=t.getProxiedURL(BoltAdManager.bestMedia.src),r.onload=function(){e.vpaid=e.frame.contentWindow.getVPAIDAd(),e.vpaid.handshakeVersion("2.0"),e.vpaid.subscribe(e._onAdLoaded,"AdLoaded"),e.vpaid.subscribe(e._onAdStarted,"AdStarted"),e.vpaid.subscribe(e._onAdStopped,"AdStopped"),e.vpaid.subscribe(e._onAdError,"AdError"),e.vpaid.subscribe(e._onAdLog,"AdLog"),e.vpaid.subscribe(e._onAdClick,"AdClickThru"),e.vpaid.subscribe(e._onAdVideoStart,"AdVideoStart"),e.vpaid.subscribe(e._onAdDurationChanged,"AdDurationChange"),e.vpaid.subscribe(e._onAdPaused,"AdPaused"),e.vpaid.subscribe(e._onAdPlaying,"AdPlaying"),e.vpaid.subscribe(e._onAdSkipped,"AdSkipped"),e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),LOG.info("creative data",e.creativeData),LOG.info("environment vars",e.environmentVars),e.vpaid.initAd(BoltAdManager.videoElement.offsetWidth,BoltAdManager.videoElement.offsetHeight,"normal",600,e.creativeData,e.environmentVars)},e.frame.contentWindow.document.body.appendChild(r)},r.appendChild(e.frame)},l.prototype._getEnvironmentVars=function(){return{slot:BoltAdManager.container,videoSlot:BoltAdManager.videoElement,videoSlotCanAutoPlay:!0}},l.prototype._getCreativeData=function(){return{AdParameters:this.creativeData}},l.prototype._autoplayPolicyChecked=!1,l.prototype._checkAutoplayPolicy=function(){var r=this,i=t.dom.getUI(e.UI.MAIN_VIDEO_CONTAINER),n=i.firstElementChild,o=window.CurrentVideoConfig.settings.automute,a=n.play();void 0!==a&&a.then(function(){r._autoplayPolicyChecked=!1}).catch(function(e){if(r._autoplayPolicyChecked)LOG.error("[Linear JSVPAID] - FAIL Error in _checkAutoplayPolicy video.play() promise: ",e);else{if(r.muted&&o)throw r._onAdError("[Linear JSVPAID] - Autoplay failed for some unknown reason."),new Error("[Linear JSVPAID] - Error in _checkAutoplayPolicy video.play() promise: ",e);r._autoplayPolicyChecked=!0,PlayerSettings.automute=!0,r.mute(!0),window.PlayerView._onMuted.call(window.PlayerView,{type:"media_muted"}),r._checkAutoplayPolicy(),LOG.info("[Linear JSVPAID] - Error in _checkAutoplayPolicy video.play() promise, muting and trying again: ",e),n.pause()}})},l.prototype._onAdLoaded=function(){LOG.info("[bolt3] "+this.provider+" JS VPAID::ad loaded",this.frame);var e=this;BoltAdManager.VpaidSdk={},BoltAdManager.VpaidSdk.stickyResize=e.stickyResize.bind(e),BoltAdManager.dispatchQueueEvent(function(){!1!==window.CurrentVideoConfig.settings.autoplay&&(BoltAdManager.videoElement.muted=!0),e.vpaid.startAd()})},l.prototype._onAdStarted=function(){var e=this;LOG.info("[bolt3] "+this.provider+" JS VPAID::ad started"),e.vpaid.unsubscribe(this._onAdStarted,"AdStarted"),s.showElement(e.container),!0===e._nativePlayback?(LOG.info("Using native video playback"),e._adHandler=new n(e)):!1===e._nativePlayback&&(LOG.info("Using JS playback"),e._adHandler=new i(e))},l.prototype._onAdVideoStart=function(){var t=this;LOG.info("[bolt3] "+t.provider+" JS VPAID::on ad video start"),t.vpaid.unsubscribe(t._onAdVideoStart,"AdVideoStart"),t.playing=!0,t.pause=!1,t._trackCreativeView(),BoltAdManager._dispatchEvent(e.Media.Event.LOADED),t._dispatchEvent(e.Media.Event.PLAY),t._adHandler.videoStarted(),void 0!==document.visibilityState&&(window.document.addEventListener("visibilitychange",t._handleVisibilityChange),"hidden"===window.document.visibilityState&&t.vpaid.pauseAd())},l.prototype._onAdDurationChanged=function(){this._adHandler&&this._adHandler.durationChanged()},l.prototype._onAdStopped=function(){LOG.info("[bolt3] "+this.provider+" JS VPAID::ad stopped");var t=this;t._error||(LOG.info(t.provider+" js vpaid ended"),t._dispatchEvent(e.Media.Event.ENDED),BoltAdManager.ad.linear.track("complete"),clearInterval(t.timer),setTimeout(function(){BoltAdManager._dispatchEvent(e.Media.Event.ENDED)},1e3))},l.prototype._onAdPaused=function(){this.paused=!0},l.prototype._onAdPlaying=function(){this.paused=!1},l.prototype._trackCreativeView=function(){var e=this;LOG.info(e.provider+" js vpaid trackCreativeView"),BoltAdManager.ad.linear.track("creativeView"),BoltAdManager.ad.linear.trackImpressions(),BoltAdManager.ad.linear.track("start"),e.hasStarted=!0},l.prototype._setCurrentTime=function(t){var r=this;r.currentTime=t,r._dispatchEvent(e.Media.Event.TIME_UPDATE,r.currentTime),r._checkQuartiles()},l.prototype._onAdError=function(r,i){t.log.error("[bolt3] "+this.provider+" JS VPAID::ad error ",i,r),"string"==typeof r?window.postLogMessage("Ad Error. "+this.provider+" JS VPAID says "+r,"error"):window.postLogMessage("Ad Error. "+this.provider+" JS VPAID failed to play","error"),this._error=!0,this.remove(),this._dispatchEvent(e.ERROR,r)},l.prototype._checkQuartiles=function(){var e=this;e._firstQuartile?e._midpoint?e._thirdQuartile||e.currentTime/e.duration>.75&&(e._thirdQuartile=!0,e._onAdThirdQuartile()):e.currentTime/e.duration>.5&&(e._midpoint=!0,e._onAdMidpoint()):e.currentTime/e.duration>.25&&(e._firstQuartile=!0,e._onAdFirstQuartile())},l.prototype._onAdFirstQuartile=function(){LOG.info(this.provider+" JS vpaid:: first quartile"),this._dispatchEvent(e.Media.Event.FIRSTQUARTILE),BoltAdManager._dispatchEvent(e.Media.Event.FIRSTQUARTILE),BoltAdManager.ad.linear.track("firstQuartile")},l.prototype._onAdMidpoint=function(){LOG.info(this.provider+" JS vpaid:: midpoint"),this._dispatchEvent(e.Media.Event.MIDPOINT),BoltAdManager._dispatchEvent(e.Media.Event.MIDPOINT),BoltAdManager.ad.linear.track("midpoint")},l.prototype._onAdThirdQuartile=function(){LOG.info(this.provider+" JS vpaid:: third quartile"),this._dispatchEvent(e.Media.Event.THIRDQUARTILE),BoltAdManager._dispatchEvent(e.Media.Event.THIRDQUARTILE),BoltAdManager.ad.linear.track("thirdQuartile")},l.prototype._onAdSkipped=function(){LOG.info("[Linear JSVPAID] - "+this.provider+" JS vpaid:: Ad Skipped event triggered"),BoltAdManager._dispatchEvent(e.Ad.Event.SKIPPED),this._onAdStopped()},l.prototype._onAdClick=function(){var e=this;LOG.info("[bolt3] "+e.provider+" clicked");var r=BoltAdManager.ad.linear,i=[];try{i=r.tracking.events.click}catch(e){}if(Array.isArray(i)&&i.length>0)for(var n=0;n<i.length;n++){var o=i[n].url;t.log.debug("[bolt3] tracking click",o),t.xhr(o,"get")}BoltAdManager._dispatchEvent("clicked")},l.prototype._onAdLog=function(e){window.postLogMessage("[JSVPAID AdLog Event] - "+e),LOG.info("[Linear JSVPAID] - JSVPaid AdLog Event.",e)},l.prototype.pause=function(){},l.prototype.resume=function(){this.vpaid&&this.vpaid.resumeAd()},l.prototype.getDuration=function(){return this.duration},l.prototype.getCurrentTime=function(){
return this.vpaid?this._adHandler.getCurrentTime():0},l.prototype.setVolume=function(t){if(!o.isMobile||o.system.android)try{this.volume=t,this._dispatchEvent(e.Media.Event.VOLUME_CHANGED,this.volume),this._adHandler.setVolume(t)}catch(e){}},l.prototype.getSource=function(){return BoltAdManager.videoElement.currentSrc||this.media},l.prototype._removeAssets=function(){var e=this,r=e.container.children;if(t.log.warn("Element to remove",r),r.length>1)for(var i=0;i<r.length;i++){var n=r[i];n!==BoltAdManager.videoElement&&e.container.removeChild(n)}},l.prototype._removeVideoElement=function(){var e=this;if(o.isMobile)(o.system.iphone||a.IPadNativeFullscreen)&&BoltAdManager.videoElement.webkitExitFullscreen(),e.show(!1),BoltAdManager.videoElement.src="",BoltAdManager.videoElement.load();else try{BoltAdManager.videoElement.parentNode.removeChild(BoltAdManager.videoElement)}catch(e){}},l.prototype._unsubscribe=function(){var e=this;if(e.vpaid){LOG.info("unsubs vpaid events");try{e.vpaid.unsubscribe(e._onAdLoaded,"AdLoaded")}catch(e){}try{e.vpaid.unsubscribe(e._onAdStarted,"AdStarted")}catch(e){}try{e.vpaid.unsubscribe(e._onAdStopped,"AdStopped")}catch(e){}try{e.vpaid.unsubscribe(e._onAdError,"AdError")}catch(e){}try{e.vpaid.unsubscribe(e._onAdLog,"AdLog")}catch(e){}try{e.vpaid.unsubscribe(e._onAdClick,"AdClickThrough")}catch(e){}try{e.vpaid.unsubscribe(e._onAdVideoStart,"AdVideoStart")}catch(e){}try{e.vpaid.unsubscribe(e._onAdDurationChanged,"AdDurationChange")}catch(e){}try{e.vpaid.unsubscribe(e._onAdPaused,"AdPaused")}catch(e){}}},l.prototype.remove=function(){LOG.info("Remove ad");var e=this;if(e._unsubscribe(),void 0!==document.visibilityState&&window.document.removeEventListener("visibilitychange",e._handleVisibilityChange),e._adHandler&&e._adHandler.destroy(),e.vpaid)try{e.vpaid.stopAd()}catch(e){}try{e.container.removeChild(e.frame)}catch(e){}e._removeAssets(),e._removeVideoElement()},l.prototype.mute=function(t){if(t!==this.muted)if(this.muted=t,parseInt(o.system.ios)>=10||o.system.android)this.video.muted=t,t?this._dispatchEvent(e.Media.Event.MUTED):this._dispatchEvent(e.Media.Event.UNMUTED);else if(!o.isMobile){var r=this.volume;t?(r=0,this._dispatchEvent(e.Media.Event.MUTED)):(BoltAdManager.videoElement&&(BoltAdManager.videoElement.muted=!1),this._dispatchEvent(e.Media.Event.UNMUTED)),this.vpaid.adVolume&&(this.vpaid.adVolume=r),this.vpaid.setAdVolume(r)}},l.prototype.setFullscreen=function(t){t!==this.fullscreen&&(this.fullscreen=t,t?this._dispatchEvent(e.Player.Event.ENTER_FULLSCREEN):this._dispatchEvent(e.Player.Event.EXIT_FULLSCREEN))},l.prototype.stop=function(){},l.prototype.show=function(e){var r=BoltAdManager.videoElement;!0===e&&"block"!==r.style.display?(t.log.debug(this.containerId,"show video"),r.style.display="block"):!1===e&&"none"!==r.style.display&&(t.log.debug(this.containerId,"hide video"),r.style.display="none")},l.prototype.isLinear=function(){return!0},l}),define("zeus_liverail_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){return e.subclass({constructor:function(r){e.prototype.constructor.call(this,r),this.provider=t.Ad.Provider.LIVERAIL}})}),define("yume_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){return e.subclass({constructor:function(r){e.prototype.constructor.call(this,r),this.provider=t.Ad.Provider.YUME}})}),define("threeTwoFiftyAdsPlayer",["zeus_constants","zeus_utils","base_ad_player"],function(e,t,r){var e=window.ZeusConstants,i=r.subclass({constructor:function(t,i){r.prototype.constructor.call(this),this.type=e.Ad.Type.THREE_TWO_FIFTY,this._isLinear=void 0===t||t,this._checkControlbarHeightIntervalId=null,this._sizeTrackerInterval=null,this.currentTime=0,this.duration=10,this.adTimer=null,i&&(this.container=i)}});return i.prototype.playAd=function(){var r=this;BoltAdManager.dispatchQueueEvent(function(){r.iframeElement=document.createElement("iframe");var i=t.normalizeProtocol(BoltAdManager.bestMedia.src);r.iframeId="bolt_iframe_"+Math.floor(1e9*Math.random()+1),r.iframeDivId="div_"+r.iframeId;var n='<!DOCTYPE html><html><head></head><body><div id="'+r.iframeDivId+'" style="width: 300px; height: 250px; overflow: hidden; left: 50%; margin-left: -150px; position: absolute; top: 50%; margin-top: -125px;border: 0px"><script language="javascript1.1" id= "script_'+r.iframeId+'" src="'+i+(new Date).getTime()+' "><\/script></div></body></html>';r.iframeElement.name=r.iframeId,r._isLinear?r.iframeElement.setAttribute("style","width: 300px !important;height: 250px !important; overflow: hidden; position: absolute; left: 50% !important; top: 50% !important; margin-left: -150px !important; margin-top: -140px !important; z-index: 99 !important;"):r.iframeElement.setAttribute("style","width: 100% !important;height: 100% !important; overflow: hidden; position: absolute;top:0;left:0"),r.iframeElement.onerror=r.iframeError,r.iframeElement.scrolling="no",r.container.appendChild(r.iframeElement),LOG.debug("[bolt3] ::300x250:: Ad is in the DOM"),r.iframeElement.src="javascript:'"+n+"'",r.newAdFrame=window.frames[r.iframeId],LOG.debug("[bolt3] IFRAME LOADED"),BoltAdManager._dispatchEvent(e.Media.Event.LOADED),r._dispatchEvent(e.Media.Event.PLAY),BoltAdManager._dispatchEvent(e.Media.Event.PLAYING),r._dispatchEvent(e.Media.Event.PLAYING),r._sizeTrackerInterval=setInterval(function(){},100)})},i.prototype.iframeError=function(e){alert(e)},i.prototype.play=function(){function t(){BoltAdManager._dispatchEvent(e.Ad.Event.CLICKED,clickthrough),window.open(clickthrough,"_bolt_advertiser").focus()}var r=this;LOG.debug("[bolt3] ThreeTwoFiftyAdsPlayer play function"),window.postLogMessage("Starting 350 ad. Duration 10 seconds"),r.adTimer=setInterval(function(){if(r.currentTime>=10){if(clearInterval(r.adTimer),LOG.debug("[bolt3] ThreeTwoFiftyAds::ended ",r.currentTime),r.iframeElement){try{r.iframeElement.parentNode.removeChild(r.iframeElement)}catch(e){}r.iframeElement.removeEventListener("mousedown",t,!1)}r._dispatchEvent(e.Media.Event.ENDED),BoltAdManager._dispatchEvent(e.Media.Event.ENDED)}else r.currentTime+=.01,r._dispatchEvent(e.Media.Event.TIME_UPDATE,r.currentTime),BoltAdManager._dispatchEvent(e.Media.Event.TIME_UPDATE,r.currentTime)},10),r.iframeElement&&(r.iframeElement.addEventListener("mousedown",t,!1),r.iframeElement.style.cursor="pointer")},i.prototype.handleClicks=function(){BoltAdManager._dispatchEvent("clicked"),window.open(BoltAdManager.staticImage.clickthrough,"_bolt_advertiser").focus()},i.prototype.getDuration=function(){return 10},i.prototype.remove=function(){var t=this;t.container.style.display="none",BoltAdManager._dispatchEvent(e.Player.Event.REMOVED),clearTimeout(t.timeout),clearInterval(t.timer),clearInterval(t._sizeTrackerInterval),t.removeAllListeners()},i.prototype.enterFullscreen=function(){this.setFullscreen(!0)},i.prototype.exitFullscreen=function(){this.setFullscreen(!1)},i.prototype.resize=function(e,t){LOG.debug("[bolt3] 350 AD RESIZE",e,t);var r=this;r.container.style.width=e,r.container.style.height=t,r.containerWidth=r.container.offsetWidth,r.containerHeight=r.container.offsetHeight},i.prototype.setFullscreen=function(e){var t=this;e?t._isLinear&&setTimeout(function(){t.container.style.width="100%",t.container.style.height="100%"},100):t._isLinear&&setTimeout(function(){t.container.style.width=t.containerWidth,t.container.style.height=t.containerHeight},100),t.fullscreen=e},i.prototype.getVolume=function(){return null},i.prototype.setVolume=function(){return null},i.prototype.getCurrentTime=function(){return this.currentTime/1e3},i.prototype.pause=function(){},i.prototype.resume=function(){},i.prototype.mute=function(){},i.prototype.centerAd=function(){var e=this;e.imgElement.setAttribute("style","margin-left:"+(e.container.offsetWidth-BoltAdManager.staticImage.width)/2+"px;margin-top:"+(e.container.offsetHeight-BoltAdManager.staticImage.height)/2+"px",!1)},i.prototype.getSource=function(){return this.iframeElement.src},i}),define("aol_jsvpaid",["linear_jsvpaid","zeus_utils","zeus_constants"],function(e,t,r){var i=window.ZeusUtils.log,n=window.BoltAdManager;return e.subclass({constructor:function(t){e.prototype.constructor.call(this,t),this.provider=r.Ad.Provider.AOL},_onAdStarted:function(){var t=this;e.prototype._onAdStarted.call(this),t._trackCreativeView(),n._dispatchEvent(r.Media.Event.LOADED),t._dispatchEvent(r.Media.Event.PLAY)},_onAdVideoStart:function(){i.info(this.provider+" Ad Video Started")}})}),define("celtra_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){return e.subclass({constructor:function(r){e.prototype.constructor.call(this,r),this.provider=t.Ad.Provider.CELTRA}})}),define("spotx_jsvpaid",["linear_jsvpaid","zeus_constants","zeus_utils"],function(e,t,r){return e.subclass({constructor:function(r,i){e.prototype.constructor.call(this,r,i),this.provider=t.Ad.Provider.SPOTX},_onAdVideoStart:function(){this._onAdStarted(),e.prototype._onAdVideoStart.call(this)},_onAdLog:function(e){var t;try{t=JSON.parse(e)}catch(t){LOG.error("[SpotX JSVPAID] - JSVPaid AdLog, Failed to parse AdLog message.",e,t)}t&&(window.postLogMessage(this._createBoltLoggerMsg(t)),LOG.info("[SpotX JSVPAID] - JSVPaid AdLog Event.",t),BoltAdManager.triedCampaigns.push(BoltAdManager.getSpotxCampaignIdRemoveExtra(t.ad_id)),"AdError"===t.event_type&&(t.name="SpotX AdLog (AdError) Object",window.kinesis.send("bolt_errors",{playerId:window.id,message:t},"boltErrors")))},_onAdError:function(t){LOG.error("[SpotX JSVPAID] - AdError ",t),window.postLogMessage("[SpotX JSVPAID] - AdError - "+t.message,"error"),e.prototype._onAdError.call(this,t)},_onAdPaused:function(){LOG.info("[SpotX JSVPAID] - ad paused"),this.paused=!0,this._dispatchEvent(t.Media.Event.PAUSED)},_createBoltLoggerMsg:function(e){var t='<span style="color:#ffa500">[Spotx JSVPAID AdLog Event] - AdLog:</span> <br><b style="color:#eee">Title:</b> '+(e.title||"")+'<br><b style="color:#ddd">Ad Id:</b> '+(e.ad_id||"")+'<br><b style="color:#ccc">Event Type:</b> '+(e.event_type||"")+'<br><b style="color:#bbb">Message:</b> '+(e.message||"")+'<br><b style="color:#aaa">Code:</b> '+(e.code.toString()||"")+" - "+this._getAdLogCode(e.code);if(e.debug&&e.debug.length){var r,i=0,n=e.debug.length;for(t+="<br><b><u>Debug:</u></b> ";i<n;i++)for(r in e.debug[i])t+="<br><b><em>"+r+"</em></b>: "+e.debug[i][r]}return t},_getAdLogCode:function(e){switch(window.parseInt(e,10)){case 101:return"Ad Fault\tAn error has occurred with this ad.";case 102:return"VPAID Error\tA VPAID error has occurred.";case 103:return"Endpoint Opt Out\tVAST document provided by the ad returned an empty response, and therefore opted out of the opportunity.";case 104:return"Endpoint Timeout\tThe request for the VAST document took longer than the configured timeout value.";case 105:return"Endpoint Error\tThe request to the endpoint failed due to an error.";case 107:return"Total Fetch Timeout\tAd was not fetched before the configured total fetch timeout.";case 108:return"Total Process Timeout\tNo ad was able to start before the configured total process timeout.";case 109:return"Unplayable Media\tIn a no-Flash environment, but only Flash creatives available.";case 110:return"Ad Throttled\tFlash ad attempted to play, but was throttled by browser.";case 111:return"Ad Loaded!";default:return"No code available"}}})}),define("adap_jsvpaid",["linear_jsvpaid","zeus_utils","zeus_constants"],function(e,t,r){return e.subclass({constructor:function(t,i){e.prototype.constructor.call(this,t,i),this.provider=r.Ad.Provider.ADAP},_createVPAID:function(){var e=this,t=e.container;e.frame=document.createElement("iframe"),e.frame.frameBorder=0,e.frame.allowfullscreen=!0,e.frame.style.display="none",e.frame.onload=function(){var t=e.frame.contentWindow.document.createElement("script");t.src=BoltAdManager.bestMedia.src,t.onload=function(){e.vpaid=e.frame.contentWindow.getVPAIDAd(),e.vpaid.handshakeVersion("2.0"),e.vpaid.subscribe(e._onAdLoaded,"AdLoaded"),e.vpaid.subscribe(e._onAdStarted,"AdStarted"),e.vpaid.subscribe(e._onAdStopped,"AdStopped"),e.vpaid.subscribe(e._onAdError,"AdError"),e.vpaid.subscribe(e._onAdLog,"AdLog"),e.vpaid.subscribe(e._onAdClick,"AdClickThru"),e.vpaid.subscribe(e._onAdVideoStart,"AdVideoStart"),e.vpaid.subscribe(e._onAdDurationChanged,"AdDurationChange"),e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),LOG.info("creative data",e.creativeData),LOG.info("environment vars",e.environmentVars),e.vpaid.initAd(BoltAdManager.videoElement.offsetWidth,BoltAdManager.videoElement.offsetHeight,"normal",600,e.creativeData,e.environmentVars)},e.frame.contentWindow.document.body.appendChild(t)},t.appendChild(e.frame)},_getCreativeData:function(){var e;try{e={AdParameters:this.creativeData}}catch(e){LOG.error(e)}return e}})}),define("moat_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){return e.subclass({constructor:function(r){e.prototype.constructor.call(this,r),this.provider=t.Ad.Provider.MOAT},_onAdClick:function(t){LOG.info("[Bolt3 MOAT Adapter] clickthru ",t),e.prototype._onAdClick.call(this),window.open(t,"_bolt_advertiser").focus()},_onAdPaused:function(){LOG.info("[Bolt3 MOAT Adapter] ad paused"),this.paused=!0,this._dispatchEvent(t.Media.Event.PAUSED)},_onAdPlaying:function(){LOG.info("[Bolt3 MOAT Adapter] ad playing"),this.paused=!1,this._dispatchEvent(t.Media.Event.PLAYING)}})}),define("innovid_jsvpaid",["linear_jsvpaid","zeus_constants"],function(e,t){return e.subclass({constructor:function(r){e.prototype.constructor.call(this,r),this.provider=t.Ad.Provider.INNOVID},_onAdClick:function(t){LOG.info("[Bolt3 Innovid Adapter] clickthru ",t),e.prototype._onAdClick.call(this),window.open(t,"_bolt_advertiser").focus()},_onAdPaused:function(){LOG.info("[Bolt3 Innovid Adapter] ad paused"),this.paused=!0,this._dispatchEvent(t.Media.Event.PAUSED)},_onAdPlaying:function(){LOG.info("[Bolt3 Innovid Adapter] ad playing"),this.paused=!1,this._dispatchEvent(t.Media.Event.PLAYING)}})}),define("spotx_sdk_initiator",["zeus_constants"],function(e){"use strict";function t(){var t=this;t.channelId=window.spotxChannelId,t.spotxScriptUrl="//js.spotx.tv/directsdk/v1/"+t.channelId+".js",t.provider=e.Ad.Provider.SPOTX,t.init()}return t.prototype.init=function(){LOG.info("[Spotx SDK Initiator] - Loading SpotX SDK"),BoltAdManager.videoElement?LOG.error("[Spotx Initiator] - Video element is already defined"):BoltAdManager._createVideoElement(),this.loadSpotxSDK()},t.prototype.getVASTAd=function(){return this.sdk.getVASTAd()},t.prototype.loadSpotxSDK=function(){var e=this;void 0===window.SpotX?e.loadScript(e.spotxScriptUrl,e.loadSDKScriptCb.bind(e)):(e.loadSDKScriptCb(),LOG.debug("[Spotx SDK Initiator] - SpotX Ad OS SDK has already been loaded"))},t.prototype.loadScript=function(e,t){var r;e&&"string"==typeof e&&(r=document.createElement("script"),r.onload=function(){window.postLogMessage("[Spotx SDK Initiator] - Spotx ad adapter script successfully loaded"),t&&t()},r.onerror=function(e){LOG.error("[Spotx SDK Initiator] - Error loading script ",e)},r.src=e,LOG.debug(r),document.getElementsByTagName("head")[0].appendChild(r))},t.prototype.loadSDKScriptCb=function(){var e=this;BoltAdManager.container&&BoltAdManager.videoElement?(LOG.debug("[Spotx SDK Initiator] - Loaded SpotX for first time! Channel ID: ",e.channelId),e.sdk=new window.SpotX.DirectAdOS({channel_id:e.channelId,contentPageUrl:window.parentBaseUrl,slot:BoltAdManager.container,video_slot:BoltAdManager.videoElement,demand_source_timeout:1e4})):LOG.debug("[Spotx SDK Initiator] - Failed to load SpotX ad; container is missing")},t}),define("spotx_sdk_player",["linear_jsvpaid","zeus_constants","zeus_utils"],function(e,t,r){"use strict";var i=window.parseInt,n=!1;try{n="true"===/#zeusdebug.*;coppaEnabled=(true|false)/i.exec(parentUrl)[1]}catch(e){}var o=e.subclass({constructor:function(r,i){var n=this;e.prototype.constructor.call(n,r,i),n.Client=window.client,n.creativeData=JSON.parse(i),n.channelId=window.spotxChannelId,n.spotxScriptUrl="//js.spotx.tv/directsdk/v1/"+n.channelId+".js",n.duration=0,n.currentTime=0,n.volume=1,n.buffered=0,n.startTime=0,n.hasStarted=!1,n.paused=!1,n.fullscreen=!1,n.metadata=null,n.muted=!1,n._isAd=!0,n.timing=BoltAdManager.timing,n._intervalId=null,n.provider=t.Ad.Provider.SPOTX,n.adServer=BoltAdManager.selectedServer,n.maxAttempts=n.adServer.maxAttempts;try{var o=n.creativeData.listing[0].ad_system.rtb.url;LOG.info("[Spotx Adapter] - 3rd party ad tag encoded "+o),LOG.info("[Spotx Adapter] - 3rd party ad tag decoded "+window.decodeURIComponent(o)),window.postLogMessage("[Spotx Adapter] - 3rd party ad tag encoded "+o),window.postLogMessage("[Spotx Adapter] - 3rd party ad tag decoded "+window.decodeURIComponent(o))}catch(e){}}});return o.prototype.getCustomReportingVal=function(e){var t;return r.objectPropExists(CurrentVideoConfig,"settings","customReporting")&&(t=CurrentVideoConfig.settings.customReporting,r.objectPropExists(t,"custom[cust_pub_reporting_"+e.toString()+"]"))?t["custom[cust_pub_reporting_"+e.toString()+"]"]:""},o.prototype.addMacrosToBoltLogger=function(e){var t,r="";for(t in e)-1===e[t].toString().indexOf("http")&&(""!==r&&(r+="<br>"),r+='<span style="color:#ccc;font-weight:bold">'+t+":</span> "+e[t]);window.postLogMessage("[Spotx Adapter] - Key Values sent in request: "+r,"extra")},o.prototype.getMacroObject=function(){var e=this,t=!0;try{t=r.isUsingSyndicatedAdTag(e.adServer)}catch(e){LOG.error("[Spotx Adapter] - Failed to determine site tag is syndicated or not",e)}var i=r.getCurrentVideoOwnerId();return{campaign_id:BoltAdManager.triedCampaigns.length?BoltAdManager.triedCampaigns[BoltAdManager.triedCampaigns.length-1]:"0.0",channel:e.channelId,content_page_url:window.parentBaseUrl,player_height:PlayerSettings.height,player_width:PlayerSettings.width,adunit:e.timing,cp_placement:r.objectPropExists(e.adServer.siteTags,"placementIds")?e.adServer.siteTags.placementIds:[""],cust_pub_reporting_1:e.getCustomReportingVal(1),cust_pub_reporting_2:e.getCustomReportingVal(2),cust_pub_reporting_3:e.getCustomReportingVal(3),cust_pub_reporting_4:e.getCustomReportingVal(4),cust_pub_reporting_5:e.getCustomReportingVal(5),device_type:e.Client.isMobile?"mobile":"desktop",owning_pub_id:CurrentVideoConfig.hostingId||i||"",placement:r.objectPropExists(e.adServer.siteTags,"placementIds")?e.adServer.siteTags.placementIds:[""],player:"bolt",pub_id:i||"",synd:t,secure:window.location.protocol.indexOf("https")>=0,vid_id:r.objectPropExists(CurrentVideoConfig,"content","videoId")?CurrentVideoConfig.content.videoId||"":"",vidcont_cat:r.objectPropExists(CurrentVideoConfig,"categories")?CurrentVideoConfig.categories:[""],vpi:r.getVPIPriority().join(","),ws_id:r.objectPropExists(e.adServer.siteTags,"id")?e.adServer.siteTags.id:"default"}},o.prototype.loadSDKScript=function(){var e=this,i=n||!!r.objectPropExists(e.adServer,"siteTags","coppa")&&!0===e.adServer.siteTags.coppa;if(i&&LOG.info("COPPA compliance required"),BoltAdManager.SpotxSdk){BoltAdManager.triedCampaigns.push(e.creativeData.ad_id||e.creativeData.listing[0].ad_id);BoltAdManager.triedCampaigns=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])}(BoltAdManager.triedCampaigns),e.sdk=new window.SpotX.DirectAdOS({channel_id:e.channelId,contentPageUrl:window.parentBaseUrl,slot:BoltAdManager.container,video_slot:BoltAdManager.videoElement,demand_source_timeout:1e4,hide_skin:!0,autoplay:!0,ados:{query_params:"price_floor=0&"+e.getVPI()},custom:e.getMacroObject(),token:{TFCD:i?"1":"0"}}),BoltAdManager.SpotxSdk.sdk=Object.create(e.sdk,{fillAdVideoContainer:{value:e.fillAdVideoContainer},resize:{value:e.sdk.resize}}),e.handlePrebid(),e.sdk.loadAd().then(function(i){var n=e.sdk.a.Ca;e.creativeData=e._getCreativeData(),e.environmentVars=e._getEnvironmentVars(),e.frame=e.container.querySelector('[id^="spotx_iframe_"]'),e.sdk.methods=i,e.subscribeEvents(),BoltAdManager._dispatchEvent(t.Ad.Event.READY),LOG.info("[Spotx Adapter] - Ad Unit loaded. Methods:",i,"\nSpotX SDK: ",e.sdk,e.container,e.video),LOG.info("[Spotx Adapter] - KVP Tokens sent to SpotX: ",n),e.addMacrosToBoltLogger(n),r.dom.showElement(t.UI.AD_CONTAINER,"block","visible")},function(){LOG.info("[Spotx Adapter] - Failed to load Ad Unit")})}else LOG.debug("[Spotx Adapter] - Failed to load SpotX ad; container is missing")},o.prototype.handlePrebid=function(){var e,t=this,r=window.prebidWinner;if(r&&r.video&&r.video.hasOwnProperty("hb_bidder")&&void 0!==t.sdk.registerBid&&void 0!==t.sdk.competeBids&&(e=t.registerBids(r)))try{e.resolve({price:r.video.hb_val,vast_url:r.video.hb_vast}),t.sdk.competeBids(),LOG.info("[Spotx SDK] - Sending Prebid prebidWinners: ",r)}catch(t){e.cancel(),LOG.info("[Spotx SDK] - Prebid attempt [promise] cancelled")}},o.prototype.registerBids=function(e){switch(e.video.hb_val=parseFloat(Math.round(e.video.hb_val)/100).toFixed(2),e.video.hb_bidder){case"amazon":return this.sdk.registerBid(t.Ad.AMAZON_DI);case"appnexusAst":case"appnexus":return this.sdk.registerBid(t.Ad.APPNEXUS_DI);case"rubicon":return this.sdk.registerBid(t.Ad.RUBICON_DI);default:return}},o.prototype.playAd=function(){var e=this,r=t.Ad.PLAYER_ID_PREFIX+BoltAdManager.containerId;e.hasStarted=!0,e.paused=!1,e.container=BoltAdManager.container,LOG.info("[Spotx Adapter] - Loading "+e.provider+" JS VPAID"),window.postLogMessage("[Spotx Adapter] - Loading spotx ad adapter script"),e.Client.isMobile&&(e._nativePlayback=!0),BoltAdManager.videoElement||(e.video=e.createVideoElement(r)),e.loadSDKScript()},o.prototype.createVideoElement=function(e){var t=this;return BoltAdManager.videoElement=document.createElement("video"),BoltAdManager.videoElement.id=e,BoltAdManager.videoElement.setAttribute("width","100%"),BoltAdManager.videoElement.setAttribute("height","100%"),BoltAdManager.videoElement.setAttribute("style","position:absolute;top:0;left:0;bottom:0;right:0;"),t.containerWidth=t.container.clientWidth,t.containerHeight=t.container.clientHeight,t.container.appendChild(BoltAdManager.videoElement),BoltAdManager.videoElement.addEventListener("loadstart",t._setNativePlayback),BoltAdManager.videoElement},o.prototype.subscribeEvents=function(){var e=this;e.sdk.subscribe(e.onAdEvent.bind(e,"AdLoaded"),"AdLoaded"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdStarted"),"AdStarted"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdImpression"),"AdImpression"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdStopped"),"AdStopped"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdSkipped"),"AdSkipped"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVideoStart"),"AdVideoStart"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVideoFirstQuartile"),"AdVideoFirstQuartile"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVideoMidpoint"),"AdVideoMidpoint"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVideoThirdQuartile"),"AdVideoThirdQuartile"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVideoComplete"),"AdVideoComplete"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdClickThru"),"AdClickThru"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdUserMinimize"),"AdUserMinimize"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdUserClose"),"AdUserClose"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdPaused"),"AdPaused"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdPlaying"),"AdPlaying"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdSizeChange"),"AdSizeChange"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdRemainingTimeChange"),"AdRemainingTimeChange"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdVolumeChange"),"AdVolumeChange"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdLog"),"AdLog"),e.sdk.subscribe(e.onAdEvent.bind(e,"AdError"),"AdError"),e.onResizeAd=e.onResizeAd.bind(e),window.addEventListener("resize",e.onResizeAd)},o.prototype._getAdLogCode=function(e){switch(i(e,10)){case 101:return"Ad Fault\tAn error has occurred with this ad.";case 102:return"VPAID Error\tA VPAID error has occurred.";case 103:return"Endpoint Opt Out\tVAST document provided by the ad returned an empty response, and therefore opted out of the opportunity.";case 104:return"Endpoint Timeout\tThe request for the VAST document took longer than the configured timeout value.";case 105:return"Endpoint Error\tThe request to the endpoint failed due to an error.";case 107:return"Total Fetch Timeout\tAd was not fetched before the configured total fetch timeout.";case 108:return"Total Process Timeout\tNo ad was able to start before the configured total process timeout.";case 109:return"Unplayable Media\tIn a no-Flash environment, but only Flash creatives available.";case 110:return"Ad Throttled\tFlash ad attempted to play, but was throttled by browser.";case 111:return"Ad Loaded!";default:return"No code available"}},o.prototype.onAdEvent=function(e,r){var n=this;switch("AdRemainingTimeChange"!==e&&"AdLog"!==e&&(LOG.info("[Spotx Adapter] - Ad Event: "+e),window.postLogMessage("[Spotx Adapter] - "+e)),e){case"AdSizeChange":break;case"AdLoaded":n.duration=n.sdk.methods.getAdDuration()||n.sdk.methods.getAdRemainingTime(),n.currentTime=0,n.startTime=0,BoltAdManager._dispatchEvent(t.Media.Event.LOADED),BoltAdManager._dispatchEvent(t.Media.Event.PLAY),n._dispatchEvent(t.Media.Event.PLAY),n._dispatchEvent(t.Media.Event.DURATION_CHANGE),n._dispatchEvent(t.Media.Event.START_TIME_CHANGED),n.sdk.methods.startAd(),n.fillAdVideoContainer("100%","100%");break;case"AdVideoStart":n._intervalId=window.setInterval(n._checkTime,100),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING),n._dispatchEvent(t.Media.Event.PLAYING),n.showControlButtons();break;case"AdImpression":case"AdStarted":break;case"AdVideoFirstQuartile":n._dispatchEvent(t.Media.Event.FIRSTQUARTILE);break;case"AdVideoMidpoint":n._dispatchEvent(t.Media.Event.MIDPOINT);break;case"AdVideoThirdQuartile":n._dispatchEvent(t.Media.Event.THIRDQUARTILE);break;case"AdStopped":case"AdSkipped":n.complete();break;case"AdClickThru":BoltAdManager._dispatchEvent(t.Ad.Event.CLICKED);break;case"AdUserMinimize":break;case"AdUserClose":BoltAdManager._dispatchEvent(t.Ad.Event.CLOSED),n.complete();break;case"AdPaused":PlayerState.state===PlayerState.PLAYING&&n.pause();break;case"AdPlaying":n.paused=!1,n.sdk.methods.resumeAd(),n._dispatchEvent(t.Media.Event.PLAYING),n._dispatchEvent(t.Media.Event.RESUME);break;case"AdRemainingTimeChange":n.currentTime=i(n.duration,10)-i(n.sdk.methods.getAdRemainingTime(),10),n._dispatchEvent(t.Media.Event.TIME_UPDATE,n.currentTime);break;case"AdVolumeChange":case"AdVideoComplete":break;case"AdLog":r=JSON.parse(r),LOG.info("[Spotx Adapter] - AdLog: ",e,r),window.postLogMessage("[Spotx Adapter] - AdLog: <br><b>Title:</b> "+(r.title||"")+"<br><b>Ad Id:</b> "+(r.ad_id||"")+"<br><b>Message:</b> "+(r.message||"")+"<br><b>Code:</b> "+n._getAdLogCode(r.code));break;case"AdError":n._error=!0,BoltAdManager.attempts<n.maxAttempts?n._dispatchEvent(t.ERROR,e):(LOG.debug("[Spotx Adapter] - Daisy Chain complete after "+BoltAdManager.attempts+". No ad found",e),n.complete())}},o.prototype.getVPI=function(){try{var e=-1,t="VPI["+(++e).toString()+"]=VPAID_JS";return client.isMobile?client.supportedVideoTypes.indexOf("mp4")>=0&&(t+="&VPI["+(++e).toString()+"]=MP4"):t+="&VPI["+(++e).toString()+"]=VPAID&VPI["+(++e).toString()+"]=MP4",t}catch(e){LOG.debug("[Spotx Adapter] - Error getting VPI (file type) ",e)}},o.prototype.showControlButtons=function(){},o.prototype.getVolume=function(){var e=this;return void 0!==e.sdk?e.sdk.methods.getAdVolume():null},o.prototype.setVolume=function(e){var r=this;client.isMobile||void 0===r.sdk||void 0===r.sdk.methods||r.volume===e||(LOG.debug("[Spotx Adapter] - Set volume",e),r.volume=e,r.sdk.methods.setAdVolume(e),r._dispatchEvent(t.Media.Event.VOLUME_CHANGED,e))},o.prototype.mute=function(e){var r=this;r.muted=!!e,LOG.info("[Spotx Adapter] - mute",r.muted),e?(r.setVolume(0),r.sdk.methods.setAdVolume(0),r._dispatchEvent(t.Media.Event.MUTED)):(r.setVolume(r.volume),r.sdk.methods.setAdVolume(r.volume),r._dispatchEvent(t.Media.Event.UNMUTED)),(i(client.system.ios,10)>=10||client.system.android)&&(r.muted=!!e,LOG.info("[Spotx Adapter] - iOS mute",r.muted),r.video.muted=r.muted,e?(r.setVolume(0),r._dispatchEvent(t.Media.Event.MUTED)):(r.setVolume(1),r._dispatchEvent(t.Media.Event.UNMUTED)))},o.prototype.pause=function(){var e=this;e.paused=!0,e._dispatchEvent(t.Media.Event.PAUSED),BoltAdManager._dispatchEvent(t.Media.Event.PAUSED),void 0!==e.sdk&&e.sdk.methods.pauseAd()},o.prototype.resume=function(){var e=this;void 0!==e.sdk&&(e.sdk.methods.resumeAd(),BoltAdManager._dispatchEvent(t.Media.Event.PLAYING))},o.prototype.onResizeAd=function(e){var t=this;document.getElementsByClassName("is-sticky-module")[0]||(PlayerView.fullscreen?(t.container.style="display:block;",t.sdk.resize(t.container.offsetWidth,t.container.offsetHeight,"fullscreen")):t.sdk.resize(t.container.getAttribute("data-zeus-initial-width")||t.container.offsetWidth,t.container.getAttribute("data-zeus-initial-height")||t.container.offsetHeight),t.setFullscreen(PlayerView.fullscreen),LOG.info("[Spotx Adapter] - Ad fullscreen toggled"))},o.prototype.fillAdVideoContainer=function(e,t){var e=(BoltAdManager.videoElement,e.toString()),t=t.toString();try{e.indexOf("%")>-1?(BoltAdManager.videoElement.style.width=e,BoltAdManager.videoElement.style.height=t):(BoltAdManager.videoElement.style.width=e,BoltAdManager.videoElement.style.height=t,BoltAdManager.videoElement.width=i(e,10),BoltAdManager.videoElement.height=i(t,10))}catch(e){LOG.error("[Spotx Adapter] - fillAdVideoContainer error:",e)}},o.prototype.setFullscreen=function(e){e!==this.fullscreen&&(this.fullscreen=e,LOG.info("[Spotx Adapter] - Set fullscreen",e))},o.prototype.complete=function(){var e=this;e._isAd=!0,BoltAdManager._dispatchEvent(t.Ad.Event.COMPLETED),e.end(),LOG.info("[Spotx Adapter] - Ad Complete")},o.prototype.end=function(){var e=this;e._intervalId&&window.clearInterval(e._intervalId),BoltAdManager._dispatchEvent(t.Media.Event.ENDED),e.sdk.destroy()},o.prototype.remove=function(){var e=this;e.hasStarted=!1,window.removeEventListener("resize",e.onResizeAd),window.clearInterval(e._intervalId),e.sdk.unsubscribeAll();try{e.container.removeChild(e.frame)}catch(e){}e._removeAssets(),e._removeVideoElement(),BoltAdManager.videoElement=null,BoltAdManager._dispatchEvent("removed"),LOG.info("[Spotx Adapter] - Ad removed")},o.prototype.getCurrentTime=function(){var e=this;return void 0!==e.sdk&&void 0!==e.sdk.methods?(LOG.debug(e.duration,e.currentTime,e.duration-e.currentTime),e.duration-e.currentTime):0},o});