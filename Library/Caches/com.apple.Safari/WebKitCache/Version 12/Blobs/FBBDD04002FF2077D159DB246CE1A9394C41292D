var IV = (function(SCOPE) {

    SCOPE.baseData = {};

    SCOPE.baseData.app_data = {"custom":{"iframe":true,"waitForLoad":true},"debug-sample-rate":1,"video":{"url":"","sourceURL":"https:\/\/s-static.innovid.com\/assets\/51745\/206963\/source_51745_206963.mp4","width":720,"height":486,"duration":15.018,"renditions":{"webm":"https:\/\/s-static.innovid.com\/media\/encoded\/08_18\/168893\/3_source_51745_206963.webm","low.mp4":"https:\/\/s-static.innovid.com\/media\/encoded\/08_18\/168893\/8_source_51745_206963.mp4","high.mp4":"https:\/\/s-static.innovid.com\/media\/encoded\/08_18\/168893\/11_source_51745_206963.mp4","iphone_stream":"https:\/\/s-static.innovid.com\/media\/encoded\/08_18\/168893\/27_source_51745_206963.m3u8","short_segment_iphone_stream":"https:\/\/s-static.innovid.com\/media\/encoded\/08_18\/168893\/29_source_51745_206963.m3u8"}},"html-custom-data":{"desktopOnly":false,"loadManager":{"beforePreroll":[],"beforeOverlay":["LOGO.png","widget.png","OverlayBackground1.png","IFE1.png","Now.png","Destinations.png","box.png","OverlayBackground2.png","landLOGO.png","landwidget.png","landtext.png","landNow.png","landDestinations.png","landbox.png","landFINAL_ART_040918.png"],"whilePreroll":[],"beforeSlate":[]}},"html-studio-properties":[{"Bottom Extra Clearance":"0","hsp - type":"text"},{"Version":"version1","hsp - type":"dropdown","hsp - values":["version1","version2"]}],"video-clicks":{"click-thru-url":"https:\/\/ad.doubleclick.net\/ddm\/clk\/427023818;228846098;r?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=1423&t28=900479&t29=335664&t30=DBR_51745_1423_900479_335664&t21=51745&t32=%m&redirecturl=http:\/\/www.delta.com?prod=freemsg?mkcpgn=DBR_51745_1423_900479_335664"},"placement-config":{"hotspot-clicks":[{"id":"Explore_Destinations","type":"click-thru","main":"https:\/\/www.delta.com\/"},{"id":"Explore_Destinations_IFE1","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=ife?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"Explore_Destinations_Messaging1","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=freemsg?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"Explore_Destinations_Wifi1","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=wifi?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"Explore_Now","type":"click-thru","main":"https:\/\/www.delta.com\/","tracking":[{"type":"url-tracking","data":"https:\/\/ad.doubleclick.net\/ddm\/clk\/427023818;228846098;r?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=1423&t28=900479&t29=335664&t30=DBR_51745_1423_900479_335664&t21=51745&t32=%m&redirecturl=http:\/\/www.delta.com?prod=freemsg?mkcpgn=DBR_51745_1423_900479_335664"}]},{"id":"Explore_Now_IFE2","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=ife?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"Explore_Now_Messaging2","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=freemsg?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"Explore_Now_Wifi2","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/416195776;216207341;h?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=%esid!&t28=%epid!&t29=%ecid!&t30=DBR_%ebuy!_%esid!_%epid!_%ecid!&t21=%ebuy!&t32=%m&redirecturl=http:\/\/www.delta.com?prod=wifi?mkcpgn=DBR_%ebuy!_%esid!_%epid!_%ecid!"},{"id":"main","type":"click-thru","main":"https:\/\/ad.doubleclick.net\/ddm\/clk\/427023818;228846098;r?http:\/\/tkpi.delta.com\/redirect?requesttype=ad.click&id=79992&t25=dcm&t27=1423&t28=900479&t29=335664&t30=DBR_51745_1423_900479_335664&t21=51745&t32=%m&redirecturl=http:\/\/www.delta.com?prod=freemsg?mkcpgn=DBR_51745_1423_900479_335664"}],"placement-hash":"1fujeu","project-hash":"1h9d4g","client-id":4080,"channel-id":886750,"publisher-id":1423,"advertiser-id":2009,"placements-group-id":900479,"campaign-id":51745,"video-id":335664,"placement-tag-id":0,"project-state":2,"child-manual-project-state":9,"child-auto-project-state":11,"real_estate_id":350268,"survey-data":null,"ivcexdata-enabled":false,"tracking-events":{"playingStart":[{"type":"url-tracking","data":"https:\/\/tkpi.delta.com\/datacollect?id=79992&requesttype=ad.imp&t25=dcm&t27=1423&t28=900479&t29=335664&t30=DP_51745_1423_900479_335664&t21=51745&t32={ivc_deviceid_raw}"},{"type":"url-tracking","data":"https:\/\/ad.doubleclick.net\/ddm\/ad\/N385602.135351SOJERN\/B20763283.215732985;sz=1x1;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=?"},{"type":"url-tracking","data":"https:\/\/dts.innovid.com\/placement\/1fujeu\/uuid?cb=[timestamp]"}]}},"error-monitoring-enabled":false,"service-config":{"integral":{"init_camp_monitor":true,"use_ecp":false,"an_id":"923167","partner":"innovid","blocking":true,"timeout":600,"useRealBlocking":true,"adv_entity_id":147979,"pub_entity_id":25037025},"comscore":{"trackingUrl":"https:\/\/sb.scorecardresearch.com\/p?c1=3&c2=6035555&c3=51745&c4=335664&c5=900479&c6=&c10=1&c11=1423&c13=&c16=inv&cj=1&ax_fwd=1&rn=[timestamp]"}}};
    SCOPE.baseData.config_data = {"iconSizes":[24,32,48,64,128],"previewParam":{"width":500,"height":281,"iconSize":32,"trayMargin":1.05},"platformScaling":{"mobile":1,"tablet":1,"desktop":1,"tv":2},"aspectRatio":1.3,"googleMapsApiKey":"AIzaSyAIvRFdH46ZxXWyLgE3_OjsL61tjxCDtS4","moat":{"disableFlash":0,"partnerCode":"innovidintvpaid2js125985325015"},"dv":{"url":"https:\/\/cdn.doubleverify.com\/dvvid_src.js?ctx=<%= ctx %>&cmp=<%= cmp %>&sid=<%= sid %>&crt=1&plc=<%= plc %>&adsrv=118&tagformat=2&tagtype=video&dvtagver=6.1.src&DVP_GVACB=<%= cb %>","blocking-url":"https:\/\/cdn.doubleverify.com\/dvbs_src.js?ctx=<%= ctx %>&cmp=<%= cmp %>&sid=<%= sid %>&crt=1&plc=<%= plc %>&adsrv=118&tagformat=2&tagtype=video&dvtagver=6.1.src&adid=<%= cb %>&DVP_DCB=<%= bcb %>"},"comscore":{"partnerId":"Innovid"},"nielsen_dbe":{"survey_url":"https:\/\/secure-gl.imrworldwide.com\/u\/t\/{survey-id}\/video_tag.html?cr={iv_creativeid}&ce={iv_publisherid}-innovid&pc={iv_placementid}&wc=wc1&am=52&tt=5&view=300x300&show={show}&mode=s&width={player-width}&height={player-height}&bgcolor=000000&uuid={sessionid}"}};
    SCOPE.baseData.cssPath = 'https://s-static.innovid.com/mobileapps/s/js/vpaid/1fujeu.css?cb=4.6.3288&secured=1';

    SCOPE.baseData.config_data.mode = 'js';
    SCOPE.baseData.targetElement = 'div#content';
    SCOPE.baseData.appPath = 'https://s-cdn.innovid.com/m/';
    SCOPE.baseData.servicePath = 'https://s-c-service.innovid.com';
    SCOPE.baseData.nonCdnServicePath = 'https://service.innovid.com';
    SCOPE.baseData.reportUrl = 'https://s.innovid.com/1x1.gif';
    SCOPE.baseData.errorReportUrl = 'https://s3.amazonaws.com/innovid-iroll-runtime/1x1.gif';
    SCOPE.baseData.runtimeConfigUrl = 'https://s-static.innovid.com/runtime/iroll-runtime-config.js';
    SCOPE.baseData.mobileCoreVersion = '4.6.3288';
    SCOPE.baseData.staticDomain = 'static.innovid.com';
    SCOPE.baseData.securedStaticDomain = 's-static.innovid.com';
    SCOPE.baseData.dtsUrl = 'https://dts.innovid.com';

    SCOPE.baseData.featureBits = {"vpaid_clktru_handle_by_innovid_for_non_in_app":false,"vpaid_viewability_geo_friendly_iframe":true};

    return SCOPE;

})(IV || {});


/* Zepto v1.1.4 - zepto event ajax form ie - zeptojs.com/license */
var Zepto=function(){function L(t){return null==t?String(t):j[S.call(t)]||"object"}function Z(t){return"function"==L(t)}function $(t){return null!=t&&t==t.window}function _(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function D(t){return"object"==L(t)}function R(t){return D(t)&&!$(t)&&Object.getPrototypeOf(t)==Object.prototype}function M(t){return"number"==typeof t.length}function k(t){return s.call(t,function(t){return null!=t})}function z(t){return t.length>0?n.fn.concat.apply([],t):t}function F(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function q(t){return t in f?f[t]:f[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function H(t,e){return"number"!=typeof e||c[F(t)]?e:e+"px"}function I(t){var e,n;return u[t]||(e=a.createElement(t),a.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),u[t]=n),u[t]}function V(t){return"children"in t?o.call(t.children):n.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function B(n,i,r){for(e in i)r&&(R(i[e])||A(i[e]))?(R(i[e])&&!R(n[e])&&(n[e]={}),A(i[e])&&!A(n[e])&&(n[e]=[]),B(n[e],i[e],r)):i[e]!==t&&(n[e]=i[e])}function U(t,e){return null==e?n(t):n(t).filter(e)}function J(t,e,n,i){return Z(e)?e.call(t,n,i):e}function X(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function W(e,n){var i=e.className,r=i&&i.baseVal!==t;return n===t?r?i.baseVal:i:void(r?i.baseVal=n:e.className=n)}function Y(t){var e;try{return t?"true"==t||("false"==t?!1:"null"==t?null:/^0/.test(t)||isNaN(e=Number(t))?/^[\[\{]/.test(t)?n.parseJSON(t):t:e):t}catch(i){return t}}function G(t,e){e(t);for(var n=0,i=t.childNodes.length;i>n;n++)G(t.childNodes[n],e)}var t,e,n,i,C,N,r=[],o=r.slice,s=r.filter,a=window.document,u={},f={},c={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},l=/^\s*<(\w+|!)[^>]*>/,h=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,d=/^(?:body|html)$/i,m=/([A-Z])/g,g=["val","css","html","text","data","width","height","offset"],v=["after","prepend","before","append"],y=a.createElement("table"),x=a.createElement("tr"),b={tr:a.createElement("tbody"),tbody:y,thead:y,tfoot:y,td:x,th:x,"*":a.createElement("div")},w=/complete|loaded|interactive/,E=/^[\w-]*$/,j={},S=j.toString,T={},O=a.createElement("div"),P={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},A=Array.isArray||function(t){return t instanceof Array};return T.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,r=t.parentNode,o=!r;return o&&(r=O).appendChild(t),i=~T.qsa(r,e).indexOf(t),o&&O.removeChild(t),i},C=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},N=function(t){return s.call(t,function(e,n){return t.indexOf(e)==n})},T.fragment=function(e,i,r){var s,u,f;return h.test(e)&&(s=n(a.createElement(RegExp.$1))),s||(e.replace&&(e=e.replace(p,"<$1></$2>")),i===t&&(i=l.test(e)&&RegExp.$1),i in b||(i="*"),f=b[i],f.innerHTML=""+e,s=n.each(o.call(f.childNodes),function(){f.removeChild(this)})),R(r)&&(u=n(s),n.each(r,function(t,e){g.indexOf(t)>-1?u[t](e):u.attr(t,e)})),s},T.Z=function(t,e){return t=t||[],t.__proto__=n.fn,t.selector=e||"",t},T.isZ=function(t){return t instanceof T.Z},T.init=function(e,i){var r;if(!e)return T.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&l.test(e))r=T.fragment(e,RegExp.$1,i),e=null;else{if(i!==t)return n(i).find(e);r=T.qsa(a,e)}else{if(Z(e))return n(a).ready(e);if(T.isZ(e))return e;if(A(e))r=k(e);else if(D(e))r=[e],e=null;else if(l.test(e))r=T.fragment(e.trim(),RegExp.$1,i),e=null;else{if(i!==t)return n(i).find(e);r=T.qsa(a,e)}}return T.Z(r,e)},n=function(t,e){return T.init(t,e)},n.extend=function(t){var e,n=o.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){B(t,n,e)}),t},T.qsa=function(t,e){var n,i="#"==e[0],r=!i&&"."==e[0],s=i||r?e.slice(1):e,a=E.test(s);return _(t)&&a&&i?(n=t.getElementById(s))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:o.call(a&&!i?r?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},n.contains=a.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},n.type=L,n.isFunction=Z,n.isWindow=$,n.isArray=A,n.isPlainObject=R,n.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},n.inArray=function(t,e,n){return r.indexOf.call(e,t,n)},n.camelCase=C,n.trim=function(t){return null==t?"":String.prototype.trim.call(t)},n.uuid=0,n.support={},n.expr={},n.map=function(t,e){var n,r,o,i=[];if(M(t))for(r=0;r<t.length;r++)n=e(t[r],r),null!=n&&i.push(n);else for(o in t)n=e(t[o],o),null!=n&&i.push(n);return z(i)},n.each=function(t,e){var n,i;if(M(t)){for(n=0;n<t.length;n++)if(e.call(t[n],n,t[n])===!1)return t}else for(i in t)if(e.call(t[i],i,t[i])===!1)return t;return t},n.grep=function(t,e){return s.call(t,e)},window.JSON&&(n.parseJSON=JSON.parse),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){j["[object "+e+"]"]=e.toLowerCase()}),n.fn={forEach:r.forEach,reduce:r.reduce,push:r.push,sort:r.sort,indexOf:r.indexOf,concat:r.concat,map:function(t){return n(n.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return n(o.apply(this,arguments))},ready:function(t){return w.test(a.readyState)&&a.body?t(n):a.addEventListener("DOMContentLoaded",function(){t(n)},!1),this},get:function(e){return e===t?o.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return r.every.call(this,function(e,n){return t.call(e,n,e)!==!1}),this},filter:function(t){return Z(t)?this.not(this.not(t)):n(s.call(this,function(e){return T.matches(e,t)}))},add:function(t,e){return n(N(this.concat(n(t,e))))},is:function(t){return this.length>0&&T.matches(this[0],t)},not:function(e){var i=[];if(Z(e)&&e.call!==t)this.each(function(t){e.call(this,t)||i.push(this)});else{var r="string"==typeof e?this.filter(e):M(e)&&Z(e.item)?o.call(e):n(e);this.forEach(function(t){r.indexOf(t)<0&&i.push(t)})}return n(i)},has:function(t){return this.filter(function(){return D(t)?n.contains(this,t):n(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!D(t)?t:n(t)},last:function(){var t=this[this.length-1];return t&&!D(t)?t:n(t)},find:function(t){var e,i=this;return e=t?"object"==typeof t?n(t).filter(function(){var t=this;return r.some.call(i,function(e){return n.contains(e,t)})}):1==this.length?n(T.qsa(this[0],t)):this.map(function(){return T.qsa(this,t)}):[]},closest:function(t,e){var i=this[0],r=!1;for("object"==typeof t&&(r=n(t));i&&!(r?r.indexOf(i)>=0:T.matches(i,t));)i=i!==e&&!_(i)&&i.parentNode;return n(i)},parents:function(t){for(var e=[],i=this;i.length>0;)i=n.map(i,function(t){return(t=t.parentNode)&&!_(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return U(e,t)},parent:function(t){return U(N(this.pluck("parentNode")),t)},children:function(t){return U(this.map(function(){return V(this)}),t)},contents:function(){return this.map(function(){return o.call(this.childNodes)})},siblings:function(t){return U(this.map(function(t,e){return s.call(V(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return n.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==(getComputedStyle(this,"") ? getComputedStyle(this,"").getPropertyValue("display") : "")&&(this.style.display=I(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var e=Z(t);if(this[0]&&!e)var i=n(t).get(0),r=i.parentNode||this.length>1;return this.each(function(o){n(this).wrapAll(e?t.call(this,o):r?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){n(this[0]).before(t=n(t));for(var e;(e=t.children()).length;)t=e.first();n(t).append(this)}return this},wrapInner:function(t){var e=Z(t);return this.each(function(i){var r=n(this),o=r.contents(),s=e?t.call(this,i):t;o.length?o.wrapAll(s):r.append(s)})},unwrap:function(){return this.parent().each(function(){n(this).replaceWith(n(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var i=n(this);(e===t?"none"==i.css("display"):e)?i.show():i.hide()})},prev:function(t){return n(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return n(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var i=this.innerHTML;n(this).empty().append(J(this,t,e,i))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var n=J(this,t,e,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(n,i){var r;return"string"!=typeof n||1 in arguments?this.each(function(t){if(1===this.nodeType)if(D(n))for(e in n)X(this,e,n[e]);else X(this,n,J(this,i,t,this.getAttribute(n)))}):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(n))&&n in this[0]?this[0][n]:r:t},removeAttr:function(t){return this.each(function(){1===this.nodeType&&X(this,t)})},prop:function(t,e){return t=P[t]||t,1 in arguments?this.each(function(n){this[t]=J(this,e,n,this[t])}):this[0]&&this[0][t]},data:function(e,n){var i="data-"+e.replace(m,"-$1").toLowerCase(),r=1 in arguments?this.attr(i,n):this.attr(i);return null!==r?Y(r):t},val:function(t){return 0 in arguments?this.each(function(e){this.value=J(this,t,e,this.value)}):this[0]&&(this[0].multiple?n(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var i=n(this),r=J(this,t,e,i.offset()),o=i.offsetParent().offset(),s={top:r.top-o.top,left:r.left-o.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(!this.length)return null;var e;try {e=this[0].getBoundingClientRect()}catch(ex){e={left:0,top:0,width:0,height:0}};return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(t,i){if(arguments.length<2){var r=this[0],o=getComputedStyle(r,"");if(!r)return;if("string"==typeof t)return r.style[C(t)]||o.getPropertyValue(t);if(A(t)){var s={};return n.each(A(t)?t:[t],function(t,e){s[e]=r.style[C(e)]||o.getPropertyValue(e)}),s}}var a="";if("string"==L(t))i||0===i?a=F(t)+":"+H(t,i):this.each(function(){this.style.removeProperty(F(t))});else for(e in t)t[e]||0===t[e]?a+=F(e)+":"+H(e,t[e])+";":this.each(function(){this.style.removeProperty(F(e))});return this.each(function(){this.style.cssText+=";"+a})},index:function(t){return t?this.indexOf(n(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return t?r.some.call(this,function(t){return this.test(W(t))},q(t)):!1},addClass:function(t){return t?this.each(function(e){i=[];var r=W(this),o=J(this,t,e,r);o.split(/\s+/g).forEach(function(t){n(this).hasClass(t)||i.push(t)},this),i.length&&W(this,r+(r?" ":"")+i.join(" "))}):this},removeClass:function(e){return this.each(function(n){return e===t?W(this,""):(i=W(this),J(this,e,n,i).split(/\s+/g).forEach(function(t){i=i.replace(q(t)," ")}),void W(this,i.trim()))})},toggleClass:function(e,i){return e?this.each(function(r){var o=n(this),s=J(this,e,r,W(this));s.split(/\s+/g).forEach(function(e){(i===t?!o.hasClass(e):i)?o.addClass(e):o.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var n="scrollTop"in this[0];return e===t?n?this[0].scrollTop:this[0].pageYOffset:this.each(n?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var n="scrollLeft"in this[0];return e===t?n?this[0].scrollLeft:this[0].pageXOffset:this.each(n?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),r=d.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(n(t).css("margin-top"))||0,i.left-=parseFloat(n(t).css("margin-left"))||0,r.top+=parseFloat(n(e[0]).css("border-top-width"))||0,r.left+=parseFloat(n(e[0]).css("border-left-width"))||0,{top:i.top-r.top,left:i.left-r.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||a.body;t&&!d.test(t.nodeName)&&"static"==n(t).css("position");)t=t.offsetParent;return t})}},n.fn.detach=n.fn.remove,["width","height"].forEach(function(e){var i=e.replace(/./,function(t){return t[0].toUpperCase()});n.fn[e]=function(r){var o,s=this[0];return r===t?$(s)?s["inner"+i]:_(s)?s.documentElement["scroll"+i]:(o=this.offset())&&o[e]:this.each(function(t){s=n(this),s.css(e,J(this,r,t,s[e]()))})}}),v.forEach(function(t,e){var i=e%2;n.fn[t]=function(){var t,o,r=n.map(arguments,function(e){return t=L(e),"object"==t||"array"==t||null==e?e:T.fragment(e)}),s=this.length>1;return r.length<1?this:this.each(function(t,u){o=i?u:u.parentNode,u=0==e?u.nextSibling:1==e?u.firstChild:2==e?u:null;var f=n.contains(a.documentElement,o);r.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!o)return n(t).remove();o.insertBefore(t,u),f&&G(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},n.fn[i?t+"To":"insert"+(e?"Before":"After")]=function(e){return n(e)[t](this),this}}),T.Z.prototype=n.fn,T.uniq=N,T.deserializeValue=Y,n.zepto=T,n}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(t){function l(t){return t._zid||(t._zid=e++)}function h(t,e,n,i){if(e=p(e),e.ns)var r=d(e.ns);return(s[l(t)]||[]).filter(function(t){return!(!t||e.e&&t.e!=e.e||e.ns&&!r.test(t.ns)||n&&l(t.fn)!==l(n)||i&&t.sel!=i)})}function p(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function d(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function m(t,e){return t.del&&!u&&t.e in f||!!e}function g(t){return c[t]||u&&f[t]||t}function v(e,i,r,o,a,u,f){var h=l(e),d=s[h]||(s[h]=[]);i.split(/\s/).forEach(function(i){if("ready"==i)return t(document).ready(r);var s=p(i);s.fn=r,s.sel=a,s.e in c&&(r=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?s.fn.apply(this,arguments):void 0}),s.del=u;var l=u||r;s.proxy=function(t){if(t=j(t),!t.isImmediatePropagationStopped()){t.data=o;var i=l.apply(e,t._args==n?[t]:[t].concat(t._args));return i===!1&&(t.preventDefault(),t.stopPropagation()),i}},s.i=d.length,d.push(s),"addEventListener"in e&&e.addEventListener(g(s.e),s.proxy,m(s,f))})}function y(t,e,n,i,r){var o=l(t);(e||"").split(/\s/).forEach(function(e){h(t,e,n,i).forEach(function(e){delete s[o][e.i],"removeEventListener"in t&&t.removeEventListener(g(e.e),e.proxy,m(e,r))})})}function j(e,i){return(i||!e.isDefaultPrevented)&&(i||(i=e),t.each(E,function(t,n){var r=i[t];e[t]=function(){return this[n]=x,r&&r.apply(i,arguments)},e[n]=b}),(i.defaultPrevented!==n?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(e.isDefaultPrevented=x)),e}function S(t){var e,i={originalEvent:t};for(e in t)w.test(e)||t[e]===n||(i[e]=t[e]);return j(i,t)}var n,e=1,i=Array.prototype.slice,r=t.isFunction,o=function(t){return"string"==typeof t},s={},a={},u="onfocusin"in window,f={focus:"focusin",blur:"focusout"},c={mouseenter:"mouseover",mouseleave:"mouseout"};a.click=a.mousedown=a.mouseup=a.mousemove="MouseEvents",t.event={add:v,remove:y},t.proxy=function(e,n){var s=2 in arguments&&i.call(arguments,2);if(r(e)){var a=function(){return e.apply(n,s?s.concat(i.call(arguments)):arguments)};return a._zid=l(e),a}if(o(n))return s?(s.unshift(e[n],e),t.proxy.apply(null,s)):t.proxy(e[n],e);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,i){return this.on(t,e,n,i,1)};var x=function(){return!0},b=function(){return!1},w=/^([A-Z]|returnValue$|layer[XY]$)/,E={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,s,a,u,f){var c,l,h=this;return e&&!o(e)?(t.each(e,function(t,e){h.on(t,s,a,e,f)}),h):(o(s)||r(u)||u===!1||(u=a,a=s,s=n),(r(a)||a===!1)&&(u=a,a=n),u===!1&&(u=b),h.each(function(n,r){f&&(c=function(t){return y(r,t.type,u),u.apply(this,arguments)}),s&&(l=function(e){var n,o=t(e.target).closest(s,r).get(0);return o&&o!==r?(n=t.extend(S(e),{currentTarget:o,liveFired:r}),(c||u).apply(o,[n].concat(i.call(arguments,1)))):void 0}),v(r,e,u,a,s,l||c)}))},t.fn.off=function(e,i,s){var a=this;return e&&!o(e)?(t.each(e,function(t,e){a.off(t,i,e)}),a):(o(i)||r(s)||s===!1||(s=i,i=n),s===!1&&(s=b),a.each(function(){y(this,e,s,i)}))},t.fn.trigger=function(e,n){return e=o(e)||t.isPlainObject(e)?t.Event(e):j(e),e._args=n,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,n){var i,r;return this.each(function(s,a){i=S(o(e)?t.Event(e):e),i._args=n,i.target=a,t.each(h(a,e.type||e),function(t,e){return r=e.proxy(i),i.isImmediatePropagationStopped()?!1:void 0})}),r},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){t.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),t.Event=function(t,e){o(t)||(e=t,t=e.type);var n=document.createEvent(a[t]||"Events"),i=!0;if(e)for(var r in e)"bubbles"==r?i=!!e[r]:n[r]=e[r];return n.initEvent(t,i,!0),j(n)}}(Zepto),function(t){function l(e,n,i){var r=t.Event(n);return t(e).trigger(r,i),!r.isDefaultPrevented()}function h(t,e,i,r){return t.global?l(e||n,i,r):void 0}function p(e){e.global&&0===t.active++&&h(e,null,"ajaxStart")}function d(e){e.global&&!--t.active&&h(e,null,"ajaxStop")}function m(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||h(e,n,"ajaxBeforeSend",[t,e])===!1?!1:void h(e,n,"ajaxSend",[t,e])}function g(t,e,n,i){var r=n.context,o="success";n.success.call(r,t,o,e),i&&i.resolveWith(r,[t,o,e]),h(n,r,"ajaxSuccess",[e,n,t]),y(o,e,n)}function v(t,e,n,i,r){var o=i.context;i.error.call(o,n,e,t),r&&r.rejectWith(o,[n,e,t]),h(i,o,"ajaxError",[n,i,t||e]),y(e,n,i)}function y(t,e,n){var i=n.context;n.complete.call(i,e,t),h(n,i,"ajaxComplete",[e,n]),d(n)}function x(){}function b(t){return t&&(t=t.split(";",2)[0]),t&&(t==f?"html":t==u?"json":s.test(t)?"script":a.test(t)&&"xml")||"text"}function w(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function E(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=w(e.url,e.data),e.data=void 0)}function j(e,n,i,r){return t.isFunction(n)&&(r=i,i=n,n=void 0),t.isFunction(i)||(r=i,i=void 0),{url:e,data:n,success:i,dataType:r}}function T(e,n,i,r){var o,s=t.isArray(n),a=t.isPlainObject(n);t.each(n,function(n,u){o=t.type(u),r&&(n=i?r:r+"["+(a||"object"==o||"array"==o?n:"")+"]"),!r&&s?e.add(u.name,u.value):"array"==o||!i&&"object"==o?T(e,u,i,n):e.add(n,u)})}var i,r,e=0,n=window.document,o=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/^(?:text|application)\/javascript/i,a=/^(?:text|application)\/xml/i,u="application/json",f="text/html",c=/^\s*$/;t.active=0,t.ajaxJSONP=function(i,r){if(!("type"in i))return t.ajax(i);var f,h,o=i.jsonpCallback,s=(t.isFunction(o)?o():o)||"jsonp"+ ++e,a=n.createElement("script"),u=window[s],c=function(e){t(a).triggerHandler("error",e||"abort")},l={abort:c};return r&&r.promise(l),t(a).on("load error",function(e,n){clearTimeout(h),t(a).off().remove(),"error"!=e.type&&f?g(f[0],l,i,r):v(null,n||"error",l,i,r),window[s]=u,f&&t.isFunction(u)&&u(f[0]),u=f=void 0}),m(l,i)===!1?(c("abort"),l):(window[s]=function(){f=arguments},a.src=i.url.replace(/\?(.+)=\?/,"?$1="+s),n.head.appendChild(a),i.timeout>0&&(h=setTimeout(function(){c("timeout")},i.timeout)),l)},t.ajaxSettings={type:"GET",beforeSend:x,success:x,error:x,complete:x,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:u,xml:"application/xml, text/xml",html:f,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n=t.extend({},e||{}),o=t.Deferred&&t.Deferred();for(i in t.ajaxSettings)void 0===n[i]&&(n[i]=t.ajaxSettings[i]);p(n),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),E(n);var s=n.dataType,a=/\?.+=\?/.test(n.url);if(a&&(s="jsonp"),n.cache!==!1&&(e&&e.cache===!0||"script"!=s&&"jsonp"!=s)||(n.url=w(n.url,"_="+Date.now())),"jsonp"==s)return a||(n.url=w(n.url,n.jsonp?n.jsonp+"=?":n.jsonp===!1?"":"callback=?")),t.ajaxJSONP(n,o);var j,u=n.accepts[s],f={},l=function(t,e){f[t.toLowerCase()]=[t,e]},h=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,d=n.xhr(),y=d.setRequestHeader;if(o&&o.promise(d),n.crossDomain||l("X-Requested-With","XMLHttpRequest"),l("Accept",u||"*/*"),(u=n.mimeType||u)&&(u.indexOf(",")>-1&&(u=u.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(u)),(n.contentType||n.contentType!==!1&&n.data&&"GET"!=n.type.toUpperCase())&&l("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(r in n.headers)l(r,n.headers[r]);if(d.setRequestHeader=l,d.onreadystatechange=function(){if(4==d.readyState){d.onreadystatechange=x,clearTimeout(j);var e,i=!1;if(d.status>=200&&d.status<300||304==d.status||0==d.status&&"file:"==h){s=s||b(n.mimeType||d.getResponseHeader("content-type")),e=d.responseText;try{"script"==s?(1,eval)(e):"xml"==s?e=d.responseXML:"json"==s&&(e=c.test(e)?null:t.parseJSON(e))}catch(r){i=r}i?v(i,"parsererror",d,n,o):g(e,d,n,o)}else v(d.statusText||null,d.status?"error":"abort",d,n,o)}},m(d,n)===!1)return d.abort(),v(null,"abort",d,n,o),d;if(n.xhrFields)for(r in n.xhrFields)d[r]=n.xhrFields[r];var S="async"in n?n.async:!0;d.open(n.type,n.url,S,n.username,n.password);for(r in f)y.apply(d,f[r]);return n.timeout>0&&(j=setTimeout(function(){d.onreadystatechange=x,d.abort(),v(null,"timeout",d,n,o)},n.timeout)),d.send(n.data?n.data:null),d},t.get=function(){return t.ajax(j.apply(null,arguments))},t.post=function(){var e=j.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=j.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var a,r=this,s=e.split(/\s/),u=j(e,n,i),f=u.success;return s.length>1&&(u.url=s[0],a=s[1]),u.success=function(e){r.html(a?t("<div>").html(e.replace(o,"")).find(a):e),f&&f.apply(r,arguments)},t.ajax(u),this};var S=encodeURIComponent;t.param=function(t,e){var n=[];return n.add=function(t,e){this.push(S(t)+"="+S(e))},T(n,t,e),n.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var n,e=[];return t([].slice.call(this.get(0).elements)).each(function(){n=t(this);var i=n.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&("radio"!=i&&"checkbox"!=i||this.checked)&&e.push({name:n.attr("name"),value:n.val()})}),e},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(e)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(e){var n=getComputedStyle;window.getComputedStyle=function(t){try{return n(t)}catch(e){return null}}}}(Zepto);

//     Underscore.js 1.7.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r=Array.prototype,e=Object.prototype,u=Function.prototype,i=r.push,a=r.slice,o=r.concat,l=e.toString,c=e.hasOwnProperty,f=Array.isArray,s=Object.keys,p=u.bind,h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):n._=h,h.VERSION="1.7.0";var g=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}};h.iteratee=function(n,t,r){return null==n?h.identity:h.isFunction(n)?g(n,t,r):h.isObject(n)?h.matches(n):h.property(n)},h.each=h.forEach=function(n,t,r){if(null==n)return n;t=g(t,r);var e,u=n.length;if(u===+u)for(e=0;u>e;e++)t(n[e],e,n);else{var i=h.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},h.map=h.collect=function(n,t,r){if(null==n)return[];t=h.iteratee(t,r);for(var e,u=n.length!==+n.length&&h.keys(n),i=(u||n).length,a=Array(i),o=0;i>o;o++)e=u?u[o]:o,a[o]=t(n[e],e,n);return a};var v="Reduce of empty array with no initial value";h.reduce=h.foldl=h.inject=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length,o=0;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[o++]:o++]}for(;a>o;o++)u=i?i[o]:o,r=t(r,n[u],u,n);return r},h.reduceRight=h.foldr=function(n,t,r,e){null==n&&(n=[]),t=g(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;if(arguments.length<3){if(!a)throw new TypeError(v);r=n[i?i[--a]:--a]}for(;a--;)u=i?i[a]:a,r=t(r,n[u],u,n);return r},h.find=h.detect=function(n,t,r){var e;return t=h.iteratee(t,r),h.some(n,function(n,r,u){return t(n,r,u)?(e=n,!0):void 0}),e},h.filter=h.select=function(n,t,r){var e=[];return null==n?e:(t=h.iteratee(t,r),h.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e)},h.reject=function(n,t,r){return h.filter(n,h.negate(h.iteratee(t)),r)},h.every=h.all=function(n,t,r){if(null==n)return!0;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,!t(n[u],u,n))return!1;return!0},h.some=h.any=function(n,t,r){if(null==n)return!1;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),a=(i||n).length;for(e=0;a>e;e++)if(u=i?i[e]:e,t(n[u],u,n))return!0;return!1},h.contains=h.include=function(n,t){return null==n?!1:(n.length!==+n.length&&(n=h.values(n)),h.indexOf(n,t)>=0)},h.invoke=function(n,t){var r=a.call(arguments,2),e=h.isFunction(t);return h.map(n,function(n){return(e?t:n[t]).apply(n,r)})},h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matches(t))},h.findWhere=function(n,t){return h.find(n,h.matches(t))},h.max=function(n,t,r){var e,u,i=-1/0,a=-1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],e>i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u>a||u===-1/0&&i===-1/0)&&(i=n,a=u)});return i},h.min=function(n,t,r){var e,u,i=1/0,a=1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var o=0,l=n.length;l>o;o++)e=n[o],i>e&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(a>u||1/0===u&&1/0===i)&&(i=n,a=u)});return i},h.shuffle=function(n){for(var t,r=n&&n.length===+n.length?n:h.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=h.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},h.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=h.values(n)),n[h.random(n.length-1)]):h.shuffle(n).slice(0,Math.max(0,t))},h.sortBy=function(n,t,r){return t=h.iteratee(t,r),h.pluck(h.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var m=function(n){return function(t,r,e){var u={};return r=h.iteratee(r,e),h.each(t,function(e,i){var a=r(e,i,t);n(u,e,a)}),u}};h.groupBy=m(function(n,t,r){h.has(n,r)?n[r].push(t):n[r]=[t]}),h.indexBy=m(function(n,t,r){n[r]=t}),h.countBy=m(function(n,t,r){h.has(n,r)?n[r]++:n[r]=1}),h.sortedIndex=function(n,t,r,e){r=h.iteratee(r,e,1);for(var u=r(t),i=0,a=n.length;a>i;){var o=i+a>>>1;r(n[o])<u?i=o+1:a=o}return i},h.toArray=function(n){return n?h.isArray(n)?a.call(n):n.length===+n.length?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:n.length===+n.length?n.length:h.keys(n).length},h.partition=function(n,t,r){t=h.iteratee(t,r);var e=[],u=[];return h.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},h.first=h.head=h.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:a.call(n,0,t)},h.initial=function(n,t,r){return a.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},h.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:a.call(n,Math.max(n.length-t,0))},h.rest=h.tail=h.drop=function(n,t,r){return a.call(n,null==t||r?1:t)},h.compact=function(n){return h.filter(n,h.identity)};var y=function(n,t,r,e){if(t&&h.every(n,h.isArray))return o.apply(e,n);for(var u=0,a=n.length;a>u;u++){var l=n[u];h.isArray(l)||h.isArguments(l)?t?i.apply(e,l):y(l,t,r,e):r||e.push(l)}return e};h.flatten=function(n,t){return y(n,t,!1,[])},h.without=function(n){return h.difference(n,a.call(arguments,1))},h.uniq=h.unique=function(n,t,r,e){if(null==n)return[];h.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=h.iteratee(r,e));for(var u=[],i=[],a=0,o=n.length;o>a;a++){var l=n[a];if(t)a&&i===l||u.push(l),i=l;else if(r){var c=r(l,a,n);h.indexOf(i,c)<0&&(i.push(c),u.push(l))}else h.indexOf(u,l)<0&&u.push(l)}return u},h.union=function(){return h.uniq(y(arguments,!0,!0,[]))},h.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;u>e;e++){var i=n[e];if(!h.contains(t,i)){for(var a=1;r>a&&h.contains(arguments[a],i);a++);a===r&&t.push(i)}}return t},h.difference=function(n){var t=y(a.call(arguments,1),!0,!0,[]);return h.filter(n,function(n){return!h.contains(t,n)})},h.zip=function(n){if(null==n)return[];for(var t=h.max(arguments,"length").length,r=Array(t),e=0;t>e;e++)r[e]=h.pluck(arguments,e);return r},h.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},h.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=h.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}for(;u>e;e++)if(n[e]===t)return e;return-1},h.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=n.length;for("number"==typeof r&&(e=0>r?e+r+1:Math.min(e,r+1));--e>=0;)if(n[e]===t)return e;return-1},h.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var d=function(){};h.bind=function(n,t){var r,e;if(p&&n.bind===p)return p.apply(n,a.call(arguments,1));if(!h.isFunction(n))throw new TypeError("Bind must be called on a function");return r=a.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(a.call(arguments)));d.prototype=n.prototype;var u=new d;d.prototype=null;var i=n.apply(u,r.concat(a.call(arguments)));return h.isObject(i)?i:u}},h.partial=function(n){var t=a.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===h&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},h.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=h.bind(n[r],n);return n},h.memoize=function(n,t){var r=function(e){var u=r.cache,i=t?t.apply(this,arguments):e;return h.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},h.delay=function(n,t){var r=a.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},h.defer=function(n){return h.delay.apply(h,[n,1].concat(a.call(arguments,1)))},h.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var l=function(){o=r.leading===!1?0:h.now(),a=null,i=n.apply(e,u),a||(e=u=null)};return function(){var c=h.now();o||r.leading!==!1||(o=c);var f=t-(c-o);return e=this,u=arguments,0>=f||f>t?(clearTimeout(a),a=null,o=c,i=n.apply(e,u),a||(e=u=null)):a||r.trailing===!1||(a=setTimeout(l,f)),i}},h.debounce=function(n,t,r){var e,u,i,a,o,l=function(){var c=h.now()-a;t>c&&c>0?e=setTimeout(l,t-c):(e=null,r||(o=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,a=h.now();var c=r&&!e;return e||(e=setTimeout(l,t)),c&&(o=n.apply(i,u),i=u=null),o}},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},h.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},h.before=function(n,t){var r;return function(){return--n>0?r=t.apply(this,arguments):t=null,r}},h.once=h.partial(h.before,2),h.keys=function(n){if(!h.isObject(n))return[];if(s)return s(n);var t=[];for(var r in n)h.has(n,r)&&t.push(r);return t},h.values=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},h.pairs=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},h.invert=function(n){for(var t={},r=h.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},h.functions=h.methods=function(n){var t=[];for(var r in n)h.isFunction(n[r])&&t.push(r);return t.sort()},h.extend=function(n){if(!h.isObject(n))return n;for(var t,r,e=1,u=arguments.length;u>e;e++){t=arguments[e];for(r in t)c.call(t,r)&&(n[r]=t[r])}return n},h.pick=function(n,t,r){var e,u={};if(null==n)return u;if(h.isFunction(t)){t=g(t,r);for(e in n){var i=n[e];t(i,e,n)&&(u[e]=i)}}else{var l=o.apply([],a.call(arguments,1));n=new Object(n);for(var c=0,f=l.length;f>c;c++)e=l[c],e in n&&(u[e]=n[e])}return u},h.omit=function(n,t,r){if(h.isFunction(t))t=h.negate(t);else{var e=h.map(o.apply([],a.call(arguments,1)),String);t=function(n,t){return!h.contains(e,t)}}return h.pick(n,t,r)},h.defaults=function(n){if(!h.isObject(n))return n;for(var t=1,r=arguments.length;r>t;t++){var e=arguments[t];for(var u in e)n[u]===void 0&&(n[u]=e[u])}return n},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n};var b=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var u=l.call(n);if(u!==l.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]===n)return e[i]===t;var a=n.constructor,o=t.constructor;if(a!==o&&"constructor"in n&&"constructor"in t&&!(h.isFunction(a)&&a instanceof a&&h.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c,f;if("[object Array]"===u){if(c=n.length,f=c===t.length)for(;c--&&(f=b(n[c],t[c],r,e)););}else{var s,p=h.keys(n);if(c=p.length,f=h.keys(t).length===c)for(;c--&&(s=p[c],f=h.has(t,s)&&b(n[s],t[s],r,e)););}return r.pop(),e.pop(),f};h.isEqual=function(n,t){return b(n,t,[],[])},h.isEmpty=function(n){if(null==n)return!0;if(h.isArray(n)||h.isString(n)||h.isArguments(n))return 0===n.length;for(var t in n)if(h.has(n,t))return!1;return!0},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=f||function(n){return"[object Array]"===l.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){h["is"+n]=function(t){return l.call(t)==="[object "+n+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return h.has(n,"callee")}),"function"!=typeof/./&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&n!==+n},h.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===l.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return n===void 0},h.has=function(n,t){return null!=n&&c.call(n,t)},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(n){return function(t){return t[n]}},h.matches=function(n){var t=h.pairs(n),r=t.length;return function(n){if(null==n)return!r;n=new Object(n);for(var e=0;r>e;e++){var u=t[e],i=u[0];if(u[1]!==n[i]||!(i in n))return!1}return!0}},h.times=function(n,t,r){var e=Array(Math.max(0,n));t=g(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=h.invert(_),j=function(n){var t=function(t){return n[t]},r="(?:"+h.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};h.escape=j(_),h.unescape=j(w),h.result=function(n,t){if(null==n)return void 0;var r=n[t];return h.isFunction(r)?n[t]():r};var x=0;h.uniqueId=function(n){var t=++x+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,F=function(n){return"\\"+k[n]};h.template=function(n,t,r){!t&&r&&(t=r),t=h.defaults({},t,h.templateSettings);var e=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,a,o){return i+=n.slice(u,o).replace(O,F),u=o+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(t.variable||"obj","_",i)}catch(o){throw o.source=i,o}var l=function(n){return a.call(this,n,h)},c=t.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},h.chain=function(n){var t=h(n);return t._chain=!0,t};var E=function(n){return this._chain?h(n).chain():n};h.mixin=function(n){h.each(h.functions(n),function(t){var r=h[t]=n[t];h.prototype[t]=function(){var n=[this._wrapped];return i.apply(n,arguments),E.call(this,r.apply(h,n))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],E.call(this,r)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}).call(this);

// Backbone.js 0.9.2

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org
(function(){var l=this,y=l.Backbone,z=Array.prototype.slice,A=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:l.Backbone={};g.VERSION="0.9.2";var f=l._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var i=l.jQuery||l.Zepto||l.ender;g.setDomLibrary=function(a){i=a};g.noConflict=function(){l.Backbone=y;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var p=/\s+/,k=g.Events={on:function(a,b,c){var d,e,f,g,j;if(!b)return this;a=a.split(p);for(d=this._callbacks||(this._callbacks=
{});e=a.shift();)f=(j=d[e])?j.tail:{},f.next=g={},f.context=c,f.callback=b,d[e]={tail:g,next:j?j.next:f};return this},off:function(a,b,c){var d,e,h,g,j,q;if(e=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;for(a=a?a.split(p):f.keys(e);d=a.shift();)if(h=e[d],delete e[d],h&&(b||c))for(g=h.tail;(h=h.next)!==g;)if(j=h.callback,q=h.context,b&&j!==b||c&&q!==c)this.on(d,j,q);return this}},trigger:function(a){var b,c,d,e,f,g;if(!(d=this._callbacks))return this;f=d.all;a=a.split(p);for(g=
z.call(arguments,1);b=a.shift();){if(c=d[b])for(e=c.tail;(c=c.next)!==e;)c.callback.apply(c.context||this,g);if(c=f){e=c.tail;for(b=[b].concat(g);(c=c.next)!==e;)c.callback.apply(c.context||this,b)}}return this}};k.bind=k.on;k.unbind=k.off;var o=g.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=n(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(o.prototype,k,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=f.escape(null==
b?"":""+b)},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof o&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=c.changes={},h=this.attributes,g=this._escapedAttributes,j=this._previousAttributes||{};for(e in d){a=d[e];if(!f.isEqual(h[e],a)||c.unset&&f.has(h,e))delete g[e],(c.silent?this._silent:
b)[e]=!0;c.unset?delete h[e]:h[e]=a;!f.isEqual(j[e],a)||f.has(h,e)!=f.has(j,e)?(this.changed[e]=a,c.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}c.silent||this.change(c);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};
a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},save:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c=c?f.clone(c):{};if(c.wait){if(!this._validate(d,c))return!1;e=f.clone(this.attributes)}a=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?a:c))return!1;var h=this,i=c.success;c.success=function(a,b,e){b=h.parse(a,e);if(c.wait){delete c.wait;b=f.extend(d||{},b)}if(!h.set(b,c))return false;i?i(h,a):h.trigger("sync",h,a,c)};c.error=g.wrapError(c.error,
h,c);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,c);c.wait&&this.set(e,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d(),!1;a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=g.wrapError(a.error,b,a);var e=(this.sync||g.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=n(this,"urlRoot")||n(this.collection,"url")||t();
return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=f.extend({},a.changes,this._silent);this._silent={};for(c in d)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});var r=g.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(r.prototype,k,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var c,d,e,g,i,j={},k={},l=[];b||(b={});a=f.isArray(a)?a.slice():[a];c=0;for(d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");g=e.cid;i=e.id;j[g]||this._byCid[g]||null!=i&&(k[i]||this._byId[i])?
l.push(c):j[g]=k[i]=e}for(c=l.length;c--;)a.splice(l[c],1);c=0;for(d=a.length;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=e.id&&(this._byId[e.id]=e);this.length+=d;A.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;c=0;for(d=this.models.length;c<d;c++)if(j[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?
a.slice():[a];c=0;for(d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},b));return a},
shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return f.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,
e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof o?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){r.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});var v=g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},F=/^(\S+)\s*(.*)$/,w="model,collection,el,id,attributes,className,tagName".split(",");
f.extend(v.prototype,k,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&i(a).attr(b);c&&i(a).html(c);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof i?a:i(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=n(this,"events"))){this.undelegateEvents();
for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(F),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=w.length;b<c;b++){var d=w[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var a=n(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});o.extend=r.extend=v.extend=function(a,b){var c=G(this,a,b);c.extend=this.extend;return c};var H={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=H[a];c||(c={});var e={type:d,dataType:"json"};c.url||(e.url=n(b,"url")||t());if(!c.data&&b&&("create"==a||"update"==a))e.contentType="application/json",
e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return i.ajax(f.extend(e,c))};g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var x=function(){},G=function(a,
b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};f.extend(d,a);x.prototype=a.prototype;d.prototype=new x;b&&f.extend(d.prototype,b);c&&f.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},n=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},t=function(){throw Error('A "url" property or function must be specified');}}).call(this);

['width','height'].forEach(function(dimension){var offset,Dimension=dimension.replace(/./,function(m){return m[0].toUpperCase()});$.fn['outer'+Dimension]=function(margin){var elem=this;if(elem){var size=elem[dimension]();var sides={'width':['left','right'],'height':['top','bottom']};sides[dimension].forEach(function(side){if(margin)size+=parseInt(elem.css('margin-'+side),10);});return size;}else{return null;}};});$.fn['end']=function(){return this.prevObject||$();};
(function($){var data={},dataAttr=$.fn.data,camelize=$.camelCase,exp=$.expando='Zepto'+(+new Date())
function getData(node,name){var id=node[exp],store=id&&data[id]
if(name===undefined)return store||setData(node)
else{if(store){if(name in store)return store[name]
var camelName=camelize(name)
if(camelName in store)return store[camelName]}
return dataAttr.call($(node),name)}}
function setData(node,name,value){var id=node[exp]||(node[exp]=++$.uuid),store=data[id]||(data[id]=attributeData(node))
if(name!==undefined)store[camelize(name)]=value
return store}
function attributeData(node){var store={}
$.each(node.attributes,function(i,attr){if(attr.name.indexOf('data-')==0)
store[camelize(attr.name.replace('data-',''))]=$.zepto.deserializeValue(attr.value)})
return store}
$.fn.data=function(name,value){return value===undefined?$.isPlainObject(name)?this.each(function(i,node){$.each(name,function(key,value){setData(node,key,value)})}):this.length==0?undefined:getData(this[0],name):this.each(function(){setData(this,name,value)})}
$.fn.removeData=function(names){if(typeof names=='string')names=names.split(/\s+/)
return this.each(function(){var id=this[exp],store=id&&data[id]
if(store)$.each(names,function(){delete store[camelize(this)]})})}})(Zepto);
(function($){var touch={},touchTimeout,tapTimeout,swipeTimeout,longTapTimeout,longTapDelay=750,gesture
function swipeDirection(x1,x2,y1,y2){return Math.abs(x1-x2)>=Math.abs(y1-y2)?(x1-x2>0?'Left':'Right'):(y1-y2>0?'Up':'Down')}
function longTap(){longTapTimeout=null
if(touch.last){touch.el.trigger('longTap')
touch={}}}
function cancelLongTap(){if(longTapTimeout)clearTimeout(longTapTimeout)
longTapTimeout=null}
function cancelAll(){if(touchTimeout)clearTimeout(touchTimeout)
if(tapTimeout)clearTimeout(tapTimeout)
if(swipeTimeout)clearTimeout(swipeTimeout)
if(longTapTimeout)clearTimeout(longTapTimeout)
touchTimeout=tapTimeout=swipeTimeout=longTapTimeout=null
touch={}}
function cancelEvent(event)
{event=event||window.event;if(event.preventDefault){event.preventDefault();event.stopPropagation();}else{event.returnValue=false;event.cancelBubble=true;}}
function isPrimaryTouch(event){return(event.pointerType=='touch'||event.pointerType==event.MSPOINTER_TYPE_TOUCH)&&event.isPrimary}
function isPointerEventType(e,type){return(e.type=='pointer'+type||e.type.toLowerCase()=='mspointer'+type)}
$.fn.registerTouch=function(){var now,delta,deltaX=0,deltaY=0,firstTouch,_isPointerType
if('MSGesture'in window){gesture=new MSGesture()
gesture.target=this[0];}
this.bind('MSGestureEnd',function(e){var swipeDirectionFromVelocity=e.velocityX>1?'Right':e.velocityX<-1?'Left':e.velocityY>1?'Down':e.velocityY<-1?'Up':null;if(swipeDirectionFromVelocity){touch.el.trigger('swipe')
touch.el.trigger('swipe'+swipeDirectionFromVelocity)}}).on('touchstart MSPointerDown pointerdown',function(e){if((_isPointerType=isPointerEventType(e,'down'))&&!isPrimaryTouch(e))return
firstTouch=_isPointerType?e:e.touches[0]
if(e.touches&&e.touches.length===1&&touch.x2){touch.x2=undefined
touch.y2=undefined}
now=Date.now()
delta=now-(touch.last||now)
touch.el=$('tagName'in firstTouch.target?firstTouch.target:firstTouch.target.parentNode)
touchTimeout&&clearTimeout(touchTimeout)
touch.x1=firstTouch.pageX
touch.y1=firstTouch.pageY
if(delta>0&&delta<=250)touch.isDoubleTap=true
touch.last=now
longTapTimeout=setTimeout(longTap,longTapDelay)
if(gesture&&_isPointerType)gesture.addPointer(e.pointerId);}).on('touchmove MSPointerMove pointermove',function(e){if((_isPointerType=isPointerEventType(e,'move'))&&!isPrimaryTouch(e))return
firstTouch=_isPointerType?e:e.touches[0]
cancelLongTap()
touch.x2=firstTouch.pageX
touch.y2=firstTouch.pageY
var hDistance=Math.abs(touch.x1-touch.x2)
deltaX+=hDistance
deltaY+=Math.abs(touch.y1-touch.y2)
if(hDistance>20){var event=$.Event('drag')
event.distance=hDistance
event.direction=(touch.x1>touch.x2)?"left":"right"
touch.el.trigger(event)
cancelEvent(e);}}).on('touchend MSPointerUp pointerup',function(e){if((_isPointerType=isPointerEventType(e,'up'))&&!isPrimaryTouch(e))return
cancelLongTap()
var event=$.Event('dragend')
event.distance=touch.x1-touch.x2;event.direction=(touch.x1>touch.x2)?"left":"right"
touch.el.trigger(event)
if((touch.x2&&Math.abs(touch.x1-touch.x2)>30)||(touch.y2&&Math.abs(touch.y1-touch.y2)>30))
swipeTimeout=setTimeout(function(){touch.el.trigger('swipe')
touch.el.trigger('swipe'+(swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2)))
touch={}},0)
else if('last'in touch)
if(deltaX<30&&deltaY<30){tapTimeout=setTimeout(function(){var event=$.Event('tap')
event.cancelTouch=cancelAll
touch.el.trigger(event)
if(touch.isDoubleTap){if(touch.el)touch.el.trigger('doubleTap')
touch={}}
else{touchTimeout=setTimeout(function(){touchTimeout=null
if(touch.el)touch.el.trigger('singleTap')
touch={}},250)}},0)}else{touch={}}
deltaX=deltaY=0}).on('touchcancel MSPointerCancel pointercancel',cancelAll)
$(window).on('scroll',cancelAll)};['drag','dragend','swipe','swipeLeft','swipeRight','swipeUp','swipeDown','doubleTap','tap','singleTap','longTap'].forEach(function(eventName){$.fn[eventName]=function(callback){return this.on(eventName,callback)}})})(Zepto);
var IV;(function(IV){var AdProgressReporter=(function(){function AdProgressReporter(irollId,reporter,customMetrics,trackingEventCallback){this.irollId=irollId;this.reporter=reporter;this.customMetrics=customMetrics;this.trackingEventCallback=trackingEventCallback;this.playReported=false;}
AdProgressReporter.prototype.startReporting=function(playCallback){var _this=this;var completeCallback=_.once(function(){_this.reportAdComplete();});this.playCallback=function(){_this.playReported=true;playCallback();};IV.Events.on(this.irollId+":ad_play",_.once(function(forceImmediateImpression){if(typeof forceImmediateImpression==="undefined"){forceImmediateImpression=false;}
if(forceImmediateImpression){_this.reportAdPlay();}
else{_this.waitForTimeUpdateBeforeImpression(function(){_this.reportAdPlay();});}}));IV.Events.on(this.irollId+":video_videoPassed25",_.once(function(){_this.reportAdFirstQuartile();}));IV.Events.on(this.irollId+":video_videoPassed50",_.once(function(){_this.reportAdMidpoint();}));IV.Events.on(this.irollId+":video_videoPassed75",_.once(function(){_this.reportAdThirdQuartile();}));["video_ended","ad_ended"].forEach(function(eventName){IV.Events.on(_this.irollId+":"+eventName,completeCallback);});IV.Events.on(this.irollId+":video_videoPassedCustomPoint",function(){_this.customMetrics.forEach(function(url){_this.reporter.submit3rdPartyTracking([{data:url,type:IV.ThirdPartyTrackingReporter.URL_TRACKING_TYPE}]);});});};AdProgressReporter.prototype.waitForTimeUpdateBeforeImpression=function(callback){var _this=this;var onTimeUpdate=function(data){if(typeof data.currentTime!=="undefined"&&data.currentTime>0){IV.Events.off(_this.irollId+":video_timeupdate",onTimeUpdate);callback();}};IV.Events.on(this.irollId+":video_timeupdate",onTimeUpdate);};AdProgressReporter.prototype.reportAdPlay=function(){IV.Events.trigger(this.irollId+":videoStarted");IV.Events.trigger(this.irollId+":ad_started");this.reporter.submit({action:"play"});this.trackingEventCallback("playingStart");this.playCallback();};AdProgressReporter.prototype.reportAdFirstQuartile=function(){this.reporter.submit({action:"vpoint",event_value:25,event_id:"percent"});this.trackingEventCallback("playingFirstQuartile");};AdProgressReporter.prototype.reportAdMidpoint=function(){this.reporter.submit({action:"vpoint",event_value:50,event_id:"percent"});this.trackingEventCallback("playingMidpoint");};AdProgressReporter.prototype.reportAdThirdQuartile=function(){this.reporter.submit({action:"vpoint",event_value:75,event_id:"percent"});this.trackingEventCallback("playingThirdQuartile");};AdProgressReporter.prototype.reportAdComplete=function(){this.reporter.submit({action:"vpoint",event_value:100,event_id:"percent"});this.trackingEventCallback("playingComplete");};return AdProgressReporter;})();IV.AdProgressReporter=AdProgressReporter;})(IV||(IV={}));
var IV;(function(IV){var CanvasAppender=(function(){function CanvasAppender(core){this.core=core;}
CanvasAppender.prototype.getSize=function(){var externalInterface=this.core.get("interface");if(externalInterface!==null&&_.isFunction(externalInterface.getAdSize)){return externalInterface.getAdSize();}
else{return{"width":$(window).width()||-1,"height":$(window).height()||-1};}};CanvasAppender.prototype.setContainer=function(mainContainer){this.mainContainer=mainContainer;};CanvasAppender.prototype.appendToContainer=function(elem){this.mainContainer.appendChild(elem);};return CanvasAppender;})();IV.CanvasAppender=CanvasAppender;})(IV||(IV={}));
var IV;(function(IV){var ClickthruRedirectHelper=(function(){function ClickthruRedirectHelper(adConfig,reporter,getPlayStartTime){this.dtsClickthruUrl=null;this.dtsClickthruUrl=""+adConfig.dtsUrl+ClickthruRedirectHelper.DTS_CLICKTHRU_PATH+"?";this.reporter=reporter;this.getPlayStartTime=getPlayStartTime;}
Object.defineProperty(ClickthruRedirectHelper,"DTS_CLICKTHRU_PATH",{get:function(){return"/clktru/action/htmlclk";},enumerable:true,configurable:true});;Object.defineProperty(ClickthruRedirectHelper,"CLICKTHRU_ACTION",{get:function(){return"clktru";},enumerable:true,configurable:true});;ClickthruRedirectHelper.prototype.redirect=function(clickthruUrl,label){var options=label?{event_id:label}:{};return this.wrapUrlWithDts(clickthruUrl,options);};ClickthruRedirectHelper.prototype.wrapUrlWithDts=function(clickthruUrl,options){var template=_.template("<%= reportUrl %>&click=<%= clickthruUrl %>");options=this.overrideChildVideoOptions(options);var reportData=this.reporter.prepareReportData(options);reportData.action=ClickthruRedirectHelper.CLICKTHRU_ACTION;reportData.relative_time=_.now()-this.getPlayStartTime();var reportUrl=this.reporter.addReportDataToReportUrl(reportData,this.dtsClickthruUrl);clickthruUrl=encodeURIComponent(clickthruUrl);return template({reportUrl:reportUrl,clickthruUrl:clickthruUrl});};ClickthruRedirectHelper.prototype.overrideChildVideoOptions=function(options){var childVideoService=this.reporter.get("childVideoService");if(childVideoService.childVideoPlaying()){var selectedChildVideoData=childVideoService.getChildVideoData();return _.extend(options,{video_id:selectedChildVideoData.videoId,placement_hash:selectedChildVideoData.placementHash,project_state:selectedChildVideoData.projectState});}
return options;};return ClickthruRedirectHelper;})();IV.ClickthruRedirectHelper=ClickthruRedirectHelper;})(IV||(IV={}));
var IV;(function(IV){var ConsoleLogUtil=(function(){function ConsoleLogUtil(){}
ConsoleLogUtil.prototype.log=function(message){console.log(message);};return ConsoleLogUtil;})();IV.ConsoleLogUtil=ConsoleLogUtil;})(IV||(IV={}));
var IV;(function(IV){var CurrentScriptPopulator=(function(){function CurrentScriptPopulator(){}
CurrentScriptPopulator.populateCurrentScript=function(contextDoc){IV._currentScript=this.findCurrentScript(contextDoc)||this.findLastScript(contextDoc)||this.findScriptByDomain(contextDoc);};CurrentScriptPopulator.findCurrentScript=function(contextDoc){return contextDoc["currentScript"];};CurrentScriptPopulator.findLastScript=function(contextDoc){var scripts=contextDoc.getElementsByTagName("script");if(scripts&&scripts.length>0){var script=scripts[scripts.length-1];if(CurrentScriptPopulator.hasRelevantDomain(script)){return script;}}
return null;};CurrentScriptPopulator.findScriptByDomain=function(contextDoc){var scripts=contextDoc.getElementsByTagName("script");if(scripts){for(var idx=0;idx<scripts.length;idx++){var script=scripts[idx];if(CurrentScriptPopulator.hasRelevantDomain(script)){return script;}}}
return null;};CurrentScriptPopulator.hasRelevantDomain=function(script){var domains=[IV.baseData.staticDomain,IV.baseData.securedStaticDomain].filter(function(domain){return!!domain;});return domains.some(function(domain){return script.src&&script.src.indexOf(domain)>=0;});};return CurrentScriptPopulator;})();IV.CurrentScriptPopulator=CurrentScriptPopulator;})(IV||(IV={}));
var IV;(function(IV){var DataInjector=(function(){function DataInjector(qstRdr,tool){if(qstRdr===void 0){qstRdr=new IV.QueryStringReader();}
if(tool===void 0){tool=IV.toolkit;}
this.tool=tool;this.qstRdr=qstRdr;}
DataInjector.prototype.injectCustomParams=function(core){var htmldata=DataInjector.HTML_DATA;var ecp=DataInjector.EXTERNAL_CUSTOM_PARAMETERS;var newData=core.get("data")||{};newData[htmldata]=newData[htmldata]||{};newData[htmldata][ecp]=this.getCustomParams();core.set("data",newData);};DataInjector.prototype.getCustomParams=function(){var ret=this.qstRdr.getExternalCustomParams(IV._currentScript,document.location.search);return ret.hasOwnProperty("ivc")?this.tool.parseQueryString(ret["ivc"]):ret;};DataInjector.HTML_DATA="html-custom-data";DataInjector.EXTERNAL_CUSTOM_PARAMETERS="EXTERNAL_CUSTOM_PARAMETERS";return DataInjector;})();IV.DataInjector=DataInjector;})(IV||(IV={}));
var IV;(function(IV){var FeatureBitsResolver=(function(){function FeatureBitsResolver(){}
Object.defineProperty(FeatureBitsResolver,"FEATURE_BITS_KEY",{get:function(){return"featureBits";},enumerable:true,configurable:true});Object.defineProperty(FeatureBitsResolver,"FEATURE_NAMES",{get:function(){return{VPAID_CLKTRU_HANDLE_BY_INNOVID_FOR_NON_IN_APP:"vpaid_clktru_handle_by_innovid_for_non_in_app",VPAID_VIEWABILITY_GEO_FRIENDLY_IFRAME:"vpaid_viewability_geo_friendly_iframe"};},enumerable:true,configurable:true});FeatureBitsResolver.isEnabled=function(name){var featureBits=IV.baseData[FeatureBitsResolver.FEATURE_BITS_KEY];return!!featureBits&&featureBits[name];};return FeatureBitsResolver;})();IV.FeatureBitsResolver=FeatureBitsResolver;})(IV||(IV={}));
var IV;(function(IV){var HtmlTextTagInjector=(function(){function HtmlTextTagInjector(iframeInjector){this.iframeInjector=iframeInjector;}
HtmlTextTagInjector.prototype.injectTextTagIntoIframe=function(textTag){var injectedIframe=this.iframeInjector.injectIframeIntoDoc(document);var ifrDoc=injectedIframe.contentWindow.document;this.writeTextTagInsideIframe(ifrDoc,textTag);};HtmlTextTagInjector.prototype.writeTextTagInsideIframe=function(ifrDoc,textTag){var _this=this;textTag=this.trimStratEndWhiteSpaces(textTag);textTag=this.addBackslashBeforeApostropheMark(textTag);textTag=this.splitScriptTag(textTag);var iframeHTML="<html><body marginwidth='0' marginheight='0' topmargin='0' leftmargin='0'><scr"+"ipt>";var codeLines=this.splitTextTagIntoLines(textTag);codeLines.forEach(function(line){iframeHTML+="document.write('"+_this.trimStratEndWhiteSpaces(line)+"');\n";});iframeHTML+="</scr"+"ipt></body></html>";ifrDoc.open().write(""+iframeHTML);ifrDoc.close();};HtmlTextTagInjector.prototype.trimStratEndWhiteSpaces=function(text){return text.replace(/^\s+|\s+$/g,"");};HtmlTextTagInjector.prototype.addBackslashBeforeApostropheMark=function(text){return text.replace(/'/ig,"\\'");};HtmlTextTagInjector.prototype.splitScriptTag=function(text){text=text.replace(/<script/ig,"<scr\' + \'ipt");return text.replace(/\/script>/ig,"/scr\' + \'ipt>");};HtmlTextTagInjector.prototype.splitTextTagIntoLines=function(text){var tempCode=text.replace(/(\r\n|\n|\r)/gm,"!!NEWLINE!!");return tempCode.split("!!NEWLINE!!");};return HtmlTextTagInjector;})();IV.HtmlTextTagInjector=HtmlTextTagInjector;})(IV||(IV={}));
var IV;(function(IV){var InAppDetector=(function(){function InAppDetector(deviceInfo){this.deviceInfo=deviceInfo;this.isInApp=this.isInAppMem();}
Object.defineProperty(InAppDetector,"IN_APP_REGEXP_LIST",{get:function(){return[/(iPhone|iPod|iPad).+AppleWebKit.*Mobile(?!.*Safari)/i,/\(.*Android.*\).+AppleWebKit.*Version\/\d/i,/^Dalvik/i,/ANVSDK/i,/CFNetwork.*Darwin/i,/^com\..*?Android/i,/FreeWheelAdManager/i,/LiveRailSDK/i,/TransperaSDK/i,/AerServSDK/i,/Anvato Android SDK/i,/Vungle/i,/Mozilla\/.*Android.*; wv\) AppleWebKit/i,/Mozilla\/.*Android.*Gecko\) Version\/\d+\.\d+/i,/ExoPlayerLib/i];},enumerable:true,configurable:true});InAppDetector.prototype.isInAppMem=function(){var _this=this;return _.memoize(function(){return!_this.deviceInfo.isDesktop()&&(_this.hasDeviceId()||_this.hasInAppUserAgent());});};InAppDetector.prototype.hasDeviceId=function(){return!!this.deviceInfo.getDeviceIdFromRequest();};InAppDetector.prototype.hasInAppUserAgent=function(){var userAgent=this.deviceInfo.getNavigatorUserAgent();return InAppDetector.IN_APP_REGEXP_LIST.some(function(regexp){return regexp.test(userAgent);});};return InAppDetector;})();IV.InAppDetector=InAppDetector;})(IV||(IV={}));
var IV;(function(IV){(function(Action){Action[Action["INVPLY"]=0]="INVPLY";Action[Action["INVPT"]=1]="INVPT";})(IV.Action||(IV.Action={}));var Action=IV.Action;var LOG_ACTION_FORMAT=">>>> HTML Internal Video ";var InUnitVideoQuartileActionUtil=(function(){function InUnitVideoQuartileActionUtil(){}
InUnitVideoQuartileActionUtil.toValue=function(action){switch(action){case Action.INVPLY:return"invply";case Action.INVPT:return"invpt";}};InUnitVideoQuartileActionUtil.toMessage=function(action,eventId,eventValue){switch(action){case Action.INVPLY:return LOG_ACTION_FORMAT+"Play: "+eventId;case Action.INVPT:return LOG_ACTION_FORMAT+eventValue+"%: "+eventId;}};return InUnitVideoQuartileActionUtil;})();IV.InUnitVideoQuartileActionUtil=InUnitVideoQuartileActionUtil;})(IV||(IV={}));
var IV;(function(IV){var InnovidLogger=(function(){function InnovidLogger(debugMode,toolKit){if(toolKit===void 0){toolKit=IV.toolkit;}
this.debugMode=debugMode;this.toolKit=toolKit;}
Object.defineProperty(InnovidLogger,"DEBUG_MODE",{get:function(){return"[INNOVID.DEBUG]";},enumerable:true,configurable:true});InnovidLogger.prototype.debug=function(){var valuesToWrite=[];for(var _i=0;_i<arguments.length;_i++){valuesToWrite[_i-0]=arguments[_i];}
if(this.debugMode){var now=this.toolKit.generateDate();var message="["+now+"]"+InnovidLogger.DEBUG_MODE+" "+valuesToWrite.join(" ");console.log(message);}};return InnovidLogger;})();IV.InnovidLogger=InnovidLogger;})(IV||(IV={}));
var IV;(function(IV){var MacroMapper=(function(){function MacroMapper(data,htmlData,ecp){if(data===void 0){data={};}
if(htmlData===void 0){htmlData=IV.DataInjector.HTML_DATA;}
if(ecp===void 0){ecp=IV.DataInjector.EXTERNAL_CUSTOM_PARAMETERS;}
var customData=data[htmlData]||{};this.publisherValues=customData[ecp]||{};}
Object.defineProperty(MacroMapper,"CDATA_OPEN",{get:function(){return"<![CDATA[";},enumerable:true,configurable:true});Object.defineProperty(MacroMapper,"CDATA_CLOSE",{get:function(){return"]]>";},enumerable:true,configurable:true});Object.defineProperty(MacroMapper,"CDATA_MACRO_OPEN",{get:function(){return /(\$\$__CDATA__\$\$)/;},enumerable:true,configurable:true});Object.defineProperty(MacroMapper,"CDATA_MACRO_END",{get:function(){return /(\$\$__CDATA_CLOSE__\$\$)/;},enumerable:true,configurable:true});MacroMapper.prototype.expandSessionId=function(trackingData,sessionId){if(trackingData===void 0){trackingData="";}
return this.expandStaticMacro(/(\{iv_sessionid\})/ig,sessionId,trackingData);};MacroMapper.prototype.expandTimeStamp=function(trackingData){if(trackingData===void 0){trackingData="";}
return this.expandStaticMacro(/(\[timestamp\])/ig,(new Date().getTime()).toString(),trackingData);};MacroMapper.prototype.expandAll=function(pixel){var macrosInPixel=_.uniq(pixel.match(/(%257B|{|%7B)(ivc_|iv_geo_)\w+(%257D|}|%7D)/ig));return this.foundMatches(macrosInPixel)?this.expand(macrosInPixel,pixel):pixel;};MacroMapper.prototype.fixCDATA=function(blob){var fixedCdataOpen=this.expandStaticMacro(MacroMapper.CDATA_MACRO_OPEN,MacroMapper.CDATA_OPEN,blob);return this.expandStaticMacro(MacroMapper.CDATA_MACRO_END,MacroMapper.CDATA_CLOSE,fixedCdataOpen);};MacroMapper.prototype.expandStaticMacro=function(pattern,replace,reportUrl){if(reportUrl===void 0){reportUrl="";}
reportUrl=_.isArray(reportUrl)?IV.toolkit.trim(reportUrl.shift()||""):IV.toolkit.trim(reportUrl);return pattern.exec(reportUrl)?reportUrl.replace(pattern,replace):reportUrl;};MacroMapper.prototype.encode=function(value,macro){var encodeTwice=/(%7B)(ivc_|iv_geo_)\w+(%7D)/ig,encodeOnce=/({)(ivc_|iv_geo_)\w+(})/ig;return encodeOnce.test(macro)?encodeURIComponent(value):encodeTwice.test(macro)?encodeURIComponent(encodeURIComponent(value)):encodeURIComponent(encodeURIComponent(encodeURIComponent(value)));};MacroMapper.prototype.expand=function(macrosInPixel,pixel){var _this=this;macrosInPixel.forEach(function(macro){var key=macro.replace(/{|}|%7B|%7D|%257B|%257D/ig,"");pixel=_this.publisherValues.hasOwnProperty(key)?pixel.replace(macro,_this.encode(_this.publisherValues[key],macro)):pixel.replace(macro,"");});return pixel;};MacroMapper.prototype.foundMatches=function(arr){return arr&&arr.length>0;};return MacroMapper;})();IV.MacroMapper=MacroMapper;})(IV||(IV={}));
var IV;(function(IV){var SkipAdHandler=(function(){function SkipAdHandler(iroll){this.iroll=iroll;}
SkipAdHandler.prototype.skipAd=function(){IV.Events.trigger(this.iroll.get('id')+":skip");var reporter=this.iroll.report;reporter.submit({action:'skip',relative_time:(new Date().getTime()-this.iroll.get('playStartTime'))});IV.Events.trigger(this.iroll.get('id')+':close');};return SkipAdHandler;})();IV.SkipAdHandler=SkipAdHandler;})(IV||(IV={}));
var IV;(function(IV){var ThirdPartyTrackingReporter=(function(){function ThirdPartyTrackingReporter(htmlTagInjector,mapper){this.mapper=mapper;this.htmlTagInjector=htmlTagInjector;}
Object.defineProperty(ThirdPartyTrackingReporter,"URL_TRACKING_TYPE",{get:function(){return"url-tracking";},enumerable:true,configurable:true});Object.defineProperty(ThirdPartyTrackingReporter,"HTML_TRACKING_TYPE",{get:function(){return"html-tracking";},enumerable:true,configurable:true});Object.defineProperty(ThirdPartyTrackingReporter,"INJECT_HTML_TRACKING_ERROR",{get:function(){return"inject-html-tracking-tag-error";},enumerable:true,configurable:true});Object.defineProperty(ThirdPartyTrackingReporter,"THIRD_PARTY_TRACKING_IFRAME_ID",{get:function(){return"3rdparty-tracking";},enumerable:true,configurable:true});ThirdPartyTrackingReporter.prototype.report=function(trackingData,trackingType,sessionId,firePixelCb,reportLogCb){trackingData=this.mapper.expandAll(this.mapper.expandTimeStamp(this.mapper.expandSessionId(trackingData,sessionId)));if(trackingType===ThirdPartyTrackingReporter.URL_TRACKING_TYPE){this.firePixel(trackingData,firePixelCb);}
else if(trackingType===ThirdPartyTrackingReporter.HTML_TRACKING_TYPE){this.injectHtmlTextTag(trackingData,reportLogCb);}};ThirdPartyTrackingReporter.prototype.firePixel=function(trackingData,firePixelCb){firePixelCb(trackingData);};ThirdPartyTrackingReporter.prototype.injectHtmlTextTag=function(trackingData,reportLogCb){try{this.htmlTagInjector.injectTextTagIntoIframe(this.mapper.fixCDATA(trackingData));}
catch(e){reportLogCb({event_id:ThirdPartyTrackingReporter.INJECT_HTML_TRACKING_ERROR,event_value:e.message+": "+trackingData});}};return ThirdPartyTrackingReporter;})();IV.ThirdPartyTrackingReporter=ThirdPartyTrackingReporter;})(IV||(IV={}));
var IV;(function(IV){var VideoClickBehaviour;(function(VideoClickBehaviour){VideoClickBehaviour[VideoClickBehaviour["CLICKTHRU"]=0]="CLICKTHRU";VideoClickBehaviour[VideoClickBehaviour["OPEN_MICROSITE"]=1]="OPEN_MICROSITE";VideoClickBehaviour[VideoClickBehaviour["DO_NOTHING"]=2]="DO_NOTHING";})(VideoClickBehaviour||(VideoClickBehaviour={}));var VideoClickHandler=(function(){function VideoClickHandler(core,adConfig,eventBus,mapper){this.core=core;this.adConfig=adConfig;this.eventBus=eventBus;this.mapper=mapper;}
Object.defineProperty(VideoClickHandler,"CLICKTHRU_MAIN_LABEL",{get:function(){return"main";},enumerable:true,configurable:true});;VideoClickHandler.prototype.handleClick=function(ev){this.core.report.submit({action:"click",event_id:"position",event_value:ev.pageX+"x"+ev.pageY,relative_time:(_.now()-this.core.get("playStartTime"))});var clickBehaviour=this.detectClickBehaviour();if(clickBehaviour===VideoClickBehaviour.OPEN_MICROSITE){this.handleMicrositeBehaviour();}
else if(clickBehaviour===VideoClickBehaviour.CLICKTHRU){this.handleClickthruBehaviour();ev.stopPropagation();ev.preventDefault();}
if(clickBehaviour!==VideoClickBehaviour.OPEN_MICROSITE){this.logMainClickthruEvent();}};VideoClickHandler.prototype.detectClickBehaviour=function(){var clickBehaviour=VideoClickBehaviour.DO_NOTHING;var data=this.adConfig.app_data;var toolbar=data["toolbar"];var isMicrosite=toolbar&&toolbar.data.engagementType==="minisite";if(isMicrosite&&(!toolbar.data.clickBehavior||toolbar.data.clickBehavior==="open-microsite")){clickBehaviour=VideoClickBehaviour.OPEN_MICROSITE;}
else if(data["video-clicks"]&&data["video-clicks"]["click-thru-url"]){clickBehaviour=VideoClickBehaviour.CLICKTHRU;}
return clickBehaviour;};VideoClickHandler.prototype.handleMicrositeBehaviour=function(){this.eventBus.trigger("openMicrosite",true);};VideoClickHandler.prototype.handleClickthruBehaviour=function(){var clickthruUrl=this.adConfig.app_data["video-clicks"]["click-thru-url"];var videoPlayer=this.core.get("videoPlayer");videoPlayer.pause();this.core.report.clickthru(VideoClickHandler.CLICKTHRU_MAIN_LABEL);var coreId=this.core.get("id");this.eventBus.trigger(coreId+":userClick");this.reportTrackingUrl();this.core.windowOpen(clickthruUrl,VideoClickHandler.CLICKTHRU_MAIN_LABEL);};VideoClickHandler.prototype.reportTrackingUrl=function(){var _this=this;var data=this.adConfig.app_data;if(data["placement-config"]&&data["placement-config"]["hotspot-clicks"]){data["placement-config"]["hotspot-clicks"].filter(function(hotspot){return hotspot.id===VideoClickHandler.CLICKTHRU_MAIN_LABEL&&_.isArray(hotspot.tracking);}).forEach(function(hotspot){_this.core.report.submit3rdPartyTracking(hotspot.tracking);});}};VideoClickHandler.prototype.logMainClickthruEvent=function(){if(this.core.get("reportEventsToConsole")){console.log(">>>> Main video clickthru");}};return VideoClickHandler;})();IV.VideoClickHandler=VideoClickHandler;})(IV||(IV={}));
var IV;(function(IV){var VideoVolumeHandler=(function(){function VideoVolumeHandler(videoElement){this.videoElement=videoElement;}
VideoVolumeHandler.prototype.onVolumeChange=function(volume){if(this.isVolumeValid(volume)){this.setVideoVolume(volume);}};VideoVolumeHandler.prototype.isVolumeValid=function(volume){var currentVolume=this.videoElement.volume;return typeof volume!=="undefined"&&!isNaN(volume)&&volume>=0&&volume<=1&&currentVolume!==volume;};VideoVolumeHandler.prototype.setVideoVolume=function(volume){if(typeof volume!=="number"){volume=parseFloat(volume);}
this.videoElement.volume=volume;};VideoVolumeHandler.prototype.bindVolumeChangeEvent=function(initialVolume){if(this.isVolumeValid(initialVolume)){this.setVideoVolume(initialVolume);}
var onVolumeChange=this.onVolumeChange;IV.Events.on("volumechange",onVolumeChange,this);};VideoVolumeHandler.prototype.unbindVolumeChangeEvent=function(){var onVolumeChange=this.onVolumeChange;IV.Events.off("volumechange",onVolumeChange);};return VideoVolumeHandler;})();IV.VideoVolumeHandler=VideoVolumeHandler;})(IV||(IV={}));
var IV;(function(IV){var ChildPlacementsTrackingEventDispatcher=(function(){function ChildPlacementsTrackingEventDispatcher(coreId){this.coreId=coreId;}
Object.defineProperty(ChildPlacementsTrackingEventDispatcher,"trackingEventMap",{get:function(){return{"init":"init","play":"playingStart","intrct":"adFirstInteraction","vpoint:25":"playingFirstQuartile","vpoint:50":"playingMidpoint","vpoint:75":"playingThirdQuartile","vpoint:100":"playingComplete"};},enumerable:true,configurable:true});ChildPlacementsTrackingEventDispatcher.prototype.trigger=function(action,eventValue,placementHash){var eventKey=action;if(action==="vpoint"){eventKey+=":"+eventValue;}
if(ChildPlacementsTrackingEventDispatcher.trackingEventMap.hasOwnProperty(eventKey)){IV.Events.trigger(this.coreId+":tracking:child:"+placementHash+":"+ChildPlacementsTrackingEventDispatcher.trackingEventMap[eventKey]);}};return ChildPlacementsTrackingEventDispatcher;})();IV.ChildPlacementsTrackingEventDispatcher=ChildPlacementsTrackingEventDispatcher;})(IV||(IV={}));
var IV;(function(IV){var ChildPlacementsTrackingEventListener=(function(){function ChildPlacementsTrackingEventListener(coreId){this.coreId=coreId;}
ChildPlacementsTrackingEventListener.prototype.start=function(childPlacementsTrackingMap,reporter){var _this=this;var childPlacementHashes=Object.keys(childPlacementsTrackingMap);childPlacementHashes.forEach(function(placementHash){var placementTrackingMap=childPlacementsTrackingMap[placementHash];var trackingEventTypes=Object.keys(placementTrackingMap);trackingEventTypes.forEach(function(trackingEventType){var trackingItems=placementTrackingMap[trackingEventType];IV.Events.on(_this.coreId+":tracking:child:"+placementHash+":"+trackingEventType,function(){return reporter.submit3rdPartyTracking(trackingItems);});});});};return ChildPlacementsTrackingEventListener;})();IV.ChildPlacementsTrackingEventListener=ChildPlacementsTrackingEventListener;})(IV||(IV={}));
var IV;(function(IV){var ChildVideoEventHandler=(function(){function ChildVideoEventHandler(coreId,childVideoService){this.coreId=coreId;this.childVideoService=childVideoService;this.triggerChildInteractEventOnce=_.once(this.triggerChildInteractEvent);}
ChildVideoEventHandler.prototype.handleRollover=function(element){$(element).on("mouseover",this.childAction(this.triggerChildInteractEventOnce));};ChildVideoEventHandler.prototype.bindActionToChildInteractEvent=function(reporter){var _this=this;IV.Events.on(this.coreId+":child:interact",_.once(function(){reporter.submit({action:"intrct"},_this.childVideoService.getChildVideoContext());}));};ChildVideoEventHandler.prototype.triggerChildInteractEvent=function(event,coreId){event.stopPropagation();if(IV.device.isDesktop()){IV.Events.trigger(coreId+":child:interact");}};ChildVideoEventHandler.prototype.childAction=function(action){var _this=this;return function(e){if(_this.childVideoService.childVideoPlaying()){action(e,_this.coreId);}
return false;};};return ChildVideoEventHandler;})();IV.ChildVideoEventHandler=ChildVideoEventHandler;})(IV||(IV={}));
var IV;(function(IV){var ChildVideoService=(function(){function ChildVideoService(){this.manualSelectionProjectState=ChildVideoService.DEFAULT_MANUAL_SELECTION_PROJECT_STATE;this.autoSelectionProjectState=ChildVideoService.DEFAULT_AUTO_SELECTION_PROJECT_STATE;this.populateChildVideoDataOnce=_.once(this.populateChildVideoData);}
Object.defineProperty(ChildVideoService,"MANUAL_SELECTION",{get:function(){return"manual_select_project_state";},enumerable:true,configurable:true});Object.defineProperty(ChildVideoService,"AUTO_SELECTION",{get:function(){return"auto_select_project_state";},enumerable:true,configurable:true});Object.defineProperty(ChildVideoService,"DEFAULT_MANUAL_SELECTION_PROJECT_STATE",{get:function(){return 8;},enumerable:true,configurable:true});Object.defineProperty(ChildVideoService,"DEFAULT_AUTO_SELECTION_PROJECT_STATE",{get:function(){return 10;},enumerable:true,configurable:true});ChildVideoService.prototype.initChildVideoData=function(options,context){this.populateChildVideoDataOnce(options,context);return this.childVideoData;};ChildVideoService.prototype.getChildVideoData=function(){return this.childVideoData;};ChildVideoService.prototype.childVideoPlaying=function(){return _.isObject(this.childVideoData);};ChildVideoService.prototype.getChildVideoContext=function(){return this.childVideoData.context;};ChildVideoService.prototype.setSelectionProjectStates=function(manualSelectionProjectState,autoSelectionProjectState){this.manualSelectionProjectState=manualSelectionProjectState;this.autoSelectionProjectState=autoSelectionProjectState;};ChildVideoService.prototype.populateChildVideoData=function(options,context){this.childVideoData={videoId:options.video_id,placementHash:options.placement_hash,context:context,projectState:this.getChildProjectState(context)};};ChildVideoService.prototype.getChildProjectState=function(context){var childProjectStateMap={};childProjectStateMap[ChildVideoService.MANUAL_SELECTION]=this.manualSelectionProjectState;childProjectStateMap[ChildVideoService.AUTO_SELECTION]=this.autoSelectionProjectState;return childProjectStateMap[context];};return ChildVideoService;})();IV.ChildVideoService=ChildVideoService;})(IV||(IV={}));
(function(SCOPE){SCOPE.ErrorDetector=function(iRoll){var id=iRoll.get('id'),that=this;that.startListener=function(){SCOPE.Events.on(id+':video_error',function(e){var eventValue="";if(e&&(e.target instanceof HTMLMediaElement)){eventValue=e.target.error.code;}
that.trigger('video_error',eventValue);});SCOPE.Events.on(id+':video_source_error',function(e){var eventValue="";if(e&&(e.target instanceof HTMLSourceElement)){eventValue=e.target.parentNode.networkState;that.trigger('video_source_error',eventValue);}});SCOPE.Events.on(id+':video_high_buffering_count',function(count){that.trigger('video_high_buffering_count',count);});SCOPE.Events.on(id+':video_long_buffering_time',function(time){if(!isNaN(time)){that.trigger('video_long_buffering_time',time);}});SCOPE.Events.on(id+":ad_started",function(){var winSize=this.canvas.getSize();if(!winSize.width||!winSize.height){that.trigger('bad_window_size_at_video_start');}
if(this.get('checkForVisibility')){if(this.isHidden()){that.trigger('document_not_visible_at_video_start');}}
var now=_.now();var LATE_IMPRESSION_THRESHOLD_MS=3000;if(now-this.initTimestamp>LATE_IMPRESSION_THRESHOLD_MS){that.trigger('late_impression',LATE_IMPRESSION_THRESHOLD_MS);}
var VERY_LATE_IMPRESSION_THRESHOLD_MS=5000;if(now-this.initTimestamp>VERY_LATE_IMPRESSION_THRESHOLD_MS){that.trigger('very_late_impression',VERY_LATE_IMPRESSION_THRESHOLD_MS);}},iRoll);SCOPE.Events.on(id+':video_started',function(){var good_duration=true;var good_currentTime=true;if(iRoll.get('videoPlayer')){var duration=iRoll.get('videoPlayer').getDuration();var currentTime=iRoll.get('videoPlayer').getCurrentTime();good_duration=_.isNumber(duration)&&isFinite(duration);good_currentTime=_.isNumber(currentTime)&&isFinite(currentTime);var sendErrorReports=[sendDurationErrorReport,sendCurrentTimeErrorReport,sendDurationAndCurrentTimeErrorReport];sendErrorReports.forEach(function(sendErrorReport){sendErrorReport();});}
function sendDurationErrorReport(){if(!good_duration&&good_currentTime){that.trigger('video_bad_properties',"duration: "+duration);}}
function sendCurrentTimeErrorReport(){if(!good_currentTime&&good_duration){that.trigger('video_bad_properties',"currentTime: "+currentTime);}}
function sendDurationAndCurrentTimeErrorReport(){if(!good_duration&&!good_currentTime){that.trigger('video_bad_properties',"duration: "+duration+"; currentTime: "+currentTime);}}});SCOPE.Events.on(id+':container_error',function(message,action){var eventValue="";if(_.isString(action)){eventValue+="(Action:"+action+")";}
if(_.isString(message)){eventValue+="(Message:"+message+")";}
that.trigger('container_error',eventValue);});SCOPE.Events.on(id+':video_videoPassed75',function(){[25,50].forEach(function(vp){if(!iRoll.report.wasPixelLoaded({action:'vpoint',event_value:vp})){that.trigger('vpoint_missing',vp);}});});SCOPE.Events.on(id+":ad_interface_error",function(module,e){var msg=e.message?e.message.substr(0,500):"";that.trigger(module+"_error",msg);});SCOPE.Events.on(id+":video_timeupdate_event_missing",function(){that.trigger("video_timeupdate_event_missing");});SCOPE.Events.on(id+":vpaid_clickthru",function(playerHandles){that.trigger("vpaid_clickthru",playerHandles?"PLAYER_HANDLED":"AD_HANDLED");});SCOPE.Events.on(id+":viewability_iframe_type",function(iframeType){that.trigger("viewability_iframe_type",iframeType);});window.onerror=_.throttle(function(e){if(typeof e==="string"){that.trigger('js_error',e.substring(0,256))}},500);};};_.extend(SCOPE.ErrorDetector.prototype,Backbone.Events);})(IV);
(function(SCOPE){SCOPE.Session=function(config){var sampleRateRec=getSampleRateRecord(config);var debugSampleRateRec=getDebugSampleRateRecord();this.isMonitored=function(){return sampleRateRec.isMonitored;};this.getSampleRate=function(){return sampleRateRec.sampleRate;};this.isDebugEnabled=function(){return debugSampleRateRec.isDebugEnabled;};this.getCreativeSampleRate=function(){return debugSampleRateRec.sampleRate;};function getSampleRateRecord(config){var sampleRate=0,isMonitored=false;if(isPreviewMode()){sampleRate=1;isMonitored=true;}else if(config["error-monitoring-enabled"]){sampleRate=toSampleRate(config["error-monitoring-rate"]||0);isMonitored=flipCoin(sampleRate);}
return{sampleRate:sampleRate,isMonitored:isMonitored};}
function getDebugSampleRateRecord(){var sampleRate=0.01,isDebugEnabled=false;var configSampleRate=SCOPE.baseData.app_data["debug-sample-rate"];if(isPreviewMode()){sampleRate=1;isDebugEnabled=true;}else if(typeof configSampleRate==="number"&&(configSampleRate>=0&&configSampleRate<=100)&&configSampleRate){sampleRate=toSampleRate(SCOPE.baseData.app_data["debug-sample-rate"]);isDebugEnabled=flipCoin(sampleRate);}
return{sampleRate:sampleRate,isDebugEnabled:isDebugEnabled};}
function isPreviewMode(){return(_.isUndefined(config['placement-config'])||config['placement-config']['placement-hash']==="-1");}
function toSampleRate(val){var rate=val|0;return rate/100.0;}
function flipCoin(sampleRate){var rand=Math.random(),result=false;if(rand<sampleRate){result=true;}
return result;}};_.extend(SCOPE.Session.prototype,Backbone.Events);})(IV);
(function(SCOPE){SCOPE.Canvas=function(iroll,canvasAppender){var el=document.createElement("DIV"),defaultFontSize=16,that=this,currentWidth,currentHeight,currentOrientation;el.id="iv-iroll";canvasAppender.appendToContainer(el);iroll.childVideoEventHandler.handleRollover(el);$(el).one('mouseover',"*",function(event){event.stopPropagation();if(SCOPE.device.isDesktop()){SCOPE.Events.trigger(iroll.get('id')+':interact');}});function init(){var adSize=that.getSize();currentWidth=adSize.width;currentHeight=adSize.height;currentOrientation=SCOPE.device.getDeviceOrientation(adSize.width,adSize.height);setInterval(monitorWindowWidth,500);if(typeof $.fn.registerTouch==='function'){$(el).registerTouch();}
$(el).attr("platform-type",SCOPE.device.getPlatformType());$(el).attr("os-type",SCOPE.device.getOSType());addMouseCaptureOverlay();}
function monitorWindowWidth(){var adSize=that.getSize();if(currentWidth!==adSize.width||currentHeight!==adSize.height){currentWidth=adSize.width;currentHeight=adSize.height;SCOPE.Events.trigger('winResize');}
var newOrientation=SCOPE.device.getDeviceOrientation(adSize.width,adSize.height);if(currentOrientation!==newOrientation){currentOrientation=newOrientation;SCOPE.Events.trigger('orientationChange');}
$(el).attr("orientation",newOrientation);}
function addMouseCaptureOverlay(){var overlay=buildResponsiveContainer();overlay.addClass("iv-mouse-capture-overlay");$(el).append(overlay);$(overlay).on(iroll.getVideoClickEventType(),function(ev){SCOPE.Events.trigger("video_click",ev);});$(overlay).on("touchmove",function(ev){ev.preventDefault();})}
function buildResponsiveContainer(className){var cont=$('<div/>'),sizes=that.getSize();cont.addClass(className);cont.width(sizes.width).height(sizes.height);SCOPE.Events.on('winResize',function(){var newSizes=that.getSize();cont.width(newSizes.width).height(newSizes.height);});return cont;}
this.addElement=function(elem){if(elem){$(el).append(elem);}};this.addResponsiveElement=function(elem){if(elem){var cont=buildResponsiveContainer("iv-elem-cont");cont.append(elem);$(el).append(cont);}};this.getSize=function(){return canvasAppender.getSize();};this.getScale=function(){var adSize=this.getSize(),config=iroll.get('config'),platformScale=SCOPE.toolkit.getPlatformScaleParameter(config.platformScaling)
var maxAdDimension=Math.max(adSize.width,adSize.height),adScale=maxAdDimension/config.previewParam.width;return adScale/platformScale;};this.getDefaultFontSize=function(){return defaultFontSize};this.setScale=function(scale){$(el).css({fontSize:scale});};this.remove=function(){if(el!==null){while(el.firstChild){el.removeChild(el.firstChild);}
el.parentNode.removeChild(el);el=null;}};this.injectCss=function(cssPath){var ownerDoc=el.ownerDocument;var linkRef=ownerDoc.createElement("link");linkRef.setAttribute("rel","stylesheet");linkRef.setAttribute("type","text/css");linkRef.setAttribute("href",cssPath);(ownerDoc.head||ownerDoc.getElementsByTagName("head")[0]).appendChild(linkRef);};this.registerInteractEvent=function(){$(el).on(iroll.get('mainEngagementEvent'),"*",function(event){event.stopPropagation();$(event.currentTarget).trigger("interact",event);});$(el).on(iroll.getVideoClickEventType(),"*",function(event){event.stopPropagation();$(event.currentTarget).trigger("interact-to-play",event);});};init.apply(this);};})(IV);
(function(SCOPE){SCOPE.AppsCore=Backbone.Model.extend({defaults:{sendLogs:false,playStartTime:null,interface:null,debug:false,autoscale:false,appPath:'',servicePath:'',nonCdnServicePath:'',reportUrl:'',errorReportUrl:'',runtimeConfigUrl:'',version:'unknown',el:null,mainContainer:null,videoContainer:null,appsContainer:null,durationBar:null,plugins:{},data:{},config:{},toolbar:null,id:null,sysLog:[],CloseButton:false,BackButton:false,CloseButtonTimeout:5000,windowOpen:null,appModeCustomEvents:{iOSPauseURL:'EXTENSION_STOP',iOSPlayURL:'EXTENSION_PLAY',iOSClickThrewURL:'EXTENSION_OPEN_URL:'},showClickToResume:true,delayAppVisibility:true,mainEngagementEvent:'tap',displayVideo:true,supportHLS:true,inlinePlaybackForced:false,videoPlayer:null,enableErrorReporting:true,checkForVisibility:false,linearOverStream:false,reportDummyErrorPixel:false,sessionMonitoringRate:1,reportImpressionsToLog:true,reportEventsToConsole:false,initialized:false,waitForCreativeToLoad:false,wrapCreativeWithIframe:false},canvas:null,session:null,report:null,errorDetector:null,videoClickHandler:null,initTimestamp:0,progressReporter:null,macroMapper:null,childVideoService:null,childVideoEventHandler:null,childPlacementsTrackingEventListener:null,clickthruRedirectHelper:null,inAppDetector:null,initialize:function(){var that=this,baseData=SCOPE.baseData;if(!this.get('autoscale')){$('head').append('<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, '+'minimum-scale=1, width=device-width, target-densitydpi=device-dpi">');}
new SCOPE.DataInjector().injectCustomParams(this);this.set({'appPath':baseData.appPath,'servicePath':baseData.servicePath,'nonCdnServicePath':baseData.nonCdnServicePath,'cssPath':baseData.cssPath,'reportUrl':baseData.reportUrl,'errorReportUrl':baseData.errorReportUrl,'runtimeConfigUrl':baseData.runtimeConfigUrl,'version':baseData.mobileCoreVersion});this.set('id',_.uniqueId('IV_'));if(!this.get('sendLogs')){this.bindTrackingEvents();}
this.set("canvasAppender",new SCOPE.CanvasAppender(this));this.session=new SCOPE.Session(baseData.app_data);this.macroMapper=new SCOPE.MacroMapper(this.get('data'));var iframeInjector=new SCOPE.FriendlyIframeInjector(SCOPE.ThirdPartyTrackingReporter.THIRD_PARTY_TRACKING_IFRAME_ID);var htmlTagInjector=new SCOPE.HtmlTextTagInjector(iframeInjector);var thirdPartyTrackingReporter=new SCOPE.ThirdPartyTrackingReporter(htmlTagInjector,this.macroMapper);var childPlacementsTrackingEventDispatcher=new SCOPE.ChildPlacementsTrackingEventDispatcher(this.get('id'));this.childVideoService=new SCOPE.ChildVideoService();this.childVideoEventHandler=new SCOPE.ChildVideoEventHandler(this.get('id'),this.childVideoService);this.childPlacementsTrackingEventListener=new SCOPE.ChildPlacementsTrackingEventListener(this.get('id'));this.report=this.report||new SCOPE.reportAnalytics({instance:this.toJSON(),instanceClass:this,session:this.session,thirdPartyTrackingReporter:thirdPartyTrackingReporter,childVideoService:this.childVideoService,childPlacementsTrackingEventDispatcher:childPlacementsTrackingEventDispatcher});this.clickthruRedirectHelper=new SCOPE.ClickthruRedirectHelper(SCOPE.baseData,this.report,function(){return that.get("playStartTime");});this.inAppDetector=new SCOPE.InAppDetector(IV.device);this.bindErrorEvents();this.on('init',function(){that.bindAnalyticsEvents();that.bindSystemEvents();that.bindChildPlacementsTrackingEvents();var id=that.get('id');SCOPE.Events.on(id+':video_videoPassed1Sec',function(){if(that.get('delayAppVisibility')){$(".iv-in-app-icon, #iv-tray, .iv-floating-icon-container").css({"visibility":"visible"});}});that.createCanvas();SCOPE.Events.trigger("IRollInit",that);that.initTimestamp=new Date().getTime();if(!that.shouldWaitForCreativeToLoad()){that.set('initialized',true);SCOPE.Events.trigger(id+':core_initialized',that);}});SCOPE.Events.on(this.get('id')+':appClickThru',function(){if(this.get('videoPlayer')&&this.get('videoPlayer').isPlaying()){this.get('videoPlayer').pause();}},that);},shouldWaitForCreativeToLoad:function(){return!!this.get("waitForCreativeToLoad");},shouldWrapCreativeWithIframe:function(){return!!this.get("wrapCreativeWithIframe");},setAttribute:function(attrs){if(_.isObject(attrs)){this.set(attrs,{silent:true});}},$log:function(){if(this.get('debug')){}},injectVideo:function(){var data=this.get('data'),that=this;if(!this.has('videoPlayer')){this.set('videoPlayer',new SCOPE.InternalVideoPlayer(this));}
this.get('videoPlayer').init(data,this);if(data.video){this.loadVideoSource(data.video.renditions,this);}
this.videoClickHandler=new SCOPE.VideoClickHandler(this,SCOPE.baseData,SCOPE.Events,this.macroMapper);this.get('videoPlayer').on("interact",function(ev){that.videoClickHandler.handleClick(ev);});},loadVideoSource:function(renditions){if(this.get('linearOverStream')!==true){this.get('videoPlayer').loadVideoSource(renditions);}},injectCSSToDoc:function(){this.canvas.injectCss(this.get('cssPath'));},removeVideo:function(){if(this.get('videoPlayer')){this.get('videoPlayer').pause();}},cleanUp:function(){SCOPE.Events.off();if(this.get('videoPlayer')&&typeof this.get('videoPlayer').cleanUp==='function'){this.get('videoPlayer').cleanUp();}
this.canvas.remove();},initAppsSystem:function(){if(this.get('reportDummyErrorPixel')){this.report.reportLog({event_id:'dummy'});}
if(this.get('displayVideo')){this.injectVideo();}
SCOPE.Events.trigger('IRollReady',this,this.get('data'));SCOPE.Events.trigger(this.get('id')+':impression',this);},createCanvas:function(){var canvasContainer=null;if(_.isNull(this.get("mainContainer"))){canvasContainer=document.body;}else{canvasContainer=this.get("mainContainer");}
var canvasAppender=this.get("canvasAppender");canvasAppender.setContainer(canvasContainer);this.canvas=new SCOPE.Canvas(this,canvasAppender);},windowOpen:function(url,label){url=new SCOPE.MacroMapper(this.get('data')).expandAll(url);url=this.clickthruRedirectHelper.redirect(url,label);if(this.report.isIvcExdataEnabled()){url=this.report.decorateUrlWithExdata(url);}
SCOPE.Events.trigger(this.get('id')+':openUrl',url);SCOPE.Events.trigger(this.get('id')+':appClickThru',url);if(_.isFunction(this.get('interface')['windowOpen'])){this.get('interface')['windowOpen'](url);}},supportFeature:function(feature){var externalInterface=this.get('interface');if(externalInterface!==null&&typeof externalInterface.supports==='function'){return externalInterface.supports(feature);}else{return false;}},onInteract:function(elem,func){elem.on(this.get('mainEngagementEvent'),func);},reportEngage:function(eventId){var that=this;that.report.submit({action:'engage',event_id:eventId});SCOPE.Events.trigger(that.get('id')+":engage");},reportInteract:function(){this.report.submit({action:'intrct'});this.fireTrackingEvent('adFirstInteraction');},bindAnalyticsEvents:function(){var that=this,id=this.get('id'),playFired=false,engaged=false,interactedBeforePlay=false,customMetrics=that.get('data').customMetrics;SCOPE.Events.on(id+':userClick',function(){if(engaged){return;}
engaged=true;that.reportEngage('user');});SCOPE.Events.on(id+':auto_engage',function(){if(engaged){return;}
engaged=true;that.reportEngage('default');});SCOPE.Events.on(id+':core_initialized',function(){var adSize=that.canvas.getSize();that.report.submit({action:'init',size:adSize.width+'x'+adSize.height});});SCOPE.Events.on(id+':interact',_.once(function(){if(playFired){that.reportInteract();}
else{interactedBeforePlay=true;}}));this.childVideoEventHandler.bindActionToChildInteractEvent(that.report);this.progressReporter=new SCOPE.AdProgressReporter(id,this.report,customMetrics,this.fireTrackingEvent.bind(this));this.progressReporter.startReporting(function(){playFired=true;that.set({playStartTime:new Date().getTime()});if(that.get('reportImpressionsToLog')){that.report.reportLog({event_id:'impression'});}
if(interactedBeforePlay){that.reportInteract();}});},bindSystemEvents:function(){SCOPE.Events.on('appsDataReady',this.initAppsSystem,this);SCOPE.Events.on('startApps',this.initAppsSystem,this);SCOPE.Events.on('orientationchange',function(){SCOPE.Events.trigger('repaint');});this.on('start',this.initAppsSystem,this);},bindTrackingEvents:function(){var that=this,id=this.get('id');var eventsList={};if(_.isObject(this.get('data')['placement-config'])){eventsList=this.get('data')['placement-config']['tracking-events'];}
_.forEach(eventsList,function(trackingItems,eventName){var handler=_.bind(that.reportTrackingEvent,that,eventName,trackingItems);SCOPE.Events.on(id+':tracking:'+eventName,handler);});},bindChildPlacementsTrackingEvents:function(){var placementConfig=this.get('data')['placement-config'];if(_.isObject(placementConfig)){var childPlacementsTracking=placementConfig['child-placements-tracking'];if(_.isObject(childPlacementsTracking)){this.childPlacementsTrackingEventListener.start(childPlacementsTracking,this.report);}}},bindErrorEvents:function(){this.errorDetector=new SCOPE.ErrorDetector(this);this.errorDetector.on("all",function(eventId,eventValue){this.report.reportLog({event_id:eventId,event_value:eventValue||''});},this);this.errorDetector.startListener();},fireTrackingEvent:function(eventName){var id=this.get('id'),event=id+':tracking:'+eventName;SCOPE.Events.trigger(event);},reportTrackingEvent:function(eventName,trackingItems){this.report.submit3rdPartyTracking(trackingItems);},getVideoClickEventType:function(){if(SCOPE.device.needsClickEventToPlay()){return'click';}else{return this.get('mainEngagementEvent');}},isHidden:function(){var prop=SCOPE.device.getHiddenProp();if(!prop)return false;return document[prop];},shouldForceInternalPlayer:function(){return this.get("data").forceInternalPlayer||(this.get("data").forceInternalPlayerOnDesktopOnly&&SCOPE.device.isDesktop());}});})(IV);
(function(SCOPE){SCOPE.CurrentScriptPopulator.populateCurrentScript(document);})(IV);
(function(SCOPE){if(_.isUndefined(SCOPE.Events)){SCOPE.Events=function(){};_.extend(SCOPE.Events,Backbone.Events);}})(IV);
(function(SCOPE){SCOPE.VideoSpy=function(videoElem){this.videoElem=videoElem;this.state=null;var instance=this,activityLog=new SCOPE.ActivityLog(),passedPoints={pass1sec:false,pass25:false,pass50:false,pass75:false,cvv:false},customPoint=null,lastPlayingTime=0,timeUpdateIntervalId=0,timeUpdateEventFired=false,lastTimeUpdated=0;this.MAX_BUFFERING_COUNT=5;this.MAX_BUFFERING_TIMES=[4000,6000,8000];this.SHORT_BUFFERING_TIME=200;this.setCustomPoint=function(time){customPoint=time};function fireEvent(eventName,newState,ev){instance.trigger(eventName,ev);if(newState)
{if(isValidState(newState))
{instance.state=newState;activityLog.log(newState);}
else
{throw("invalid video state");}}}
function fireErrorEvent(errorType,ev){instance.trigger(errorType,ev);}
function isValidState(state){var validStates=['playing','paused','ended'];return(validStates.indexOf(state)!=-1);}
function onTimeUpdate(elem,ev){timeUpdateEventFired=true;updateTime(elem,ev);}
function playingHeartbeat(currentTime){lastPlayingTime=currentTime;activityLog.log('playing');}
function setPassedPoint(currentTime,duration){var currentProgress=100*currentTime/duration;if(currentTime>1&&!passedPoints.pass1sec){passedPoints.pass1sec=true;fireEvent('video_videoPassed1Sec',null);}
if(currentProgress>25&&!passedPoints.pass25){passedPoints.pass25=true;fireEvent('video_videoPassed25',null);}
if(currentProgress>50&&!passedPoints.pass50){passedPoints.pass50=true;fireEvent('video_videoPassed50',null);}
if(currentProgress>75&&!passedPoints.pass75){passedPoints.pass75=true;fireEvent('video_videoPassed75',null);}
if(customPoint!==null){if(currentTime>customPoint&&!passedPoints.cvv){passedPoints.cvv=true;fireEvent('video_videoPassedCustomPoint',null);}}}
function startBackupTimeUpdate(){timeUpdateIntervalId=setInterval(updateTime.bind({},videoElem),500);}
function stopBackupTimeUpdate(){if(timeUpdateIntervalId)clearInterval(timeUpdateIntervalId);timeUpdateIntervalId=0;}
function missingTimeUpdateCheck(){if(!timeUpdateEventFired)instance.trigger("video_timeupdate_event_missing");}
function updateTime(elem,ev){if(lastTimeUpdated!==elem.getCurrentTime()&&isFinite(elem.getCurrentTime())&&!isNaN(elem.getCurrentTime())){lastTimeUpdated=elem.getCurrentTime();var tDelta=(elem.getCurrentTime()-lastPlayingTime);if(tDelta>1.0){playingHeartbeat(elem.getCurrentTime());}
setPassedPoint(elem.getCurrentTime(),elem.getDuration());var data={"currentTime":elem.getCurrentTime(),"duration":elem.getDuration(),"ev":ev};fireEvent('video_timeupdate',null,data);}}
videoElem.on('stalled',function(){if(instance.state!=="paused"){activityLog.log('buffering');fireEvent("buffering",null);}});videoElem.on('waiting',function(){if(instance.state!=="paused"){activityLog.log('buffering');fireEvent("buffering",null);}});videoElem.on('playing',function(){activityLog.log('playing');});videoElem.on('playing',_.once(startBackupTimeUpdate));videoElem.on('ended',stopBackupTimeUpdate);videoElem.on('ended',missingTimeUpdateCheck);videoElem.on('durationchange',fireEvent.bind({},'video_durationchange',null));videoElem.on('playing',fireEvent.bind({},'video_play','playing'));videoElem.on('playing',_.once(fireEvent.bind({},'video_started',null)));videoElem.on('pause',fireEvent.bind({},'video_pause','paused'));videoElem.on('timeupdate',onTimeUpdate.bind({},videoElem));videoElem.on('ended',fireEvent.bind({},'video_ended','ended'));videoElem.on('webkitendfullscreen',fireEvent.bind({},'video_exitfullscreen',null));videoElem.on('error',fireErrorEvent.bind({},'video_error'));_.each(videoElem.getAllSourceChildren(),function(elem){$(elem).on('error',fireErrorEvent.bind({},'video_source_error'));});activityLog.onCount('buffering',this.MAX_BUFFERING_COUNT,fireErrorEvent.bind({},'video_high_buffering_count',this.MAX_BUFFERING_COUNT));_.each(this.MAX_BUFFERING_TIMES,function(time){activityLog.onTime('buffering',time,fireErrorEvent.bind({},'video_long_buffering_time',time));});activityLog.onTime('buffering',this.SHORT_BUFFERING_TIME,fireEvent.bind({},"video_short_buffering_time",null));};_.extend(SCOPE.VideoSpy.prototype,Backbone.Events);})(IV);
(function(SCOPE){SCOPE.ActivityLog=function(){var eventsMap=[],countListeners=[],timers=[],runningTimers=[];this.log=function(event){var now=new Date().getTime(),newCount;if(this.has(event)){newCount=++eventsMap[event].count;eventsMap[event].time=now;}else{newCount=1;eventsMap[event]={"count":newCount,"time":now};}
resetAllTimers();startEventTimers(event);notifyCountListeners(event,newCount);return this;};this.getCount=function(event){var count=0;if(this.has(event)){count=eventsMap[event].count;}
return count;};this.has=function(event){return event in eventsMap;};this.onCount=function(event,count,cb,context){if(!(event in countListeners)){countListeners[event]=[];}
if(!(count in countListeners[event])){countListeners[event][count]=[];}
countListeners[event][count].push({"callback":cb,"context":context});};this.onTime=function(event,time,cb,context){if(!(event in timers)){timers[event]=[];}
timers[event].push({"time":time,"cb":cb,"context":context});};function notifyCountListeners(ev,count){if(ev in countListeners&&count in countListeners[ev]){for(var cb in countListeners[ev][count]){if(countListeners[ev][count].hasOwnProperty(cb)){var listenerObj=countListeners[ev][count][cb];var context=listenerObj.context!=='undefined'?listenerObj.context:null;listenerObj.callback.call(context,ev,count);}}}}
function resetAllTimers(){for(var i=0;i<runningTimers.length;i++){if(typeof runningTimers[i]==="number"){clearTimeout(runningTimers[i]);}}}
function startEventTimers(ev){if(ev in timers){for(var i=0;i<timers[ev].length;i++){var job=timers[ev][i];var taskId=createTimeoutTask(job.cb,job.context,job.time);runningTimers.push(taskId);}}}
function createTimeoutTask(cb,context,time){return setTimeout(function(){cb.apply(context)},time);}};})(IV);
(function(SCOPE){var device=function(){var that=this;this.getPlatformType=_.memoize(function(){var ua=that.getNavigatorUserAgent();return ua.match(/GoogleTV|SmartTV|Internet.TV|NetCast|NETTV|AppleTV|boxee|Kylo|Roku|DLNADOC|CE\-HTML/i)?'tv':ua.match(/Xbox|PLAYSTATION.3|PLAYSTATION.4|Wii/i)?'tv':ua.match(/iPad/i)||ua.match(/tablet/i)&&!ua.match(/RX-34/i)||ua.match(/FOLIO/i)?'tablet':ua.match(/Linux/i)&&ua.match(/Android/i)&&!ua.match(/Fennec|mobi|HTC.Magic|HTCX06HT|Nexus.One|SC-02B|fone.945/i)?'tablet':ua.match(/Kindle/i)||ua.match(/Mac.OS/i)&&ua.match(/Silk/i)?'tablet':ua.match(/Opera/i)&&ua.match(/Windows.NT.5/i)&&ua.match(/HTC|Xda|Mini|Vario|SAMSUNG\-GT\-i8000|SAMSUNG\-SGH\-i9/i)?'mobile':ua.match(/Windows.(NT|XP|ME|9)/)&&!ua.match(/Phone/i)||ua.match(/Win(9|.9|NT)/i)?'desktop':ua.match(/Macintosh|PowerPC/i)&&!ua.match(/Silk/i)?'desktop':ua.match(/Linux/i)&&ua.match(/X11/i)?'desktop':ua.match(/Solaris|SunOS|BSD/i)?'desktop':'mobile';});this.isAndroid=function(){var userAgent=this.getNavigatorUserAgent();return(userAgent.match(/android/i)!==null);};this.is_iOS=function(){var userAgent=this.getNavigatorUserAgent();return userAgent.match('iPod')||userAgent.match('iPhone')||userAgent.match('iPad');};this.getOSType=function(){if(this.is_iOS()){return"ios";}
else if(this.isAndroid()){return"android";}
else{return"other"}};this.getDeviceName=function(){var userAgent=this.getNavigatorUserAgent();if(userAgent.match('iPod')){return'iPod';}else if(userAgent.match('iPad')){return'iPad';}else if(userAgent.match('iPhone')){return'iPhone';}else if(userAgent.match(/android/i)){return'Android';}else if(this.isDesktop()){return'Desktop';}
return undefined;};this.isDeviceHLSSupported=function(){if(this.is_iOS()){return true;}else if(this.isAndroid()&&versionAtLeastAsNewAs(this.getAndroidOSVersion(),"5.0")){return true;}
return false;};this.isDesktop=function(){return this.getPlatformType()==="desktop";};this.getDeviceInformation=function(){var device,resolution,version,orientation,os;var userAgent=this.getNavigatorUserAgent();if(userAgent.match('iPod')){device='iPod';os='iOS';}else if(userAgent.match('iPad')){device='iPad';os='iOS';}else if(userAgent.match('iPhone')){device='iPhone';os='iOS';}else if(userAgent.match(/android/i)){device='Android';os='Android';}
else{return userAgent;}
resolution='('+window.screen.width+'x'+window.screen.height+')';if(os=="iOS"){version=this.getiPhoneOSVersion();}else if(os=="Android"){version=this.getAndroidOSVersion();}
orientation=this.getDeviceOrientation();return[device,resolution,version,orientation].join(', ');};this.getWebsiteHost=function(){var website;try{website=this.getLocationHost();}catch(e){}
if(_.isUndefined(website)){website=getHostName(document.referrer);}
return website;};this.canPlayInline=function(){var deviceName=this.getDeviceName();if(deviceName==="iPod"||deviceName==="iPhone"){return supportsInline(this);}else{return true;}};this.getLocationHost=function(){return window.top.location.host;};this.getDeviceScreenSize=function(){return{w:Math.round(window.screen.width*window.devicePixelRatio),h:Math.round(window.screen.height*window.devicePixelRatio)};};this.getiPhoneOSVersion=function(){var match,userAgent=this.getNavigatorUserAgent();var version=this.is_iOS()?1.0:false;if(!(match=/iP.+ OS (.*) like Mac OS X/.exec(userAgent))){}else{version=match[1].split('_').join('.');}
return version;};this.getAndroidOSVersion=function(){var match,userAgent=this.getNavigatorUserAgent();var version='';if(!(match=/Android (\d+(?:\.\d+)+)/.exec(userAgent))){}else{version=match[1];}
return version;};this.getDeviceOrientation=function(width,height){var deviceHeight=_.isUndefined(height)?window.innerHeight:height,deviceWidth=_.isUndefined(width)?window.innerWidth:width,aspectRatio=1.3;return(deviceHeight*aspectRatio>deviceWidth)?'Portrait':'Landscape';};this.getDeviceScreenSizeClass=function(){var dim=this.getDeviceScreenSize();if(!this.getiPhoneOSVersion()&&!this.getAndroidOSVersion())return'small';return(dim.h>=960||dim.w>=1280)?'big':'small';};this.supportsAnimations=function(){return(this.isAndroid()&&versionAtLeastAsNewAs(this.getAndroidOSVersion().toString(),"4.1"))||(this.is_iOS()&&versionAtLeastAsNewAs(this.getiPhoneOSVersion().toString(),"5.2"));};this.getNavigatorUserAgent=function(){return navigator.userAgent;};this.needsClickEventToPlay=function(){return this.isAndroid();};this.getHiddenProp=function(){var prefixes=['webkit','moz','ms','o'];if('hidden'in document)return'hidden';for(var i=0;i<prefixes.length;i++){if((prefixes[i]+'Hidden')in document)
return prefixes[i]+'Hidden';}
return null;};this.needsElemForcedRedraw=function(){return this.isAndroid();};this.getDocumentQueryString=function(){return document.location.search;};this.getDeviceIdFromRequest=function(){var queryStringReader=new SCOPE.QueryStringReader();return queryStringReader.getDeviceIdFromRequest(SCOPE._currentScript,this.getDocumentQueryString());};function getHostName(url){var a=document.createElement('a');a.href=url;return a.hostname;}
function supportsInline(currentDeviceInfo){var canDoInline=SCOPE.InlineVideoValidator.shouldTransformToInlineVideo(currentDeviceInfo);if(!canDoInline&&currentDeviceInfo.is_iOS()){var currentDeviceVersion=currentDeviceInfo.getiPhoneOSVersion();canDoInline=versionAtLeastAsNewAs(currentDeviceVersion.toString(),"10.0.0");}
return canDoInline;}
function versionAtLeastAsNewAs(version,comparedTo){if(!_.isString(version)){return false;}
var versionParts=version.split('.');var compareToParts=comparedTo.split('.');var i=0,isNewer=true;while(isNewer===true&&i<compareToParts.length){if(i<versionParts.length){var versionPartNum=parseInt(versionParts[i],10);var compareToPartNum=parseInt(compareToParts[i],10);var delta=versionPartNum-compareToPartNum;if(delta>0){break;}else if(delta<0){isNewer=false;}}else{isNewer=false;}
i++;}
return isNewer;}};SCOPE.device=new device();})(IV||{});
(function(SCOPE){var html5video=function(options,container,initialVolume){var that=this,params=options||{},defaults={},iroll=options.iroll;var videoControls=options.controls||['resume'];var _videoControls=function(args){var defaults={show:false,showControls:videoControls||['resume']};var params=args||{};var options=_.extend(defaults,params);var controlsBar=_.template('<div class="video-controls"></div>');var controlsButtons={resume:'<a class="control control-resume" data-fn="play">&nbsp;</a>',play:'<a class="control control-play" data-fn="play">&nbsp;</a>'};if(options.show){if(container.find('.video-controls').length>0){$(container.find('.video-controls').remove());}
var controls=$(controlsBar());_.each(options.showControls,function(control){var ctrl=controlsButtons[control];controls.append(ctrl);controls.find('.control').each(function(){$(this).css({display:'inline-block',cursor:'pointer'});});});$(container).append(controls).on(iroll.getVideoClickEventType(),'.control',function(ev){ev.preventDefault();var action=$(this).attr('data-fn');if(_.isFunction(that[action]))that[action]();});}
else{$(container.find('.video-controls').remove());}};var _init=function(){that.el=document.createElement('video');if(SCOPE.InlineVideoValidator.shouldTransformToInlineVideo(SCOPE.device)){SCOPE.InlineVideoFactory.create(that.el);}
SCOPE.InlineVideoTransformer.checkAndOverrideFastSeek(that.el);$(that.el).css({width:"100%",height:"100%",top:0,left:0,position:'absolute','pointer-events':'visible'});that.el.preload=true;that.el.controls=false;$(that.el).attr('webkit-playsinline','webkit-playsinline');$(that.el).attr('playsinline','playsinline');$(that.el).addClass('iv-main-video');if(that.params.preview){$(that.el).attr("poster",that.params.preview);}else{$(that.el).attr("poster","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=");}
var videoVolumeHandler=new SCOPE.VideoVolumeHandler(that.el);videoVolumeHandler.bindVolumeChangeEvent(initialVolume);};this.setVideoSource=function(renditions){var elem=new SCOPE.VideoElementWrapper(that.el);var videoLoader=new SCOPE.VideoSourceLoader(elem,iroll);videoLoader.loadVideoSource(renditions);return videoLoader.isLoaded();};this.play=function(){this.el.play();_videoControls({show:false});};this.resume=this.play;this.pause=function(hideControls){this.el.pause();if(hideControls!==true){_videoControls({show:true});}};this.stop=function(){this.el.stop();_videoControls({show:false});};this.showControls=function(controls){_videoControls(_.extend({show:true},controls||{}));};this.setSrc=function(src){this.el.src=src;};this.getDuration=function(){return this.el.duration;};this.getCurrentTime=function(){return this.el.currentTime;};this.getRemainingTime=function(){return this.getDuration()-this.getCurrentTime();};this.load=function(){this.el.load();};this.events=_.extend({},Backbone.Events);this.params=_.extend(defaults,params);_init();};SCOPE.html5video=html5video;})(IV);
(function(SCOPE){SCOPE.IRollSimpleTracker=function(eventHandler,eventPrefix){var map={"expand":"dialogOpened","clickthru":"openUrl","engage":"engage","impression":"ad_started","firstquartile":"video_videoPassed25","midpoint":"video_videoPassed50","thirdquartile":"video_videoPassed75","completion":"ad_ended"};this.registerCustomPixels=function(customPixels){_.each(customPixels,function(urls,eventName){var iRollEventName=mapEventNameToIRollEventName(eventPrefix,eventName);if(iRollEventName!==null){var urlArr=urls;if(!_.isArray(urlArr)){urlArr=new Array(urlArr);}
_.each(urlArr,function(val){eventHandler.on(iRollEventName,function(){fireCustomPixel(val);});});}});};function fireCustomPixel(url){var req=new Image();req.src=url;}
function mapEventNameToIRollEventName(eventPrefix,eventName){if(map.hasOwnProperty(eventName)){return eventPrefix+map[eventName];}else{return null;}}};})(IV);
(function(SCOPE){SCOPE.reportAnalytics=Backbone.Model.extend({defaults:{sendLogs:true,instance:null,instanceClass:null,session:null,thirdPartyTrackingReporter:null,childVideoService:null,childPlacementsTrackingEventDispatcher:null,ivcExdataEnabled:false,defaultReportData:{'ad_criteria':null,placement_tag_id:0,r:'',viewer_id:'',action:'',session_id:'',client_id:-1,channel_id:0,project_state:0,video_id:0,project_hash:'',placement_hash:-1,impression_id:'',event_id:'',website:'unknown',publisher_id:0,event_value:'',fver:null,real_estate_id:0}},CONTEXT:{MANUAL_SELECT:SCOPE.ChildVideoService.MANUAL_SELECTION,AUTO_SELECT:SCOPE.ChildVideoService.AUTO_SELECTION},reportedUrls:[],reportedOptions:[],errorLogQueue:[],loadedOptions:[],postLoadedPixelCallbackActions:{},postReportedPixelCallbackActions:{},initialize:function(){var that=this,instanceData=this.get('instance'),reportData={},placementConfig=instanceData.data['placement-config'];_.extend(reportData,this.get('defaultReportData'));reportData.fver=SCOPE.baseData.mobileCoreVersion||null;that.childVideoService=this.get('childVideoService');that.childPlacementsTrackingEventDispatcher=this.get('childPlacementsTrackingEventDispatcher');that.reportedUrls=[];that.errorLogQueue=[];that.reportedOptions=[];that.loadedOptions=[];that.postLoadedPixelCallbackActions={};that.postReportedPixelCallbackActions={};that.get('instanceClass').set({sendLogs:true});reportData.session_id=SCOPE.toolkit.randomId();reportData.viewer_id=SCOPE.toolkit.randomId();reportData.impression_id=SCOPE.toolkit.randomId();reportData.ver=instanceData.data['version']||reportData.fver;reportData.website=(SCOPE.device.isDesktop()?SCOPE.device.getWebsiteHost():SCOPE.device.getDeviceInformation()).substring(0,128);if(_.isObject(placementConfig)){reportData.placement_hash=placementConfig['placement-hash']||'';reportData.placement_tag_id=placementConfig['placement-tag-id']||0;reportData.publisher_id=placementConfig['publisher-id'];reportData.channel_id=placementConfig['channel-id'];reportData.client_id=placementConfig['client-id'];reportData.project_hash=placementConfig['project-hash'];reportData.video_id=placementConfig['video-id'];reportData.project_state=placementConfig['project-state'];reportData.real_estate_id=placementConfig['real_estate_id'];that.childVideoService.setSelectionProjectStates(placementConfig['child-manual-project-state'],placementConfig['child-auto-project-state']);that.ivcExdataEnabled=placementConfig['ivcexdata-enabled'];}else{reportData.project_hash=instanceData.data['id'];}
var deviceId=SCOPE.device.getDeviceIdFromRequest();if(deviceId){reportData.device_id=deviceId;}
this.url=this.get('instance').reportUrl;this.set("reportData",reportData);},submit3rdPartyTracking:function(trackingItems){if(!this.get('sendLogs'))return;var that=this;_.each(trackingItems,function(trackingItem){var session_id=that.get("reportData").session_id;var thirdPartyTrackingReporter=that.get("thirdPartyTrackingReporter");thirdPartyTrackingReporter.report(trackingItem.data,trackingItem.type,session_id,that.firePixel.bind(that),that.reportLog.bind(that));});},addReportDataToReportUrl:function(reportData,reportUrl){var userEvents=['click','clktruevt','clkint','cxon','cxoff','engage'];var userEventsWithoutEngage=userEvents.filter(function(eventName){return eventName!=="engage";});_.each(reportData,function(val,key){if(val==='')return;if(key==='relative_time'){val=(val/1000).toFixed(3);}
if(_.indexOf(['init','play','vpoint','engage'],reportData.action)!==-1){if(key==='impression_id')return;}
if(key==='ad_criteria'){if(_.indexOf(userEventsWithoutEngage,reportData.action)!==-1){val=null;}else{return;}}
if(key==='real_estate_id'){if(_.indexOf(userEvents,reportData.action)===-1){return;}}
reportUrl+=key+'='+encodeURIComponent(val)+'&';});return reportUrl.slice(0,-1);},prepareReportData:function(options,context){var reportData=_.extend({},this.toJSON()['reportData']);var pixelData=options||{};var isChildContext=typeof context!=='undefined';if(isChildContext){var childVideoData=this.childVideoService.initChildVideoData(options,context);_.extend(pixelData,{video_id:childVideoData.videoId,placement_hash:childVideoData.placementHash});_.extend(reportData,{project_state:childVideoData.projectState});this.childPlacementsTrackingEventDispatcher.trigger(pixelData.action,pixelData.event_value,pixelData.placement_hash);}
_.extend(reportData,pixelData);reportData.r=SCOPE.toolkit.randomId();return reportData;},submit:function(options,context){if(!this.get('sendLogs'))return;options=options||{};options=replaceOption(options,'action','clktru','clktruevt');var reportData=this.prepareReportData(options,context);var reportUrlPrefix=this.get('instance').reportUrl+'?';var reportUrl=this.addReportDataToReportUrl(reportData,reportUrlPrefix);if(this.isIvcExdataEnabled()){reportUrl=this.decorateUrlWithExdata(reportUrl);}
if(_.indexOf(['click','clktruevt','engage'],reportData.action)!==-1){var that=this;setTimeout(function(){that.firePixel(reportUrl,options);},100);}else{this.firePixel(reportUrl,options);}},decorateUrlWithExdata:function(reportUrl){var ivcExdata=new SCOPE.QueryStringReader().getQueryIvcParam(IV._currentScript);if(_.isUndefined(ivcExdata)){return reportUrl;}
var pixelTemplate=_.template("<%= reportUrl %>&ivc_exdata=<%= ivcExdata %>");return pixelTemplate({reportUrl:reportUrl,ivcExdata:ivcExdata});},isIvcExdataEnabled:function(){return this.ivcExdataEnabled;},getReportingTrackingItems:function(action,reporting){if(!this.get('sendLogs')){return[];}
var reportingData=_.clone(reporting),eventName=action||'',resultArr=[];if(reportingData.hotspots&&_.size(reportingData.hotspots)&&reportingData.hotspots[eventName]){_.each(reportingData.hotspots[eventName],function(item){if(!_.isUndefined(item['tracking'])){_.each(item['tracking'],function(url){resultArr.push(url);});}});}
return resultArr;},click:function(ev){this.submit({action:'click',event_id:'position',event_value:ev.pageX+'x'+ev.pageY});},clickthru:function(event_id,event_value){this.submit({action:"clktruevt",event_id:event_id,event_value:event_value||"",relative_time:(_.now()-this.get('instanceClass').get("playStartTime"))});},submitCreativeDebug:function(options)
{options.action='creative';options.sample_rate=this.get('session').getCreativeSampleRate();this.submitCustomEvent(options);},submitError:function(options)
{options.action='error';options.sample_rate=this.get('session').getSampleRate();this.submitCustomEvent(options);},submitCustomEvent:function(options){options.runtime_type='html';options.suffix=this.get('instance').version.split('.').splice(0,2).join('_');this.cutPixel(options);var params=options||{},data=_.extend({},this.toJSON()['reportData']),reportData=_.extend(data,params);delete reportData.website;reportData.r=SCOPE.toolkit.randomId();var reportUrlPrefix=this.get('instance').errorReportUrl;reportUrlPrefix+='?';var reportUrl=this.addReportDataToReportUrl(reportData,reportUrlPrefix);this.fireErrorPixel(reportUrl);},reportCreativeDebugLog:function(options){if(this.get('session').isDebugEnabled()){this.submitCreativeDebug(options);}},reportLog:function(options){if(this.get('instance').enableErrorReporting&&this.get('instance').errorReportUrl){if(this.get('session').isMonitored(options.event_id)){this.submitError(options);}else{this.errorLogQueue.push(options);}}},flushErrorQueue:function(){for(var i=0;i<this.errorLogQueue.length;i++){if(this.get('session').isMonitored(this.errorLogQueue[i].event_id)){this.submitError(this.errorLogQueue[i]);}}
this.errorLogQueue=[];},firePixel:function(reportUrl,options){SCOPE.toolkit.debug("Fire Pixel - ",reportUrl);var that=this;var img=new Image(1,1);if(options){img.onload=this.loadedPixelCallback.bind(this,options);}
img.onerror=function(){that.reportLog({event_id:"pixel_error",event_value:reportUrl});};try{img.src=reportUrl;this.reportedUrls.push(reportUrl);if(options){this.reportedPixelCallback(options);}}catch(e){this.reportLog({event_id:"pixel_error_message",event_value:e.message+": "+reportUrl});}
return img;},fireErrorPixel:function(reportUrl){var img=this.firePixel(reportUrl);var irollAd=this.get('instanceClass');var appendImageToElement=function(element,img){if(element&&_.isElement(element)){try{img.style.display="none";element.ownerDocument.body.appendChild(img);return true;}catch(e){return false;}}else{return false;}};var videoContainer=irollAd.get("videoContainer");var mainContainer=irollAd.get("mainContainer");if(!appendImageToElement(videoContainer,img)){appendImageToElement(mainContainer,img);}},cutPixel:function(options){var MAX_LEN=125;if(!options.event_value)
return;options.event_value=options.event_value.length>MAX_LEN?options.event_value.substring(0,MAX_LEN):options.event_value;},reportedPixelCallback:function(options){pixelCallback(this.reportedOptions,this.postReportedPixelCallbackActions,options);},wasPixelReported:function(options){return!!_.findWhere(this.reportedOptions,options);},addPostReportedPixelCallback:function(cb,action){addActionCallback(this.postReportedPixelCallbackActions,cb,action);},loadedPixelCallback:function(options){pixelCallback(this.loadedOptions,this.postLoadedPixelCallbackActions,options);},wasPixelLoaded:function(options){return!!_.findWhere(this.loadedOptions,options);},addPostLoadedPixelCallback:function(cb,action){addActionCallback(this.postLoadedPixelCallbackActions,cb,action);}});function replaceOption(options,key,original,replacement){options[key]=options.hasOwnProperty(key)?(options[key]===original?replacement:options[key]):options[key];return options;}
function pixelCallback(pixelOptionsArr,callbackActionsObj,options){pixelOptionsArr.push(options);if(callbackActionsObj.hasOwnProperty(options.action)){callbackActionsObj[options.action].forEach(function(postReportPixelCb){postReportPixelCb();});}}
function addActionCallback(callbackActionsObj,cb,action){if(callbackActionsObj.hasOwnProperty(action)){callbackActionsObj[action].push(cb);}else{callbackActionsObj[action]=[cb];}}})(IV);
(function(SCOPE){if(!_.isObject(SCOPE.toolkit)){SCOPE.toolkit={};}
var logger=null;SCOPE.toolkit.debug=function(){if(logger===null){logger=createLogger();}
logger.debug.apply(logger,arguments);};function createLogger(){var queryReader=new SCOPE.QueryStringReader();var customParams=new SCOPE.DataInjector(queryReader,SCOPE.toolkit).getCustomParams();var isDebugMode=customParams.hasOwnProperty("innovid_debug")?customParams["innovid_debug"]==="1":false;return new SCOPE.InnovidLogger(isDebugMode);}
SCOPE.toolkit.randomId=function(){var res="";for(var i=0;i<8;i++){res+=(0x10000|Math.random()*0x10000).toString(16).substr(1);}
return res;};SCOPE.toolkit.getEnvironmentFromURL=function(url){url=url.replace(/^https?:\/\//,'');var urlParts=url.split("/");var host=urlParts[0];return host.split(".").slice(-2).join(".");};SCOPE.toolkit.getURLparts=function(url){var uriBreakeDownRexExp=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");var urlPartsArray=url.split(uriBreakeDownRexExp);var urlPartObj={scheme:urlPartsArray[2],authority:urlPartsArray[4],path:urlPartsArray[5],query:urlPartsArray[7],fragment:urlPartsArray[9]};return urlPartObj;};SCOPE.toolkit.getURISchemeFromURL=function(url){return SCOPE.toolkit.getURLparts(url).scheme;};SCOPE.toolkit.trim=function(str){return str.replace(/^\s+|\s+$/g,"");};SCOPE.toolkit.getRGBcolorFromMScolor=function(color){var red,blue,green;red=Math.floor(Math.floor(color/256)/256);color=color-red*256*256;green=Math.floor(color/256);blue=color-green*256;return{red:red,green:green,blue:blue};};SCOPE.toolkit.dayCodesToDaysInWeek=function(recurrence){var pos,days=recurrence.split(","),daysInWeek=[],dayCodes=["SU","MO","TU","WE","TH","FR","SA"];_.each(days,function(dayCode){pos=dayCodes.indexOf(dayCode);if(pos!=-1){daysInWeek.push(pos);}});return daysInWeek;};SCOPE.toolkit.dateToString=function(date){var weekday=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var dateParts=date.toDateString().split(" ");return weekday[date.getDay()]+", "+dateParts[1]+". "+dateParts[2]+", "+dateParts[3];};SCOPE.toolkit.getExpirationDate=function(date){var expires=new Date(date);expires.setFullYear(expires.getFullYear()+1);return expires.getFullYear()
+"-"+SCOPE.toolkit.padDigits((expires.getUTCMonth()+1),2)
+"-"+SCOPE.toolkit.padDigits(expires.getUTCDate(),2)
+"T"
+SCOPE.toolkit.padDigits(expires.getUTCHours(),2)
+":"+SCOPE.toolkit.padDigits(expires.getUTCMinutes(),2)
+":"+SCOPE.toolkit.padDigits(expires.getUTCSeconds(),2);};SCOPE.toolkit.padDigits=function(number,digits){return Array(Math.max(digits-String(number).length+1,0)).join(0)+number;};SCOPE.toolkit.getIconImageSize=function(sizeArray,iconSize){var iconImageSize=null;var nextIndex=0;for(var i in sizeArray){if(iconImageSize==null||Math.abs(sizeArray[i]-iconSize)<Math.abs(iconImageSize-iconSize)){iconImageSize=sizeArray[i];nextIndex++;}}
if((nextIndex<sizeArray.length)&&(iconSize>iconImageSize)){iconImageSize=sizeArray[nextIndex];}
return iconImageSize};SCOPE.toolkit.getPlatformScaleParameter=function(platformScaling){var scale=1;var platform=SCOPE.device.getPlatformType();switch(platform){case"mobile":scale=platformScaling.mobile;break;case"tablet":scale=platformScaling.tablet;break;case"desktop":scale=platformScaling.desktop;break;case"tv":scale=platformScaling.tv;break;}
return scale};SCOPE.toolkit.secondsToHMS=function(seconds){var seconds=Number(seconds);var h=Math.floor(seconds/3600);var m=Math.floor(seconds%3600/60);var s=Math.floor(seconds%3600%60);return((h>0?h+":":"")+(m>0?(m<10?"0":"")+m+":":"00:")+(s<10?"0":"")+s);};SCOPE.toolkit.addDaySuffix=function(i){var j=i%10;if(j==1&&i!=11){return i+"st";}
if(j==2&&i!=12){return i+"nd";}
if(j==3&&i!=13){return i+"rd";}
return i+"th";};SCOPE.toolkit.getDateLabel=function(date){var daysDiff=SCOPE.toolkit.calcDiffInDays(date,new Date());switch(daysDiff)
{case 0:return"Today";case 1:return"Tomorrow";default:return date.toDateString().split(" ")[1]+" "+SCOPE.toolkit.addDaySuffix(date.getDate());}};SCOPE.toolkit.calcDiffInDays=function(from,to){var diff=from-to;return Math.max(Math.ceil(diff/1000/60/60/24),0);};function removeQuestionMark(str){return str.charAt(0)==="?"?str.substring(1):str;}
SCOPE.toolkit.parseQueryString=function(querystring){var res={};if(querystring&&typeof querystring==="string"){var paramString=removeQuestionMark(querystring);var paramPartArray=paramString.split("&");_.each(paramPartArray,function(paramPart){var splittedParam=paramPart.split("=");res[splittedParam[0]]=splittedParam[1]?decodeURIComponent(splittedParam[1]):"";});}
return res;};SCOPE.toolkit.addCssPrefixes=function(prop,value){var cssStyle={};_.each(this.getCssPrefixes(),function(prefix){cssStyle[prefix+prop]=value;});return cssStyle;};SCOPE.toolkit.getCssPrefixes=function(){return['','-webkit-','-moz-','-ms-','-o-'];};SCOPE.toolkit.generateDate=function(){var now=new Date();var date=[now.getFullYear(),now.getMonth()+1,now.getDate()];var time=[now.getHours(),now.getMinutes(),now.getSeconds()];return date.join('-')+' '+time.join(':')+'.'+now.getMilliseconds();}})(IV);
(function(SCOPE){SCOPE.VideoRenditions=(function(){function VideoRenditions(){var renditionsMap={"iphone_stream":{"mimetype":"application/x-mpegurl","device":["iPhone","iPod","iPad","Android"],"extension":"m3u8","isHLS":true},"low.mp4":{"mimetype":"video/mp4"},"mp4":{"mimetype":"video/mp4"},"high.mp4":{"mimetype":"video/mp4","device":["Desktop"]},"webm":{"mimetype":"video/webm"},"specificRendition":{}};var extensionToRenditionMap={"m3u8":"iphone_stream","mp4":"mp4","webm":"webm"};var renditionsPriority=["specificRendition","high.mp4","iphone_stream","low.mp4","mp4","webm"];this.disableSupport=function(name){if(supported(name)){delete renditionsMap[name];}
return this;};this.add=function(name,url){if(supported(name)){renditionsMap[name]["src"]=filterURL(name,url);}
return this;};this.isDeviceSupported=function(name,device,supportsHLS){var deviceSupported=false;if(supported(name)){var rend=renditionsMap[name];if(rend.hasOwnProperty("device")){deviceSupported=(rend["isHLS"])?(rend["device"].indexOf(device)!=-1)&&supportsHLS:(rend["device"].indexOf(device)!=-1);}
else{deviceSupported=true;}}
return deviceSupported;};this.getIterator=function(){return new VideoRenditionsIterator(renditionsMap,renditionsPriority);};function supported(name){return renditionsMap.hasOwnProperty(name);}
function filterURL(name,url){if(renditionsMap.hasOwnProperty(name)){var rendition=renditionsMap[name];if(rendition.hasOwnProperty("extension")){url=url.replace("."+name,"."+rendition["extension"]);}}
return url;}
this.hasMimeType=function(name){return renditionsMap[name].hasOwnProperty('mimetype');};function getMimeTypeFromSource(extension){var renditionInMap=extensionToRenditionMap[extension];return renditionsMap[renditionInMap]['mimetype'];}
this.setMimeTypeBySource=function(name,src){var extension=src.substring(src.lastIndexOf('.')+1);if(extensionToRenditionMap.hasOwnProperty(extension)){renditionsMap[name]['mimetype']=getMimeTypeFromSource(extension);}};}
var VideoRenditionsIterator=(function(){function VideoRenditionsIterator(renditions,order){this.renditions=renditions;this.order=order;this.current=0;}
VideoRenditionsIterator.prototype.next=function(){var i=this.current;var rendWithSrc=null;while(i<_.size(this.order)&&rendWithSrc===null){var rend=this.renditions[this.order[i]];if(_.isObject(rend)&&rend.hasOwnProperty("src")){rendWithSrc=rend;this.current=i+1;}
i++;}
return rendWithSrc;};VideoRenditionsIterator.prototype.reset=function(){this.current=0;};return VideoRenditionsIterator;})();return VideoRenditions;})();})(IV);
(function(SCOPE){function renderCloseButton(core){var closeButton=$('<div id="iv-close-btn" />');closeButton.on(core.get('mainEngagementEvent'),function(ev){ev.preventDefault();core.report.submit({action:'close',event_value:'click'});SCOPE.Events.trigger(core.get('id')+':close');});core.canvas.addElement(closeButton);SCOPE.Events.trigger("closeButtonRendered");}
function unrenderCloseButton(){SCOPE.Events.trigger("closeButtonUnrendered");}
SCOPE.Events.on("IRollReady",function(core){var showCloseButton=core.get('CloseButton'),waitTillImpression=core.get('CloseButtonWaitToImpression');if(showCloseButton||waitTillImpression){SCOPE.Events.trigger("closeButtonEnabled");var renderFn;if(showCloseButton){renderFn=_.once(renderCloseButton.bind(this,core));}else{renderFn=unrenderCloseButton;}
var timeout=parseInt(core.get('CloseButtonTimeout'),10);if(isNaN(timeout))timeout=0;var timer=setTimeout(function(){renderFn();},timeout);SCOPE.Events.on(core.get('id')+':ad_started',function(){clearTimeout(timer);renderFn();});}});})(IV);
(function(SCOPE){SCOPE.Events.on("videoPlayerReady",function(core,videoPlayer,videoSpy){var elem,coreId=core.get('id'),enabled=true;function buildElem(){elem=$("<div class='iv-video-controls' />");elem.hide();elem.on(core.getVideoClickEventType(),function(){videoPlayer.play();IV.Events.trigger(coreId+":video_controls_play");});}
function bindEvents(){var pauseTimerId=null;["video_play","video_ended","buffering"].forEach(function(ev){videoSpy.on(ev,function(){hideControls();});});videoSpy.on("video_pause",function(){showControls();});["dialogClosed","slateClosed"].forEach(function(ev){IV.Events.on(coreId+':'+ev,function(){enabled=true});});["dialogOpened","slateOpened"].forEach(function(ev){IV.Events.on(coreId+':'+ev,function(){enabled=false});});function hideControls(){if(pauseTimerId){clearTimeout(pauseTimerId);pauseTimerId=null;}
elem.hide();}
function showControls(){pauseTimerId=setTimeout(function(){if(enabled&&!hasVideoEnded())elem.show();pauseTimerId=null;},500);}}
function hasVideoEnded(){return videoPlayer.getState()==="ended";}
if(core.get('showClickToResume')===true){buildElem();core.canvas.addResponsiveElement(elem);bindEvents();}});SCOPE.Events.on("previewPlayerReady",function(core){var elem=$('<div class="iv-video-controls" />');elem.on(core.getVideoClickEventType(),function(){IV.Events.trigger(core.get('id')+":preview_play_click");elem.hide();});$("#iv-iroll").append(elem);});})(IV);
(function(SCOPE){SCOPE.VideoElementWrapper=function(elem){this.elem=elem;this.fallbackDuration=0;};SCOPE.VideoElementWrapper.prototype.play=function(){this.elem.play();};SCOPE.VideoElementWrapper.prototype.pause=function(){this.elem.pause();};SCOPE.VideoElementWrapper.prototype.getAllSourceChildren=function(){return this.elem.children||[];};SCOPE.VideoElementWrapper.prototype.setSrc=function(src){this.elem.src=src;};SCOPE.VideoElementWrapper.prototype.hasSrc=function(){return!!this.elem.src;};SCOPE.VideoElementWrapper.prototype.getDuration=function(){return(isFinite(this.elem.duration)&&this.elem.duration>0)?this.elem.duration:this.fallbackDuration;};SCOPE.VideoElementWrapper.prototype.setFallbackDuration=function(fallbackDuration){this.fallbackDuration=fallbackDuration;};SCOPE.VideoElementWrapper.prototype.getCurrentTime=function(){return this.elem.currentTime;};SCOPE.VideoElementWrapper.prototype.getElem=function(){return this.elem;};SCOPE.VideoElementWrapper.prototype.on=function(event,callback){this.elem.addEventListener(event,callback);};SCOPE.VideoElementWrapper.prototype.canPlayType=function(mimeType){var canPlay;if(this.elem.canPlayType){canPlay=this.elem.canPlayType(mimeType);}else{var tempVideo=document.createElement('video');if(typeof tempVideo.canPlayType==="function"){canPlay=tempVideo.canPlayType(mimeType);}}
return(canPlay==='probably'||canPlay==='maybe');};SCOPE.VideoElementWrapper.prototype.load=function(){if(this.elem.load){this.elem.load();}};SCOPE.VideoElementWrapper.prototype.seekTo=function(secs){this.elem.currentTime=secs;};SCOPE.VideoElementWrapper.prototype.getVolume=function(){if(typeof this.elem.volume!=='undefined'){return this.elem.volume;}else{return-1;}};SCOPE.VideoElementWrapper.prototype.setVolume=function(val){if(typeof this.elem.volume!=='undefined'){var volumeNum=parseFloat(val);if(!isNaN(volumeNum)&&volumeNum>=0&&volumeNum<=1){this.elem.volume=volumeNum;}}};SCOPE.VideoElementWrapper.prototype.exitFullScreen=function(){if(this.elem.exitFullscreen){this.elem.exitFullscreen();}
else if(this.elem.webkitExitFullscreen){this.elem.webkitExitFullscreen();}};SCOPE.VideoElementWrapper.prototype.hasTracks=function(){return _.isElement(this.elem)&&$(this.elem).find("track").size()>0;};SCOPE.VideoElementWrapper.prototype.setMute=function(isMuted){this.elem.muted=isMuted;};})(IV);
(function(SCOPE){SCOPE.InternalVideoPlayer=function(core,initialVolume){var elem;this.video=null;this.core=null;this.spy=null;this.loaded=false;this.everPlayed=false;var videoOptions={preview:false,controls:[],autoplay:true,iroll:core};var startMuted=!!core.get("startMuted");this.videoContainer=$('<div class="video-container" />');var initialVol=_.isUndefined(initialVolume)?(startMuted?0:1):initialVolume;this.video=new SCOPE.html5video(videoOptions,this.videoContainer,initialVol);elem=new SCOPE.VideoElementWrapper(this.video.el);elem.setMute(startMuted);this.init=function(data,core){var that=this;this.spy=new SCOPE.VideoSpy(elem);if(data.customMetricsEnabled){this.spy.setCustomPoint(data.customMetricsTime)}
this.spy.on("all",function(eventName,ev){SCOPE.Events.trigger(core.get('id')+':'+eventName,ev);if(eventName==="video_short_buffering_time"||eventName==="video_long_buffering_time"){SCOPE.Events.trigger('buffering');}
else if(eventName!=="video_timeupdate"&&eventName!=="buffering"){SCOPE.Events.trigger('not_buffering');}});this.core=core;this.videoContainer.append(this.video.el);core.canvas.addElement(this.videoContainer);SCOPE.Events.on("video_click",function(ev){that.trigger("interact",ev)});SCOPE.Events.on('winResize',setSizes.bind(null,this));setSizes(this);SCOPE.Events.trigger("videoPlayerReady",core,this,this.spy);};this.loadVideoSource=function(renditionsConfig){this.loaded=this.video.setVideoSource(renditionsConfig);};var setSizes=function(context){var core=context.core;var adSize=core.canvas.getSize();context.videoContainer.css({width:adSize.width,height:adSize.height});};this.getDuration=function(){return this.video.getDuration();};this.getRemainingTime=function(){return this.video.getRemainingTime();};this.getCurrentTime=function(){return this.video.getCurrentTime();};this.play=function(){if(this.loaded){this.video.play();this.everPlayed=true;}
else{throw("Failed to load video");}};this.resume=function(){this.video.resume();};this.pause=function(){this.video.pause(true);};this.getState=function(){return this.spy.state;};this.isPlaying=function(){return(this.spy.state==="playing");};this.isEverPlayed=function(){return this.everPlayed;};this.preparePlay=function(){if(!this.everPlayed){this.video.load();}};this.getVolume=function(){return elem.getVolume();};this.setVolume=function(val){elem.setVolume(val);};this.exitFullScreen=function(){elem.exitFullScreen();};};_.extend(SCOPE.InternalVideoPlayer.prototype,Backbone.Events);})(IV);
(function(SCOPE){SCOPE.SharedVideoPlayer=function(elem){this.spy=null;this.active=true;this.loaded=false;this.elem=elem;this.init=function(data,core){var that=this;if(!elem instanceof IV.VideoElementWrapper){throw{'name':'TypeError','message':'elem must be a VideoElementWrapper'};}
if(data.video){elem.setFallbackDuration(data.video.duration);}
this.spy=new SCOPE.VideoSpy(elem);this.videoLoader=new SCOPE.VideoSourceLoader(elem,core);if(data.customMetricsEnabled){this.spy.setCustomPoint(data.customMetricsTime)}
this.spy.on("all",function(eventName,ev){SCOPE.Events.trigger(core.get('id')+':'+eventName,ev);if(eventName==="video_short_buffering_time"||eventName==="video_long_buffering_time"){SCOPE.Events.trigger('buffering');}
else if(eventName!=="video_timeupdate"){SCOPE.Events.trigger('not_buffering');}});var bareElem=elem.getElem();if(_.isElement(bareElem)){videoDecorators.applyByVideoId(bareElem.id,bareElem,core);}
SCOPE.Events.on("video_click",function(ev){if(that.active){that.trigger("interact",ev);}});SCOPE.Events.trigger("videoPlayerReady",core,this,this.spy);};this.loadVideoSource=function(renditionsConfig){this.videoLoader.loadVideoSource(renditionsConfig);this.loaded=this.videoLoader.isLoaded();};this.getCurrentTime=function(){return elem.getCurrentTime();};this.getDuration=function(){return elem.getDuration();};this.getRemainingTime=function(){return this.getDuration()-this.getCurrentTime();};this.play=function(){if(this.loaded){elem.play();}
else{throw new Error("Failed to load video");}};this.resume=function(){elem.play();};this.pause=function(){elem.pause();};this.getState=function(){return this.spy.state;};this.isPlaying=function(){return(this.spy.state==="playing");};this.isEverPlayed=function(){return true;};this.preparePlay=function(){};this.cleanUp=function(){if(this.spy)this.spy.off();this.active=false;};this.getVolume=function(){return elem.getVolume();};this.setVolume=function(val){elem.setVolume(val);};this.exitFullScreen=function(){elem.exitFullScreen();};var videoDecorators={applyByVideoId:function(videoId,videoElement,iroll){if(this.decorators.hasOwnProperty(videoId)){this.decorators[videoId].call(this,videoElement,iroll);SCOPE.Events.on('winResize',this.decorators[videoId].bind(this,videoElement,iroll));}},decorators:{"fwVPAIDPlayer":function(videoElement,iroll){$(videoElement).attr("webkit-playsinline","webkit-playsinline");$(videoElement).attr("playsinline","playsinline");var adSize=iroll.canvas.getSize();$(videoElement).css("width",adSize.width||"100%").css("height",adSize.height||"100%");}}};};_.extend(SCOPE.SharedVideoPlayer.prototype,Backbone.Events);})(IV);
(function(SCOPE){SCOPE.VideoSourceLoader=function(videoElem,core){var isLoaded=false;this.loadVideoSource=function(renditionsConfig){var renditions=new SCOPE.VideoRenditions(),foundSuitableSource=false;if(!core.get('supportHLS')||videoElem.hasTracks()){renditions.disableSupport("iphone_stream");}
if(SCOPE.InlineVideoValidator.shouldTransformToInlineVideo(SCOPE.device)){renditions.disableSupport("iphone_stream");}
if(_.isObject(renditionsConfig)&&_.size(renditionsConfig)>0){_.each(renditionsConfig,function(src,name){if(renditions.isDeviceSupported(name,SCOPE.device.getDeviceName(),SCOPE.device.isDeviceHLSSupported())){renditions.add(name,src);if(!renditions.hasMimeType(name)){renditions.setMimeTypeBySource(name,src);}}});var iterator=renditions.getIterator();var rend=iterator.next();while(rend!==null&&foundSuitableSource===false){if(videoElem.canPlayType(rend['mimetype'])){var hadSrc=videoElem.hasSrc();videoElem.setSrc(rend['src']);if(hadSrc){videoElem.load();}
foundSuitableSource=true;}else{rend=iterator.next();}}
if(!foundSuitableSource){SCOPE.Events.trigger(core.get('id')+':video_error');}}
isLoaded=foundSuitableSource;};this.isLoaded=function(){return isLoaded;}};})(IV);
(function(SCOPE){var updateOrientation=function(){$('body').attr('orientation',SCOPE.device.getDeviceOrientation());SCOPE.Events.trigger('orientationchange');};$(document).on('ready',function(){SCOPE.Events.trigger('domReady');});$(window).on('load',function(){SCOPE.Events.trigger('winLoad');});$(window).on('resize',function(){$('body').attr('orientation',SCOPE.device.getDeviceOrientation());});window.onorientationchange=updateOrientation;SCOPE.enableAnimations=SCOPE.device.supportsAnimations();$(function(){SCOPE.editingMode=false;$('body').css({"margin":0,"padding":0,"border":0,"fontSize":"100%","font":"inherit","verticalAlign":"baseline"});$('body').attr('orientation',SCOPE.device.getDeviceOrientation());$('html').attr('screen-size',SCOPE.device.getDeviceScreenSizeClass()).attr('auto-scale',SCOPE.device.getAndroidOSVersion()!=='');$('body').on('focus',".editable",function(){SCOPE.editingMode=true;});$('body').on("blur",".editable",function(){SCOPE.editingMode=false;});});})(IV);
var IV;(function(IV){var InUnitVideoQuartileReporter=(function(){function InUnitVideoQuartileReporter(iroll,spy,videoName,playStartTimeFunc,consoleLogUtil){this.iroll=iroll;this.reporter=this.iroll.report;this.spy=spy;this.videoName=videoName;this.getPlayStartTime=playStartTimeFunc;this.consoleLogUtil=consoleLogUtil;}
InUnitVideoQuartileReporter.prototype.start=function(){var _this=this;this.spy.on("video_play",_.once(function(){_this.sendReport(IV.Action.INVPLY,_this.videoName);}));this.spy.on("video_videoPassed25",_.once(function(){_this.sendReport(IV.Action.INVPT,_this.videoName,25);}));this.spy.on("video_videoPassed50",_.once(function(){_this.sendReport(IV.Action.INVPT,_this.videoName,50);}));this.spy.on("video_videoPassed75",_.once(function(){_this.sendReport(IV.Action.INVPT,_this.videoName,75);}));this.spy.on("video_ended",_.once(function(){_this.sendReport(IV.Action.INVPT,_this.videoName,100);}));};InUnitVideoQuartileReporter.prototype.stop=function(){this.spy.off("video_play");this.spy.off("video_videoPassed25");this.spy.off("video_videoPassed50");this.spy.off("video_videoPassed75");this.spy.off("video_ended");};InUnitVideoQuartileReporter.prototype.sendReport=function(action,eventId,eventValue){if(this.iroll.get("reportEventsToConsole")){this.consoleLogUtil.log(IV.InUnitVideoQuartileActionUtil.toMessage(action,eventId,eventValue));}
this.reporter.submit({action:IV.InUnitVideoQuartileActionUtil.toValue(action),relative_time:(new Date().getTime()-this.getPlayStartTime()),event_id:eventId,event_value:eventValue||""});};return InUnitVideoQuartileReporter;})();IV.InUnitVideoQuartileReporter=InUnitVideoQuartileReporter;})(IV||(IV={}));
var IV;(function(IV){var QueryStringReader=(function(){function QueryStringReader(tool){if(tool===void 0){tool=IV.toolkit;}
this.DEVICE_ID_PARAM_NAME="deviceid";this.toolkit=tool;}
QueryStringReader.prototype.getExternalCustomParams=function(currentScript,locationSearch){if(currentScript&&currentScript.src){locationSearch=currentScript.src.split("?")[1];}
return this.toolkit.parseQueryString(locationSearch);};QueryStringReader.prototype.getQueryIvcParam=function(currentScript){if(!currentScript||!currentScript.src||currentScript.src.indexOf("?")<0){return;}
var locationSearch=currentScript.src.split("?")[1];var parsedQueryParams=this.toolkit.parseQueryString(locationSearch);if("ivc"in parsedQueryParams){return encodeURIComponent(parsedQueryParams["ivc"]);}
else{return;}};QueryStringReader.prototype.getDeviceIdFromRequest=function(currentScript,locationsSearch){locationsSearch=this.fromCurrentScript(currentScript,locationsSearch);var params=this.toolkit.parseQueryString(locationsSearch);return this.isDeviceIdValid(params[this.DEVICE_ID_PARAM_NAME])?params[this.DEVICE_ID_PARAM_NAME]:undefined;};QueryStringReader.prototype.fromCurrentScript=function(currentScript,defaultValue){if(currentScript&&currentScript.src){var scriptQueryString=currentScript.src.split("?")[1];if(scriptQueryString&&scriptQueryString.indexOf(this.DEVICE_ID_PARAM_NAME)!==-1){defaultValue=scriptQueryString;}}
return defaultValue;};QueryStringReader.prototype.isDeviceIdValid=function(dId){return dId&&dId.length>0;};return QueryStringReader;})();IV.QueryStringReader=QueryStringReader;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoEventRouter=(function(){function InlineVideoEventRouter(videoElem){this.videoEventMap={};this.audioTemporaryEventMap={};this.videoElem=videoElem;this.audioElem=null;}
Object.defineProperty(InlineVideoEventRouter,"VIDEO_EVENTS",{get:function(){return["playing","ended","pause","play","timeupdate","durationchange","volumechange","seeked"];},enumerable:true,configurable:true});InlineVideoEventRouter.prototype.setAudioContext=function(audioElem){var _this=this;this.audioElem=audioElem;_.each(this.audioTemporaryEventMap,function(listeners,type){listeners.forEach(function(listener){_this.audioElem.addEventListener(type,listener.bind(_this.videoElem));});});this.audioTemporaryEventMap={};};InlineVideoEventRouter.prototype.route=function(type,listener){if(this.isVideoEvent(type)){if(this.videoEventMap.hasOwnProperty(type)){this.videoEventMap[type].push(listener);}
else{this.videoEventMap[type]=[listener];}}
else if(this.audioElem!==null){this.audioElem.addEventListener(type,listener.bind(this.videoElem));}
else{if(this.audioTemporaryEventMap.hasOwnProperty(type)){this.audioTemporaryEventMap[type].push(listener);}
else{this.audioTemporaryEventMap[type]=[listener];}}};InlineVideoEventRouter.prototype.raise=function(type){var _this=this;if(this.isVideoEvent(type)){if(this.videoEventMap.hasOwnProperty(type)){var listeners=this.videoEventMap[type];listeners.forEach(function(listener){listener.call(_this.videoElem,new Event(type));});}}};InlineVideoEventRouter.prototype.isVideoEvent=function(type){return _.contains(InlineVideoEventRouter.VIDEO_EVENTS,type);};return InlineVideoEventRouter;})();IV.InlineVideoEventRouter=InlineVideoEventRouter;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoFactory=(function(){function InlineVideoFactory(){}
InlineVideoFactory.create=function(videoElem,props){if(props===void 0){props=null;}
if(props===null){props={autoplayWithoutSound:false,showUnmuteButton:false};}
var router=new IV.InlineVideoEventRouter(videoElem);var inlineVideoWrapper=new IV.InlineVideoWrapper(videoElem,router,props,document);var renderer=new IV.InlineVideoRenderer(inlineVideoWrapper);var transformer=new IV.InlineVideoTransformer(inlineVideoWrapper,renderer);transformer.transform();return videoElem;};return InlineVideoFactory;})();IV.InlineVideoFactory=InlineVideoFactory;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoRenderer=(function(){function InlineVideoRenderer(inlineVideo,fps){if(fps===void 0){fps=25;}
this.inlineVideo=inlineVideo;this.canvas=null;this.context=null;this.lastTimeRendered=0;this.fps=fps;this.force=false;}
InlineVideoRenderer.prototype.render=function(){var currTime=new Date().getTime();if(this.inlineVideo.isVideoDone()){return;}
if(this.inlineVideo.isVideoPaused()){return;}
this.inlineVideo.beforeAnimation();if(this.lastTimeRendered===0){this.lastTimeRendered=currTime;this.force=true;}
else{this.force=false;}
var timeToAdd=(currTime-this.lastTimeRendered)/1000;if(this.shouldRender(timeToAdd)){if(this.inlineVideo.isAudioStarted()){this.inlineVideo.syncTimeToAudio();}
else{if(this.inlineVideo.currentTime+timeToAdd>this.inlineVideo.duration){timeToAdd=this.inlineVideo.duration-this.inlineVideo.currentTime;}
this.inlineVideo.updateTime(timeToAdd);}
this.lastTimeRendered=currTime;}
this.inlineVideo.afterAnimation();this.drawNextFrame();};InlineVideoRenderer.prototype.drawNextFrame=function(){var _this=this;requestAnimationFrame(function(){_this.render();});};InlineVideoRenderer.prototype.shouldRender=function(timeToAdd){return this.force?true:timeToAdd>=1/this.fps;};return InlineVideoRenderer;})();IV.InlineVideoRenderer=InlineVideoRenderer;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoTransformer=(function(){function InlineVideoTransformer(inlineVideo,renderer){this.inlineVideo=inlineVideo;this.renderer=renderer;}
InlineVideoTransformer.prototype.transform=function(){this.overrideMethods();this.overrideProperties();};InlineVideoTransformer.prototype.startVideoRendering=function(){this.renderer.render();this.inlineVideo.dispatch("playing");};InlineVideoTransformer.checkAndOverrideFastSeek=function(videoElem){if(typeof videoElem["fastSeek"]!=="function"){videoElem["fastSeek"]=function(time){videoElem.currentTime=time;};}};InlineVideoTransformer.prototype.overrideMethods=function(){var _this=this;var videoElem=this.inlineVideo.elem;videoElem["play"]=function(){if(_this.inlineVideo.isVideoPaused()){_this.inlineVideo.resume(function(){_this.startVideoRendering();});}
else{_this.inlineVideo.play(function(){_this.startVideoRendering();});}};videoElem["pause"]=function(){_this.inlineVideo.pause();};videoElem["addEventListener"]=function(type,listener){_this.inlineVideo.addEventListener(type,listener);};videoElem["fastSeek"]=function(time){_this.inlineVideo.setTime(time);};};InlineVideoTransformer.prototype.overrideProperties=function(){var _this=this;var videoElem=this.inlineVideo.elem;Object.defineProperty(videoElem,"loop",{get:function(){return _this.inlineVideo.loop;},set:function(loop){_this.inlineVideo.setLoop(loop);},enumerable:true,configurable:true});Object.defineProperty(videoElem,"volume",{get:function(){return _this.inlineVideo.volume;},set:function(vol){_this.inlineVideo.setVolume(vol);},enumerable:true,configurable:true});var oldSrc=videoElem.src;Object.defineProperty(videoElem,"src",{set:function(newSrc){if(oldSrc!==newSrc){oldSrc=newSrc;videoElem.setAttribute("src",newSrc);_this.inlineVideo.setSource(newSrc);}},get:function(){return oldSrc;},enumerable:true,configurable:true});var oldCurrSrc=videoElem.currentSrc;Object.defineProperty(videoElem,"currentSrc",{set:function(newCurrSrc){if(oldCurrSrc!==newCurrSrc){oldCurrSrc=newCurrSrc;videoElem.setAttribute("currentSrc",newCurrSrc);_this.inlineVideo.setSource(newCurrSrc);}},get:function(){return oldCurrSrc;},enumerable:true,configurable:true});};return InlineVideoTransformer;})();IV.InlineVideoTransformer=InlineVideoTransformer;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoValidator=(function(){function InlineVideoValidator(){}
Object.defineProperty(InlineVideoValidator,"VALID_DEVICE_NAMES",{get:function(){return["iPhone","iPod"];},enumerable:true,configurable:true});;Object.defineProperty(InlineVideoValidator,"VALID_iOS_VERSIONS",{get:function(){return["8.","9."];},enumerable:true,configurable:true});;InlineVideoValidator.shouldTransformToInlineVideo=function(deviceInfo,force){if(force===void 0){force=false;}
if(InlineVideoValidator.config===null){InlineVideoValidator.config=window["IV"].baseData.app_data;}
if(force){return true;}
if(typeof InlineVideoValidator.config!=="undefined"&&InlineVideoValidator.config.hasOwnProperty("iphone-inline")&&InlineVideoValidator.config["iphone-inline"]===false){return false;}
if(typeof deviceInfo==="undefined"){return false;}
return InlineVideoValidator.isMobileBrowserPlatform()&&InlineVideoValidator.isIOS(deviceInfo)&&InlineVideoValidator.isValidDeviceName(deviceInfo)&&InlineVideoValidator.isValidOS(deviceInfo);};InlineVideoValidator.isValidOS=function(deviceInfo){var valid=false;InlineVideoValidator.VALID_iOS_VERSIONS.forEach(function(osVersionPrefix){if(deviceInfo.getiPhoneOSVersion().indexOf(osVersionPrefix)===0){valid=true;}});return valid;};InlineVideoValidator.isValidDeviceName=function(deviceInfo){var valid=false;InlineVideoValidator.VALID_DEVICE_NAMES.forEach(function(deviceName){if(deviceInfo.getDeviceName()===deviceName){valid=true;}});return valid;};InlineVideoValidator.isMobileBrowserPlatform=function(){if(typeof window["IVAPPS"]!=="undefined"){if(window["IVAPPS"]===window["IV"].default){return true;}}
return false;};InlineVideoValidator.isIOS=function(deviceInfo){return deviceInfo.is_iOS();};InlineVideoValidator.config=null;return InlineVideoValidator;})();IV.InlineVideoValidator=InlineVideoValidator;})(IV||(IV={}));
var IV;(function(IV){var InlineVideoProperties=(function(){function InlineVideoProperties(){this.showUnmuteButton=false;this.autoplayWithoutSound=false;}
return InlineVideoProperties;})();IV.InlineVideoProperties=InlineVideoProperties;var InlineVideoWrapper=(function(){function InlineVideoWrapper(videoElem,router,props,contextDocument){this.videoElem=videoElem;this.props=props;this.creativeElementsInitialized=false;this.audioElem=null;this.source=videoElem.src||videoElem.currentSrc;this.paused=false;this.looped=false;this.loaded=false;this.ended=false;this.audioStarted=false;this.currentVolume=1;this.animating=false;this.audioPlayListener=null;this.router=router;this.contextDocument=contextDocument;this.bindEvents();}
Object.defineProperty(InlineVideoWrapper,"UNMUTE_BUTTON_SCALE",{get:function(){return 0.08;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.load=function(){if(this.loaded){return;}
if(this.audioElem){this.audioElem.load();}
this.videoElem.load();this.videoElem.currentTime=0;this.loaded=true;this.initCreativeElements();};InlineVideoWrapper.prototype.bindEvents=function(){var _this=this;var hiddenKey=null,visibilityChangeEventName=null;this.videoElem.addEventListener("loadedmetadata",function(){_this.dispatch("durationchange");});if(typeof this.contextDocument["hidden"]!=="undefined"){hiddenKey="hidden";visibilityChangeEventName="visibilitychange";}
else if(typeof this.contextDocument["webkitHidden"]!=="undefined"){hiddenKey="webkitHidden";visibilityChangeEventName="webkitvisibilitychange";}
if(hiddenKey!==null){this.contextDocument.addEventListener(visibilityChangeEventName,function(){if(_this.contextDocument[hiddenKey]===true){_this.pause();}});}};InlineVideoWrapper.prototype.initCreativeElements=function(){if(!this.creativeElementsInitialized){this.creativeElementsInitialized=true;this.hideNativePlayButton();this.hideControls();if(this.props.showUnmuteButton){this.showUnmuteButton();}}};InlineVideoWrapper.prototype.playAudio=function(){if(!this.audioElem){this.extractAudioFromVideo();}
if(this.isAudioStarted()&&this.paused){this.audioElem.play();}
else if(!this.isAudioStarted()){this.audioElem.play();}};InlineVideoWrapper.prototype.play=function(renderCallback){if(!this.paused){this.load();}
if(!this.props.autoplayWithoutSound){this.registerToAudioPlayEvent(renderCallback);this.playAudio();}
else{renderCallback();}
this.paused=false;this.ended=false;};InlineVideoWrapper.prototype.pause=function(){if(this.paused){return;}
this.paused=true;if(this.audioElem){this.audioElem.pause();}
this.dispatch("pause");};InlineVideoWrapper.prototype.resume=function(renderCallback){this.play(renderCallback);this.dispatch("play");};Object.defineProperty(InlineVideoWrapper.prototype,"loop",{get:function(){if(this.audioElem){return this.audioElem.loop;}
return this.looped;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.setLoop=function(loop){if(this.audioElem){this.audioElem.loop=loop;}
this.looped=loop;};Object.defineProperty(InlineVideoWrapper.prototype,"volume",{get:function(){return this.currentVolume;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.setVolume=function(vol){if(this.audioElem){this.audioElem.volume=vol;}
this.currentVolume=vol;this.dispatch("volumechange");};InlineVideoWrapper.prototype.isAudioStarted=function(){return this.audioStarted;};InlineVideoWrapper.prototype.isVideoPaused=function(){return this.paused;};InlineVideoWrapper.prototype.isVideoAlreadyLoaded=function(){return this.loaded;};Object.defineProperty(InlineVideoWrapper.prototype,"width",{get:function(){return this.videoElem.width||this.videoElem.offsetWidth;},enumerable:true,configurable:true});Object.defineProperty(InlineVideoWrapper.prototype,"height",{get:function(){return this.videoElem.height||this.videoElem.offsetHeight;},enumerable:true,configurable:true});Object.defineProperty(InlineVideoWrapper.prototype,"top",{get:function(){return this.videoElem.offsetTop;},enumerable:true,configurable:true});Object.defineProperty(InlineVideoWrapper.prototype,"left",{get:function(){return this.videoElem.offsetLeft;},enumerable:true,configurable:true});Object.defineProperty(InlineVideoWrapper.prototype,"duration",{get:function(){return this.videoElem.duration;},enumerable:true,configurable:true});Object.defineProperty(InlineVideoWrapper.prototype,"currentTime",{get:function(){return this.videoElem.currentTime;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.syncTimeToAudio=function(){this.setTime(this.audioElem.currentTime);};InlineVideoWrapper.prototype.updateTime=function(timeToAdd){this.setTime(this.videoElem.currentTime+timeToAdd);};InlineVideoWrapper.prototype.setTime=function(time){if(!this.animating&&this.audioElem){this.audioElem.currentTime=time;}
this.videoElem.currentTime=time;this.dispatch("timeupdate");this.dispatch("seeked");if(this.isVideoDone()){this.ended=true;this.dispatch("ended");}};InlineVideoWrapper.prototype.beforeAnimation=function(){this.animating=true;};InlineVideoWrapper.prototype.afterAnimation=function(){this.animating=false;};InlineVideoWrapper.prototype.setSource=function(source){this.source=source;if(this.audioElem){this.audioElem.src=source;}};Object.defineProperty(InlineVideoWrapper.prototype,"src",{get:function(){return this.videoElem.src||this.videoElem.currentSrc;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.isVideoDone=function(){return(this.ended&&!this.loop)||this.videoElem.currentTime>=this.videoElem.duration;};InlineVideoWrapper.prototype.addEventListener=function(type,listener){this.router.route(type,listener);};InlineVideoWrapper.prototype.dispatch=function(type){this.router.raise(type);};Object.defineProperty(InlineVideoWrapper.prototype,"elem",{get:function(){return this.videoElem;},enumerable:true,configurable:true});InlineVideoWrapper.prototype.extractAudioFromVideo=function(){var _this=this;this.audioElem=this.contextDocument.createElement("audio");this.audioElem.id="iv-inline-audio";this.audioElem.src=this.source;this.audioElem.volume=this.videoElem.volume;this.audioElem.loop=this.looped;this.audioElem.addEventListener("playing",function(){_this.audioStarted=true;_this.audioElem.currentTime=_this.videoElem.currentTime;if(_this.audioPlayListener){_this.audioPlayListener.call(_this);}});this.router.setAudioContext(this.audioElem);};InlineVideoWrapper.prototype.hideNativePlayButton=function(){var style=this.contextDocument.createElement("style");style.innerHTML="video::-webkit-media-controls-start-playback-button { display: none; }";this.contextDocument.getElementsByTagName("head")[0].appendChild(style);};InlineVideoWrapper.prototype.hideControls=function(){var style=this.contextDocument.createElement("style");style.innerHTML="video::-webkit-media-controls { display:none !important; }";this.contextDocument.getElementsByTagName("head")[0].appendChild(style);};InlineVideoWrapper.prototype.showUnmuteButton=function(){var _this=this;var div=this.contextDocument.createElement("div");var size=(this.width*InlineVideoWrapper.UNMUTE_BUTTON_SCALE);div.id="iv-inline-unmute-container";div.style.width=size+"px";div.style.height=size+"px";div.style.top=((this.top+this.height-5)-size)+"px";div.style.left=(this.left+5)+"px";div.style.position="absolute";div.style.zIndex="25";div.style.backgroundImage="url('___PATH___/assets/images/ui/unmute-button.png')";div.style.backgroundSize="cover";div.onclick=function(){div.style.display="none";_this.playAudio();};this.contextDocument.body.appendChild(div);};InlineVideoWrapper.prototype.registerToAudioPlayEvent=function(renderCallback){this.audioPlayListener=renderCallback;};return InlineVideoWrapper;})();IV.InlineVideoWrapper=InlineVideoWrapper;})(IV||(IV={}));
var IV;(function(IV){var IframeInjector=(function(){function IframeInjector(id,container,iframeConfig){if(container===void 0){container=null;}
if(iframeConfig===void 0){iframeConfig=null;}
this.container=null;this.id=id;this.container=container;this.iframeConfig=iframeConfig?iframeConfig:this.getDefaultIframeConfig();}
IframeInjector.prototype.createIframe=function(){return document.createElement("IFRAME");};IframeInjector.prototype.injectIframeIntoDoc=function(targetDoc,createdIframe){if(targetDoc===void 0){targetDoc=null;}
if(createdIframe===void 0){createdIframe=null;}
var ifr=(createdIframe)?createdIframe:this.createIframe();ifr.id=("iv-ext-ifr-"+this.id+"-")+(new Date().getTime()).toString();ifr.width=this.iframeConfig.width;ifr.height=this.iframeConfig.height;ifr.frameBorder=this.iframeConfig.border;this.setIframeSpecificAttributes(ifr);if(!this.injectIframe(targetDoc,this.container,ifr)){return null;}
return ifr;};IframeInjector.prototype.injectIframeOnElement=function(container,ifr){if(container){container.appendChild(ifr);return true;}
return false;};IframeInjector.prototype.getDefaultIframeConfig=function(){return new IV.IframeConfigBuilder().setWidth("0").setHeight("0").setDisplay("none").setBorder("0").build();};return IframeInjector;})();IV.IframeInjector=IframeInjector;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var FriendlyIframeInjector=(function(_super){__extends(FriendlyIframeInjector,_super);function FriendlyIframeInjector(){_super.apply(this,arguments);}
FriendlyIframeInjector.prototype.injectIframe=function(targetDoc,container,ifr){return this.injectIframeOnElement(targetDoc.body,ifr)||this.injectIframeOnElement(container,ifr);};FriendlyIframeInjector.prototype.setIframeSpecificAttributes=function(ifr){ifr.style.display=this.iframeConfig.display;};return FriendlyIframeInjector;})(IV.IframeInjector);IV.FriendlyIframeInjector=FriendlyIframeInjector;})(IV||(IV={}));
var IV;(function(IV){var IframeConfig=(function(){function IframeConfig(builder){this._width=builder.width;this._height=builder.height;this._display=builder.display;this._border=builder.border;this._src=builder.src;this._zIndex=builder.zIndex;this._position=builder.position;this._left=builder.left;this._top=builder.top;this._visibility=builder.visibility;}
Object.defineProperty(IframeConfig.prototype,"width",{get:function(){return this._width;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"height",{get:function(){return this._height;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"display",{get:function(){return this._display;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"border",{get:function(){return this._border;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"src",{get:function(){return this._src;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"zIndex",{get:function(){return this._zIndex;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"position",{get:function(){return this._position;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"left",{get:function(){return this._left;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"top",{get:function(){return this._top;},enumerable:true,configurable:true});Object.defineProperty(IframeConfig.prototype,"visibility",{get:function(){return this._visibility;},enumerable:true,configurable:true});return IframeConfig;})();IV.IframeConfig=IframeConfig;})(IV||(IV={}));
var IV;(function(IV){var IframeConfigBuilder=(function(){function IframeConfigBuilder(){}
Object.defineProperty(IframeConfigBuilder.prototype,"width",{get:function(){return this._width;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"height",{get:function(){return this._height;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"display",{get:function(){return this._display;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"zIndex",{get:function(){return this._zIndex;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"border",{get:function(){return this._border;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"src",{get:function(){return this._src;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"position",{get:function(){return this._position;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"left",{get:function(){return this._left;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"top",{get:function(){return this._top;},enumerable:true,configurable:true});Object.defineProperty(IframeConfigBuilder.prototype,"visibility",{get:function(){return this._visibility;},enumerable:true,configurable:true});IframeConfigBuilder.prototype.setWidth=function(value){this._width=value;return this;};IframeConfigBuilder.prototype.setHeight=function(value){this._height=value;return this;};IframeConfigBuilder.prototype.setDisplay=function(value){this._display=value;return this;};IframeConfigBuilder.prototype.setZIndex=function(value){this._zIndex=value;return this;};IframeConfigBuilder.prototype.setPosition=function(value){this._position=value;return this;};IframeConfigBuilder.prototype.setLeft=function(value){this._left=value;return this;};IframeConfigBuilder.prototype.setTop=function(value){this._top=value;return this;};IframeConfigBuilder.prototype.setBorder=function(value){this._border=value;return this;};IframeConfigBuilder.prototype.setSrc=function(value){this._src=value;return this;};IframeConfigBuilder.prototype.setVisibility=function(value){this._visibility=value;return this;};IframeConfigBuilder.prototype.build=function(){return new IV.IframeConfig(this);};return IframeConfigBuilder;})();IV.IframeConfigBuilder=IframeConfigBuilder;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var NonFriendlyIframeInjector=(function(_super){__extends(NonFriendlyIframeInjector,_super);function NonFriendlyIframeInjector(){_super.apply(this,arguments);}
NonFriendlyIframeInjector.prototype.injectIframe=function(targetDoc,container,ifr){return this.injectIframeOnElement(container,ifr);};NonFriendlyIframeInjector.prototype.setIframeSpecificAttributes=function(ifr){ifr.src=this.iframeConfig.src;ifr.style.zIndex=this.iframeConfig.zIndex;ifr.style.position=this.iframeConfig.position;ifr.style.left=this.iframeConfig.left;ifr.style.top=this.iframeConfig.top;ifr.style.visibility=this.iframeConfig.visibility;};return NonFriendlyIframeInjector;})(IV.IframeInjector);IV.NonFriendlyIframeInjector=NonFriendlyIframeInjector;})(IV||(IV={}));
(function(SCOPE){var format;SCOPE.CustomFormat=function(iroll,data){var that=this,disableClickTruReporting=false,inUnitVidQuartileReporters=[],videoVolumeHandlers=[];this.iroll=iroll;this.data=data;this.Events=function(){};_.extend(this.Events,Backbone.Events);this.play=function(){var videoPlayer=iroll.get('videoPlayer');if(videoPlayer.isPlaying()){this.Events.trigger("video_play");}
videoPlayer.play();};this.pause=function(){iroll.get('videoPlayer').pause();};this.skip=function(){var skipAdHandler=new SCOPE.SkipAdHandler(iroll);skipAdHandler.skipAd();};this.preparePlay=function(){iroll.get('videoPlayer').preparePlay();};this.getDevicePlatformType=function(){return SCOPE.device.getPlatformType();};this.getDeviceOSType=function(){return SCOPE.device.getOSType();};this.canPlayInline=function(){return SCOPE.device.canPlayInline()||this.iroll.supportFeature("inlineVideo");};this.initVideo=function(videoElem,videoData){var elem=new SCOPE.VideoElementWrapper(videoElem),videoLoader=new SCOPE.VideoSourceLoader(elem,iroll),spy=new SCOPE.VideoSpy(elem);if(_.isUndefined(videoData.media))
{throw"could not find a video 'media' data in config";}
if(_.isUndefined(videoData.media.renditions))
{throw"could not find a video 'renditions' data in the config";}
bindInUnitVideoVolumeHandler();bindInUnitVideoQuartileReporter();videoLoader.loadVideoSource(videoData.media.renditions);function bindInUnitVideoVolumeHandler(){var videoVolumeHandler=new SCOPE.VideoVolumeHandler(videoElem);videoVolumeHandler.bindVolumeChangeEvent(iroll.get("videoPlayer").getVolume());videoVolumeHandlers.push(videoVolumeHandler);}
function bindInUnitVideoQuartileReporter(){var inUnitVidQuartileReporter=new SCOPE.InUnitVideoQuartileReporter(iroll,spy,videoData.name,function(){return iroll.get('playStartTime');},new SCOPE.ConsoleLogUtil());inUnitVidQuartileReporter.start();inUnitVidQuartileReporters.push(inUnitVidQuartileReporter);}};this.disableClickTruReporting=function(){disableClickTruReporting=true;};this.enableClickTruReporting=function(){disableClickTruReporting=false;};this.reportHotSpotTracking=function(eventId){if(_.isObject(this.iroll.get('data')['placement-config'])){var hotSpotClicks=this.iroll.get('data')['placement-config']['hotspot-clicks'];if(hotSpotClicks){hotSpotClicks.forEach(function(hotspot){if(hotspot.id===eventId&&hotspot.tracking){that.iroll.report.submit3rdPartyTracking(hotspot.tracking);}});}}};this.transformToInlineVideo=function(videoElem){SCOPE.InlineVideoFactory.create(videoElem);};this.shouldTransformToInlineVideo=function(){return SCOPE.InlineVideoValidator.shouldTransformToInlineVideo(SCOPE.device);};this.checkAndOverrideFastSeek=function(videoElem){SCOPE.InlineVideoTransformer.checkAndOverrideFastSeek(videoElem);};this.openUrl=function(label){SCOPE.Events.trigger(iroll.get('id')+':userClick');if(!disableClickTruReporting&&!iroll.childVideoService.childVideoPlaying()){iroll.report.clickthru(label);}
that.reportHotSpotTracking(label);if(iroll.get('videoPlayer').isPlaying()){iroll.get('videoPlayer').pause();}
if(iroll.get('reportEventsToConsole')){console.log(">>>> HTML Custom clickthru label: "+label);}};this.reportSlateEvent=function(action){var relativeTime=0;if(iroll.get('playStartTime')){relativeTime=new Date().getTime()-iroll.get('playStartTime');}
iroll.report.submit({action:action,event_id:'slate',event_value:'click',relative_time:relativeTime});};this.shouldWrapCreativeWithIframe=function(){return iroll.shouldWrapCreativeWithIframe();};var reportEventHandler=function(type,label,value){var logParam="";iroll.report.submit({action:'clkint',relative_time:(new Date().getTime()-iroll.get('playStartTime')),event_id:label,event_value:value||''});that.reportHotSpotTracking(label);if(type==="reportEventWithoutEngagement"){logParam="- no engagement"}
if(iroll.get('reportEventsToConsole')){console.log(">>>> HTML Custom in-unit label%s: %s (event value = %s)",logParam,label,value);}};var reportCreativeDebugHandler=function(label,value){iroll.report.reportCreativeDebugLog({action:'creative',relative_time:(new Date().getTime()-iroll.get('playStartTime')),event_id:label,event_value:value||''});};var reportCreativeDebugListener=function(){that.Events.on('reportCreativeDebugEvent',function(label,value){reportCreativeDebugHandler(label,value);});};function mapFormatEventsToCoreActions(){that.Events.on('ad_play',function(forceImmediateImpression){SCOPE.Events.trigger(iroll.get('id')+':ad_play',forceImmediateImpression);});that.Events.on('ad_ended',function(){SCOPE.Events.trigger(iroll.get('id')+':ad_ended');});that.Events.on('userClick',function(){SCOPE.Events.trigger(iroll.get('id')+':userClick');});that.Events.on('reportEvent',function(label,value){SCOPE.Events.trigger(iroll.get('id')+':userClick');reportEventHandler("reportEvent",label,value);});that.Events.on('reportEventWithoutEngagement',function(label,value){reportEventHandler("reportEventWithoutEngagement",label,value);});that.Events.on('timeEarnedStart',function(){that.pause();that.reportSlateEvent('cxon');});that.Events.on('slateOpened',function(){SCOPE.Events.trigger(iroll.get('id')+':slateOpened');that.iroll.fireTrackingEvent("adOverlayShowExpanded");if(!(SCOPE.device.canPlayInline()||iroll.get("inlinePlaybackForced"))){iroll.get("videoPlayer").exitFullScreen();}});that.Events.on('surveyOpened',function(){SCOPE.Events.trigger(iroll.get('id')+':surveyOpened');});that.Events.on('timeEarnedStop',function(playAgain){if(playAgain)that.play();that.reportSlateEvent('cxoff');});that.Events.on('slateClosed',function(){SCOPE.Events.trigger(iroll.get('id')+':slateClosed');that.iroll.fireTrackingEvent("adOverlayHideExpanded");});that.Events.on('surveyClosed',function(){SCOPE.Events.trigger(iroll.get('id')+':surveyClosed');});that.Events.on('auto_engage',function(){SCOPE.Events.trigger(iroll.get('id')+':auto_engage');});}
function mapCoreEventsToFormatEvents(){SCOPE.Events.on('winResize',function(){var scale=iroll.canvas.getDefaultFontSize()*iroll.canvas.getScale();iroll.canvas.setScale(scale);that.Events.trigger('winResize');});SCOPE.Events.on('orientationChange',function(){that.Events.trigger('orientationChange');});SCOPE.Events.on("volumechange",function(vol){that.Events.trigger("volumechange",vol);});SCOPE.Events.on(iroll.get('id')+':video_play',function(){that.Events.trigger('video_play');});SCOPE.Events.on(iroll.get('id')+':video_pause',function(){that.Events.trigger('video_pause');});SCOPE.Events.on(iroll.get('id')+':video_ended',function(){that.Events.trigger('video_ended');});SCOPE.Events.on(iroll.get('id')+':video_videoPassed25',function(){that.Events.trigger('video_videoPassed25');});SCOPE.Events.on(iroll.get('id')+':video_videoPassed50',function(){that.Events.trigger('video_videoPassed50');});SCOPE.Events.on(iroll.get('id')+':video_videoPassed75',function(){that.Events.trigger('video_videoPassed75');});}
SCOPE.Events.on(iroll.get('id')+':video_exitfullscreen',function(){SCOPE.Events.trigger('video_ended');});mapFormatEventsToCoreActions();mapCoreEventsToFormatEvents();reportCreativeDebugListener();};SCOPE.Events.on("IRollInit",function(core){var forceInternalPlayer=core.shouldForceInternalPlayer();var initialVolume=core.has("videoPlayer")?core.get("videoPlayer").getVolume():1;if(forceInternalPlayer){core.setAttribute({videoPlayer:new SCOPE.InternalVideoPlayer(core,initialVolume)});}});SCOPE.Events.on("IRollReady",function(iroll,data){format=new SCOPE.CustomFormat(iroll,data);var canvas=iroll.canvas;var loadingSpinner=$('<div id="iv-buffering-spinner"></div>');loadingSpinner.width(canvas.getSize().width).height(canvas.getSize().height);canvas.addElement(loadingSpinner);SCOPE.Events.on('winResize',function(){loadingSpinner.width(canvas.getSize().width).height(canvas.getSize().height);});SCOPE.Events.on('buffering',function(){loadingSpinner.addClass("iv-buffering");});SCOPE.Events.on('not_buffering',function(){loadingSpinner.removeClass("iv-buffering");});var scale=canvas.getDefaultFontSize()*canvas.getScale();canvas.setScale(scale);canvas.registerInteractEvent();SCOPE.Events.trigger("CustomFormatReady",format);},this);})(IV);
var IVA;(function(SCOPE){SCOPE.registerCreative=function(onReadyCallback){if(typeof IV==="undefined"){throw new Error("IV is undefined. Did you include the core library in your project?");}
IV.Events.on('CustomFormatReady',function(contextImpl){if(!contextImpl.shouldWrapCreativeWithIframe()){SCOPE.Events.trigger("StartCreative",contextImpl);}});SCOPE.Events.on("StartCreative",_.once(function(contextImpl){IVA.creativeContext=new SCOPE.Context(contextImpl);onReadyCallback.call(this,IVA.creativeContext);contextImpl.preparePlay();}));};SCOPE.Events=function(){};_.extend(SCOPE.Events,Backbone.Events);})(IVA||(IVA={}));
(function(SCOPE){SCOPE.IRoll=function(contextImpl){var iroll=contextImpl.iroll,program=new SCOPE.Program(contextImpl),preloadCache={};this.start=function(){var preSurvey=program.preContentSurvey();var beforeNode=program.beforeVideo();var afterNode=program.afterVideo();var postSurvey=program.postContentSurvey();preSurvey.execute(function(){beforeNode.execute(function(){contextImpl.play();});contextImpl.Events.on('video_ended',function(){afterNode.execute(function(){postSurvey.execute(function(){contextImpl.Events.trigger("ad_ended");});});});var forceImpression=beforeNode.willOpen()?true:false;contextImpl.Events.trigger("ad_play",forceImpression);});};this.openURL=function(label,customURL){if(!_.isString(label)||_.isEmpty(label)){throw new TypeError("label must be a non empty string");}
var url=customURL||getUrl(label);if(_.isUndefined(url)){throw new TypeError("there is no url defined for the given label: "+label);}
if(!SCOPE.Utils.isValidUrl(url)){throw new TypeError("url must be a valid url");}
contextImpl.openUrl(label);iroll.windowOpen(url,label);SCOPE.Events.trigger("openURL",label);};this.skip=function(){program.finish(function(){contextImpl.skip();});};this.reportEvent=function(label,value){triggerReportEvent("reportEvent",label,value);};this.reportCreativeDebugEvent=function(label,value){triggerReportEvent("reportCreativeDebugEvent",label,value);};this.reportEventWithoutEngagement=function(label,value){triggerReportEvent("reportEventWithoutEngagement",label,value);};this.getVolume=function(){var vol=iroll.get('videoPlayer').getVolume();if(typeof vol==='undefined'){vol=null;}else if(typeof vol!=='number'){vol=parseFloat(vol);}
return vol;};this.onVolumeChange=function(handlerFn){if(typeof handlerFn!=='function')return;contextImpl.Events.on("volumechange",function(){handlerFn(this.getVolume());},this);};this.getProgram=function(){return program;};this.injectCSS=function(assetName){var cssSuffix=".css";if(typeof assetName==="string"&&assetName.indexOf(cssSuffix,assetName.length-cssSuffix.length)!==-1){var path=SCOPE.Utils.getAssetPathWithCB(assetName);iroll.canvas.injectCss(path);}
else{throw"assetName is not a valid asset name";}};this.preloadAssets=function(assets,callback){var failedAssets=[],loadedAssetsCount=0,assetArr;function toArray(value){return _.isArray(value)?value:[value];}
assetArr=toArray(assets).filter(function(asset){return _.isString(asset)&&asset.length>0;}).filter(function(asset){return!preloadCache.hasOwnProperty(asset);});var preloader=new SCOPE.Preloader({onSuccess:function(){loadedAssetsCount++;},onError:function(asset){loadedAssetsCount++;failedAssets.push(asset);},onDone:function(){if(loadedAssetsCount===assetArr.length){callback(failedAssets);}}});assetArr.forEach(function(asset){preloader.preloadAsset(asset,SCOPE.Utils.getAssetPath(asset));preloadCache[asset]=true;});};var getUrl=function(label){var url;if(_.isObject(iroll.get('data')['placement-config'])){url=getHotspotUrl(label);}
else if(_.isObject(iroll.get('data')['html-click-thrus'])){url=iroll.get('data')['html-click-thrus'][label];}
return url;};var getHotspotUrl=function(label){var hotspotUrl;var hotSpotClicks=iroll.get('data')['placement-config']['hotspot-clicks'];if(hotSpotClicks){_.every(hotSpotClicks,function(hotspot){if(hotspot.id===label){hotspotUrl=hotspot.main;return false;}
else{return true;}});}
return hotspotUrl;};var triggerReportEvent=function(type,label,value){if(typeof type!=="string"||type.length===0){throw new TypeError("type must be a non empty string");}
if(typeof label!=="string"||label.length===0){throw new TypeError("label must be a non empty string");}
contextImpl.Events.trigger(type,label,value);SCOPE.Events.trigger(type,label,value);};};})(IVA||(IVA={}));
(function(SCOPE){var ProgramNodeBucket=function(){var nodesBucket=[];this.add=function(node,slate){var exists=_.find(nodesBucket,function(aNode){return aNode.node===node;});if(!exists){nodesBucket.push({node:node,slate:slate});}};this.clear=function(node){nodesBucket=_.filter(nodesBucket,function(aNode){return aNode.node!==node;});};this.getAll=function(){return nodesBucket;};};SCOPE.ProgramNode=function(contextImpl,bucket){var that=this,_willOpen=false;var action=function(callback){callback();};this.willOpen=function(){return _willOpen;};this.open=function(slate){_willOpen=true;action=function(callback){bucket.add(that,slate);slate._open(contextImpl);that.trigger("open");slate.on("close",_.once(function(){that.trigger("close");callback();}));};};this.close=function(slate){action=function(callback){bucket.clear(that);slate.close();callback();};};this.show=function(overlay){action=function(callback){overlay._show(contextImpl);callback();};};this.hide=function(overlay){action=function(callback){overlay.hide();callback();};};this.execute=function(callback){that.on("done",callback);action(function(){that.trigger("done");});};};_.extend(IVA.ProgramNode.prototype,Backbone.Events);SCOPE.ProgramNowNode=function(contextImpl,bucket){this.open=function(slate){var that=this;bucket.add(this,slate);slate.on("close",_.once(function(){that.trigger("close");}));slate._open(contextImpl);this.trigger("open");};this.close=function(slate){bucket.clear(this);slate.close();};this.show=function(overlay){overlay._show(contextImpl);};this.hide=function(overlay){overlay.hide();};};_.extend(SCOPE.ProgramNowNode.prototype,Backbone.Events);SCOPE.Program=function(contextImpl){var bucket=new ProgramNodeBucket(),finished=false;var beforeNode=new SCOPE.ProgramNode(contextImpl,bucket),afterNode=new SCOPE.ProgramNode(contextImpl,bucket);var beforeContentNode=new SCOPE.ProgramNode(contextImpl,bucket),afterContentNode=new SCOPE.ProgramNode(contextImpl,bucket);beforeContentNode.on('open',_.once(function(){contextImpl.Events.trigger('surveyOpened');}));beforeContentNode.on('close',_.once(function(){contextImpl.Events.trigger('surveyClosed');}));beforeNode.on('open',_.once(function(){contextImpl.Events.trigger('slateOpened');}));beforeNode.on('close',_.once(function(){contextImpl.Events.trigger('slateClosed');}));afterNode.on('open',_.once(function(){contextImpl.Events.trigger('slateOpened');contextImpl.Events.trigger('timeEarnedStart');}));afterNode.on('close',_.once(function(){contextImpl.Events.trigger('slateClosed');contextImpl.Events.trigger('timeEarnedStop',false);}));afterContentNode.on('open',_.once(function(){contextImpl.Events.trigger('surveyOpened');}));afterContentNode.on('close',_.once(function(){contextImpl.Events.trigger('surveyClosed');}));var intervalMs=50,timeline=new SCOPE.Timeline(contextImpl,intervalMs);this.beforeVideo=function(){return beforeNode;};this.afterVideo=function(){return afterNode;};this.preContentSurvey=function(){return beforeContentNode;};this.postContentSurvey=function(){return afterContentNode;};this.at=function(videoPos){if(typeof videoPos!=="number"){throw new Error("Cannot attach a program node: Video position is not a number");}
var node=new SCOPE.ProgramNode(contextImpl,bucket);node.on('open',function(){contextImpl.Events.trigger('slateOpened');contextImpl.Events.trigger('timeEarnedStart');});node.on('close',function(){contextImpl.Events.trigger('slateClosed');contextImpl.Events.trigger('timeEarnedStop',isFinished()?false:true);});timeline.at(videoPos,node.execute);return node;};this.after=function(videoPos){if(typeof videoPos!=="number"){throw new Error("Cannot attach a program node: Video position is not a number");}
var node=new SCOPE.ProgramNode(contextImpl,bucket);node.on('open',function(){contextImpl.Events.trigger('slateOpened');contextImpl.Events.trigger('timeEarnedStart');});node.on('close',function(){contextImpl.Events.trigger('slateClosed');contextImpl.Events.trigger('timeEarnedStop',isFinished()?false:true);});timeline.after(videoPos,node.execute);return node;};this.now=function(){var node=new SCOPE.ProgramNowNode(contextImpl,bucket);node.on('open',function(){contextImpl.Events.trigger('slateOpened');contextImpl.Events.trigger('timeEarnedStart');});node.on('close',function(){contextImpl.Events.trigger('slateClosed');contextImpl.Events.trigger('timeEarnedStop',isFinished()?false:true);});return node;};this.finish=function(callback){finished=true;timeline.stop();bucket.getAll().forEach(function(aNode){var node=aNode.node,slate=aNode.slate;node.close(slate);if(typeof node.execute==='function'){node.execute(_.noop);}});if(typeof callback==='function')callback();};function isFinished(){return finished;}};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Timeline=function(contextImpl,intervalTimeMs){var that=this;var video=new SCOPE.Video(contextImpl);var events=[];var interval;var isIntervalSet=false;contextImpl.Events.on('video_play',function(){if(!isIntervalSet){events=_.map(events,normalizeTime);events=_.sortBy(events,'time');checkEventsTime();interval=setInterval(checkEventsTime,intervalTimeMs);isIntervalSet=true;}});['video_pause','video_ended'].forEach(function(evtName){contextImpl.Events.on(evtName,function(){that.stop();});});var checkEventsTime=function(){_.every(events,function(event){var timeDiff=(event.time-video.getCurrentTime())*1000;if(event.isTimeToPlay(timeDiff)){events=_.without(events,event);event.callback();return true;}else if(timeDiff>=0&&timeDiff<intervalTimeMs){setTimeout(function(){events=_.without(events,event);event.callback();},timeDiff);return true;}else{return false;}});};var normalizeTime=function(event){if(event.time<0)
{event.time=video.getDuration()+event.time;}
return event;};var addEventToQueue=function(event){if(typeof video.getDuration()!=='undefined'){event=normalizeTime(event);}
events.push(event);events=_.sortBy(events,'time');};this.at=function(time,callback){var event={callback:callback,time:time,isTimeToPlay:function(timeDiff){return(timeDiff<0&&timeDiff>-intervalTimeMs);}};addEventToQueue(event);};this.after=function(time,callback){var event={callback:callback,time:time,isTimeToPlay:function(timeDiff){return(timeDiff<0);}};addEventToQueue(event);};this.getEvents=function(){return events;};this.isIntervalSet=function(){return isIntervalSet;};this.stop=function(){if(this.isIntervalSet()){clearInterval(interval);isIntervalSet=false;}};};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.ConfigSection=function(data){this.section=function(key){if(data.hasOwnProperty(key)&&typeof data[key]==="object"){return new SCOPE.ConfigSection(data[key]);}else{return new SCOPE.ConfigSection({});}};this.value=function(key,defVal){var val=defVal;if(data.hasOwnProperty(key)){if(typeof data[key]!=="object"){val=data[key];}}
return val;};this.array=function(key){if(_.isArray(data[key])){return data[key].slice(0);}else{return[];}};};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.PlayerPlayButtonState={PAUSED:1,PLAYED:2,UNKNOWN:3};SCOPE.Player=function(contextImpl){var iroll=contextImpl.iroll;var playerStates={paused:SCOPE.PlayerPlayButtonState.PAUSED,played:SCOPE.PlayerPlayButtonState.PLAYED};var playerState=SCOPE.PlayerPlayButtonState.UNKNOWN;this.getState=function(){return playerState;};iroll.on('playButtonStateChanged',function(state){if(state in playerStates){playerState=playerStates[state];contextImpl.Events.trigger('playButtonStateChanged');}});};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Context=function(contextImpl){var filteredPlacementConfig={};if(contextImpl.data.hasOwnProperty("placement-config")){filteredPlacementConfig=JSON.parse(JSON.stringify(contextImpl.data["placement-config"]));}
if(filteredPlacementConfig.hasOwnProperty("tracking-events")){delete filteredPlacementConfig["tracking-events"];}
var iRoll=new SCOPE.IRoll(contextImpl),video=new SCOPE.Video(contextImpl),player=new SCOPE.Player(contextImpl),config=new SCOPE.ConfigSection(contextImpl.data["html-custom-data"]||{}),plcConf=new SCOPE.ConfigSection(filteredPlacementConfig),device=new SCOPE.Device(contextImpl);this.getIroll=function(){return iRoll;};this.getVideo=function(){return video;};this.getPlayer=function(){return player;};this.getConfig=function(){return config;};this.getPlacementConfig=function(){return plcConf;};this.getStudioPropertiesConfig=function(key){var studioPropConf=contextImpl.data["html-studio-properties"];var value=void(0);if(Array.isArray(studioPropConf)&&studioPropConf.length>0){studioPropConf.some(function(property){if(property.hasOwnProperty(key)){value=property[key].toString();return true;}});}
return value;};this.getDevice=function(){return device;};this.isSecured=function(){return location.protocol=="https:";};this.on=function(eventName,cb,context){contextImpl.Events.on(eventName,cb,context);};this.trigger=function(eventName){contextImpl.Events.trigger(eventName);};this.__contextImpl=contextImpl;};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Device=function(contextImpl){var
that=this;this.getOrientation=function(){var aspectRatio=1.3;var adSize=contextImpl.iroll.canvas.getSize();return(adSize.height*aspectRatio>adSize.width)?SCOPE.Device.Orientation.PORTRAIT:SCOPE.Device.Orientation.LANDSCAPE;};this.getPlatformType=function(){var platformTypes={"mobile":SCOPE.Device.PlatformType.MOBILE,"tablet":SCOPE.Device.PlatformType.TABLET,"desktop":SCOPE.Device.PlatformType.DESKTOP,"tv":SCOPE.Device.PlatformType.TV};var type=contextImpl.getDevicePlatformType();return platformTypes[type];};this.getOSType=function(){var osTypes={"ios":SCOPE.Device.OSType.IOS,"android":SCOPE.Device.OSType.ANDROID,"other":SCOPE.Device.OSType.OTHER};var type=contextImpl.getDeviceOSType();return osTypes[type];};this.canPlayInline=function(){return contextImpl.canPlayInline()||contextImpl.iroll.get("inlinePlaybackForced");};this.onOrientationChange=function(handlerFn){contextImpl.Events.on('orientationChange',function(){handlerFn(that.getOrientation());});};};SCOPE.Device.Orientation={"LANDSCAPE":1,"PORTRAIT":2};SCOPE.Device.OSType={"IOS":1,"ANDROID":2,"OTHER":3};SCOPE.Device.PlatformType={"MOBILE":1,"TABLET":2,"DESKTOP":3,"TV":4};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.VideoState={PLAYING:1,PAUSED:2,ENDED:3,UNKNOWN:4};SCOPE.Video=function(contextImpl){var iroll=contextImpl.iroll;var videoStates={playing:SCOPE.VideoState.PLAYING,paused:SCOPE.VideoState.PAUSED,ended:SCOPE.VideoState.ENDED};this.getState=function(){var state=iroll.get("videoPlayer").getState();if(state in videoStates){return videoStates[state];}
return SCOPE.VideoState.UNKNOWN;};this.getDuration=function(){var duration=iroll.get("videoPlayer").getDuration();if(isNaN(duration)){duration=undefined;}
return duration;};this.getCurrentTime=function(){return iroll.get("videoPlayer").getCurrentTime();};this.disableDefaultClickThru=function(){iroll.get("videoPlayer").off("interact");};};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.CreativeComponent=function(){this._hooks=[];this._rendered=false;};SCOPE.CreativeComponent.prototype.getCSSClass=function(){return this._cssClass;};SCOPE.CreativeComponent.prototype._render=function(contextImpl){if(!this._rendered){var elem=this.render(),sizes;if(elem&&isHTMLElement(elem)){var container=$("<div />");container.addClass(this.getCSSClass());if(this.hasOwnProperty("options")&&this.options.preserveSizes){sizes=this.options.preserveSizes;}
resizeComponent(contextImpl.iroll.canvas,container,sizes);contextImpl.Events.on('winResize',function(){resizeComponent(contextImpl.iroll.canvas,container,sizes);});container.append(elem);contextImpl.iroll.canvas.addElement(container);_.each(this._hooks,function(action){action(contextImpl);});this._rendered=true;}else{throw new Error("render did not return an HTMLElement or Zepto element");}}};SCOPE.CreativeComponent.prototype.addHook=function(action){this._hooks.push(action);};var resizeComponent=function(canvas,elem,origSizes){var adSize=canvas.getSize(),width=adSize.width,height=adSize.height;if(origSizes){var backgroundRatio=origSizes.width/origSizes.height;if(adSize.width>adSize.height*backgroundRatio){width=origSizes.width*(adSize.height/origSizes.height);}else{height=origSizes.height*(adSize.width/origSizes.width);}
var fontSize=width/1920;elem.css("font-size",fontSize*10);}
elem.height(height);elem.width(width);};var isHTMLElement=function(obj){var result=false;if(typeof obj.get==="function"){var elements=obj.get();_.every(elements,function(elem){result=_.isElement(elem);return result;});}
else if(_.isElement(obj)){result=true;}
return result;};_.extend(SCOPE.CreativeComponent.prototype,Backbone.Events);})(IVA||(IVA={}));
(function(SCOPE){SCOPE.createOverlay=function(props){SCOPE.Utils.validateFuncProp(props,["show","render"]);var overlay=new SCOPE.CreativeComponent();overlay._cssClass="iva-overlay";_.extend(overlay,props);overlay._show=function(contextImpl){this._render(contextImpl);props.show.apply(overlay);};return overlay;};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.createSlate=function(props){SCOPE.Utils.validateFuncProp(props,["open","close","render"]);var slate=new SCOPE.CreativeComponent();slate._cssClass="iva-slate";_.extend(slate,props);slate._open=function(contextImpl){this._render(contextImpl);props.open.apply(slate);};slate.close=function(){props.close.apply(slate);slate.trigger("close");};return slate;};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Elements={};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Elements.createVideo=function(id,slate){var video=$('<video />');if(typeof SCOPE.creativeContext!=="undefined"){if(SCOPE.creativeContext.__contextImpl.shouldTransformToInlineVideo()){SCOPE.creativeContext.__contextImpl.transformToInlineVideo(video[0]);}else{SCOPE.creativeContext.__contextImpl.checkAndOverrideFastSeek(video[0]);}}
video.addClass("iva-in-unit-video");video.attr('webkit-playsinline','webkit-playsinline');video.attr('playsinline','playsinline');video.attr("id",id);slate.addHook(function(contextImpl){var videoData=_.findWhere(contextImpl.iroll.get("data")['html-in-unit-videos'],{"name":id});if(_.isUndefined(videoData))
{throw"could not find a video with id="+id+"under 'html-in-unit-videos' in the config";}
if(_.isEmpty(videoData['poster-image']))
{video.attr("poster","data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=");}
else{video.attr("poster",SCOPE.Utils.getAssetPath(videoData['poster-image']));}
contextImpl.initVideo(video[0],videoData);});return video[0];};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Elements.createImage=function(assetName){var assetPath=SCOPE.Utils.getAssetPath(assetName);return $('<img src="'+assetPath+'"/>');};})(IVA||(IVA={}));
(function(SCOPE){SCOPE.Preloader=function(config){this.onSuccess=function(asset){if(config.onSuccess){config.onSuccess(asset);}
if(config.onDone){config.onDone(asset);}};this.onError=function(asset){if(config.onError){config.onError(asset);}
if(config.onDone){config.onDone(asset);}};};SCOPE.Preloader.PRELOAD_TIMEOUT_MS=5000;SCOPE.Preloader.prototype.preloadAsset=function(assetId,assetPath){var preloaderElem=SCOPE.Preloader.getAssetPreloaderByFileType(assetPath),that=this;var timer=setTimeout(function(){preloaderElem.onload=function(){};preloaderElem.onerror=function(){};that.onError(assetId);},SCOPE.Preloader.PRELOAD_TIMEOUT_MS);preloaderElem.onload=function(){clearTimeout(timer);that.onSuccess(assetId);};preloaderElem.onerror=function(){clearTimeout(timer);that.onError(assetId);};preloaderElem.preload();};SCOPE.Preloader.getAssetPreloaderByFileType=function(assetPath){var isFontAsset=["woff","otf","ttf","woff2"].some(function(font){var ext="."+font;return assetPath.indexOf(ext,this.length-ext.length)!==-1;});var fontLoadingSupported=typeof FontFace!=="undefined";if(isFontAsset&&fontLoadingSupported){return SCOPE.Preloader.getFontPreloader(assetPath);}else{return SCOPE.Preloader.getImagePreloader(assetPath);}};SCOPE.Preloader.getFontPreloader=function(assetPath){var fontCssUrl="url("+assetPath+")";var fontFace=new FontFace("preloaded-font",fontCssUrl);return{preload:function(){fontFace.load().then(this.onload).catch(this.onerror);},onload:function(){},onerror:function(){}};};SCOPE.Preloader.getImagePreloader=function(assetPath){var newAsset=new Image();return{preload:function(){newAsset.onload=this.onload;newAsset.onerror=this.onerror;newAsset.src=assetPath;},onload:function(){},onerror:function(){}};};})(IVA);
(function(SCOPE){SCOPE.Utils={};SCOPE.Utils.isValidUrl=function(url){var regexp=/(\w+):(\/\/)*(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return regexp.test(url.toLowerCase());};SCOPE.Utils.validateFuncProp=function(obj,props){props.forEach(function(prop){if(!obj.hasOwnProperty(prop)||typeof obj[prop]!=="function"){throw new Error("Cannot create object: Missing function: "+prop);}});};SCOPE.Utils.getAssetPath=function(assetName){var path;if(IVA.devMode===true){path=assetName;}
else
{path='https://s-static.innovid.com/s3rsync/home/innovid/public_html/project_uploads/1h990g/Archive.0/'+assetName;}
return path;};SCOPE.Utils.getAssetPathWithCB=function(assetName){var path;if(IVA.devMode===true){path=assetName;}
else
{path='https://s-static.innovid.com/s3rsync/home/innovid/public_html/project_uploads/1h990g/Archive.0/'+assetName+'?cb=1538013160';}
return path;};})(IVA);
var IVC;(function(SCOPE){console.log('packaged on: Tue, 21 Aug 2018 17:09:44 GMT; local timezone: GMT -3 hours');var generalUtilsVersion="1.1.0";var devMode=false;try{if(IVA.devMode==true||window.location.hostname=="cdn.innovid.com"||window.location.hostname=="deliver.innovid.com")devMode=true;}
catch(err){console.log("unable to detect hostname");}
window.ivcLog=function(){printMe(arguments,"log");};window.ivcWarn=function(){printMe(arguments,"warn");};function printMe(data,type){if(!ivcDevMode||(typeof(console)==='undefined'))return;switch(type){case"log":console.log.apply(console,data);break;case"warn":console.warn.apply(console,data);break;}}
Object.defineProperty(window,'ivcDevMode',{get:function(){return devMode;},set:function(n){return ivcWarn("setting devMode is not possible in the current context");}});SCOPE.ivcOnClickthru=[];SCOPE.ivcOnReportEvent=[];SCOPE.ivcOnReportEventWithoutEngagement=[];IVA.Events.on('openURL',function(label){SCOPE.ivcOnClickthru.forEach(function(f){f.call({},label);});});IVA.Events.on('reportEvent',function(label,other){SCOPE.ivcOnReportEvent.forEach(function(f){f.call({},label,other);});});IVA.Events.on('reportEventWithoutEngagement',function(label,other){SCOPE.ivcOnReportEventWithoutEngagement.forEach(function(f){f.call({},label,other);});});ivcLog("ivcGeneralUtils version: "+generalUtilsVersion);})(IVC||(IVC={}));
/*!
 * VERSION: 1.20.2
 * DATE: 2017-06-30
 * UPDATES AND DOCS AT: http://greensock.com
 * 
 * Includes all of the following: TweenLite, TweenMax, TimelineLite, TimelineMax, EasePack, CSSPlugin, RoundPropsPlugin, BezierPlugin, AttrPlugin, DirectionalRotationPlugin
 *
 * @license Copyright (c) 2008-2017, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 * 
 * @author: Jack Doyle, jack@greensock.com
 **/
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(a,b,c){var d=function(a){var b,c=[],d=a.length;for(b=0;b!==d;c.push(a[b++]));return c},e=function(a,b,c){var d,e,f=a.cycle;for(d in f)e=f[d],a[d]="function"==typeof e?e(c,b[c]):e[c%e.length];delete a.cycle},f=function(a,b,d){c.call(this,a,b,d),this._cycle=0,this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=f.prototype.render},g=1e-10,h=c._internals,i=h.isSelector,j=h.isArray,k=f.prototype=c.to({},.1,{}),l=[];f.version="1.20.2",k.constructor=f,k.kill()._gc=!1,f.killTweensOf=f.killDelayedCallsTo=c.killTweensOf,f.getTweensOf=c.getTweensOf,f.lagSmoothing=c.lagSmoothing,f.ticker=c.ticker,f.render=c.render,k.invalidate=function(){return this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._yoyoEase=null,this._uncache(!0),c.prototype.invalidate.call(this)},k.updateTo=function(a,b){var d,e=this.ratio,f=this.vars.immediateRender||a.immediateRender;b&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(d in a)this.vars[d]=a[d];if(this._initted||f)if(b)this._initted=!1,f&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&c._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var g=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(g,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||f)for(var h,i=1/(1-e),j=this._firstPT;j;)h=j.s+j.c,j.c*=i,j.s=h-j.c,j=j._next;return this},k.render=function(a,b,d){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var e,f,i,j,k,l,m,n,o,p=this._dirty?this.totalDuration():this._totalDuration,q=this._time,r=this._totalTime,s=this._cycle,t=this._duration,u=this._rawPrevTime;if(a>=p-1e-7&&a>=0?(this._totalTime=p,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=t,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(e=!0,f="onComplete",d=d||this._timeline.autoRemoveChildren),0===t&&(this._initted||!this.vars.lazy||d)&&(this._startTime===this._timeline._duration&&(a=0),(0>u||0>=a&&a>=-1e-7||u===g&&"isPause"!==this.data)&&u!==a&&(d=!0,u>g&&(f="onReverseComplete")),this._rawPrevTime=n=!b||a||u===a?a:g)):1e-7>a?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==r||0===t&&u>0)&&(f="onReverseComplete",e=this._reversed),0>a&&(this._active=!1,0===t&&(this._initted||!this.vars.lazy||d)&&(u>=0&&(d=!0),this._rawPrevTime=n=!b||a||u===a?a:g)),this._initted||(d=!0)):(this._totalTime=this._time=a,0!==this._repeat&&(j=t+this._repeatDelay,this._cycle=this._totalTime/j>>0,0!==this._cycle&&this._cycle===this._totalTime/j&&a>=r&&this._cycle--,this._time=this._totalTime-this._cycle*j,this._yoyo&&0!==(1&this._cycle)&&(this._time=t-this._time,o=this._yoyoEase||this.vars.yoyoEase,o&&(this._yoyoEase||(o!==!0||this._initted?this._yoyoEase=o=o===!0?this._ease:o instanceof Ease?o:Ease.map[o]:(o=this.vars.ease,this._yoyoEase=o=o?o instanceof Ease?o:"function"==typeof o?new Ease(o,this.vars.easeParams):Ease.map[o]||c.defaultEase:c.defaultEase)),this.ratio=o?1-o.getRatio((t-this._time)/t):0)),this._time>t?this._time=t:this._time<0&&(this._time=0)),this._easeType&&!o?(k=this._time/t,l=this._easeType,m=this._easePower,(1===l||3===l&&k>=.5)&&(k=1-k),3===l&&(k*=2),1===m?k*=k:2===m?k*=k*k:3===m?k*=k*k*k:4===m&&(k*=k*k*k*k),1===l?this.ratio=1-k:2===l?this.ratio=k:this._time/t<.5?this.ratio=k/2:this.ratio=1-k/2):o||(this.ratio=this._ease.getRatio(this._time/t))),q===this._time&&!d&&s===this._cycle)return void(r!==this._totalTime&&this._onUpdate&&(b||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!d&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=q,this._totalTime=r,this._rawPrevTime=u,this._cycle=s,h.lazyTweens.push(this),void(this._lazy=[a,b]);!this._time||e||o?e&&this._ease._calcEnd&&!o&&(this.ratio=this._ease.getRatio(0===this._time?0:1)):this.ratio=this._ease.getRatio(this._time/t)}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==q&&a>=0&&(this._active=!0),0===r&&(2===this._initted&&a>0&&this._init(),this._startAt&&(a>=0?this._startAt.render(a,b,d):f||(f="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===t)&&(b||this._callback("onStart"))),i=this._firstPT;i;)i.f?i.t[i.p](i.c*this.ratio+i.s):i.t[i.p]=i.c*this.ratio+i.s,i=i._next;this._onUpdate&&(0>a&&this._startAt&&this._startTime&&this._startAt.render(a,b,d),b||(this._totalTime!==r||f)&&this._callback("onUpdate")),this._cycle!==s&&(b||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),f&&(!this._gc||d)&&(0>a&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(a,b,d),e&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[f]&&this._callback(f),0===t&&this._rawPrevTime===g&&n!==g&&(this._rawPrevTime=0))},f.to=function(a,b,c){return new f(a,b,c)},f.from=function(a,b,c){return c.runBackwards=!0,c.immediateRender=0!=c.immediateRender,new f(a,b,c)},f.fromTo=function(a,b,c,d){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,new f(a,b,d)},f.staggerTo=f.allTo=function(a,b,g,h,k,m,n){h=h||0;var o,p,q,r,s=0,t=[],u=function(){g.onComplete&&g.onComplete.apply(g.onCompleteScope||this,arguments),k.apply(n||g.callbackScope||this,m||l)},v=g.cycle,w=g.startAt&&g.startAt.cycle;for(j(a)||("string"==typeof a&&(a=c.selector(a)||a),i(a)&&(a=d(a))),a=a||[],0>h&&(a=d(a),a.reverse(),h*=-1),o=a.length-1,q=0;o>=q;q++){p={};for(r in g)p[r]=g[r];if(v&&(e(p,a,q),null!=p.duration&&(b=p.duration,delete p.duration)),w){w=p.startAt={};for(r in g.startAt)w[r]=g.startAt[r];e(p.startAt,a,q)}p.delay=s+(p.delay||0),q===o&&k&&(p.onComplete=u),t[q]=new f(a[q],b,p),s+=h}return t},f.staggerFrom=f.allFrom=function(a,b,c,d,e,g,h){return c.runBackwards=!0,c.immediateRender=0!=c.immediateRender,f.staggerTo(a,b,c,d,e,g,h)},f.staggerFromTo=f.allFromTo=function(a,b,c,d,e,g,h,i){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,f.staggerTo(a,b,d,e,g,h,i)},f.delayedCall=function(a,b,c,d,e){return new f(b,0,{delay:a,onComplete:b,onCompleteParams:c,callbackScope:d,onReverseComplete:b,onReverseCompleteParams:c,immediateRender:!1,useFrames:e,overwrite:0})},f.set=function(a,b){return new f(a,0,b)},f.isTweening=function(a){return c.getTweensOf(a,!0).length>0};var m=function(a,b){for(var d=[],e=0,f=a._first;f;)f instanceof c?d[e++]=f:(b&&(d[e++]=f),d=d.concat(m(f,b)),e=d.length),f=f._next;return d},n=f.getAllTweens=function(b){return m(a._rootTimeline,b).concat(m(a._rootFramesTimeline,b))};f.killAll=function(a,c,d,e){null==c&&(c=!0),null==d&&(d=!0);var f,g,h,i=n(0!=e),j=i.length,k=c&&d&&e;for(h=0;j>h;h++)g=i[h],(k||g instanceof b||(f=g.target===g.vars.onComplete)&&d||c&&!f)&&(a?g.totalTime(g._reversed?0:g.totalDuration()):g._enabled(!1,!1))},f.killChildTweensOf=function(a,b){if(null!=a){var e,g,k,l,m,n=h.tweenLookup;if("string"==typeof a&&(a=c.selector(a)||a),i(a)&&(a=d(a)),j(a))for(l=a.length;--l>-1;)f.killChildTweensOf(a[l],b);else{e=[];for(k in n)for(g=n[k].target.parentNode;g;)g===a&&(e=e.concat(n[k].tweens)),g=g.parentNode;for(m=e.length,l=0;m>l;l++)b&&e[l].totalTime(e[l].totalDuration()),e[l]._enabled(!1,!1)}}};var o=function(a,c,d,e){c=c!==!1,d=d!==!1,e=e!==!1;for(var f,g,h=n(e),i=c&&d&&e,j=h.length;--j>-1;)g=h[j],(i||g instanceof b||(f=g.target===g.vars.onComplete)&&d||c&&!f)&&g.paused(a)};return f.pauseAll=function(a,b,c){o(!0,a,b,c)},f.resumeAll=function(a,b,c){o(!1,a,b,c)},f.globalTimeScale=function(b){var d=a._rootTimeline,e=c.ticker.time;return arguments.length?(b=b||g,d._startTime=e-(e-d._startTime)*d._timeScale/b,d=a._rootFramesTimeline,e=c.ticker.frame,d._startTime=e-(e-d._startTime)*d._timeScale/b,d._timeScale=a._rootTimeline._timeScale=b,b):d._timeScale},k.progress=function(a,b){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-a:a)+this._cycle*(this._duration+this._repeatDelay),b):this._time/this.duration()},k.totalProgress=function(a,b){return arguments.length?this.totalTime(this.totalDuration()*a,b):this._totalTime/this.totalDuration()},k.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),a>this._duration&&(a=this._duration),this._yoyo&&0!==(1&this._cycle)?a=this._duration-a+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(a+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(a,b)):this._time},k.duration=function(b){return arguments.length?a.prototype.duration.call(this,b):this._duration},k.totalDuration=function(a){return arguments.length?-1===this._repeat?this:this.duration((a-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},k.repeat=function(a){return arguments.length?(this._repeat=a,this._uncache(!0)):this._repeat},k.repeatDelay=function(a){return arguments.length?(this._repeatDelay=a,this._uncache(!0)):this._repeatDelay},k.yoyo=function(a){return arguments.length?(this._yoyo=a,this):this._yoyo},f},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(a,b,c){var d=function(a){b.call(this,a),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var c,d,e=this.vars;for(d in e)c=e[d],i(c)&&-1!==c.join("").indexOf("{self}")&&(e[d]=this._swapSelfInParams(c));i(e.tweens)&&this.add(e.tweens,0,e.align,e.stagger)},e=1e-10,f=c._internals,g=d._internals={},h=f.isSelector,i=f.isArray,j=f.lazyTweens,k=f.lazyRender,l=_gsScope._gsDefine.globals,m=function(a){var b,c={};for(b in a)c[b]=a[b];return c},n=function(a,b,c){var d,e,f=a.cycle;for(d in f)e=f[d],a[d]="function"==typeof e?e(c,b[c]):e[c%e.length];delete a.cycle},o=g.pauseCallback=function(){},p=function(a){var b,c=[],d=a.length;for(b=0;b!==d;c.push(a[b++]));return c},q=d.prototype=new b;return d.version="1.20.2",q.constructor=d,q.kill()._gc=q._forcingPlayhead=q._hasPause=!1,q.to=function(a,b,d,e){var f=d.repeat&&l.TweenMax||c;return b?this.add(new f(a,b,d),e):this.set(a,d,e)},q.from=function(a,b,d,e){return this.add((d.repeat&&l.TweenMax||c).from(a,b,d),e)},q.fromTo=function(a,b,d,e,f){var g=e.repeat&&l.TweenMax||c;return b?this.add(g.fromTo(a,b,d,e),f):this.set(a,e,f)},q.staggerTo=function(a,b,e,f,g,i,j,k){var l,o,q=new d({onComplete:i,onCompleteParams:j,callbackScope:k,smoothChildTiming:this.smoothChildTiming}),r=e.cycle;for("string"==typeof a&&(a=c.selector(a)||a),a=a||[],h(a)&&(a=p(a)),f=f||0,0>f&&(a=p(a),a.reverse(),f*=-1),o=0;o<a.length;o++)l=m(e),l.startAt&&(l.startAt=m(l.startAt),l.startAt.cycle&&n(l.startAt,a,o)),r&&(n(l,a,o),null!=l.duration&&(b=l.duration,delete l.duration)),q.to(a[o],b,l,o*f);return this.add(q,g)},q.staggerFrom=function(a,b,c,d,e,f,g,h){return c.immediateRender=0!=c.immediateRender,c.runBackwards=!0,this.staggerTo(a,b,c,d,e,f,g,h)},q.staggerFromTo=function(a,b,c,d,e,f,g,h,i){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,this.staggerTo(a,b,d,e,f,g,h,i)},q.call=function(a,b,d,e){return this.add(c.delayedCall(0,a,b,d),e)},q.set=function(a,b,d){return d=this._parseTimeOrLabel(d,0,!0),null==b.immediateRender&&(b.immediateRender=d===this._time&&!this._paused),this.add(new c(a,0,b),d)},d.exportRoot=function(a,b){a=a||{},null==a.smoothChildTiming&&(a.smoothChildTiming=!0);var e,f,g=new d(a),h=g._timeline;for(null==b&&(b=!0),h._remove(g,!0),g._startTime=0,g._rawPrevTime=g._time=g._totalTime=h._time,e=h._first;e;)f=e._next,b&&e instanceof c&&e.target===e.vars.onComplete||g.add(e,e._startTime-e._delay),e=f;return h.add(g,0),g},q.add=function(e,f,g,h){var j,k,l,m,n,o;if("number"!=typeof f&&(f=this._parseTimeOrLabel(f,0,!0,e)),!(e instanceof a)){if(e instanceof Array||e&&e.push&&i(e)){for(g=g||"normal",h=h||0,j=f,k=e.length,l=0;k>l;l++)i(m=e[l])&&(m=new d({tweens:m})),this.add(m,j),"string"!=typeof m&&"function"!=typeof m&&("sequence"===g?j=m._startTime+m.totalDuration()/m._timeScale:"start"===g&&(m._startTime-=m.delay())),j+=h;return this._uncache(!0)}if("string"==typeof e)return this.addLabel(e,f);if("function"!=typeof e)throw"Cannot add "+e+" into the timeline; it is not a tween, timeline, function, or string.";e=c.delayedCall(0,e)}if(b.prototype.add.call(this,e,f),e._time&&e.render((this.rawTime()-e._startTime)*e._timeScale,!1,!1),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(n=this,o=n.rawTime()>e._startTime;n._timeline;)o&&n._timeline.smoothChildTiming?n.totalTime(n._totalTime,!0):n._gc&&n._enabled(!0,!1),n=n._timeline;return this},q.remove=function(b){if(b instanceof a){this._remove(b,!1);var c=b._timeline=b.vars.useFrames?a._rootFramesTimeline:a._rootTimeline;return b._startTime=(b._paused?b._pauseTime:c._time)-(b._reversed?b.totalDuration()-b._totalTime:b._totalTime)/b._timeScale,this}if(b instanceof Array||b&&b.push&&i(b)){for(var d=b.length;--d>-1;)this.remove(b[d]);return this}return"string"==typeof b?this.removeLabel(b):this.kill(null,b)},q._remove=function(a,c){b.prototype._remove.call(this,a,c);var d=this._last;return d?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},q.append=function(a,b){return this.add(a,this._parseTimeOrLabel(null,b,!0,a))},q.insert=q.insertMultiple=function(a,b,c,d){return this.add(a,b||0,c,d)},q.appendMultiple=function(a,b,c,d){return this.add(a,this._parseTimeOrLabel(null,b,!0,a),c,d)},q.addLabel=function(a,b){return this._labels[a]=this._parseTimeOrLabel(b),this},q.addPause=function(a,b,d,e){var f=c.delayedCall(0,o,d,e||this);return f.vars.onComplete=f.vars.onReverseComplete=b,f.data="isPause",this._hasPause=!0,this.add(f,a)},q.removeLabel=function(a){return delete this._labels[a],this},q.getLabelTime=function(a){return null!=this._labels[a]?this._labels[a]:-1},q._parseTimeOrLabel=function(b,c,d,e){var f,g;if(e instanceof a&&e.timeline===this)this.remove(e);else if(e&&(e instanceof Array||e.push&&i(e)))for(g=e.length;--g>-1;)e[g]instanceof a&&e[g].timeline===this&&this.remove(e[g]);if(f=this.duration()>99999999999?this.recent().endTime(!1):this._duration,"string"==typeof c)return this._parseTimeOrLabel(c,d&&"number"==typeof b&&null==this._labels[c]?b-f:0,d);if(c=c||0,"string"!=typeof b||!isNaN(b)&&null==this._labels[b])null==b&&(b=f);else{if(g=b.indexOf("="),-1===g)return null==this._labels[b]?d?this._labels[b]=f+c:c:this._labels[b]+c;c=parseInt(b.charAt(g-1)+"1",10)*Number(b.substr(g+1)),b=g>1?this._parseTimeOrLabel(b.substr(0,g-1),0,d):f}return Number(b)+c},q.seek=function(a,b){return this.totalTime("number"==typeof a?a:this._parseTimeOrLabel(a),b!==!1)},q.stop=function(){return this.paused(!0)},q.gotoAndPlay=function(a,b){return this.play(a,b)},q.gotoAndStop=function(a,b){return this.pause(a,b)},q.render=function(a,b,c){this._gc&&this._enabled(!0,!1);var d,f,g,h,i,l,m,n=this._dirty?this.totalDuration():this._totalDuration,o=this._time,p=this._startTime,q=this._timeScale,r=this._paused;if(a>=n-1e-7&&a>=0)this._totalTime=this._time=n,this._reversed||this._hasPausedChild()||(f=!0,h="onComplete",i=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=a&&a>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===e)&&this._rawPrevTime!==a&&this._first&&(i=!0,this._rawPrevTime>e&&(h="onReverseComplete"))),this._rawPrevTime=this._duration||!b||a||this._rawPrevTime===a?a:e,a=n+1e-4;else if(1e-7>a)if(this._totalTime=this._time=0,(0!==o||0===this._duration&&this._rawPrevTime!==e&&(this._rawPrevTime>0||0>a&&this._rawPrevTime>=0))&&(h="onReverseComplete",f=this._reversed),0>a)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(i=f=!0,h="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(i=!0),this._rawPrevTime=a;else{if(this._rawPrevTime=this._duration||!b||a||this._rawPrevTime===a?a:e,0===a&&f)for(d=this._first;d&&0===d._startTime;)d._duration||(f=!1),d=d._next;a=0,this._initted||(i=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!b){if(a>=o)for(d=this._first;d&&d._startTime<=a&&!l;)d._duration||"isPause"!==d.data||d.ratio||0===d._startTime&&0===this._rawPrevTime||(l=d),d=d._next;else for(d=this._last;d&&d._startTime>=a&&!l;)d._duration||"isPause"===d.data&&d._rawPrevTime>0&&(l=d),d=d._prev;l&&(this._time=a=l._startTime,this._totalTime=a+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=a}if(this._time!==o&&this._first||c||i||l){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==o&&a>0&&(this._active=!0),0===o&&this.vars.onStart&&(0===this._time&&this._duration||b||this._callback("onStart")),m=this._time,m>=o)for(d=this._first;d&&(g=d._next,m===this._time&&(!this._paused||r));)(d._active||d._startTime<=m&&!d._paused&&!d._gc)&&(l===d&&this.pause(),d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,c):d.render((a-d._startTime)*d._timeScale,b,c)),d=g;else for(d=this._last;d&&(g=d._prev,m===this._time&&(!this._paused||r));){if(d._active||d._startTime<=o&&!d._paused&&!d._gc){if(l===d){for(l=d._prev;l&&l.endTime()>this._time;)l.render(l._reversed?l.totalDuration()-(a-l._startTime)*l._timeScale:(a-l._startTime)*l._timeScale,b,c),l=l._prev;l=null,this.pause()}d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,c):d.render((a-d._startTime)*d._timeScale,b,c)}d=g}this._onUpdate&&(b||(j.length&&k(),this._callback("onUpdate"))),h&&(this._gc||(p===this._startTime||q!==this._timeScale)&&(0===this._time||n>=this.totalDuration())&&(f&&(j.length&&k(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[h]&&this._callback(h)))}},q._hasPausedChild=function(){for(var a=this._first;a;){if(a._paused||a instanceof d&&a._hasPausedChild())return!0;a=a._next}return!1},q.getChildren=function(a,b,d,e){e=e||-9999999999;for(var f=[],g=this._first,h=0;g;)g._startTime<e||(g instanceof c?b!==!1&&(f[h++]=g):(d!==!1&&(f[h++]=g),a!==!1&&(f=f.concat(g.getChildren(!0,b,d)),h=f.length))),g=g._next;return f},q.getTweensOf=function(a,b){var d,e,f=this._gc,g=[],h=0;for(f&&this._enabled(!0,!0),d=c.getTweensOf(a),e=d.length;--e>-1;)(d[e].timeline===this||b&&this._contains(d[e]))&&(g[h++]=d[e]);return f&&this._enabled(!1,!0),g},q.recent=function(){return this._recent},q._contains=function(a){for(var b=a.timeline;b;){if(b===this)return!0;b=b.timeline}return!1},q.shiftChildren=function(a,b,c){c=c||0;for(var d,e=this._first,f=this._labels;e;)e._startTime>=c&&(e._startTime+=a),e=e._next;if(b)for(d in f)f[d]>=c&&(f[d]+=a);return this._uncache(!0)},q._kill=function(a,b){if(!a&&!b)return this._enabled(!1,!1);for(var c=b?this.getTweensOf(b):this.getChildren(!0,!0,!1),d=c.length,e=!1;--d>-1;)c[d]._kill(a,b)&&(e=!0);return e},q.clear=function(a){var b=this.getChildren(!1,!0,!0),c=b.length;for(this._time=this._totalTime=0;--c>-1;)b[c]._enabled(!1,!1);return a!==!1&&(this._labels={}),this._uncache(!0)},q.invalidate=function(){for(var b=this._first;b;)b.invalidate(),b=b._next;return a.prototype.invalidate.call(this)},q._enabled=function(a,c){if(a===this._gc)for(var d=this._first;d;)d._enabled(a,!0),d=d._next;return b.prototype._enabled.call(this,a,c)},q.totalTime=function(b,c,d){this._forcingPlayhead=!0;var e=a.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,e},q.duration=function(a){return arguments.length?(0!==this.duration()&&0!==a&&this.timeScale(this._duration/a),this):(this._dirty&&this.totalDuration(),this._duration)},q.totalDuration=function(a){if(!arguments.length){if(this._dirty){for(var b,c,d=0,e=this._last,f=999999999999;e;)b=e._prev,e._dirty&&e.totalDuration(),e._startTime>f&&this._sortChildren&&!e._paused?this.add(e,e._startTime-e._delay):f=e._startTime,e._startTime<0&&!e._paused&&(d-=e._startTime,this._timeline.smoothChildTiming&&(this._startTime+=e._startTime/this._timeScale),this.shiftChildren(-e._startTime,!1,-9999999999),f=0),c=e._startTime+e._totalDuration/e._timeScale,c>d&&(d=c),e=b;this._duration=this._totalDuration=d,this._dirty=!1}return this._totalDuration}return a&&this.totalDuration()?this.timeScale(this._totalDuration/a):this},q.paused=function(b){if(!b)for(var c=this._first,d=this._time;c;)c._startTime===d&&"isPause"===c.data&&(c._rawPrevTime=0),c=c._next;return a.prototype.paused.apply(this,arguments)},q.usesFrames=function(){for(var b=this._timeline;b._timeline;)b=b._timeline;return b===a._rootFramesTimeline},q.rawTime=function(a){return a&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(a)-this._startTime)*this._timeScale},d},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(a,b,c){var d=function(b){a.call(this,b),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},e=1e-10,f=b._internals,g=f.lazyTweens,h=f.lazyRender,i=_gsScope._gsDefine.globals,j=new c(null,null,1,0),k=d.prototype=new a;return k.constructor=d,k.kill()._gc=!1,d.version="1.20.2",k.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),a.prototype.invalidate.call(this)},k.addCallback=function(a,c,d,e){return this.add(b.delayedCall(0,a,d,e),c)},k.removeCallback=function(a,b){if(a)if(null==b)this._kill(null,a);else for(var c=this.getTweensOf(a,!1),d=c.length,e=this._parseTimeOrLabel(b);--d>-1;)c[d]._startTime===e&&c[d]._enabled(!1,!1);return this},k.removePause=function(b){return this.removeCallback(a._internals.pauseCallback,b)},k.tweenTo=function(a,c){c=c||{};var d,e,f,g={ease:j,useFrames:this.usesFrames(),immediateRender:!1},h=c.repeat&&i.TweenMax||b;for(e in c)g[e]=c[e];return g.time=this._parseTimeOrLabel(a),d=Math.abs(Number(g.time)-this._time)/this._timeScale||.001,f=new h(this,d,g),g.onStart=function(){f.target.paused(!0),f.vars.time!==f.target.time()&&d===f.duration()&&f.duration(Math.abs(f.vars.time-f.target.time())/f.target._timeScale),c.onStart&&c.onStart.apply(c.onStartScope||c.callbackScope||f,c.onStartParams||[])},f},k.tweenFromTo=function(a,b,c){c=c||{},a=this._parseTimeOrLabel(a),c.startAt={onComplete:this.seek,onCompleteParams:[a],callbackScope:this},c.immediateRender=c.immediateRender!==!1;var d=this.tweenTo(b,c);return d.duration(Math.abs(d.vars.time-a)/this._timeScale||.001)},k.render=function(a,b,c){this._gc&&this._enabled(!0,!1);var d,f,i,j,k,l,m,n,o=this._dirty?this.totalDuration():this._totalDuration,p=this._duration,q=this._time,r=this._totalTime,s=this._startTime,t=this._timeScale,u=this._rawPrevTime,v=this._paused,w=this._cycle;if(a>=o-1e-7&&a>=0)this._locked||(this._totalTime=o,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(f=!0,j="onComplete",k=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=a&&a>=-1e-7||0>u||u===e)&&u!==a&&this._first&&(k=!0,u>e&&(j="onReverseComplete"))),this._rawPrevTime=this._duration||!b||a||this._rawPrevTime===a?a:e,this._yoyo&&0!==(1&this._cycle)?this._time=a=0:(this._time=p,a=p+1e-4);else if(1e-7>a)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==q||0===p&&u!==e&&(u>0||0>a&&u>=0)&&!this._locked)&&(j="onReverseComplete",f=this._reversed),0>a)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(k=f=!0,j="onReverseComplete"):u>=0&&this._first&&(k=!0),this._rawPrevTime=a;else{if(this._rawPrevTime=p||!b||a||this._rawPrevTime===a?a:e,0===a&&f)for(d=this._first;d&&0===d._startTime;)d._duration||(f=!1),d=d._next;a=0,this._initted||(k=!0)}else if(0===p&&0>u&&(k=!0),this._time=this._rawPrevTime=a,this._locked||(this._totalTime=a,0!==this._repeat&&(l=p+this._repeatDelay,this._cycle=this._totalTime/l>>0,0!==this._cycle&&this._cycle===this._totalTime/l&&a>=r&&this._cycle--,this._time=this._totalTime-this._cycle*l,this._yoyo&&0!==(1&this._cycle)&&(this._time=p-this._time),this._time>p?(this._time=p,a=p+1e-4):this._time<0?this._time=a=0:a=this._time)),this._hasPause&&!this._forcingPlayhead&&!b){if(a=this._time,a>=q||this._repeat&&w!==this._cycle)for(d=this._first;d&&d._startTime<=a&&!m;)d._duration||"isPause"!==d.data||d.ratio||0===d._startTime&&0===this._rawPrevTime||(m=d),d=d._next;else for(d=this._last;d&&d._startTime>=a&&!m;)d._duration||"isPause"===d.data&&d._rawPrevTime>0&&(m=d),d=d._prev;m&&m._startTime<p&&(this._time=a=m._startTime,this._totalTime=a+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==w&&!this._locked){var x=this._yoyo&&0!==(1&w),y=x===(this._yoyo&&0!==(1&this._cycle)),z=this._totalTime,A=this._cycle,B=this._rawPrevTime,C=this._time;if(this._totalTime=w*p,this._cycle<w?x=!x:this._totalTime+=p,this._time=q,this._rawPrevTime=0===p?u-1e-4:u,this._cycle=w,this._locked=!0,q=x?0:p,this.render(q,b,0===p),b||this._gc||this.vars.onRepeat&&(this._cycle=A,this._locked=!1,this._callback("onRepeat")),q!==this._time)return;if(y&&(this._cycle=w,this._locked=!0,q=x?p+1e-4:-1e-4,this.render(q,!0,!1)),this._locked=!1,this._paused&&!v)return;this._time=C,this._totalTime=z,this._cycle=A,this._rawPrevTime=B}if(!(this._time!==q&&this._first||c||k||m))return void(r!==this._totalTime&&this._onUpdate&&(b||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==r&&a>0&&(this._active=!0),0===r&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||b||this._callback("onStart")),n=this._time,n>=q)for(d=this._first;d&&(i=d._next,n===this._time&&(!this._paused||v));)(d._active||d._startTime<=this._time&&!d._paused&&!d._gc)&&(m===d&&this.pause(),d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,c):d.render((a-d._startTime)*d._timeScale,b,c)),d=i;else for(d=this._last;d&&(i=d._prev,n===this._time&&(!this._paused||v));){if(d._active||d._startTime<=q&&!d._paused&&!d._gc){if(m===d){for(m=d._prev;m&&m.endTime()>this._time;)m.render(m._reversed?m.totalDuration()-(a-m._startTime)*m._timeScale:(a-m._startTime)*m._timeScale,b,c),m=m._prev;m=null,this.pause()}d._reversed?d.render((d._dirty?d.totalDuration():d._totalDuration)-(a-d._startTime)*d._timeScale,b,c):d.render((a-d._startTime)*d._timeScale,b,c)}d=i}this._onUpdate&&(b||(g.length&&h(),this._callback("onUpdate"))),j&&(this._locked||this._gc||(s===this._startTime||t!==this._timeScale)&&(0===this._time||o>=this.totalDuration())&&(f&&(g.length&&h(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[j]&&this._callback(j)))},k.getActive=function(a,b,c){null==a&&(a=!0),null==b&&(b=!0),null==c&&(c=!1);var d,e,f=[],g=this.getChildren(a,b,c),h=0,i=g.length;for(d=0;i>d;d++)e=g[d],e.isActive()&&(f[h++]=e);return f},k.getLabelAfter=function(a){a||0!==a&&(a=this._time);var b,c=this.getLabelsArray(),d=c.length;for(b=0;d>b;b++)if(c[b].time>a)return c[b].name;return null},k.getLabelBefore=function(a){null==a&&(a=this._time);for(var b=this.getLabelsArray(),c=b.length;--c>-1;)if(b[c].time<a)return b[c].name;return null},k.getLabelsArray=function(){var a,b=[],c=0;for(a in this._labels)b[c++]={time:this._labels[a],name:a};return b.sort(function(a,b){return a.time-b.time}),b},k.invalidate=function(){return this._locked=!1,a.prototype.invalidate.call(this)},k.progress=function(a,b){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-a:a)+this._cycle*(this._duration+this._repeatDelay),b):this._time/this.duration()||0},k.totalProgress=function(a,b){return arguments.length?this.totalTime(this.totalDuration()*a,b):this._totalTime/this.totalDuration()||0},k.totalDuration=function(b){return arguments.length?-1!==this._repeat&&b?this.timeScale(this.totalDuration()/b):this:(this._dirty&&(a.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},k.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),a>this._duration&&(a=this._duration),this._yoyo&&0!==(1&this._cycle)?a=this._duration-a+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(a+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(a,b)):this._time},k.repeat=function(a){return arguments.length?(this._repeat=a,this._uncache(!0)):this._repeat},k.repeatDelay=function(a){return arguments.length?(this._repeatDelay=a,this._uncache(!0)):this._repeatDelay},k.yoyo=function(a){return arguments.length?(this._yoyo=a,this):this._yoyo},k.currentLabel=function(a){return arguments.length?this.seek(a,!0):this.getLabelBefore(this._time+1e-8)},d},!0),function(){var a=180/Math.PI,b=[],c=[],d=[],e={},f=_gsScope._gsDefine.globals,g=function(a,b,c,d){c===d&&(c=d-(d-b)/1e6),a===b&&(b=a+(c-a)/1e6),this.a=a,this.b=b,this.c=c,this.d=d,this.da=d-a,this.ca=c-a,this.ba=b-a},h=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",i=function(a,b,c,d){var e={a:a},f={},g={},h={c:d},i=(a+b)/2,j=(b+c)/2,k=(c+d)/2,l=(i+j)/2,m=(j+k)/2,n=(m-l)/8;return e.b=i+(a-i)/4,f.b=l+n,e.c=f.a=(e.b+f.b)/2,f.c=g.a=(l+m)/2,g.b=m-n,h.b=k+(d-k)/4,g.c=h.a=(g.b+h.b)/2,[e,f,g,h]},j=function(a,e,f,g,h){var j,k,l,m,n,o,p,q,r,s,t,u,v,w=a.length-1,x=0,y=a[0].a;for(j=0;w>j;j++)n=a[x],k=n.a,l=n.d,m=a[x+1].d,h?(t=b[j],u=c[j],v=(u+t)*e*.25/(g?.5:d[j]||.5),o=l-(l-k)*(g?.5*e:0!==t?v/t:0),p=l+(m-l)*(g?.5*e:0!==u?v/u:0),q=l-(o+((p-o)*(3*t/(t+u)+.5)/4||0))):(o=l-(l-k)*e*.5,p=l+(m-l)*e*.5,q=l-(o+p)/2),o+=q,p+=q,n.c=r=o,0!==j?n.b=y:n.b=y=n.a+.6*(n.c-n.a),n.da=l-k,n.ca=r-k,n.ba=y-k,f?(s=i(k,y,r,l),a.splice(x,1,s[0],s[1],s[2],s[3]),x+=4):x++,y=p;n=a[x],n.b=y,n.c=y+.4*(n.d-y),n.da=n.d-n.a,n.ca=n.c-n.a,n.ba=y-n.a,f&&(s=i(n.a,y,n.c,n.d),a.splice(x,1,s[0],s[1],s[2],s[3]))},k=function(a,d,e,f){var h,i,j,k,l,m,n=[];if(f)for(a=[f].concat(a),i=a.length;--i>-1;)"string"==typeof(m=a[i][d])&&"="===m.charAt(1)&&(a[i][d]=f[d]+Number(m.charAt(0)+m.substr(2)));if(h=a.length-2,0>h)return n[0]=new g(a[0][d],0,0,a[0][d]),n;for(i=0;h>i;i++)j=a[i][d],k=a[i+1][d],n[i]=new g(j,0,0,k),e&&(l=a[i+2][d],b[i]=(b[i]||0)+(k-j)*(k-j),c[i]=(c[i]||0)+(l-k)*(l-k));return n[i]=new g(a[i][d],0,0,a[i+1][d]),n},l=function(a,f,g,i,l,m){var n,o,p,q,r,s,t,u,v={},w=[],x=m||a[0];l="string"==typeof l?","+l+",":h,null==f&&(f=1);for(o in a[0])w.push(o);if(a.length>1){for(u=a[a.length-1],t=!0,n=w.length;--n>-1;)if(o=w[n],Math.abs(x[o]-u[o])>.05){t=!1;break}t&&(a=a.concat(),m&&a.unshift(m),a.push(a[1]),m=a[a.length-3])}for(b.length=c.length=d.length=0,n=w.length;--n>-1;)o=w[n],e[o]=-1!==l.indexOf(","+o+","),v[o]=k(a,o,e[o],m);for(n=b.length;--n>-1;)b[n]=Math.sqrt(b[n]),c[n]=Math.sqrt(c[n]);if(!i){for(n=w.length;--n>-1;)if(e[o])for(p=v[w[n]],s=p.length-1,q=0;s>q;q++)r=p[q+1].da/c[q]+p[q].da/b[q]||0,d[q]=(d[q]||0)+r*r;for(n=d.length;--n>-1;)d[n]=Math.sqrt(d[n])}for(n=w.length,q=g?4:1;--n>-1;)o=w[n],p=v[o],j(p,f,g,i,e[o]),t&&(p.splice(0,q),p.splice(p.length-q,q));return v},m=function(a,b,c){b=b||"soft";var d,e,f,h,i,j,k,l,m,n,o,p={},q="cubic"===b?3:2,r="soft"===b,s=[];if(r&&c&&(a=[c].concat(a)),null==a||a.length<q+1)throw"invalid Bezier data";for(m in a[0])s.push(m);for(j=s.length;--j>-1;){for(m=s[j],p[m]=i=[],n=0,l=a.length,k=0;l>k;k++)d=null==c?a[k][m]:"string"==typeof(o=a[k][m])&&"="===o.charAt(1)?c[m]+Number(o.charAt(0)+o.substr(2)):Number(o),r&&k>1&&l-1>k&&(i[n++]=(d+i[n-2])/2),i[n++]=d;for(l=n-q+1,n=0,k=0;l>k;k+=q)d=i[k],e=i[k+1],f=i[k+2],h=2===q?0:i[k+3],i[n++]=o=3===q?new g(d,e,f,h):new g(d,(2*e+d)/3,(2*e+f)/3,f);i.length=n}return p},n=function(a,b,c){for(var d,e,f,g,h,i,j,k,l,m,n,o=1/c,p=a.length;--p>-1;)for(m=a[p],f=m.a,g=m.d-f,h=m.c-f,i=m.b-f,d=e=0,k=1;c>=k;k++)j=o*k,l=1-j,d=e-(e=(j*j*g+3*l*(j*h+l*i))*j),n=p*c+k-1,b[n]=(b[n]||0)+d*d},o=function(a,b){b=b>>0||6;var c,d,e,f,g=[],h=[],i=0,j=0,k=b-1,l=[],m=[];for(c in a)n(a[c],g,b);for(e=g.length,d=0;e>d;d++)i+=Math.sqrt(g[d]),f=d%b,m[f]=i,f===k&&(j+=i,f=d/b>>0,l[f]=m,h[f]=j,i=0,m=[]);return{length:j,lengths:h,segments:l}},p=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.8",API:2,global:!0,init:function(a,b,c){this._target=a,b instanceof Array&&(b={values:b}),this._func={},this._mod={},this._props=[],this._timeRes=null==b.timeResolution?6:parseInt(b.timeResolution,10);var d,e,f,g,h,i=b.values||[],j={},k=i[0],n=b.autoRotate||c.vars.orientToBezier;this._autoRotate=n?n instanceof Array?n:[["x","y","rotation",n===!0?0:Number(n)||0]]:null;for(d in k)this._props.push(d);for(f=this._props.length;--f>-1;)d=this._props[f],this._overwriteProps.push(d),e=this._func[d]="function"==typeof a[d],j[d]=e?a[d.indexOf("set")||"function"!=typeof a["get"+d.substr(3)]?d:"get"+d.substr(3)]():parseFloat(a[d]),h||j[d]!==i[0][d]&&(h=j);if(this._beziers="cubic"!==b.type&&"quadratic"!==b.type&&"soft"!==b.type?l(i,isNaN(b.curviness)?1:b.curviness,!1,"thruBasic"===b.type,b.correlate,h):m(i,b.type,j),this._segCount=this._beziers[d].length,this._timeRes){var p=o(this._beziers,this._timeRes);this._length=p.length,this._lengths=p.lengths,this._segments=p.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(n=this._autoRotate)for(this._initialRotations=[],n[0]instanceof Array||(this._autoRotate=n=[n]),f=n.length;--f>-1;){for(g=0;3>g;g++)d=n[f][g],this._func[d]="function"==typeof a[d]?a[d.indexOf("set")||"function"!=typeof a["get"+d.substr(3)]?d:"get"+d.substr(3)]:!1;d=n[f][2],this._initialRotations[f]=(this._func[d]?this._func[d].call(this._target):this._target[d])||0,this._overwriteProps.push(d)}return this._startRatio=c.vars.runBackwards?1:0,!0},set:function(b){var c,d,e,f,g,h,i,j,k,l,m=this._segCount,n=this._func,o=this._target,p=b!==this._startRatio;if(this._timeRes){if(k=this._lengths,l=this._curSeg,b*=this._length,e=this._li,b>this._l2&&m-1>e){for(j=m-1;j>e&&(this._l2=k[++e])<=b;);this._l1=k[e-1],this._li=e,this._curSeg=l=this._segments[e],this._s2=l[this._s1=this._si=0]}else if(b<this._l1&&e>0){for(;e>0&&(this._l1=k[--e])>=b;);0===e&&b<this._l1?this._l1=0:e++,this._l2=k[e],this._li=e,this._curSeg=l=this._segments[e],this._s1=l[(this._si=l.length-1)-1]||0,this._s2=l[this._si]}if(c=e,b-=this._l1,e=this._si,b>this._s2&&e<l.length-1){for(j=l.length-1;j>e&&(this._s2=l[++e])<=b;);this._s1=l[e-1],this._si=e}else if(b<this._s1&&e>0){for(;e>0&&(this._s1=l[--e])>=b;);0===e&&b<this._s1?this._s1=0:e++,this._s2=l[e],this._si=e}h=(e+(b-this._s1)/(this._s2-this._s1))*this._prec||0}else c=0>b?0:b>=1?m-1:m*b>>0,h=(b-c*(1/m))*m;for(d=1-h,e=this._props.length;--e>-1;)f=this._props[e],g=this._beziers[f][c],i=(h*h*g.da+3*d*(h*g.ca+d*g.ba))*h+g.a,this._mod[f]&&(i=this._mod[f](i,o)),n[f]?o[f](i):o[f]=i;if(this._autoRotate){var q,r,s,t,u,v,w,x=this._autoRotate;for(e=x.length;--e>-1;)f=x[e][2],v=x[e][3]||0,w=x[e][4]===!0?1:a,g=this._beziers[x[e][0]],q=this._beziers[x[e][1]],g&&q&&(g=g[c],q=q[c],r=g.a+(g.b-g.a)*h,t=g.b+(g.c-g.b)*h,r+=(t-r)*h,t+=(g.c+(g.d-g.c)*h-t)*h,s=q.a+(q.b-q.a)*h,u=q.b+(q.c-q.b)*h,s+=(u-s)*h,u+=(q.c+(q.d-q.c)*h-u)*h,i=p?Math.atan2(u-s,t-r)*w+v:this._initialRotations[e],this._mod[f]&&(i=this._mod[f](i,o)),n[f]?o[f](i):o[f]=i)}}}),q=p.prototype;p.bezierThrough=l,p.cubicToQuadratic=i,p._autoCSS=!0,p.quadraticToCubic=function(a,b,c){return new g(a,(2*b+a)/3,(2*b+c)/3,c)},p._cssRegister=function(){var a=f.CSSPlugin;if(a){var b=a._internals,c=b._parseToProxy,d=b._setPluginRatio,e=b.CSSPropTween;b._registerComplexSpecialProp("bezier",{parser:function(a,b,f,g,h,i){b instanceof Array&&(b={values:b}),i=new p;var j,k,l,m=b.values,n=m.length-1,o=[],q={};if(0>n)return h;for(j=0;n>=j;j++)l=c(a,m[j],g,h,i,n!==j),o[j]=l.end;for(k in b)q[k]=b[k];return q.values=o,h=new e(a,"bezier",0,0,l.pt,2),h.data=l,h.plugin=i,h.setRatio=d,0===q.autoRotate&&(q.autoRotate=!0),!q.autoRotate||q.autoRotate instanceof Array||(j=q.autoRotate===!0?0:Number(q.autoRotate),q.autoRotate=null!=l.end.left?[["left","top","rotation",j,!1]]:null!=l.end.x?[["x","y","rotation",j,!1]]:!1),q.autoRotate&&(g._transform||g._enableTransforms(!1),l.autoRotate=g._target._gsTransform,l.proxy.rotation=l.autoRotate.rotation||0,g._overwriteProps.push("rotation")),i._onInitTween(l.proxy,q,g._tween),h}})}},q._mod=function(a){for(var b,c=this._overwriteProps,d=c.length;--d>-1;)b=a[c[d]],b&&"function"==typeof b&&(this._mod[c[d]]=b)},q._kill=function(a){var b,c,d=this._props;for(b in this._beziers)if(b in a)for(delete this._beziers[b],delete this._func[b],c=d.length;--c>-1;)d[c]===b&&d.splice(c,1);if(d=this._autoRotate)for(c=d.length;--c>-1;)a[d[c][2]]&&d.splice(c,1);return this._super._kill.call(this,a)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(a,b){var c,d,e,f,g=function(){a.call(this,"css"),this._overwriteProps.length=0,this.setRatio=g.prototype.setRatio},h=_gsScope._gsDefine.globals,i={},j=g.prototype=new a("css");j.constructor=g,g.version="1.20.0",g.API=2,g.defaultTransformPerspective=0,g.defaultSkewType="compensated",g.defaultSmoothOrigin=!0,j="px",g.suffixMap={top:j,right:j,bottom:j,left:j,width:j,height:j,fontSize:j,padding:j,margin:j,perspective:j,lineHeight:""};var k,l,m,n,o,p,q,r,s=/(?:\-|\.|\b)(\d|\.|e\-)+/g,t=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,u=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,v=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,w=/(?:\d|\-|\+|=|#|\.)*/g,x=/opacity *= *([^)]*)/i,y=/opacity:([^;]*)/i,z=/alpha\(opacity *=.+?\)/i,A=/^(rgb|hsl)/,B=/([A-Z])/g,C=/-([a-z])/gi,D=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,E=function(a,b){return b.toUpperCase()},F=/(?:Left|Right|Width)/i,G=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,H=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,I=/,(?=[^\)]*(?:\(|$))/gi,J=/[\s,\(]/i,K=Math.PI/180,L=180/Math.PI,M={},N={style:{}},O=_gsScope.document||{createElement:function(){return N}},P=function(a,b){return O.createElementNS?O.createElementNS(b||"http://www.w3.org/1999/xhtml",a):O.createElement(a)},Q=P("div"),R=P("img"),S=g._internals={_specialProps:i},T=(_gsScope.navigator||{}).userAgent||"",U=function(){var a=T.indexOf("Android"),b=P("a");return m=-1!==T.indexOf("Safari")&&-1===T.indexOf("Chrome")&&(-1===a||parseFloat(T.substr(a+8,2))>3),o=m&&parseFloat(T.substr(T.indexOf("Version/")+8,2))<6,n=-1!==T.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(T)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(T))&&(p=parseFloat(RegExp.$1)),b?(b.style.cssText="top:1px;opacity:.55;",/^0.55/.test(b.style.opacity)):!1}(),V=function(a){return x.test("string"==typeof a?a:(a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100:1},W=function(a){_gsScope.console&&console.log(a)},X="",Y="",Z=function(a,b){b=b||Q;var c,d,e=b.style;if(void 0!==e[a])return a;for(a=a.charAt(0).toUpperCase()+a.substr(1),c=["O","Moz","ms","Ms","Webkit"],d=5;--d>-1&&void 0===e[c[d]+a];);return d>=0?(Y=3===d?"ms":c[d],X="-"+Y.toLowerCase()+"-",Y+a):null},$=O.defaultView?O.defaultView.getComputedStyle:function(){},_=g.getStyle=function(a,b,c,d,e){var f;return U||"opacity"!==b?(!d&&a.style[b]?f=a.style[b]:(c=c||$(a))?f=c[b]||c.getPropertyValue(b)||c.getPropertyValue(b.replace(B,"-$1").toLowerCase()):a.currentStyle&&(f=a.currentStyle[b]),null==e||f&&"none"!==f&&"auto"!==f&&"auto auto"!==f?f:e):V(a)},aa=S.convertToPixels=function(a,c,d,e,f){if("px"===e||!e&&"lineHeight"!==c)return d;if("auto"===e||!d)return 0;var h,i,j,k=F.test(c),l=a,m=Q.style,n=0>d,o=1===d;if(n&&(d=-d),o&&(d*=100),"lineHeight"!==c||e)if("%"===e&&-1!==c.indexOf("border"))h=d/100*(k?a.clientWidth:a.clientHeight);else{if(m.cssText="border:0 solid red;position:"+_(a,"position")+";line-height:0;","%"!==e&&l.appendChild&&"v"!==e.charAt(0)&&"rem"!==e)m[k?"borderLeftWidth":"borderTopWidth"]=d+e;else{if(l=a.parentNode||O.body,-1!==_(l,"display").indexOf("flex")&&(m.position="absolute"),i=l._gsCache,j=b.ticker.frame,i&&k&&i.time===j)return i.width*d/100;m[k?"width":"height"]=d+e}l.appendChild(Q),h=parseFloat(Q[k?"offsetWidth":"offsetHeight"]),l.removeChild(Q),k&&"%"===e&&g.cacheWidths!==!1&&(i=l._gsCache=l._gsCache||{},i.time=j,i.width=h/d*100),0!==h||f||(h=aa(a,c,d,e,!0))}else i=$(a).lineHeight,a.style.lineHeight=d,h=parseFloat($(a).lineHeight),a.style.lineHeight=i;return o&&(h/=100),n?-h:h},ba=S.calculateOffset=function(a,b,c){if("absolute"!==_(a,"position",c))return 0;var d="left"===b?"Left":"Top",e=_(a,"margin"+d,c);return a["offset"+d]-(aa(a,b,parseFloat(e),e.replace(w,""))||0)},ca=function(a,b){var c,d,e,f={};if(b=b||$(a,null))if(c=b.length)for(;--c>-1;)e=b[c],(-1===e.indexOf("-transform")||Da===e)&&(f[e.replace(C,E)]=b.getPropertyValue(e));else for(c in b)(-1===c.indexOf("Transform")||Ca===c)&&(f[c]=b[c]);else if(b=a.currentStyle||a.style)for(c in b)"string"==typeof c&&void 0===f[c]&&(f[c.replace(C,E)]=b[c]);return U||(f.opacity=V(a)),d=Ra(a,b,!1),f.rotation=d.rotation,f.skewX=d.skewX,f.scaleX=d.scaleX,f.scaleY=d.scaleY,f.x=d.x,f.y=d.y,Fa&&(f.z=d.z,f.rotationX=d.rotationX,f.rotationY=d.rotationY,f.scaleZ=d.scaleZ),f.filters&&delete f.filters,f},da=function(a,b,c,d,e){var f,g,h,i={},j=a.style;for(g in c)"cssText"!==g&&"length"!==g&&isNaN(g)&&(b[g]!==(f=c[g])||e&&e[g])&&-1===g.indexOf("Origin")&&("number"==typeof f||"string"==typeof f)&&(i[g]="auto"!==f||"left"!==g&&"top"!==g?""!==f&&"auto"!==f&&"none"!==f||"string"!=typeof b[g]||""===b[g].replace(v,"")?f:0:ba(a,g),void 0!==j[g]&&(h=new sa(j,g,j[g],h)));if(d)for(g in d)"className"!==g&&(i[g]=d[g]);return{difs:i,firstMPT:h}},ea={width:["Left","Right"],height:["Top","Bottom"]},fa=["marginLeft","marginRight","marginTop","marginBottom"],ga=function(a,b,c){if("svg"===(a.nodeName+"").toLowerCase())return(c||$(a))[b]||0;if(a.getCTM&&Oa(a))return a.getBBox()[b]||0;var d=parseFloat("width"===b?a.offsetWidth:a.offsetHeight),e=ea[b],f=e.length;for(c=c||$(a,null);--f>-1;)d-=parseFloat(_(a,"padding"+e[f],c,!0))||0,d-=parseFloat(_(a,"border"+e[f]+"Width",c,!0))||0;return d},ha=function(a,b){if("contain"===a||"auto"===a||"auto auto"===a)return a+" ";(null==a||""===a)&&(a="0 0");var c,d=a.split(" "),e=-1!==a.indexOf("left")?"0%":-1!==a.indexOf("right")?"100%":d[0],f=-1!==a.indexOf("top")?"0%":-1!==a.indexOf("bottom")?"100%":d[1];if(d.length>3&&!b){for(d=a.split(", ").join(",").split(","),a=[],c=0;c<d.length;c++)a.push(ha(d[c]));return a.join(",")}return null==f?f="center"===e?"50%":"0":"center"===f&&(f="50%"),("center"===e||isNaN(parseFloat(e))&&-1===(e+"").indexOf("="))&&(e="50%"),a=e+" "+f+(d.length>2?" "+d[2]:""),b&&(b.oxp=-1!==e.indexOf("%"),b.oyp=-1!==f.indexOf("%"),b.oxr="="===e.charAt(1),b.oyr="="===f.charAt(1),b.ox=parseFloat(e.replace(v,"")),b.oy=parseFloat(f.replace(v,"")),b.v=a),b||a},ia=function(a,b){return"function"==typeof a&&(a=a(r,q)),"string"==typeof a&&"="===a.charAt(1)?parseInt(a.charAt(0)+"1",10)*parseFloat(a.substr(2)):parseFloat(a)-parseFloat(b)||0},ja=function(a,b){return"function"==typeof a&&(a=a(r,q)),null==a?b:"string"==typeof a&&"="===a.charAt(1)?parseInt(a.charAt(0)+"1",10)*parseFloat(a.substr(2))+b:parseFloat(a)||0},ka=function(a,b,c,d){var e,f,g,h,i,j=1e-6;return"function"==typeof a&&(a=a(r,q)),null==a?h=b:"number"==typeof a?h=a:(e=360,f=a.split("_"),i="="===a.charAt(1),g=(i?parseInt(a.charAt(0)+"1",10)*parseFloat(f[0].substr(2)):parseFloat(f[0]))*(-1===a.indexOf("rad")?1:L)-(i?0:b),f.length&&(d&&(d[c]=b+g),-1!==a.indexOf("short")&&(g%=e,g!==g%(e/2)&&(g=0>g?g+e:g-e)),-1!==a.indexOf("_cw")&&0>g?g=(g+9999999999*e)%e-(g/e|0)*e:-1!==a.indexOf("ccw")&&g>0&&(g=(g-9999999999*e)%e-(g/e|0)*e)),h=b+g),j>h&&h>-j&&(h=0),h},la={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},ma=function(a,b,c){return a=0>a?a+1:a>1?a-1:a,255*(1>6*a?b+(c-b)*a*6:.5>a?c:2>3*a?b+(c-b)*(2/3-a)*6:b)+.5|0},na=g.parseColor=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(a)if("number"==typeof a)c=[a>>16,a>>8&255,255&a];else{if(","===a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),la[a])c=la[a];else if("#"===a.charAt(0))4===a.length&&(d=a.charAt(1),e=a.charAt(2),f=a.charAt(3),a="#"+d+d+e+e+f+f),a=parseInt(a.substr(1),16),c=[a>>16,a>>8&255,255&a];else if("hsl"===a.substr(0,3))if(c=m=a.match(s),b){if(-1!==a.indexOf("="))return a.match(t)}else g=Number(c[0])%360/360,h=Number(c[1])/100,i=Number(c[2])/100,e=.5>=i?i*(h+1):i+h-i*h,d=2*i-e,c.length>3&&(c[3]=Number(a[3])),c[0]=ma(g+1/3,d,e),c[1]=ma(g,d,e),c[2]=ma(g-1/3,d,e);else c=a.match(s)||la.transparent;c[0]=Number(c[0]),c[1]=Number(c[1]),c[2]=Number(c[2]),c.length>3&&(c[3]=Number(c[3]))}else c=la.black;return b&&!m&&(d=c[0]/255,e=c[1]/255,f=c[2]/255,j=Math.max(d,e,f),k=Math.min(d,e,f),i=(j+k)/2,j===k?g=h=0:(l=j-k,h=i>.5?l/(2-j-k):l/(j+k),g=j===d?(e-f)/l+(f>e?6:0):j===e?(f-d)/l+2:(d-e)/l+4,g*=60),c[0]=g+.5|0,c[1]=100*h+.5|0,c[2]=100*i+.5|0),c},oa=function(a,b){var c,d,e,f=a.match(pa)||[],g=0,h="";if(!f.length)return a;for(c=0;c<f.length;c++)d=f[c],e=a.substr(g,a.indexOf(d,g)-g),g+=e.length+d.length,d=na(d,b),3===d.length&&d.push(1),h+=e+(b?"hsla("+d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:"rgba("+d.join(","))+")";return h+a.substr(g)},pa="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(j in la)pa+="|"+j+"\\b";pa=new RegExp(pa+")","gi"),g.colorStringFilter=function(a){var b,c=a[0]+" "+a[1];pa.test(c)&&(b=-1!==c.indexOf("hsl(")||-1!==c.indexOf("hsla("),a[0]=oa(a[0],b),a[1]=oa(a[1],b)),pa.lastIndex=0},b.defaultStringFilter||(b.defaultStringFilter=g.colorStringFilter);var qa=function(a,b,c,d){if(null==a)return function(a){return a};var e,f=b?(a.match(pa)||[""])[0]:"",g=a.split(f).join("").match(u)||[],h=a.substr(0,a.indexOf(g[0])),i=")"===a.charAt(a.length-1)?")":"",j=-1!==a.indexOf(" ")?" ":",",k=g.length,l=k>0?g[0].replace(s,""):"";return k?e=b?function(a){var b,m,n,o;if("number"==typeof a)a+=l;else if(d&&I.test(a)){for(o=a.replace(I,"|").split("|"),n=0;n<o.length;n++)o[n]=e(o[n]);return o.join(",")}if(b=(a.match(pa)||[f])[0],m=a.split(b).join("").match(u)||[],n=m.length,k>n--)for(;++n<k;)m[n]=c?m[(n-1)/2|0]:g[n];return h+m.join(j)+j+b+i+(-1!==a.indexOf("inset")?" inset":"")}:function(a){var b,f,m;if("number"==typeof a)a+=l;else if(d&&I.test(a)){for(f=a.replace(I,"|").split("|"),m=0;m<f.length;m++)f[m]=e(f[m]);return f.join(",")}if(b=a.match(u)||[],m=b.length,k>m--)for(;++m<k;)b[m]=c?b[(m-1)/2|0]:g[m];return h+b.join(j)+i}:function(a){return a}},ra=function(a){return a=a.split(","),function(b,c,d,e,f,g,h){var i,j=(c+"").split(" ");for(h={},i=0;4>i;i++)h[a[i]]=j[i]=j[i]||j[(i-1)/2>>0];return e.parse(b,h,f,g)}},sa=(S._setPluginRatio=function(a){this.plugin.setRatio(a);for(var b,c,d,e,f,g=this.data,h=g.proxy,i=g.firstMPT,j=1e-6;i;)b=h[i.v],i.r?b=Math.round(b):j>b&&b>-j&&(b=0),i.t[i.p]=b,i=i._next;if(g.autoRotate&&(g.autoRotate.rotation=g.mod?g.mod(h.rotation,this.t):h.rotation),1===a||0===a)for(i=g.firstMPT,f=1===a?"e":"b";i;){if(c=i.t,c.type){if(1===c.type){for(e=c.xs0+c.s+c.xs1,d=1;d<c.l;d++)e+=c["xn"+d]+c["xs"+(d+1)];c[f]=e}}else c[f]=c.s+c.xs0;i=i._next}},function(a,b,c,d,e){this.t=a,this.p=b,this.v=c,this.r=e,d&&(d._prev=this,this._next=d)}),ta=(S._parseToProxy=function(a,b,c,d,e,f){var g,h,i,j,k,l=d,m={},n={},o=c._transform,p=M;for(c._transform=null,M=b,d=k=c.parse(a,b,d,e),M=p,f&&(c._transform=o,l&&(l._prev=null,l._prev&&(l._prev._next=null)));d&&d!==l;){if(d.type<=1&&(h=d.p,n[h]=d.s+d.c,m[h]=d.s,f||(j=new sa(d,"s",h,j,d.r),d.c=0),1===d.type))for(g=d.l;--g>0;)i="xn"+g,h=d.p+"_"+i,n[h]=d.data[i],m[h]=d[i],f||(j=new sa(d,i,h,j,d.rxp[i]));d=d._next}return{proxy:m,end:n,firstMPT:j,pt:k}},S.CSSPropTween=function(a,b,d,e,g,h,i,j,k,l,m){this.t=a,this.p=b,this.s=d,this.c=e,this.n=i||b,a instanceof ta||f.push(this.n),this.r=j,this.type=h||0,k&&(this.pr=k,c=!0),this.b=void 0===l?d:l,this.e=void 0===m?d+e:m,g&&(this._next=g,g._prev=this)}),ua=function(a,b,c,d,e,f){var g=new ta(a,b,c,d-c,e,-1,f);return g.b=c,g.e=g.xs0=d,g},va=g.parseComplex=function(a,b,c,d,e,f,h,i,j,l){c=c||f||"","function"==typeof d&&(d=d(r,q)),h=new ta(a,b,0,0,h,l?2:1,null,!1,i,c,d),d+="",e&&pa.test(d+c)&&(d=[c,d],g.colorStringFilter(d),c=d[0],d=d[1]);var m,n,o,p,u,v,w,x,y,z,A,B,C,D=c.split(", ").join(",").split(" "),E=d.split(", ").join(",").split(" "),F=D.length,G=k!==!1;for((-1!==d.indexOf(",")||-1!==c.indexOf(","))&&(D=D.join(" ").replace(I,", ").split(" "),E=E.join(" ").replace(I,", ").split(" "),F=D.length),F!==E.length&&(D=(f||"").split(" "),F=D.length),h.plugin=j,h.setRatio=l,pa.lastIndex=0,m=0;F>m;m++)if(p=D[m],u=E[m],x=parseFloat(p),x||0===x)h.appendXtra("",x,ia(u,x),u.replace(t,""),G&&-1!==u.indexOf("px"),!0);else if(e&&pa.test(p))B=u.indexOf(")")+1,B=")"+(B?u.substr(B):""),C=-1!==u.indexOf("hsl")&&U,z=u,p=na(p,C),u=na(u,C),y=p.length+u.length>6,y&&!U&&0===u[3]?(h["xs"+h.l]+=h.l?" transparent":"transparent",h.e=h.e.split(E[m]).join("transparent")):(U||(y=!1),C?h.appendXtra(z.substr(0,z.indexOf("hsl"))+(y?"hsla(":"hsl("),p[0],ia(u[0],p[0]),",",!1,!0).appendXtra("",p[1],ia(u[1],p[1]),"%,",!1).appendXtra("",p[2],ia(u[2],p[2]),y?"%,":"%"+B,!1):h.appendXtra(z.substr(0,z.indexOf("rgb"))+(y?"rgba(":"rgb("),p[0],u[0]-p[0],",",!0,!0).appendXtra("",p[1],u[1]-p[1],",",!0).appendXtra("",p[2],u[2]-p[2],y?",":B,!0),y&&(p=p.length<4?1:p[3],h.appendXtra("",p,(u.length<4?1:u[3])-p,B,!1))),pa.lastIndex=0;else if(v=p.match(s)){if(w=u.match(t),!w||w.length!==v.length)return h;for(o=0,n=0;n<v.length;n++)A=v[n],z=p.indexOf(A,o),h.appendXtra(p.substr(o,z-o),Number(A),ia(w[n],A),"",G&&"px"===p.substr(z+A.length,2),0===n),o=z+A.length;h["xs"+h.l]+=p.substr(o)}else h["xs"+h.l]+=h.l||h["xs"+h.l]?" "+u:u;if(-1!==d.indexOf("=")&&h.data){for(B=h.xs0+h.data.s,m=1;m<h.l;m++)B+=h["xs"+m]+h.data["xn"+m];h.e=B+h["xs"+m]}return h.l||(h.type=-1,h.xs0=h.e),h.xfirst||h},wa=9;for(j=ta.prototype,j.l=j.pr=0;--wa>0;)j["xn"+wa]=0,j["xs"+wa]="";j.xs0="",j._next=j._prev=j.xfirst=j.data=j.plugin=j.setRatio=j.rxp=null,j.appendXtra=function(a,b,c,d,e,f){var g=this,h=g.l;return g["xs"+h]+=f&&(h||g["xs"+h])?" "+a:a||"",c||0===h||g.plugin?(g.l++,g.type=g.setRatio?2:1,g["xs"+g.l]=d||"",h>0?(g.data["xn"+h]=b+c,g.rxp["xn"+h]=e,g["xn"+h]=b,g.plugin||(g.xfirst=new ta(g,"xn"+h,b,c,g.xfirst||g,0,g.n,e,g.pr),g.xfirst.xs0=0),g):(g.data={s:b+c},g.rxp={},g.s=b,g.c=c,g.r=e,g)):(g["xs"+h]+=b+(d||""),g)};var xa=function(a,b){b=b||{},this.p=b.prefix?Z(a)||a:a,i[a]=i[this.p]=this,this.format=b.formatter||qa(b.defaultValue,b.color,b.collapsible,b.multi),b.parser&&(this.parse=b.parser),this.clrs=b.color,this.multi=b.multi,this.keyword=b.keyword,this.dflt=b.defaultValue,this.pr=b.priority||0},ya=S._registerComplexSpecialProp=function(a,b,c){"object"!=typeof b&&(b={parser:c});var d,e,f=a.split(","),g=b.defaultValue;for(c=c||[g],d=0;d<f.length;d++)b.prefix=0===d&&b.prefix,b.defaultValue=c[d]||g,e=new xa(f[d],b)},za=S._registerPluginProp=function(a){if(!i[a]){var b=a.charAt(0).toUpperCase()+a.substr(1)+"Plugin";ya(a,{parser:function(a,c,d,e,f,g,j){var k=h.com.greensock.plugins[b];return k?(k._cssRegister(),i[d].parse(a,c,d,e,f,g,j)):(W("Error: "+b+" js file not loaded."),f)}})}};j=xa.prototype,j.parseComplex=function(a,b,c,d,e,f){var g,h,i,j,k,l,m=this.keyword;if(this.multi&&(I.test(c)||I.test(b)?(h=b.replace(I,"|").split("|"),i=c.replace(I,"|").split("|")):m&&(h=[b],i=[c])),i){for(j=i.length>h.length?i.length:h.length,g=0;j>g;g++)b=h[g]=h[g]||this.dflt,c=i[g]=i[g]||this.dflt,m&&(k=b.indexOf(m),l=c.indexOf(m),k!==l&&(-1===l?h[g]=h[g].split(m).join(""):-1===k&&(h[g]+=" "+m)));b=h.join(", "),c=i.join(", ")}return va(a,this.p,b,c,this.clrs,this.dflt,d,this.pr,e,f)},j.parse=function(a,b,c,d,f,g,h){return this.parseComplex(a.style,this.format(_(a,this.p,e,!1,this.dflt)),this.format(b),f,g)},g.registerSpecialProp=function(a,b,c){ya(a,{parser:function(a,d,e,f,g,h,i){var j=new ta(a,e,0,0,g,2,e,!1,c);return j.plugin=h,j.setRatio=b(a,d,f._tween,e),j},priority:c})},g.useSVGTransformAttr=!0;var Aa,Ba="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),Ca=Z("transform"),Da=X+"transform",Ea=Z("transformOrigin"),Fa=null!==Z("perspective"),Ga=S.Transform=function(){this.perspective=parseFloat(g.defaultTransformPerspective)||0,this.force3D=g.defaultForce3D!==!1&&Fa?g.defaultForce3D||"auto":!1},Ha=_gsScope.SVGElement,Ia=function(a,b,c){var d,e=O.createElementNS("http://www.w3.org/2000/svg",a),f=/([a-z])([A-Z])/g;for(d in c)e.setAttributeNS(null,d.replace(f,"$1-$2").toLowerCase(),c[d]);return b.appendChild(e),e},Ja=O.documentElement||{},Ka=function(){var a,b,c,d=p||/Android/i.test(T)&&!_gsScope.chrome;return O.createElementNS&&!d&&(a=Ia("svg",Ja),b=Ia("rect",a,{width:100,height:50,x:100}),c=b.getBoundingClientRect().width,b.style[Ea]="50% 50%",b.style[Ca]="scaleX(0.5)",d=c===b.getBoundingClientRect().width&&!(n&&Fa),Ja.removeChild(a)),d}(),La=function(a,b,c,d,e,f){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=a._gsTransform,w=Qa(a,!0);v&&(t=v.xOrigin,u=v.yOrigin),(!d||(h=d.split(" ")).length<2)&&(n=a.getBBox(),0===n.x&&0===n.y&&n.width+n.height===0&&(n={x:parseFloat(a.hasAttribute("x")?a.getAttribute("x"):a.hasAttribute("cx")?a.getAttribute("cx"):0)||0,y:parseFloat(a.hasAttribute("y")?a.getAttribute("y"):a.hasAttribute("cy")?a.getAttribute("cy"):0)||0,width:0,height:0}),b=ha(b).split(" "),h=[(-1!==b[0].indexOf("%")?parseFloat(b[0])/100*n.width:parseFloat(b[0]))+n.x,(-1!==b[1].indexOf("%")?parseFloat(b[1])/100*n.height:parseFloat(b[1]))+n.y]),c.xOrigin=k=parseFloat(h[0]),c.yOrigin=l=parseFloat(h[1]),d&&w!==Pa&&(m=w[0],n=w[1],o=w[2],p=w[3],q=w[4],r=w[5],s=m*p-n*o,s&&(i=k*(p/s)+l*(-o/s)+(o*r-p*q)/s,j=k*(-n/s)+l*(m/s)-(m*r-n*q)/s,k=c.xOrigin=h[0]=i,l=c.yOrigin=h[1]=j)),v&&(f&&(c.xOffset=v.xOffset,c.yOffset=v.yOffset,v=c),e||e!==!1&&g.defaultSmoothOrigin!==!1?(i=k-t,j=l-u,v.xOffset+=i*w[0]+j*w[2]-i,v.yOffset+=i*w[1]+j*w[3]-j):v.xOffset=v.yOffset=0),f||a.setAttribute("data-svg-origin",h.join(" "))},Ma=function(a){var b,c=P("svg",this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),d=this.parentNode,e=this.nextSibling,f=this.style.cssText;if(Ja.appendChild(c),c.appendChild(this),this.style.display="block",a)try{b=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=Ma}catch(g){}else this._originalGetBBox&&(b=this._originalGetBBox());return e?d.insertBefore(this,e):d.appendChild(this),Ja.removeChild(c),this.style.cssText=f,b},Na=function(a){try{return a.getBBox()}catch(b){return Ma.call(a,!0)}},Oa=function(a){return!(!(Ha&&a.getCTM&&Na(a))||a.parentNode&&!a.ownerSVGElement)},Pa=[1,0,0,1,0,0],Qa=function(a,b){var c,d,e,f,g,h,i=a._gsTransform||new Ga,j=1e5,k=a.style;if(Ca?d=_(a,Da,null,!0):a.currentStyle&&(d=a.currentStyle.filter.match(G),d=d&&4===d.length?[d[0].substr(4),Number(d[2].substr(4)),Number(d[1].substr(4)),d[3].substr(4),i.x||0,i.y||0].join(","):""),c=!d||"none"===d||"matrix(1, 0, 0, 1, 0, 0)"===d,!Ca||!(h="none"===$(a).display)&&a.parentNode||(h&&(f=k.display,k.display="block"),a.parentNode||(g=1,Ja.appendChild(a)),d=_(a,Da,null,!0),c=!d||"none"===d||"matrix(1, 0, 0, 1, 0, 0)"===d,f?k.display=f:h&&Va(k,"display"),g&&Ja.removeChild(a)),(i.svg||a.getCTM&&Oa(a))&&(c&&-1!==(k[Ca]+"").indexOf("matrix")&&(d=k[Ca],c=0),e=a.getAttribute("transform"),c&&e&&(-1!==e.indexOf("matrix")?(d=e,c=0):-1!==e.indexOf("translate")&&(d="matrix(1,0,0,1,"+e.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",c=0))),c)return Pa;for(e=(d||"").match(s)||[],wa=e.length;--wa>-1;)f=Number(e[wa]),e[wa]=(g=f-(f|=0))?(g*j+(0>g?-.5:.5)|0)/j+f:f;return b&&e.length>6?[e[0],e[1],e[4],e[5],e[12],e[13]]:e},Ra=S.getTransform=function(a,c,d,e){if(a._gsTransform&&d&&!e)return a._gsTransform;var f,h,i,j,k,l,m=d?a._gsTransform||new Ga:new Ga,n=m.scaleX<0,o=2e-5,p=1e5,q=Fa?parseFloat(_(a,Ea,c,!1,"0 0 0").split(" ")[2])||m.zOrigin||0:0,r=parseFloat(g.defaultTransformPerspective)||0;if(m.svg=!(!a.getCTM||!Oa(a)),m.svg&&(La(a,_(a,Ea,c,!1,"50% 50%")+"",m,a.getAttribute("data-svg-origin")),Aa=g.useSVGTransformAttr||Ka),f=Qa(a),f!==Pa){if(16===f.length){var s,t,u,v,w,x=f[0],y=f[1],z=f[2],A=f[3],B=f[4],C=f[5],D=f[6],E=f[7],F=f[8],G=f[9],H=f[10],I=f[12],J=f[13],K=f[14],M=f[11],N=Math.atan2(D,H);m.zOrigin&&(K=-m.zOrigin,I=F*K-f[12],J=G*K-f[13],K=H*K+m.zOrigin-f[14]),m.rotationX=N*L,N&&(v=Math.cos(-N),w=Math.sin(-N),s=B*v+F*w,t=C*v+G*w,u=D*v+H*w,F=B*-w+F*v,G=C*-w+G*v,H=D*-w+H*v,M=E*-w+M*v,B=s,C=t,D=u),N=Math.atan2(-z,H),m.rotationY=N*L,N&&(v=Math.cos(-N),w=Math.sin(-N),s=x*v-F*w,t=y*v-G*w,u=z*v-H*w,G=y*w+G*v,H=z*w+H*v,M=A*w+M*v,x=s,y=t,z=u),N=Math.atan2(y,x),m.rotation=N*L,N&&(v=Math.cos(N),w=Math.sin(N),s=x*v+y*w,t=B*v+C*w,u=F*v+G*w,y=y*v-x*w,C=C*v-B*w,G=G*v-F*w,x=s,B=t,F=u),m.rotationX&&Math.abs(m.rotationX)+Math.abs(m.rotation)>359.9&&(m.rotationX=m.rotation=0,m.rotationY=180-m.rotationY),N=Math.atan2(B,C),m.scaleX=(Math.sqrt(x*x+y*y+z*z)*p+.5|0)/p,m.scaleY=(Math.sqrt(C*C+D*D)*p+.5|0)/p,m.scaleZ=(Math.sqrt(F*F+G*G+H*H)*p+.5|0)/p,x/=m.scaleX,B/=m.scaleY,y/=m.scaleX,C/=m.scaleY,Math.abs(N)>o?(m.skewX=N*L,B=0,"simple"!==m.skewType&&(m.scaleY*=1/Math.cos(N))):m.skewX=0,m.perspective=M?1/(0>M?-M:M):0,m.x=I,m.y=J,m.z=K,m.svg&&(m.x-=m.xOrigin-(m.xOrigin*x-m.yOrigin*B),m.y-=m.yOrigin-(m.yOrigin*y-m.xOrigin*C))}else if(!Fa||e||!f.length||m.x!==f[4]||m.y!==f[5]||!m.rotationX&&!m.rotationY){var O=f.length>=6,P=O?f[0]:1,Q=f[1]||0,R=f[2]||0,S=O?f[3]:1;m.x=f[4]||0,m.y=f[5]||0,i=Math.sqrt(P*P+Q*Q),j=Math.sqrt(S*S+R*R),k=P||Q?Math.atan2(Q,P)*L:m.rotation||0,l=R||S?Math.atan2(R,S)*L+k:m.skewX||0,m.scaleX=i,m.scaleY=j,m.rotation=k,m.skewX=l,Fa&&(m.rotationX=m.rotationY=m.z=0,m.perspective=r,m.scaleZ=1),m.svg&&(m.x-=m.xOrigin-(m.xOrigin*P+m.yOrigin*R),m.y-=m.yOrigin-(m.xOrigin*Q+m.yOrigin*S))}Math.abs(m.skewX)>90&&Math.abs(m.skewX)<270&&(n?(m.scaleX*=-1,m.skewX+=m.rotation<=0?180:-180,m.rotation+=m.rotation<=0?180:-180):(m.scaleY*=-1,m.skewX+=m.skewX<=0?180:-180)),m.zOrigin=q;for(h in m)m[h]<o&&m[h]>-o&&(m[h]=0)}return d&&(a._gsTransform=m,m.svg&&(Aa&&a.style[Ca]?b.delayedCall(.001,function(){Va(a.style,Ca)}):!Aa&&a.getAttribute("transform")&&b.delayedCall(.001,function(){a.removeAttribute("transform")}))),m},Sa=function(a){var b,c,d=this.data,e=-d.rotation*K,f=e+d.skewX*K,g=1e5,h=(Math.cos(e)*d.scaleX*g|0)/g,i=(Math.sin(e)*d.scaleX*g|0)/g,j=(Math.sin(f)*-d.scaleY*g|0)/g,k=(Math.cos(f)*d.scaleY*g|0)/g,l=this.t.style,m=this.t.currentStyle;if(m){c=i,i=-j,j=-c,b=m.filter,l.filter="";var n,o,q=this.t.offsetWidth,r=this.t.offsetHeight,s="absolute"!==m.position,t="progid:DXImageTransform.Microsoft.Matrix(M11="+h+", M12="+i+", M21="+j+", M22="+k,u=d.x+q*d.xPercent/100,v=d.y+r*d.yPercent/100;if(null!=d.ox&&(n=(d.oxp?q*d.ox*.01:d.ox)-q/2,o=(d.oyp?r*d.oy*.01:d.oy)-r/2,u+=n-(n*h+o*i),v+=o-(n*j+o*k)),s?(n=q/2,o=r/2,t+=", Dx="+(n-(n*h+o*i)+u)+", Dy="+(o-(n*j+o*k)+v)+")"):t+=", sizingMethod='auto expand')",-1!==b.indexOf("DXImageTransform.Microsoft.Matrix(")?l.filter=b.replace(H,t):l.filter=t+" "+b,(0===a||1===a)&&1===h&&0===i&&0===j&&1===k&&(s&&-1===t.indexOf("Dx=0, Dy=0")||x.test(b)&&100!==parseFloat(RegExp.$1)||-1===b.indexOf(b.indexOf("Alpha"))&&l.removeAttribute("filter")),!s){var y,z,A,B=8>p?1:-1;for(n=d.ieOffsetX||0,o=d.ieOffsetY||0,d.ieOffsetX=Math.round((q-((0>h?-h:h)*q+(0>i?-i:i)*r))/2+u),d.ieOffsetY=Math.round((r-((0>k?-k:k)*r+(0>j?-j:j)*q))/2+v),wa=0;4>wa;wa++)z=fa[wa],y=m[z],c=-1!==y.indexOf("px")?parseFloat(y):aa(this.t,z,parseFloat(y),y.replace(w,""))||0,A=c!==d[z]?2>wa?-d.ieOffsetX:-d.ieOffsetY:2>wa?n-d.ieOffsetX:o-d.ieOffsetY,l[z]=(d[z]=Math.round(c-A*(0===wa||2===wa?1:B)))+"px"}}},Ta=S.set3DTransformRatio=S.setTransformRatio=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z=this.data,A=this.t.style,B=z.rotation,C=z.rotationX,D=z.rotationY,E=z.scaleX,F=z.scaleY,G=z.scaleZ,H=z.x,I=z.y,J=z.z,L=z.svg,M=z.perspective,N=z.force3D,O=z.skewY,P=z.skewX;if(O&&(P+=O,B+=O),((1===a||0===a)&&"auto"===N&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!N)&&!J&&!M&&!D&&!C&&1===G||Aa&&L||!Fa)return void(B||P||L?(B*=K,x=P*K,y=1e5,c=Math.cos(B)*E,f=Math.sin(B)*E,d=Math.sin(B-x)*-F,g=Math.cos(B-x)*F,x&&"simple"===z.skewType&&(b=Math.tan(x-O*K),b=Math.sqrt(1+b*b),d*=b,g*=b,O&&(b=Math.tan(O*K),b=Math.sqrt(1+b*b),c*=b,f*=b)),L&&(H+=z.xOrigin-(z.xOrigin*c+z.yOrigin*d)+z.xOffset,I+=z.yOrigin-(z.xOrigin*f+z.yOrigin*g)+z.yOffset,Aa&&(z.xPercent||z.yPercent)&&(q=this.t.getBBox(),H+=.01*z.xPercent*q.width,I+=.01*z.yPercent*q.height),q=1e-6,q>H&&H>-q&&(H=0),q>I&&I>-q&&(I=0)),u=(c*y|0)/y+","+(f*y|0)/y+","+(d*y|0)/y+","+(g*y|0)/y+","+H+","+I+")",L&&Aa?this.t.setAttribute("transform","matrix("+u):A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix(":"matrix(")+u):A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix(":"matrix(")+E+",0,0,"+F+","+H+","+I+")");if(n&&(q=1e-4,q>E&&E>-q&&(E=G=2e-5),q>F&&F>-q&&(F=G=2e-5),!M||z.z||z.rotationX||z.rotationY||(M=0)),B||P)B*=K,r=c=Math.cos(B),s=f=Math.sin(B),P&&(B-=P*K,r=Math.cos(B),s=Math.sin(B),"simple"===z.skewType&&(b=Math.tan((P-O)*K),b=Math.sqrt(1+b*b),r*=b,s*=b,z.skewY&&(b=Math.tan(O*K),b=Math.sqrt(1+b*b),c*=b,f*=b))),d=-s,g=r;else{if(!(D||C||1!==G||M||L))return void(A[Ca]=(z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) translate3d(":"translate3d(")+H+"px,"+I+"px,"+J+"px)"+(1!==E||1!==F?" scale("+E+","+F+")":""));c=g=1,d=f=0}k=1,e=h=i=j=l=m=0,o=M?-1/M:0,p=z.zOrigin,q=1e-6,v=",",w="0",B=D*K,B&&(r=Math.cos(B),s=Math.sin(B),i=-s,l=o*-s,e=c*s,h=f*s,k=r,o*=r,c*=r,f*=r),B=C*K,B&&(r=Math.cos(B),s=Math.sin(B),b=d*r+e*s,t=g*r+h*s,j=k*s,m=o*s,e=d*-s+e*r,h=g*-s+h*r,k*=r,o*=r,d=b,g=t),1!==G&&(e*=G,h*=G,k*=G,o*=G),1!==F&&(d*=F,g*=F,j*=F,m*=F),1!==E&&(c*=E,f*=E,i*=E,l*=E),(p||L)&&(p&&(H+=e*-p,I+=h*-p,J+=k*-p+p),L&&(H+=z.xOrigin-(z.xOrigin*c+z.yOrigin*d)+z.xOffset,I+=z.yOrigin-(z.xOrigin*f+z.yOrigin*g)+z.yOffset),q>H&&H>-q&&(H=w),q>I&&I>-q&&(I=w),q>J&&J>-q&&(J=0)),u=z.xPercent||z.yPercent?"translate("+z.xPercent+"%,"+z.yPercent+"%) matrix3d(":"matrix3d(",u+=(q>c&&c>-q?w:c)+v+(q>f&&f>-q?w:f)+v+(q>i&&i>-q?w:i),u+=v+(q>l&&l>-q?w:l)+v+(q>d&&d>-q?w:d)+v+(q>g&&g>-q?w:g),C||D||1!==G?(u+=v+(q>j&&j>-q?w:j)+v+(q>m&&m>-q?w:m)+v+(q>e&&e>-q?w:e),u+=v+(q>h&&h>-q?w:h)+v+(q>k&&k>-q?w:k)+v+(q>o&&o>-q?w:o)+v):u+=",0,0,0,0,1,0,",u+=H+v+I+v+J+v+(M?1+-J/M:1)+")",A[Ca]=u};j=Ga.prototype,j.x=j.y=j.z=j.skewX=j.skewY=j.rotation=j.rotationX=j.rotationY=j.zOrigin=j.xPercent=j.yPercent=j.xOffset=j.yOffset=0,j.scaleX=j.scaleY=j.scaleZ=1,ya("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(a,b,c,d,f,h,i){if(d._lastParsedTransform===i)return f;d._lastParsedTransform=i;var j,k=i.scale&&"function"==typeof i.scale?i.scale:0;"function"==typeof i[c]&&(j=i[c],i[c]=b),k&&(i.scale=k(r,a));var l,m,n,o,p,s,t,u,v,w=a._gsTransform,x=a.style,y=1e-6,z=Ba.length,A=i,B={},C="transformOrigin",D=Ra(a,e,!0,A.parseTransform),E=A.transform&&("function"==typeof A.transform?A.transform(r,q):A.transform);if(D.skewType=A.skewType||D.skewType||g.defaultSkewType,d._transform=D,E&&"string"==typeof E&&Ca)m=Q.style,m[Ca]=E,m.display="block",m.position="absolute",O.body.appendChild(Q),l=Ra(Q,null,!1),"simple"===D.skewType&&(l.scaleY*=Math.cos(l.skewX*K)),D.svg&&(s=D.xOrigin,t=D.yOrigin,l.x-=D.xOffset,l.y-=D.yOffset,(A.transformOrigin||A.svgOrigin)&&(E={},La(a,ha(A.transformOrigin),E,A.svgOrigin,A.smoothOrigin,!0),s=E.xOrigin,t=E.yOrigin,l.x-=E.xOffset-D.xOffset,l.y-=E.yOffset-D.yOffset),(s||t)&&(u=Qa(Q,!0),l.x-=s-(s*u[0]+t*u[2]),l.y-=t-(s*u[1]+t*u[3]))),O.body.removeChild(Q),l.perspective||(l.perspective=D.perspective),null!=A.xPercent&&(l.xPercent=ja(A.xPercent,D.xPercent)),null!=A.yPercent&&(l.yPercent=ja(A.yPercent,D.yPercent));else if("object"==typeof A){if(l={scaleX:ja(null!=A.scaleX?A.scaleX:A.scale,D.scaleX),scaleY:ja(null!=A.scaleY?A.scaleY:A.scale,D.scaleY),scaleZ:ja(A.scaleZ,D.scaleZ),x:ja(A.x,D.x),y:ja(A.y,D.y),z:ja(A.z,D.z),xPercent:ja(A.xPercent,D.xPercent),yPercent:ja(A.yPercent,D.yPercent),perspective:ja(A.transformPerspective,D.perspective)},p=A.directionalRotation,null!=p)if("object"==typeof p)for(m in p)A[m]=p[m];else A.rotation=p;"string"==typeof A.x&&-1!==A.x.indexOf("%")&&(l.x=0,l.xPercent=ja(A.x,D.xPercent)),"string"==typeof A.y&&-1!==A.y.indexOf("%")&&(l.y=0,l.yPercent=ja(A.y,D.yPercent)),l.rotation=ka("rotation"in A?A.rotation:"shortRotation"in A?A.shortRotation+"_short":"rotationZ"in A?A.rotationZ:D.rotation,D.rotation,"rotation",B),Fa&&(l.rotationX=ka("rotationX"in A?A.rotationX:"shortRotationX"in A?A.shortRotationX+"_short":D.rotationX||0,D.rotationX,"rotationX",B),l.rotationY=ka("rotationY"in A?A.rotationY:"shortRotationY"in A?A.shortRotationY+"_short":D.rotationY||0,D.rotationY,"rotationY",B)),l.skewX=ka(A.skewX,D.skewX),l.skewY=ka(A.skewY,D.skewY)}for(Fa&&null!=A.force3D&&(D.force3D=A.force3D,o=!0),n=D.force3D||D.z||D.rotationX||D.rotationY||l.z||l.rotationX||l.rotationY||l.perspective,n||null==A.scale||(l.scaleZ=1);--z>-1;)v=Ba[z],E=l[v]-D[v],(E>y||-y>E||null!=A[v]||null!=M[v])&&(o=!0,f=new ta(D,v,D[v],E,f),v in B&&(f.e=B[v]),f.xs0=0,f.plugin=h,d._overwriteProps.push(f.n));return E=A.transformOrigin,D.svg&&(E||A.svgOrigin)&&(s=D.xOffset,t=D.yOffset,La(a,ha(E),l,A.svgOrigin,A.smoothOrigin),f=ua(D,"xOrigin",(w?D:l).xOrigin,l.xOrigin,f,C),f=ua(D,"yOrigin",(w?D:l).yOrigin,l.yOrigin,f,C),(s!==D.xOffset||t!==D.yOffset)&&(f=ua(D,"xOffset",w?s:D.xOffset,D.xOffset,f,C),f=ua(D,"yOffset",w?t:D.yOffset,D.yOffset,f,C)),E="0px 0px"),(E||Fa&&n&&D.zOrigin)&&(Ca?(o=!0,v=Ea,E=(E||_(a,v,e,!1,"50% 50%"))+"",f=new ta(x,v,0,0,f,-1,C),f.b=x[v],f.plugin=h,Fa?(m=D.zOrigin,E=E.split(" "),D.zOrigin=(E.length>2&&(0===m||"0px"!==E[2])?parseFloat(E[2]):m)||0,f.xs0=f.e=E[0]+" "+(E[1]||"50%")+" 0px",f=new ta(D,"zOrigin",0,0,f,-1,f.n),f.b=m,f.xs0=f.e=D.zOrigin):f.xs0=f.e=E):ha(E+"",D)),o&&(d._transformType=D.svg&&Aa||!n&&3!==this._transformType?2:3),j&&(i[c]=j),k&&(i.scale=k),f},prefix:!0}),ya("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),ya("borderRadius",{defaultValue:"0px",parser:function(a,b,c,f,g,h){b=this.format(b);var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],z=a.style;for(q=parseFloat(a.offsetWidth),r=parseFloat(a.offsetHeight),i=b.split(" "),j=0;j<y.length;j++)this.p.indexOf("border")&&(y[j]=Z(y[j])),m=l=_(a,y[j],e,!1,"0px"),-1!==m.indexOf(" ")&&(l=m.split(" "),m=l[0],l=l[1]),n=k=i[j],o=parseFloat(m),t=m.substr((o+"").length),u="="===n.charAt(1),u?(p=parseInt(n.charAt(0)+"1",10),n=n.substr(2),p*=parseFloat(n),s=n.substr((p+"").length-(0>p?1:0))||""):(p=parseFloat(n),s=n.substr((p+"").length)),""===s&&(s=d[c]||t),s!==t&&(v=aa(a,"borderLeft",o,t),w=aa(a,"borderTop",o,t),"%"===s?(m=v/q*100+"%",l=w/r*100+"%"):"em"===s?(x=aa(a,"borderLeft",1,"em"),m=v/x+"em",l=w/x+"em"):(m=v+"px",l=w+"px"),u&&(n=parseFloat(m)+p+s,k=parseFloat(l)+p+s)),g=va(z,y[j],m+" "+l,n+" "+k,!1,"0px",g);return g},prefix:!0,formatter:qa("0px 0px 0px 0px",!1,!0)}),ya("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(a,b,c,d,f,g){return va(a.style,c,this.format(_(a,c,e,!1,"0px 0px")),this.format(b),!1,"0px",f)},prefix:!0,formatter:qa("0px 0px",!1,!0)}),ya("backgroundPosition",{defaultValue:"0 0",parser:function(a,b,c,d,f,g){var h,i,j,k,l,m,n="background-position",o=e||$(a,null),q=this.format((o?p?o.getPropertyValue(n+"-x")+" "+o.getPropertyValue(n+"-y"):o.getPropertyValue(n):a.currentStyle.backgroundPositionX+" "+a.currentStyle.backgroundPositionY)||"0 0"),r=this.format(b);if(-1!==q.indexOf("%")!=(-1!==r.indexOf("%"))&&r.split(",").length<2&&(m=_(a,"backgroundImage").replace(D,""),m&&"none"!==m)){for(h=q.split(" "),i=r.split(" "),R.setAttribute("src",m),j=2;--j>-1;)q=h[j],k=-1!==q.indexOf("%"),k!==(-1!==i[j].indexOf("%"))&&(l=0===j?a.offsetWidth-R.width:a.offsetHeight-R.height,h[j]=k?parseFloat(q)/100*l+"px":parseFloat(q)/l*100+"%");q=h.join(" ")}return this.parseComplex(a.style,q,r,f,g)},formatter:ha}),ya("backgroundSize",{defaultValue:"0 0",formatter:function(a){return a+="",ha(-1===a.indexOf(" ")?a+" "+a:a)}}),ya("perspective",{defaultValue:"0px",prefix:!0}),ya("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),ya("transformStyle",{prefix:!0}),ya("backfaceVisibility",{prefix:!0}),ya("userSelect",{prefix:!0}),ya("margin",{parser:ra("marginTop,marginRight,marginBottom,marginLeft")}),ya("padding",{parser:ra("paddingTop,paddingRight,paddingBottom,paddingLeft")}),ya("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(a,b,c,d,f,g){var h,i,j;return 9>p?(i=a.currentStyle,j=8>p?" ":",",h="rect("+i.clipTop+j+i.clipRight+j+i.clipBottom+j+i.clipLeft+")",b=this.format(b).split(",").join(j)):(h=this.format(_(a,this.p,e,!1,this.dflt)),b=this.format(b)),this.parseComplex(a.style,h,b,f,g)}}),ya("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),ya("autoRound,strictUnits",{parser:function(a,b,c,d,e){return e}}),ya("border",{defaultValue:"0px solid #000",parser:function(a,b,c,d,f,g){var h=_(a,"borderTopWidth",e,!1,"0px"),i=this.format(b).split(" "),j=i[0].replace(w,"");return"px"!==j&&(h=parseFloat(h)/aa(a,"borderTopWidth",1,j)+j),this.parseComplex(a.style,this.format(h+" "+_(a,"borderTopStyle",e,!1,"solid")+" "+_(a,"borderTopColor",e,!1,"#000")),i.join(" "),f,g)},color:!0,formatter:function(a){var b=a.split(" ");return b[0]+" "+(b[1]||"solid")+" "+(a.match(pa)||["#000"])[0]}}),ya("borderWidth",{parser:ra("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),ya("float,cssFloat,styleFloat",{parser:function(a,b,c,d,e,f){var g=a.style,h="cssFloat"in g?"cssFloat":"styleFloat";return new ta(g,h,0,0,e,-1,c,!1,0,g[h],b)}});var Ua=function(a){var b,c=this.t,d=c.filter||_(this.data,"filter")||"",e=this.s+this.c*a|0;100===e&&(-1===d.indexOf("atrix(")&&-1===d.indexOf("radient(")&&-1===d.indexOf("oader(")?(c.removeAttribute("filter"),b=!_(this.data,"filter")):(c.filter=d.replace(z,""),b=!0)),b||(this.xn1&&(c.filter=d=d||"alpha(opacity="+e+")"),-1===d.indexOf("pacity")?0===e&&this.xn1||(c.filter=d+" alpha(opacity="+e+")"):c.filter=d.replace(x,"opacity="+e))};ya("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(a,b,c,d,f,g){var h=parseFloat(_(a,"opacity",e,!1,"1")),i=a.style,j="autoAlpha"===c;return"string"==typeof b&&"="===b.charAt(1)&&(b=("-"===b.charAt(0)?-1:1)*parseFloat(b.substr(2))+h),j&&1===h&&"hidden"===_(a,"visibility",e)&&0!==b&&(h=0),U?f=new ta(i,"opacity",h,b-h,f):(f=new ta(i,"opacity",100*h,100*(b-h),f),f.xn1=j?1:0,i.zoom=1,f.type=2,f.b="alpha(opacity="+f.s+")",f.e="alpha(opacity="+(f.s+f.c)+")",f.data=a,f.plugin=g,f.setRatio=Ua),j&&(f=new ta(i,"visibility",0,0,f,-1,null,!1,0,0!==h?"inherit":"hidden",0===b?"hidden":"inherit"),f.xs0="inherit",d._overwriteProps.push(f.n),d._overwriteProps.push(c)),f}});var Va=function(a,b){b&&(a.removeProperty?(("ms"===b.substr(0,2)||"webkit"===b.substr(0,6))&&(b="-"+b),a.removeProperty(b.replace(B,"-$1").toLowerCase())):a.removeAttribute(b))},Wa=function(a){if(this.t._gsClassPT=this,1===a||0===a){this.t.setAttribute("class",0===a?this.b:this.e);for(var b=this.data,c=this.t.style;b;)b.v?c[b.p]=b.v:Va(c,b.p),b=b._next;1===a&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};ya("className",{parser:function(a,b,d,f,g,h,i){var j,k,l,m,n,o=a.getAttribute("class")||"",p=a.style.cssText;if(g=f._classNamePT=new ta(a,d,0,0,g,2),g.setRatio=Wa,g.pr=-11,c=!0,g.b=o,k=ca(a,e),l=a._gsClassPT){for(m={},n=l.data;n;)m[n.p]=1,n=n._next;l.setRatio(1)}return a._gsClassPT=g,g.e="="!==b.charAt(1)?b:o.replace(new RegExp("(?:\\s|^)"+b.substr(2)+"(?![\\w-])"),"")+("+"===b.charAt(0)?" "+b.substr(2):""),a.setAttribute("class",g.e),j=da(a,k,ca(a),i,m),a.setAttribute("class",o),g.data=j.firstMPT,a.style.cssText=p,g=g.xfirst=f.parse(a,j.difs,g,h)}});var Xa=function(a){if((1===a||0===a)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var b,c,d,e,f,g=this.t.style,h=i.transform.parse;if("all"===this.e)g.cssText="",e=!0;else for(b=this.e.split(" ").join("").split(","),d=b.length;--d>-1;)c=b[d],i[c]&&(i[c].parse===h?e=!0:c="transformOrigin"===c?Ea:i[c].p),Va(g,c);e&&(Va(g,Ca),f=this.t._gsTransform,f&&(f.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(ya("clearProps",{parser:function(a,b,d,e,f){return f=new ta(a,d,0,0,f,2),f.setRatio=Xa,f.e=b,f.pr=-10,f.data=e._tween,c=!0,f}}),j="bezier,throwProps,physicsProps,physics2D".split(","),wa=j.length;wa--;)za(j[wa]);j=g.prototype,j._firstPT=j._lastParsedTransform=j._transform=null,j._onInitTween=function(a,b,h,j){if(!a.nodeType)return!1;this._target=q=a,this._tween=h,this._vars=b,r=j,k=b.autoRound,c=!1,d=b.suffixMap||g.suffixMap,e=$(a,""),f=this._overwriteProps;var n,p,s,t,u,v,w,x,z,A=a.style;if(l&&""===A.zIndex&&(n=_(a,"zIndex",e),("auto"===n||""===n)&&this._addLazySet(A,"zIndex",0)),"string"==typeof b&&(t=A.cssText,n=ca(a,e),A.cssText=t+";"+b,n=da(a,n,ca(a)).difs,!U&&y.test(b)&&(n.opacity=parseFloat(RegExp.$1)),b=n,A.cssText=t),b.className?this._firstPT=p=i.className.parse(a,b.className,"className",this,null,null,b):this._firstPT=p=this.parse(a,b,null),this._transformType){for(z=3===this._transformType,Ca?m&&(l=!0,""===A.zIndex&&(w=_(a,"zIndex",e),("auto"===w||""===w)&&this._addLazySet(A,"zIndex",0)),o&&this._addLazySet(A,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(z?"visible":"hidden"))):A.zoom=1,s=p;s&&s._next;)s=s._next;x=new ta(a,"transform",0,0,null,2),this._linkCSSP(x,null,s),x.setRatio=Ca?Ta:Sa,x.data=this._transform||Ra(a,e,!0),x.tween=h,x.pr=-1,f.pop()}if(c){for(;p;){for(v=p._next,s=t;s&&s.pr>p.pr;)s=s._next;(p._prev=s?s._prev:u)?p._prev._next=p:t=p,(p._next=s)?s._prev=p:u=p,p=v}this._firstPT=t}return!0},j.parse=function(a,b,c,f){var g,h,j,l,m,n,o,p,s,t,u=a.style;for(g in b){if(n=b[g],"function"==typeof n&&(n=n(r,q)),h=i[g])c=h.parse(a,n,g,this,c,f,b);else{if("--"===g.substr(0,2)){this._tween._propLookup[g]=this._addTween.call(this._tween,a.style,"setProperty",$(a).getPropertyValue(g)+"",n+"",g,!1,g);continue}m=_(a,g,e)+"",s="string"==typeof n,"color"===g||"fill"===g||"stroke"===g||-1!==g.indexOf("Color")||s&&A.test(n)?(s||(n=na(n),n=(n.length>3?"rgba(":"rgb(")+n.join(",")+")"),c=va(u,g,m,n,!0,"transparent",c,0,f)):s&&J.test(n)?c=va(u,g,m,n,!0,null,c,0,f):(j=parseFloat(m),o=j||0===j?m.substr((j+"").length):"",(""===m||"auto"===m)&&("width"===g||"height"===g?(j=ga(a,g,e),o="px"):"left"===g||"top"===g?(j=ba(a,g,e),o="px"):(j="opacity"!==g?0:1,o="")),t=s&&"="===n.charAt(1),t?(l=parseInt(n.charAt(0)+"1",10),n=n.substr(2),l*=parseFloat(n),p=n.replace(w,"")):(l=parseFloat(n),p=s?n.replace(w,""):""),""===p&&(p=g in d?d[g]:o),n=l||0===l?(t?l+j:l)+p:b[g],o!==p&&(""!==p||"lineHeight"===g)&&(l||0===l)&&j&&(j=aa(a,g,j,o),"%"===p?(j/=aa(a,g,100,"%")/100,b.strictUnits!==!0&&(m=j+"%")):"em"===p||"rem"===p||"vw"===p||"vh"===p?j/=aa(a,g,1,p):"px"!==p&&(l=aa(a,g,l,p),p="px"),t&&(l||0===l)&&(n=l+j+p)),t&&(l+=j),!j&&0!==j||!l&&0!==l?void 0!==u[g]&&(n||n+""!="NaN"&&null!=n)?(c=new ta(u,g,l||j||0,0,c,-1,g,!1,0,m,n),c.xs0="none"!==n||"display"!==g&&-1===g.indexOf("Style")?n:m):W("invalid "+g+" tween value: "+b[g]):(c=new ta(u,g,j,l-j,c,0,g,k!==!1&&("px"===p||"zIndex"===g),0,m,n),c.xs0=p))}f&&c&&!c.plugin&&(c.plugin=f)}return c},j.setRatio=function(a){var b,c,d,e=this._firstPT,f=1e-6;if(1!==a||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(a||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;e;){if(b=e.c*a+e.s,e.r?b=Math.round(b):f>b&&b>-f&&(b=0),e.type)if(1===e.type)if(d=e.l,2===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2;else if(3===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3;else if(4===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4;else if(5===d)e.t[e.p]=e.xs0+b+e.xs1+e.xn1+e.xs2+e.xn2+e.xs3+e.xn3+e.xs4+e.xn4+e.xs5;else{for(c=e.xs0+b+e.xs1,d=1;d<e.l;d++)c+=e["xn"+d]+e["xs"+(d+1)];e.t[e.p]=c}else-1===e.type?e.t[e.p]=e.xs0:e.setRatio&&e.setRatio(a);else e.t[e.p]=b+e.xs0;e=e._next}else for(;e;)2!==e.type?e.t[e.p]=e.b:e.setRatio(a),e=e._next;else for(;e;){if(2!==e.type)if(e.r&&-1!==e.type)if(b=Math.round(e.s+e.c),e.type){if(1===e.type){for(d=e.l,c=e.xs0+b+e.xs1,d=1;d<e.l;d++)c+=e["xn"+d]+e["xs"+(d+1)];e.t[e.p]=c}}else e.t[e.p]=b+e.xs0;else e.t[e.p]=e.e;else e.setRatio(a);e=e._next}},j._enableTransforms=function(a){this._transform=this._transform||Ra(this._target,e,!0),this._transformType=this._transform.svg&&Aa||!a&&3!==this._transformType?2:3};var Ya=function(a){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};j._addLazySet=function(a,b,c){var d=this._firstPT=new ta(a,b,0,0,this._firstPT,2);d.e=c,d.setRatio=Ya,d.data=this},j._linkCSSP=function(a,b,c,d){return a&&(b&&(b._prev=a),a._next&&(a._next._prev=a._prev),a._prev?a._prev._next=a._next:this._firstPT===a&&(this._firstPT=a._next,d=!0),c?c._next=a:d||null!==this._firstPT||(this._firstPT=a),a._next=b,a._prev=c),a},j._mod=function(a){for(var b=this._firstPT;b;)"function"==typeof a[b.p]&&a[b.p]===Math.round&&(b.r=1),b=b._next},j._kill=function(b){var c,d,e,f=b;if(b.autoAlpha||b.alpha){f={};for(d in b)f[d]=b[d];f.opacity=1,f.autoAlpha&&(f.visibility=1)}for(b.className&&(c=this._classNamePT)&&(e=c.xfirst,e&&e._prev?this._linkCSSP(e._prev,c._next,e._prev._prev):e===this._firstPT&&(this._firstPT=c._next),c._next&&this._linkCSSP(c._next,c._next._next,e._prev),this._classNamePT=null),c=this._firstPT;c;)c.plugin&&c.plugin!==d&&c.plugin._kill&&(c.plugin._kill(b),d=c.plugin),c=c._next;return a.prototype._kill.call(this,f)};var Za=function(a,b,c){var d,e,f,g;if(a.slice)for(e=a.length;--e>-1;)Za(a[e],b,c);else for(d=a.childNodes,e=d.length;--e>-1;)f=d[e],g=f.type,f.style&&(b.push(ca(f)),c&&c.push(f)),1!==g&&9!==g&&11!==g||!f.childNodes.length||Za(f,b,c)};return g.cascadeTo=function(a,c,d){var e,f,g,h,i=b.to(a,c,d),j=[i],k=[],l=[],m=[],n=b._internals.reservedProps;for(a=i._targets||i.target,Za(a,k,m),i.render(c,!0,!0),Za(a,l),i.render(0,!0,!0),i._enabled(!0),e=m.length;--e>-1;)if(f=da(m[e],k[e],l[e]),f.firstMPT){f=f.difs;for(g in d)n[g]&&(f[g]=d[g]);h={};for(g in f)h[g]=k[e][g];j.push(b.fromTo(m[e],c,h,f))}return j},a.activate([g]),g},!0),function(){var a=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(a,b,c){return this._tween=c,!0}}),b=function(a){for(;a;)a.f||a.blob||(a.m=Math.round),a=a._next},c=a.prototype;c._onInitAllProps=function(){for(var a,c,d,e=this._tween,f=e.vars.roundProps.join?e.vars.roundProps:e.vars.roundProps.split(","),g=f.length,h={},i=e._propLookup.roundProps;--g>-1;)h[f[g]]=Math.round;for(g=f.length;--g>-1;)for(a=f[g],c=e._firstPT;c;)d=c._next,c.pg?c.t._mod(h):c.n===a&&(2===c.f&&c.t?b(c.t._firstPT):(this._add(c.t,a,c.s,c.c),d&&(d._prev=c._prev),c._prev?c._prev._next=d:e._firstPT===c&&(e._firstPT=d),c._next=c._prev=null,e._propLookup[a]=i)),c=d;return!1},c._add=function(a,b,c,d){this._addTween(a,b,c,c+d,b,Math.round),this._overwriteProps.push(b)}}(),function(){_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.1",init:function(a,b,c,d){var e,f;if("function"!=typeof a.setAttribute)return!1;for(e in b)f=b[e],"function"==typeof f&&(f=f(d,a)),this._addTween(a,"setAttribute",a.getAttribute(e)+"",f+"",e,!1,e),this._overwriteProps.push(e);return!0}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.1",API:2,init:function(a,b,c,d){"object"!=typeof b&&(b={rotation:b}),this.finals={};var e,f,g,h,i,j,k=b.useRadians===!0?2*Math.PI:360,l=1e-6;for(e in b)"useRadians"!==e&&(h=b[e],"function"==typeof h&&(h=h(d,a)),j=(h+"").split("_"),f=j[0],g=parseFloat("function"!=typeof a[e]?a[e]:a[e.indexOf("set")||"function"!=typeof a["get"+e.substr(3)]?e:"get"+e.substr(3)]()),h=this.finals[e]="string"==typeof f&&"="===f.charAt(1)?g+parseInt(f.charAt(0)+"1",10)*Number(f.substr(2)):Number(f)||0,i=h-g,j.length&&(f=j.join("_"),-1!==f.indexOf("short")&&(i%=k,i!==i%(k/2)&&(i=0>i?i+k:i-k)),-1!==f.indexOf("_cw")&&0>i?i=(i+9999999999*k)%k-(i/k|0)*k:-1!==f.indexOf("ccw")&&i>0&&(i=(i-9999999999*k)%k-(i/k|0)*k)),(i>l||-l>i)&&(this._addTween(a,e,g,g+i,e),this._overwriteProps.push(e)));return!0},set:function(a){var b;if(1!==a)this._super.setRatio.call(this,a);else for(b=this._firstPT;b;)b.f?b.t[b.p](this.finals[b.p]):b.t[b.p]=this.finals[b.p],b=b._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(a){var b,c,d,e=_gsScope.GreenSockGlobals||_gsScope,f=e.com.greensock,g=2*Math.PI,h=Math.PI/2,i=f._class,j=function(b,c){var d=i("easing."+b,function(){},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,d},k=a.register||function(){},l=function(a,b,c,d,e){var f=i("easing."+a,{easeOut:new b,easeIn:new c,easeInOut:new d},!0);return k(f,a),f},m=function(a,b,c){this.t=a,this.v=b,c&&(this.next=c,c.prev=this,this.c=c.v-b,this.gap=c.t-a)},n=function(b,c){var d=i("easing."+b,function(a){this._p1=a||0===a?a:1.70158,this._p2=1.525*this._p1},!0),e=d.prototype=new a;return e.constructor=d,e.getRatio=c,e.config=function(a){return new d(a)},d},o=l("Back",n("BackOut",function(a){return(a-=1)*a*((this._p1+1)*a+this._p1)+1}),n("BackIn",function(a){return a*a*((this._p1+1)*a-this._p1)}),n("BackInOut",function(a){return(a*=2)<1?.5*a*a*((this._p2+1)*a-this._p2):.5*((a-=2)*a*((this._p2+1)*a+this._p2)+2)})),p=i("easing.SlowMo",function(a,b,c){b=b||0===b?b:.7,null==a?a=.7:a>1&&(a=1),this._p=1!==a?b:0,this._p1=(1-a)/2,this._p2=a,this._p3=this._p1+this._p2,this._calcEnd=c===!0},!0),q=p.prototype=new a;return q.constructor=p,q.getRatio=function(a){var b=a+(.5-a)*this._p;return a<this._p1?this._calcEnd?1-(a=1-a/this._p1)*a:b-(a=1-a/this._p1)*a*a*a*b:a>this._p3?this._calcEnd?1-(a=(a-this._p3)/this._p1)*a:b+(a-b)*(a=(a-this._p3)/this._p1)*a*a*a:this._calcEnd?1:b},p.ease=new p(.7,.7),q.config=p.config=function(a,b,c){return new p(a,b,c)},b=i("easing.SteppedEase",function(a,b){a=a||1,this._p1=1/a,this._p2=a+(b?0:1),this._p3=b?1:0},!0),q=b.prototype=new a,q.constructor=b,q.getRatio=function(a){return 0>a?a=0:a>=1&&(a=.999999999),((this._p2*a|0)+this._p3)*this._p1},q.config=b.config=function(a,c){return new b(a,c)},c=i("easing.RoughEase",function(b){b=b||{};for(var c,d,e,f,g,h,i=b.taper||"none",j=[],k=0,l=0|(b.points||20),n=l,o=b.randomize!==!1,p=b.clamp===!0,q=b.template instanceof a?b.template:null,r="number"==typeof b.strength?.4*b.strength:.4;--n>-1;)c=o?Math.random():1/l*n,d=q?q.getRatio(c):c,"none"===i?e=r:"out"===i?(f=1-c,e=f*f*r):"in"===i?e=c*c*r:.5>c?(f=2*c,e=f*f*.5*r):(f=2*(1-c),e=f*f*.5*r),o?d+=Math.random()*e-.5*e:n%2?d+=.5*e:d-=.5*e,p&&(d>1?d=1:0>d&&(d=0)),j[k++]={x:c,y:d};for(j.sort(function(a,b){return a.x-b.x}),h=new m(1,1,null),n=l;--n>-1;)g=j[n],h=new m(g.x,g.y,h);this._prev=new m(0,0,0!==h.t?h:h.next)},!0),q=c.prototype=new a,q.constructor=c,q.getRatio=function(a){var b=this._prev;if(a>b.t){for(;b.next&&a>=b.t;)b=b.next;b=b.prev}else for(;b.prev&&a<=b.t;)b=b.prev;return this._prev=b,b.v+(a-b.t)/b.gap*b.c},q.config=function(a){return new c(a)},c.ease=new c,l("Bounce",j("BounceOut",function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),j("BounceIn",function(a){return(a=1-a)<1/2.75?1-7.5625*a*a:2/2.75>a?1-(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?1-(7.5625*(a-=2.25/2.75)*a+.9375):1-(7.5625*(a-=2.625/2.75)*a+.984375)}),j("BounceInOut",function(a){var b=.5>a;return a=b?1-2*a:2*a-1,a=1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375,b?.5*(1-a):.5*a+.5})),l("Circ",j("CircOut",function(a){return Math.sqrt(1-(a-=1)*a)}),j("CircIn",function(a){return-(Math.sqrt(1-a*a)-1)}),j("CircInOut",function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)})),d=function(b,c,d){var e=i("easing."+b,function(a,b){this._p1=a>=1?a:1,this._p2=(b||d)/(1>a?a:1),this._p3=this._p2/g*(Math.asin(1/this._p1)||0),this._p2=g/this._p2},!0),f=e.prototype=new a;return f.constructor=e,f.getRatio=c,f.config=function(a,b){return new e(a,b)},e},l("Elastic",d("ElasticOut",function(a){return this._p1*Math.pow(2,-10*a)*Math.sin((a-this._p3)*this._p2)+1},.3),d("ElasticIn",function(a){return-(this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*this._p2))},.3),d("ElasticInOut",function(a){return(a*=2)<1?-.5*(this._p1*Math.pow(2,10*(a-=1))*Math.sin((a-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(a-=1))*Math.sin((a-this._p3)*this._p2)*.5+1},.45)),l("Expo",j("ExpoOut",function(a){return 1-Math.pow(2,-10*a)}),j("ExpoIn",function(a){return Math.pow(2,10*(a-1))-.001}),j("ExpoInOut",function(a){return(a*=2)<1?.5*Math.pow(2,10*(a-1)):.5*(2-Math.pow(2,-10*(a-1)))})),l("Sine",j("SineOut",function(a){return Math.sin(a*h)}),j("SineIn",function(a){return-Math.cos(a*h)+1}),j("SineInOut",function(a){return-.5*(Math.cos(Math.PI*a)-1)})),i("easing.EaseLookup",{find:function(b){return a.map[b]}},!0),k(e.SlowMo,"SlowMo","ease,"),k(c,"RoughEase","ease,"),k(b,"SteppedEase","ease,"),o},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(a,b){"use strict";var c={},d=a.document,e=a.GreenSockGlobals=a.GreenSockGlobals||a;if(!e.TweenLite){var f,g,h,i,j,k=function(a){var b,c=a.split("."),d=e;for(b=0;b<c.length;b++)d[c[b]]=d=d[c[b]]||{};return d},l=k("com.greensock"),m=1e-10,n=function(a){var b,c=[],d=a.length;for(b=0;b!==d;c.push(a[b++]));return c},o=function(){},p=function(){var a=Object.prototype.toString,b=a.call([]);return function(c){return null!=c&&(c instanceof Array||"object"==typeof c&&!!c.push&&a.call(c)===b)}}(),q={},r=function(d,f,g,h){this.sc=q[d]?q[d].sc:[],q[d]=this,this.gsClass=null,this.func=g;var i=[];this.check=function(j){for(var l,m,n,o,p=f.length,s=p;--p>-1;)(l=q[f[p]]||new r(f[p],[])).gsClass?(i[p]=l.gsClass,s--):j&&l.sc.push(this);if(0===s&&g){if(m=("com.greensock."+d).split("."),n=m.pop(),o=k(m.join("."))[n]=this.gsClass=g.apply(g,i),h)if(e[n]=c[n]=o,"undefined"!=typeof module&&module.exports)if(d===b){module.exports=c[b]=o;for(p in c)o[p]=c[p]}else c[b]&&(c[b][n]=o);else"function"==typeof define&&define.amd&&define((a.GreenSockAMDPath?a.GreenSockAMDPath+"/":"")+d.split(".").pop(),[],function(){return o});for(p=0;p<this.sc.length;p++)this.sc[p].check()}},this.check(!0)},s=a._gsDefine=function(a,b,c,d){return new r(a,b,c,d)},t=l._class=function(a,b,c){return b=b||function(){},s(a,[],function(){return b},c),b};s.globals=e;var u=[0,0,1,1],v=t("easing.Ease",function(a,b,c,d){this._func=a,this._type=c||0,this._power=d||0,this._params=b?u.concat(b):u},!0),w=v.map={},x=v.register=function(a,b,c,d){for(var e,f,g,h,i=b.split(","),j=i.length,k=(c||"easeIn,easeOut,easeInOut").split(",");--j>-1;)for(f=i[j],e=d?t("easing."+f,null,!0):l.easing[f]||{},g=k.length;--g>-1;)h=k[g],w[f+"."+h]=w[h+f]=e[h]=a.getRatio?a:a[h]||new a};for(h=v.prototype,h._calcEnd=!1,h.getRatio=function(a){if(this._func)return this._params[0]=a,this._func.apply(null,this._params);var b=this._type,c=this._power,d=1===b?1-a:2===b?a:.5>a?2*a:2*(1-a);return 1===c?d*=d:2===c?d*=d*d:3===c?d*=d*d*d:4===c&&(d*=d*d*d*d),1===b?1-d:2===b?d:.5>a?d/2:1-d/2},f=["Linear","Quad","Cubic","Quart","Quint,Strong"],g=f.length;--g>-1;)h=f[g]+",Power"+g,x(new v(null,null,1,g),h,"easeOut",!0),x(new v(null,null,2,g),h,"easeIn"+(0===g?",easeNone":"")),x(new v(null,null,3,g),h,"easeInOut");w.linear=l.easing.Linear.easeIn,w.swing=l.easing.Quad.easeInOut;var y=t("events.EventDispatcher",function(a){this._listeners={},this._eventTarget=a||this});h=y.prototype,h.addEventListener=function(a,b,c,d,e){e=e||0;var f,g,h=this._listeners[a],k=0;for(this!==i||j||i.wake(),null==h&&(this._listeners[a]=h=[]),g=h.length;--g>-1;)f=h[g],f.c===b&&f.s===c?h.splice(g,1):0===k&&f.pr<e&&(k=g+1);h.splice(k,0,{c:b,s:c,up:d,pr:e})},h.removeEventListener=function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].c===b)return void d.splice(c,1)},h.dispatchEvent=function(a){var b,c,d,e=this._listeners[a];if(e)for(b=e.length,b>1&&(e=e.slice(0)),c=this._eventTarget;--b>-1;)d=e[b],d&&(d.up?d.c.call(d.s||c,{type:a,target:c}):d.c.call(d.s||c))};var z=a.requestAnimationFrame,A=a.cancelAnimationFrame,B=Date.now||function(){return(new Date).getTime()},C=B();for(f=["ms","moz","webkit","o"],g=f.length;--g>-1&&!z;)z=a[f[g]+"RequestAnimationFrame"],A=a[f[g]+"CancelAnimationFrame"]||a[f[g]+"CancelRequestAnimationFrame"];t("Ticker",function(a,b){var c,e,f,g,h,k=this,l=B(),n=b!==!1&&z?"auto":!1,p=500,q=33,r="tick",s=function(a){var b,d,i=B()-C;i>p&&(l+=i-q),C+=i,k.time=(C-l)/1e3,b=k.time-h,(!c||b>0||a===!0)&&(k.frame++,h+=b+(b>=g?.004:g-b),d=!0),a!==!0&&(f=e(s)),d&&k.dispatchEvent(r)};y.call(k),k.time=k.frame=0,k.tick=function(){s(!0)},k.lagSmoothing=function(a,b){p=a||1/m,q=Math.min(b,p,0)},k.sleep=function(){null!=f&&(n&&A?A(f):clearTimeout(f),e=o,f=null,k===i&&(j=!1))},k.wake=function(a){null!==f?k.sleep():a?l+=-C+(C=B()):k.frame>10&&(C=B()-p+5),e=0===c?o:n&&z?z:function(a){return setTimeout(a,1e3*(h-k.time)+1|0)},k===i&&(j=!0),s(2)},k.fps=function(a){return arguments.length?(c=a,g=1/(c||60),h=this.time+g,void k.wake()):c},k.useRAF=function(a){return arguments.length?(k.sleep(),n=a,void k.fps(c)):n},k.fps(a),setTimeout(function(){"auto"===n&&k.frame<5&&"hidden"!==d.visibilityState&&k.useRAF(!1)},1500)}),h=l.Ticker.prototype=new l.events.EventDispatcher,h.constructor=l.Ticker;var D=t("core.Animation",function(a,b){if(this.vars=b=b||{},this._duration=this._totalDuration=a||0,this._delay=Number(b.delay)||0,this._timeScale=1,this._active=b.immediateRender===!0,this.data=b.data,this._reversed=b.reversed===!0,X){j||i.wake();var c=this.vars.useFrames?W:X;c.add(this,c._time),this.vars.paused&&this.paused(!0)}});i=D.ticker=new l.Ticker,h=D.prototype,h._dirty=h._gc=h._initted=h._paused=!1,h._totalTime=h._time=0,h._rawPrevTime=-1,h._next=h._last=h._onUpdate=h._timeline=h.timeline=null,h._paused=!1;var E=function(){j&&B()-C>2e3&&"hidden"!==d.visibilityState&&i.wake();var a=setTimeout(E,2e3);a.unref&&a.unref()};E(),h.play=function(a,b){return null!=a&&this.seek(a,b),this.reversed(!1).paused(!1)},h.pause=function(a,b){return null!=a&&this.seek(a,b),this.paused(!0)},h.resume=function(a,b){return null!=a&&this.seek(a,b),this.paused(!1)},h.seek=function(a,b){return this.totalTime(Number(a),b!==!1)},h.restart=function(a,b){return this.reversed(!1).paused(!1).totalTime(a?-this._delay:0,b!==!1,!0)},h.reverse=function(a,b){return null!=a&&this.seek(a||this.totalDuration(),b),this.reversed(!0).paused(!1)},h.render=function(a,b,c){},h.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},h.isActive=function(){var a,b=this._timeline,c=this._startTime;return!b||!this._gc&&!this._paused&&b.isActive()&&(a=b.rawTime(!0))>=c&&a<c+this.totalDuration()/this._timeScale-1e-7},h._enabled=function(a,b){return j||i.wake(),this._gc=!a,this._active=this.isActive(),b!==!0&&(a&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!a&&this.timeline&&this._timeline._remove(this,!0)),!1},h._kill=function(a,b){return this._enabled(!1,!1)},h.kill=function(a,b){return this._kill(a,b),this},h._uncache=function(a){for(var b=a?this:this.timeline;b;)b._dirty=!0,b=b.timeline;return this},h._swapSelfInParams=function(a){for(var b=a.length,c=a.concat();--b>-1;)"{self}"===a[b]&&(c[b]=this);return c},h._callback=function(a){var b=this.vars,c=b[a],d=b[a+"Params"],e=b[a+"Scope"]||b.callbackScope||this,f=d?d.length:0;switch(f){case 0:c.call(e);break;case 1:c.call(e,d[0]);break;case 2:c.call(e,d[0],d[1]);break;default:c.apply(e,d)}},h.eventCallback=function(a,b,c,d){if("on"===(a||"").substr(0,2)){var e=this.vars;if(1===arguments.length)return e[a];null==b?delete e[a]:(e[a]=b,e[a+"Params"]=p(c)&&-1!==c.join("").indexOf("{self}")?this._swapSelfInParams(c):c,e[a+"Scope"]=d),"onUpdate"===a&&(this._onUpdate=b)}return this},h.delay=function(a){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+a-this._delay),this._delay=a,this):this._delay},h.duration=function(a){return arguments.length?(this._duration=this._totalDuration=a,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==a&&this.totalTime(this._totalTime*(a/this._duration),!0),this):(this._dirty=!1,this._duration)},h.totalDuration=function(a){return this._dirty=!1,arguments.length?this.duration(a):this._totalDuration},h.time=function(a,b){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(a>this._duration?this._duration:a,b)):this._time},h.totalTime=function(a,b,c){if(j||i.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>a&&!c&&(a+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var d=this._totalDuration,e=this._timeline;if(a>d&&!c&&(a=d),this._startTime=(this._paused?this._pauseTime:e._time)-(this._reversed?d-a:a)/this._timeScale,e._dirty||this._uncache(!1),e._timeline)for(;e._timeline;)e._timeline._time!==(e._startTime+e._totalTime)/e._timeScale&&e.totalTime(e._totalTime,!0),e=e._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==a||0===this._duration)&&(J.length&&Z(),this.render(a,b,!1),J.length&&Z())}return this},h.progress=h.totalProgress=function(a,b){var c=this.duration();return arguments.length?this.totalTime(c*a,b):c?this._time/c:this.ratio},h.startTime=function(a){return arguments.length?(a!==this._startTime&&(this._startTime=a,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,a-this._delay)),this):this._startTime},h.endTime=function(a){return this._startTime+(0!=a?this.totalDuration():this.duration())/this._timeScale},h.timeScale=function(a){if(!arguments.length)return this._timeScale;if(a=a||m,this._timeline&&this._timeline.smoothChildTiming){var b=this._pauseTime,c=b||0===b?b:this._timeline.totalTime();this._startTime=c-(c-this._startTime)*this._timeScale/a}return this._timeScale=a,this._uncache(!1)},h.reversed=function(a){return arguments.length?(a!=this._reversed&&(this._reversed=a,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},h.paused=function(a){if(!arguments.length)return this._paused;var b,c,d=this._timeline;return a!=this._paused&&d&&(j||a||i.wake(),b=d.rawTime(),c=b-this._pauseTime,!a&&d.smoothChildTiming&&(this._startTime+=c,this._uncache(!1)),this._pauseTime=a?b:null,this._paused=a,this._active=this.isActive(),!a&&0!==c&&this._initted&&this.duration()&&(b=d.smoothChildTiming?this._totalTime:(b-this._startTime)/this._timeScale,this.render(b,b===this._totalTime,!0))),this._gc&&!a&&this._enabled(!0,!1),this};var F=t("core.SimpleTimeline",function(a){D.call(this,0,a),this.autoRemoveChildren=this.smoothChildTiming=!0});h=F.prototype=new D,h.constructor=F,h.kill()._gc=!1,h._first=h._last=h._recent=null,h._sortChildren=!1,h.add=h.insert=function(a,b,c,d){var e,f;if(a._startTime=Number(b||0)+a._delay,a._paused&&this!==a._timeline&&(a._pauseTime=a._startTime+(this.rawTime()-a._startTime)/a._timeScale),a.timeline&&a.timeline._remove(a,!0),a.timeline=a._timeline=this,a._gc&&a._enabled(!0,!0),e=this._last,this._sortChildren)for(f=a._startTime;e&&e._startTime>f;)e=e._prev;return e?(a._next=e._next,e._next=a):(a._next=this._first,this._first=a),a._next?a._next._prev=a:this._last=a,a._prev=e,this._recent=a,this._timeline&&this._uncache(!0),this},h._remove=function(a,b){return a.timeline===this&&(b||a._enabled(!1,!0),a._prev?a._prev._next=a._next:this._first===a&&(this._first=a._next),a._next?a._next._prev=a._prev:this._last===a&&(this._last=a._prev),a._next=a._prev=a.timeline=null,a===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},h.render=function(a,b,c){var d,e=this._first;for(this._totalTime=this._time=this._rawPrevTime=a;e;)d=e._next,(e._active||a>=e._startTime&&!e._paused&&!e._gc)&&(e._reversed?e.render((e._dirty?e.totalDuration():e._totalDuration)-(a-e._startTime)*e._timeScale,b,c):e.render((a-e._startTime)*e._timeScale,b,c)),e=d},h.rawTime=function(){return j||i.wake(),this._totalTime};var G=t("TweenLite",function(b,c,d){if(D.call(this,c,d),this.render=G.prototype.render,null==b)throw"Cannot tween a null target.";this.target=b="string"!=typeof b?b:G.selector(b)||b;var e,f,g,h=b.jquery||b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType),i=this.vars.overwrite;if(this._overwrite=i=null==i?V[G.defaultOverwrite]:"number"==typeof i?i>>0:V[i],(h||b instanceof Array||b.push&&p(b))&&"number"!=typeof b[0])for(this._targets=g=n(b),this._propLookup=[],this._siblings=[],e=0;e<g.length;e++)f=g[e],f?"string"!=typeof f?f.length&&f!==a&&f[0]&&(f[0]===a||f[0].nodeType&&f[0].style&&!f.nodeType)?(g.splice(e--,1),this._targets=g=g.concat(n(f))):(this._siblings[e]=$(f,this,!1),1===i&&this._siblings[e].length>1&&aa(f,this,null,1,this._siblings[e])):(f=g[e--]=G.selector(f),"string"==typeof f&&g.splice(e+1,1)):g.splice(e--,1);else this._propLookup={},this._siblings=$(b,this,!1),1===i&&this._siblings.length>1&&aa(b,this,null,1,this._siblings);(this.vars.immediateRender||0===c&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-m,this.render(Math.min(0,-this._delay)))},!0),H=function(b){return b&&b.length&&b!==a&&b[0]&&(b[0]===a||b[0].nodeType&&b[0].style&&!b.nodeType)},I=function(a,b){var c,d={};for(c in a)U[c]||c in b&&"transform"!==c&&"x"!==c&&"y"!==c&&"width"!==c&&"height"!==c&&"className"!==c&&"border"!==c||!(!R[c]||R[c]&&R[c]._autoCSS)||(d[c]=a[c],delete a[c]);a.css=d};h=G.prototype=new D,h.constructor=G,h.kill()._gc=!1,h.ratio=0,h._firstPT=h._targets=h._overwrittenProps=h._startAt=null,h._notifyPluginsOfEnabled=h._lazy=!1,G.version="1.20.2",G.defaultEase=h._ease=new v(null,null,1,1),G.defaultOverwrite="auto",G.ticker=i,G.autoSleep=120,G.lagSmoothing=function(a,b){i.lagSmoothing(a,b)},G.selector=a.$||a.jQuery||function(b){var c=a.$||a.jQuery;return c?(G.selector=c,c(b)):"undefined"==typeof d?b:d.querySelectorAll?d.querySelectorAll(b):d.getElementById("#"===b.charAt(0)?b.substr(1):b)};var J=[],K={},L=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,M=/[\+-]=-?[\.\d]/,N=function(a){for(var b,c=this._firstPT,d=1e-6;c;)b=c.blob?1===a&&this.end?this.end:a?this.join(""):this.start:c.c*a+c.s,c.m?b=c.m(b,this._target||c.t):d>b&&b>-d&&!c.blob&&(b=0),c.f?c.fp?c.t[c.p](c.fp,b):c.t[c.p](b):c.t[c.p]=b,c=c._next},O=function(a,b,c,d){var e,f,g,h,i,j,k,l=[],m=0,n="",o=0;for(l.start=a,l.end=b,a=l[0]=a+"",b=l[1]=b+"",c&&(c(l),a=l[0],b=l[1]),l.length=0,e=a.match(L)||[],f=b.match(L)||[],d&&(d._next=null,d.blob=1,l._firstPT=l._applyPT=d),i=f.length,h=0;i>h;h++)k=f[h],j=b.substr(m,b.indexOf(k,m)-m),n+=j||!h?j:",",m+=j.length,o?o=(o+1)%5:"rgba("===j.substr(-5)&&(o=1),k===e[h]||e.length<=h?n+=k:(n&&(l.push(n),n=""),g=parseFloat(e[h]),l.push(g),l._firstPT={_next:l._firstPT,t:l,p:l.length-1,s:g,c:("="===k.charAt(1)?parseInt(k.charAt(0)+"1",10)*parseFloat(k.substr(2)):parseFloat(k)-g)||0,f:0,m:o&&4>o?Math.round:0}),m+=k.length;return n+=b.substr(m),n&&l.push(n),l.setRatio=N,M.test(b)&&(l.end=0),l},P=function(a,b,c,d,e,f,g,h,i){"function"==typeof d&&(d=d(i||0,a));var j,k=typeof a[b],l="function"!==k?"":b.indexOf("set")||"function"!=typeof a["get"+b.substr(3)]?b:"get"+b.substr(3),m="get"!==c?c:l?g?a[l](g):a[l]():a[b],n="string"==typeof d&&"="===d.charAt(1),o={t:a,p:b,s:m,f:"function"===k,pg:0,n:e||b,m:f?"function"==typeof f?f:Math.round:0,pr:0,c:n?parseInt(d.charAt(0)+"1",10)*parseFloat(d.substr(2)):parseFloat(d)-m||0};return("number"!=typeof m||"number"!=typeof d&&!n)&&(g||isNaN(m)||!n&&isNaN(d)||"boolean"==typeof m||"boolean"==typeof d?(o.fp=g,j=O(m,n?parseFloat(o.s)+o.c:d,h||G.defaultStringFilter,o),o={t:j,p:"setRatio",s:0,c:1,f:2,pg:0,n:e||b,pr:0,m:0}):(o.s=parseFloat(m),n||(o.c=parseFloat(d)-o.s||0))),o.c?((o._next=this._firstPT)&&(o._next._prev=o),this._firstPT=o,o):void 0},Q=G._internals={isArray:p,isSelector:H,lazyTweens:J,blobDif:O},R=G._plugins={},S=Q.tweenLookup={},T=0,U=Q.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},V={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},W=D._rootFramesTimeline=new F,X=D._rootTimeline=new F,Y=30,Z=Q.lazyRender=function(){var a,b=J.length;for(K={};--b>-1;)a=J[b],a&&a._lazy!==!1&&(a.render(a._lazy[0],a._lazy[1],!0),a._lazy=!1);J.length=0};X._startTime=i.time,W._startTime=i.frame,X._active=W._active=!0,setTimeout(Z,1),D._updateRoot=G.render=function(){var a,b,c;if(J.length&&Z(),X.render((i.time-X._startTime)*X._timeScale,!1,!1),W.render((i.frame-W._startTime)*W._timeScale,!1,!1),J.length&&Z(),i.frame>=Y){Y=i.frame+(parseInt(G.autoSleep,10)||120);for(c in S){for(b=S[c].tweens,a=b.length;--a>-1;)b[a]._gc&&b.splice(a,1);0===b.length&&delete S[c]}if(c=X._first,(!c||c._paused)&&G.autoSleep&&!W._first&&1===i._listeners.tick.length){for(;c&&c._paused;)c=c._next;c||i.sleep()}}},i.addEventListener("tick",D._updateRoot);var $=function(a,b,c){var d,e,f=a._gsTweenID;if(S[f||(a._gsTweenID=f="t"+T++)]||(S[f]={target:a,tweens:[]}),b&&(d=S[f].tweens,d[e=d.length]=b,c))for(;--e>-1;)d[e]===b&&d.splice(e,1);return S[f].tweens},_=function(a,b,c,d){var e,f,g=a.vars.onOverwrite;return g&&(e=g(a,b,c,d)),g=G.onOverwrite,g&&(f=g(a,b,c,d)),e!==!1&&f!==!1},aa=function(a,b,c,d,e){var f,g,h,i;if(1===d||d>=4){for(i=e.length,f=0;i>f;f++)if((h=e[f])!==b)h._gc||h._kill(null,a,b)&&(g=!0);else if(5===d)break;return g}var j,k=b._startTime+m,l=[],n=0,o=0===b._duration;for(f=e.length;--f>-1;)(h=e[f])===b||h._gc||h._paused||(h._timeline!==b._timeline?(j=j||ba(b,0,o),0===ba(h,j,o)&&(l[n++]=h)):h._startTime<=k&&h._startTime+h.totalDuration()/h._timeScale>k&&((o||!h._initted)&&k-h._startTime<=2e-10||(l[n++]=h)));for(f=n;--f>-1;)if(h=l[f],2===d&&h._kill(c,a,b)&&(g=!0),2!==d||!h._firstPT&&h._initted){if(2!==d&&!_(h,b))continue;h._enabled(!1,!1)&&(g=!0)}return g},ba=function(a,b,c){for(var d=a._timeline,e=d._timeScale,f=a._startTime;d._timeline;){if(f+=d._startTime,e*=d._timeScale,d._paused)return-100;d=d._timeline}return f/=e,f>b?f-b:c&&f===b||!a._initted&&2*m>f-b?m:(f+=a.totalDuration()/a._timeScale/e)>b+m?0:f-b-m};h._init=function(){var a,b,c,d,e,f,g=this.vars,h=this._overwrittenProps,i=this._duration,j=!!g.immediateRender,k=g.ease;if(g.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),e={};for(d in g.startAt)e[d]=g.startAt[d];if(e.overwrite=!1,e.immediateRender=!0,e.lazy=j&&g.lazy!==!1,e.startAt=e.delay=null,e.onUpdate=g.onUpdate,e.onUpdateScope=g.onUpdateScope||g.callbackScope||this,this._startAt=G.to(this.target,0,e),j)if(this._time>0)this._startAt=null;else if(0!==i)return}else if(g.runBackwards&&0!==i)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(j=!1),c={};for(d in g)U[d]&&"autoCSS"!==d||(c[d]=g[d]);if(c.overwrite=0,c.data="isFromStart",c.lazy=j&&g.lazy!==!1,c.immediateRender=j,this._startAt=G.to(this.target,0,c),j){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=k=k?k instanceof v?k:"function"==typeof k?new v(k,g.easeParams):w[k]||G.defaultEase:G.defaultEase,g.easeParams instanceof Array&&k.config&&(this._ease=k.config.apply(k,g.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(f=this._targets.length,a=0;f>a;a++)this._initProps(this._targets[a],this._propLookup[a]={},this._siblings[a],h?h[a]:null,a)&&(b=!0);else b=this._initProps(this.target,this._propLookup,this._siblings,h,0);if(b&&G._onPluginEvent("_onInitAllProps",this),h&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),g.runBackwards)for(c=this._firstPT;c;)c.s+=c.c,c.c=-c.c,c=c._next;this._onUpdate=g.onUpdate,this._initted=!0},h._initProps=function(b,c,d,e,f){var g,h,i,j,k,l;if(null==b)return!1;K[b._gsTweenID]&&Z(),this.vars.css||b.style&&b!==a&&b.nodeType&&R.css&&this.vars.autoCSS!==!1&&I(this.vars,b);for(g in this.vars)if(l=this.vars[g],U[g])l&&(l instanceof Array||l.push&&p(l))&&-1!==l.join("").indexOf("{self}")&&(this.vars[g]=l=this._swapSelfInParams(l,this));else if(R[g]&&(j=new R[g])._onInitTween(b,this.vars[g],this,f)){for(this._firstPT=k={_next:this._firstPT,t:j,p:"setRatio",s:0,c:1,f:1,n:g,pg:1,pr:j._priority,m:0},h=j._overwriteProps.length;--h>-1;)c[j._overwriteProps[h]]=this._firstPT;(j._priority||j._onInitAllProps)&&(i=!0),(j._onDisable||j._onEnable)&&(this._notifyPluginsOfEnabled=!0),k._next&&(k._next._prev=k)}else c[g]=P.call(this,b,g,"get",l,g,0,null,this.vars.stringFilter,f);return e&&this._kill(e,b)?this._initProps(b,c,d,e,f):this._overwrite>1&&this._firstPT&&d.length>1&&aa(b,this,c,this._overwrite,d)?(this._kill(c,b),this._initProps(b,c,d,e,f)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(K[b._gsTweenID]=!0),i)},h.render=function(a,b,c){var d,e,f,g,h=this._time,i=this._duration,j=this._rawPrevTime;if(a>=i-1e-7&&a>=0)this._totalTime=this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(d=!0,e="onComplete",c=c||this._timeline.autoRemoveChildren),0===i&&(this._initted||!this.vars.lazy||c)&&(this._startTime===this._timeline._duration&&(a=0),(0>j||0>=a&&a>=-1e-7||j===m&&"isPause"!==this.data)&&j!==a&&(c=!0,j>m&&(e="onReverseComplete")),this._rawPrevTime=g=!b||a||j===a?a:m);else if(1e-7>a)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==h||0===i&&j>0)&&(e="onReverseComplete",d=this._reversed),0>a&&(this._active=!1,0===i&&(this._initted||!this.vars.lazy||c)&&(j>=0&&(j!==m||"isPause"!==this.data)&&(c=!0),this._rawPrevTime=g=!b||a||j===a?a:m)),(!this._initted||this._startAt&&this._startAt.progress())&&(c=!0);else if(this._totalTime=this._time=a,this._easeType){var k=a/i,l=this._easeType,n=this._easePower;(1===l||3===l&&k>=.5)&&(k=1-k),3===l&&(k*=2),1===n?k*=k:2===n?k*=k*k:3===n?k*=k*k*k:4===n&&(k*=k*k*k*k),1===l?this.ratio=1-k:2===l?this.ratio=k:.5>a/i?this.ratio=k/2:this.ratio=1-k/2}else this.ratio=this._ease.getRatio(a/i);if(this._time!==h||c){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!c&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=h,this._rawPrevTime=j,J.push(this),void(this._lazy=[a,b]);this._time&&!d?this.ratio=this._ease.getRatio(this._time/i):d&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==h&&a>=0&&(this._active=!0),0===h&&(this._startAt&&(a>=0?this._startAt.render(a,b,c):e||(e="_dummyGS")),this.vars.onStart&&(0!==this._time||0===i)&&(b||this._callback("onStart"))),f=this._firstPT;f;)f.f?f.t[f.p](f.c*this.ratio+f.s):f.t[f.p]=f.c*this.ratio+f.s,f=f._next;this._onUpdate&&(0>a&&this._startAt&&a!==-1e-4&&this._startAt.render(a,b,c),b||(this._time!==h||d||c)&&this._callback("onUpdate")),e&&(!this._gc||c)&&(0>a&&this._startAt&&!this._onUpdate&&a!==-1e-4&&this._startAt.render(a,b,c),d&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!b&&this.vars[e]&&this._callback(e),0===i&&this._rawPrevTime===m&&g!==m&&(this._rawPrevTime=0))}},h._kill=function(a,b,c){if("all"===a&&(a=null),null==a&&(null==b||b===this.target))return this._lazy=!1,this._enabled(!1,!1);b="string"!=typeof b?b||this._targets||this.target:G.selector(b)||b;var d,e,f,g,h,i,j,k,l,m=c&&this._time&&c._startTime===this._startTime&&this._timeline===c._timeline;if((p(b)||H(b))&&"number"!=typeof b[0])for(d=b.length;--d>-1;)this._kill(a,b[d],c)&&(i=!0);else{if(this._targets){for(d=this._targets.length;--d>-1;)if(b===this._targets[d]){h=this._propLookup[d]||{},this._overwrittenProps=this._overwrittenProps||[],e=this._overwrittenProps[d]=a?this._overwrittenProps[d]||{}:"all";break}}else{if(b!==this.target)return!1;h=this._propLookup,e=this._overwrittenProps=a?this._overwrittenProps||{}:"all"}if(h){if(j=a||h,k=a!==e&&"all"!==e&&a!==h&&("object"!=typeof a||!a._tempKill),c&&(G.onOverwrite||this.vars.onOverwrite)){for(f in j)h[f]&&(l||(l=[]),l.push(f));if((l||!a)&&!_(this,c,b,l))return!1}for(f in j)(g=h[f])&&(m&&(g.f?g.t[g.p](g.s):g.t[g.p]=g.s,i=!0),g.pg&&g.t._kill(j)&&(i=!0),g.pg&&0!==g.t._overwriteProps.length||(g._prev?g._prev._next=g._next:g===this._firstPT&&(this._firstPT=g._next),g._next&&(g._next._prev=g._prev),g._next=g._prev=null),delete h[f]),k&&(e[f]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return i},h.invalidate=function(){return this._notifyPluginsOfEnabled&&G._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],D.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-m,this.render(Math.min(0,-this._delay))),this},h._enabled=function(a,b){if(j||i.wake(),a&&this._gc){var c,d=this._targets;if(d)for(c=d.length;--c>-1;)this._siblings[c]=$(d[c],this,!0);else this._siblings=$(this.target,this,!0)}return D.prototype._enabled.call(this,a,b),this._notifyPluginsOfEnabled&&this._firstPT?G._onPluginEvent(a?"_onEnable":"_onDisable",this):!1},G.to=function(a,b,c){return new G(a,b,c)},G.from=function(a,b,c){return c.runBackwards=!0,c.immediateRender=0!=c.immediateRender,new G(a,b,c)},G.fromTo=function(a,b,c,d){return d.startAt=c,d.immediateRender=0!=d.immediateRender&&0!=c.immediateRender,new G(a,b,d)},G.delayedCall=function(a,b,c,d,e){return new G(b,0,{delay:a,onComplete:b,onCompleteParams:c,callbackScope:d,onReverseComplete:b,onReverseCompleteParams:c,immediateRender:!1,lazy:!1,useFrames:e,overwrite:0})},G.set=function(a,b){return new G(a,0,b)},G.getTweensOf=function(a,b){if(null==a)return[];a="string"!=typeof a?a:G.selector(a)||a;var c,d,e,f;if((p(a)||H(a))&&"number"!=typeof a[0]){for(c=a.length,d=[];--c>-1;)d=d.concat(G.getTweensOf(a[c],b));for(c=d.length;--c>-1;)for(f=d[c],e=c;--e>-1;)f===d[e]&&d.splice(c,1)}else if(a._gsTweenID)for(d=$(a).concat(),c=d.length;--c>-1;)(d[c]._gc||b&&!d[c].isActive())&&d.splice(c,1);return d||[]},G.killTweensOf=G.killDelayedCallsTo=function(a,b,c){"object"==typeof b&&(c=b,b=!1);for(var d=G.getTweensOf(a,b),e=d.length;--e>-1;)d[e]._kill(c,a)};var ca=t("plugins.TweenPlugin",function(a,b){this._overwriteProps=(a||"").split(","),this._propName=this._overwriteProps[0],this._priority=b||0,this._super=ca.prototype},!0);if(h=ca.prototype,ca.version="1.19.0",ca.API=2,h._firstPT=null,h._addTween=P,h.setRatio=N,h._kill=function(a){var b,c=this._overwriteProps,d=this._firstPT;if(null!=a[this._propName])this._overwriteProps=[];else for(b=c.length;--b>-1;)null!=a[c[b]]&&c.splice(b,1);for(;d;)null!=a[d.n]&&(d._next&&(d._next._prev=d._prev),d._prev?(d._prev._next=d._next,d._prev=null):this._firstPT===d&&(this._firstPT=d._next)),d=d._next;return!1},h._mod=h._roundProps=function(a){for(var b,c=this._firstPT;c;)b=a[this._propName]||null!=c.n&&a[c.n.split(this._propName+"_").join("")],b&&"function"==typeof b&&(2===c.f?c.t._applyPT.m=b:c.m=b),c=c._next},G._onPluginEvent=function(a,b){var c,d,e,f,g,h=b._firstPT;if("_onInitAllProps"===a){for(;h;){for(g=h._next,d=e;d&&d.pr>h.pr;)d=d._next;(h._prev=d?d._prev:f)?h._prev._next=h:e=h,(h._next=d)?d._prev=h:f=h,h=g}h=b._firstPT=e}for(;h;)h.pg&&"function"==typeof h.t[a]&&h.t[a]()&&(c=!0),h=h._next;return c},ca.activate=function(a){for(var b=a.length;--b>-1;)a[b].API===ca.API&&(R[(new a[b])._propName]=a[b]);return!0},s.plugin=function(a){if(!(a&&a.propName&&a.init&&a.API))throw"illegal plugin definition.";var b,c=a.propName,d=a.priority||0,e=a.overwriteProps,f={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},g=t("plugins."+c.charAt(0).toUpperCase()+c.substr(1)+"Plugin",function(){ca.call(this,c,d),this._overwriteProps=e||[]},a.global===!0),h=g.prototype=new ca(c);h.constructor=g,g.API=a.API;for(b in f)"function"==typeof a[b]&&(h[f[b]]=a[b]);return g.version=a.version,ca.activate([g]),g},f=a._gsQueue){for(g=0;g<f.length;g++)f[g]();for(h in q)q[h].func||a.console.log("GSAP encountered missing dependency: "+h)}j=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax");
var IVC;(function(SCOPE){var version="1.1.0";ivcLog("ivcCustomTracking version: "+version);var that=this,tracking_version;var passedPoints={pass25:false,pass50:false,pass75:false,pass100:false};that.iRoll;that.mainVideo;var CUSTOM_REPORT_LABEL='Custom_Track';var VERSION_REPORT_VALUE='Video_Version';var PROGRESS_REPORT_TYPE='Progress';var INUNIT_REPORT_TYPE='InUnit';var AUTO_INUNIT_REPORT_TYPE='InUnit-Auto';var CLICKTHRU_REPORT_TYPE='ClickThru';var videoTimeUpdate;var allowAnimationFrame=true;var flagReportEventWithoutEngagement=false;"use strict";SCOPE.initCustomTracking=function(context){if(that.iRoll)return;that.iRoll=context.getIroll();that.mainVideo=context.getVideo();SCOPE.ivcOnClickthru.push(function(label){localLogger('openURL',label);dynamicOpenURL(label);});SCOPE.ivcOnReportEvent.push(function(label,other){localLogger('reportEvent',label);dynamicReportEvent(label,other);});SCOPE.ivcOnReportEventWithoutEngagement.push(function(label,other){if(flagReportEventWithoutEngagement){flagReportEventWithoutEngagement=false;}else{localLogger('reportEventWithoutEngagement',label);dynamicReportEventWithoutEngagement(label,other);}});context.__contextImpl.iroll.get("videoPlayer").on("interact",function(){localLogger('openURL',"main");dynamicOpenURL("main");});};SCOPE.declareVersion=function(version_value){if(!!tracking_version){ivcLog("VERSION CAN BE REPORTED ONLY ONCE!!");return;}
tracking_version=version_value;ivcLog("DYNAMIC VERSION : ",tracking_version);reportVersion();initTimeUpdate();};function dynamicReportEvent(label,other){customReport(INUNIT_REPORT_TYPE,label,other||'');}
function dynamicReportEventWithoutEngagement(label,other){customReport(AUTO_INUNIT_REPORT_TYPE,label,other||'');}
function dynamicOpenURL(label,other){customReport(CLICKTHRU_REPORT_TYPE,label,other||'');}
function initTimeUpdate(){videoTimeUpdate=requestAnimationFrame(updatePlayback);}
function updatePlayback(){if(!allowAnimationFrame)return;setPassedPoint(that.mainVideo.getCurrentTime(),that.mainVideo.getDuration(),tracking_version);videoTimeUpdate=requestAnimationFrame(updatePlayback);}
function reportVersion(){customReport(PROGRESS_REPORT_TYPE,VERSION_REPORT_VALUE);}
function customReport(type,trackValue,other){if(!tracking_version)return;flagReportEventWithoutEngagement=true;other=(other)?","+other:'';if(IVA.devMode)ivcLog(">>>> HTML CUSTOM TRACK : ",CUSTOM_REPORT_LABEL+","+tracking_version+","+type+","+trackValue+other);that.iRoll.reportEventWithoutEngagement(CUSTOM_REPORT_LABEL,tracking_version+","+type+","+trackValue+other);}
function autoReport(trackValue){customReport(PROGRESS_REPORT_TYPE,trackValue)}
function localLogger(type,label){if(IVA.devMode)console.log("this is "+type+" event : ",label);}
function setPassedPoint(currentTime,duration){var currentProgress=100*currentTime/duration;if(currentProgress>25&&!passedPoints.pass25){passedPoints.pass25=true;autoReport('video_playback_25');}
if(currentProgress>50&&!passedPoints.pass50){passedPoints.pass50=true;autoReport('video_playback_50');}
if(currentProgress>75&&!passedPoints.pass75){passedPoints.pass75=true;autoReport('video_playback_75');}
if(currentProgress>99&&!passedPoints.pass100){passedPoints.pass100=true;autoReport('video_playback_complete');allowAnimationFrame=false;cancelAnimationFrame(videoTimeUpdate);}}})(IVC||(IVC={}));
var IVC;(function(SCOPE){var resizerVersion="3.6.2";if(!window.requestAnimationFrame){window.requestAnimationFrame=(function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1000/60);};})();}
window.portrait={"FIXED_ON_PREROLL":"fixed-preroll-port","FIXED_VERTICALLY":"fixed-portrait-port","BACKGROUND_TOP":"bg-top-port","BACKGROUND_BOTTOM":"bg-bottom-port","CONTENT_TOP":"content-top-port","CONTENT_BOTTOM":"content-bottom-port","FULL_WIDTH":"full-width-port","FULL_AD":"full-ad-port","INVISIBLE":"none"};window.landscape={"FIXED_ON_PREROLL":"fixed-preroll-land","FIXED_VERTICALLY":"fixed-portrait-land","BACKGROUND_TOP":"bg-top-land","BACKGROUND_BOTTOM":"bg-bottom-land","CONTENT_TOP":"content-top-land","CONTENT_BOTTOM":"content-bottom-land","FULL_WIDTH":"full-width-land","FULL_AD":"full-ad-land","INVISIBLE":"none"};SCOPE.startIVCResize=function(context,baseWidth,baseHeight,bottomOffset,topOffset,useScale,showPortraitOnDesktop,videoRatio){ivcLog("ivcResizer version: "+resizerVersion);if(!baseWidth||isNaN(baseWidth.toString())||!baseHeight||isNaN(baseHeight.toString()))throw"Creative size was not set in startIVCResize()";var element,lastWidth,lastHeight,elWidth,elHeight,vidWidth,vidHeight,elSet=false,irollEl,orientationSet=false;var holders=[];var contextImpl=context.__contextImpl;ivcLog("iframe: "+(contextImpl.data.custom.iframe)+", waitForLoad: "+(contextImpl.data.custom.waitForLoad));ivcLog("desktopOnly: "+contextImpl.data['html-custom-data'].desktopOnly);var isCanvas=contextImpl.data['html-custom-data'].isCanvas;ivcLog("isCanvas: "+isCanvas+", forceInternalPlayer: "+(contextImpl.data.forceInternalPlayer));var pixelRatio=('devicePixelRatio'in window)?window.devicePixelRatio:window.screen.deviceXDPI/window.screen.logicalXDPI;ivcLog("pixelRatio: "+pixelRatio);var defaultRatio=16/9;var tabletRatio=4/3;var holderDefaults={anchorP:"MM",anchorL:"MM",scaleToFit:false,fullscreen:false,maxWidth:960,maxHeight:540,tablet:false,anchorTo:"video",overflowP:"hidden",overflowL:"hidden",fontSize:20,zIndex:"auto",useScale:true};var generalSettings={bottomOffset:0,topOffset:0,showPortraitOnDesktop:true,adRatio:undefined,videoRatio:defaultRatio,useScale:true};bottomOffset=generalSettings.bottomOffset=typeof bottomOffset==='undefined'?generalSettings.bottomOffset:bottomOffset;topOffset=generalSettings.topOffset=typeof topOffset==='undefined'?generalSettings.topOffset:topOffset;useScale=generalSettings.useScale=typeof useScale==='undefined'?generalSettings.useScale:useScale;showPortraitOnDesktop=generalSettings.showPortraitOnDesktop=typeof showPortraitOnDesktop==='undefined'?generalSettings.showPortraitOnDesktop:showPortraitOnDesktop;var adRatio=generalSettings.adRatio=baseWidth/baseHeight;var spaceRatio;videoRatio=generalSettings.videoRatio=typeof videoRatio==='undefined'?generalSettings.videoRatio:videoRatio;baseWidth/=pixelRatio;var baseSizeBig=baseWidth,baseSizeSmall=baseSizeBig*1/adRatio;ivcLog("creative base size: "+Math.floor(baseSizeBig*pixelRatio)+" x "+Math.floor(baseSizeSmall*pixelRatio));var isDesktop=(context.getDevice().getPlatformType()===IVA.Device.PlatformType.DESKTOP);var isPortrait;ivcLog(generalSettings);ivcLog("----------------------------------------------");var resizeIndex=0;var sessionId=context.__contextImpl.iroll.report.get('reportData')['session_id'];var platform=(isDesktop)?"Desktop":"Mobile";var resizeChecker=IVA.createOverlay({show:function(){window.requestAnimationFrame(function(){checkResize();});},render:function(){element=$('<div id="ivc-resize-checker"/>');element[0].style.cssText+="position: absolute !important";element[0].style.cssText+="width: 100% !important";element[0].style.cssText+="height: 100% !important";element[0].style.cssText+="pointer-events: none !important";return element;}});context.getIroll().getProgram().now().show(resizeChecker);if(ivcDevMode&&!IVA.devMode){contextImpl.Events.on('ad_ended',function(){contextImpl.Events.off('ad_ended');element[0].style.cssText+="background-color: black !important";element[0].style.cssText+="pointer-events: auto !important";element[0].style.cssText+="z-index: 99 !important";});}
SCOPE.ivcAddResizeHolder=function(holder,landscape,portrait,params){var whichHolder;var whichTypeLandscape;var whichTypePortrait;var params;var paramsComputed=[];for(var i=0;i<arguments.length;i++){if(typeof arguments[i]==='object'){if($(arguments[i])[0].tagName)whichHolder=arguments[i];else params=arguments[i];}
else if(arguments[i].indexOf('land')>-1)whichTypeLandscape=arguments[i].substring(0,arguments[i].length-5);else if(arguments[i].indexOf('port')>-1)whichTypePortrait=arguments[i].substring(0,arguments[i].length-5);}
if(!whichHolder)throw"You must pass the holder div, when calling the SCOPE.ivcAddResizeHolder() function";params=params||{};for(var def in holderDefaults){if(typeof params[def]==='undefined'){switch(def){case"overflowP":case"overflowL":if(typeof params.overflow!=='undefined')paramsComputed[def]=params.overflow;else if(def=="overflowP"){if(whichTypePortrait=="fixed-portrait"||whichTypePortrait.indexOf('content')>-1)paramsComputed.overflowP="visible";else paramsComputed.overflowP=holderDefaults["overflowP"];}else{paramsComputed.overflowL=holderDefaults["overflowL"];}
break;case"anchorP":case"anchorL":if(typeof params.anchor!=='undefined')paramsComputed[def]=params.anchor;else if(def=="anchorP"){if(whichTypePortrait=="content-top")paramsComputed.anchorP="BM";else if(whichTypePortrait=="content-bottom")paramsComputed.anchorP="TM";else paramsComputed.anchorP=holderDefaults["anchorP"];}else{paramsComputed.anchorL=holderDefaults["anchorL"];}
break;case"useScale":paramsComputed.useScale=useScale;break;default:paramsComputed[def]=holderDefaults[def];break;}}else{paramsComputed[def]=params[def];}}
paramsComputed.typeLand=whichTypeLandscape||"none";paramsComputed.typePort=whichTypePortrait||"none";whichHolder[0].style.cssText+="z-index:"+paramsComputed.zIndex+" !important;";ivcLog(whichHolder);ivcLog("portrait: ",paramsComputed.typePort," | landscape: ",paramsComputed.typeLand);ivcLog("Params as set by developer:");ivcLog(params);ivcLog("Params Computed:");ivcLog(paramsComputed);ivcLog("----------------------------------------------");holders.push({div:whichHolder,params:paramsComputed});whichHolder.addClass("ivc-registered-holder");SCOPE.onResize();};SCOPE.ivcResizeFunctions=[];var elementsToFit=[];SCOPE.ivcFitText=function(who){elementsToFit.push({element:who,className:null});}
requestAnimationFrame(checkElementsToFit);function checkElementsToFit(){elementsToFit.forEach(function(item){if(item.element[0]&&item.element[0].scrollWidth>item.element[0].clientWidth){var fSize=parseFloat(item.element.css("font-size"));var ratio=0.95*item.element[0].clientWidth/item.element[0].scrollWidth;fSize*=ratio;var className="ivcFitTest_"+item.element[0].id+"_"+elementsToFit.indexOf(item);var style=document.createElement('style');style.type='text/css';style.innerHTML='.'+className+' { font-size: '+fSize+'px !important; }';document.getElementsByTagName('head')[0].appendChild(style);item.className=className;item.element.addClass(className);}})
requestAnimationFrame(checkElementsToFit);};function checkResize(e){if(element&&element.width()>0&&!elSet){elSet=true;if(isCanvas)setPlayBtnHolder();SCOPE.onResize();}
if((element.width()!=lastWidth)||(element.height()!=lastHeight)){SCOPE.onResize();lastWidth=element.width();lastHeight=element.height();if(lastWidth>0&&resizeIndex<=5){var orientation=(lastWidth>lastHeight)?"Landscape":"Portrait";context.getIroll().reportCreativeDebugEvent("Ad_Size_Data",resizeIndex+","+orientation+","+lastWidth+"x"+lastHeight+","+pixelRatio+","+platform+","+sessionId);resizeIndex++;}}
window.requestAnimationFrame(checkResize);}
SCOPE.onResize=function(){if(!element)return;elWidth=element.width();elHeight=element.height();spaceRatio=elWidth/elHeight;var ratioType=defaultRatio;var orientation=SCOPE.deviceMode=context.getDevice().getOrientation();isPortrait=SCOPE.deviceMode===IVA.Device.Orientation.PORTRAIT;if(!isDesktop||showPortraitOnDesktop){if(spaceRatio>0.68&&spaceRatio<1.555){ratioType=tabletRatio;}}
SCOPE.adRatioType=ratioType;SCOPE.adWidth=elWidth;SCOPE.adHeight=elHeight;setCreative(orientation);SCOPE.ivcResizeFunctions.forEach(function(f){f.call();});elementsToFit.forEach(function(item){if(item.className){ivcLog("unclassing: ",item.className);item.element.removeClass(item.className);item.className=null;}})};function setCreative(orientation){holders.forEach(function(holder){setHolders(holder,orientation);});setAttributesToIroll();}
function setHolders(holder,orientation){var holderScale=1;var creativeWidth;var creativeHeight;var toScaleHor;var toScaleVer;var toScaleContent;var containRatio=5.46875/16;adRatio=generalSettings.adRatio;if(holder.params.tablet&&SCOPE.adRatioType==tabletRatio&&holder.params.typePort!=="bg-top"&&holder.params.typePort!=="bg-bottom"&&!isDesktop){adRatio=tabletRatio;containRatio=1.15625/4;}
baseSizeSmall=baseSizeBig*1/adRatio;vidWidth=elWidth;vidHeight=(elWidth*1/videoRatio);if(orientation===IVA.Device.Orientation.PORTRAIT){if(spaceRatio<1/adRatio){toScaleHor=elWidth/(baseSizeBig);toScaleVer=elWidth/(baseSizeSmall);toScaleContent=toScaleVer;}else{toScaleHor=elWidth/(baseSizeBig);toScaleVer=elHeight/(baseSizeBig);if(spaceRatio>defaultRatio){vidHeight=elHeight;vidWidth=(elHeight*videoRatio);}
toScaleContent=((elHeight-vidHeight)/2)/(baseSizeBig*containRatio);}}else{if((spaceRatio>=1&&(spaceRatio<adRatio)||adRatio==tabletRatio)||(spaceRatio==adRatio&&spaceRatio<defaultRatio)){toScaleHor=elWidth/(baseSizeBig);toScaleVer=elHeight/(baseSizeBig);}else{vidHeight=elHeight;vidWidth=(elHeight*videoRatio);toScaleHor=elHeight/(baseSizeSmall);toScaleVer=elHeight/(baseSizeBig);}
toScaleContent=((elHeight-vidHeight)/2)/(baseSizeBig*containRatio);}
toScaleHor/=pixelRatio;toScaleVer/=pixelRatio;toScaleContent/=pixelRatio;var holderType=(isPortrait&&(!isDesktop||showPortraitOnDesktop))?holder.params.typePort:holder.params.typeLand;var overflow=(isPortrait&&(!isDesktop||showPortraitOnDesktop))?holder.params.overflowP:holder.params.overflowL;holder.params.anchor=(isPortrait&&(!isDesktop||showPortraitOnDesktop))?holder.params.anchorP:holder.params.anchorL;switch(holderType){case"fixed-preroll":creativeHeight=baseSizeSmall;creativeWidth=baseSizeBig;holderScale=toScaleHor;break;case"fixed-portrait":creativeHeight=baseSizeBig;creativeWidth=baseSizeSmall;holderScale=toScaleVer;break;case"full-width":creativeHeight=baseSizeBig;holderScale=toScaleVer;creativeWidth=elWidth/(holderScale*pixelRatio);break;case"full-ad":creativeWidth=(isPortrait)?baseSizeSmall:baseSizeBig;creativeHeight=creativeWidth*(elHeight/elWidth);holderScale=elWidth/(creativeWidth*pixelRatio);break;case"content-top":case"content-bottom":creativeHeight=baseSizeBig*containRatio;creativeWidth=baseSizeSmall;holderScale=toScaleContent;var push=holder.params.pushBg=((elHeight-vidHeight)/2)-(creativeHeight*holderScale*pixelRatio);if(adRatio==tabletRatio){if(holderType=="content-top")holder.params.pushBg=(holder.params.anchor.substr(0,1)=="T")?0:((holder.params.anchor.substr(0,1)=="M")?push/2:push);else holder.params.pushBg=(holder.params.anchor.substr(0,1)=="T")?push:((holder.params.anchor.substr(0,1)=="M")?push/2:0);}
break;case"bg-top":case"bg-bottom":creativeHeight=baseSizeBig*containRatio;holderScale=toScaleContent;creativeWidth=elWidth/(holderScale*pixelRatio);holder.params.pushBg=((elHeight-vidHeight)/2)-(creativeHeight*holderScale*pixelRatio);break;default:break;}
$(holder.div).attr('holder-type',holderType);$(holder.div).attr('holder-anchor',holder.params.anchor);$(holder.div).attr('resize-method',(holder.params.useScale?"scaling":"sizing"));var anchorToVid=(isPortrait)?false:(holder.params.anchorTo=="video");if(isDesktop){if(SCOPE.deviceMode===IVA.Device.Orientation.LANDSCAPE||!showPortraitOnDesktop){var totalHeight=(anchorToVid&&holder.params.typeLand.indexOf("fixed")>-1)?vidHeight:elHeight;if(holder.params.scaleToFit){if(creativeHeight*pixelRatio*holderScale+((bottomOffset+topOffset))>totalHeight){holderScale*=((totalHeight-((bottomOffset+topOffset)))/totalHeight)*vidHeight/(creativeHeight*pixelRatio*holderScale);}}
var maxWidth=holder.params.fullscreen?9999:holder.params.maxWidth;var maxHeight=holder.params.fullscreen?9999:holder.params.maxHeight;if(shouldScale(creativeWidth*pixelRatio*holderScale,maxWidth)){holderScale*=((maxWidth)/(creativeWidth*pixelRatio*holderScale));ivcLog("reached max width: "+maxWidth);}
if(shouldScale(creativeHeight*pixelRatio*holderScale,maxHeight)){holderScale*=((maxHeight)/(creativeHeight*pixelRatio*holderScale));ivcLog("reached max height: "+maxHeight);}}}
var resizeFactor=holder.params.resizeFactor=(holder.params.useScale)?1:holderScale;holder.params.scale=holderScale=(holder.params.useScale)?holderScale+0.001:1;holder.div[0].style.cssText+="width:"+creativeWidth*pixelRatio*resizeFactor+"px !important;";holder.div[0].style.cssText+="height:"+creativeHeight*pixelRatio*resizeFactor+"px !important;";holder.div[0].style.cssText+="overflow:"+overflow+" !important;";holder.div[0].style.cssText+="pointer-events: none !important;";holder.div[0].style.cssText+="font-size:"+(holder.params.fontSize)*resizeFactor+"px !important;";alignAndScale(holder,holderType,holderScale,anchorToVid,holder.params.scaleToFit);}
function alignAndScale(holder,holderType,toScale,anchorToVid,scaleToFit){var anchorArrV=["B","M","T"];var anchorArrH=["L","M","R"];var anchorIndexV=anchorArrV.indexOf(holder.params.anchor.substr(0,1));var anchorIndexH=anchorArrH.indexOf(holder.params.anchor.substr(1,1));var positionV=anchorIndexV*50;var positionH=anchorIndexH*50;var offsetArrB=[bottomOffset,bottomOffset/2,0];var offsetArrT=[0,topOffset/2,topOffset];var offsetAnchor=[1,0,-1];var offsetV=(typeof holder.params.pushBg!=='undefined'&&(isPortrait&&(!isDesktop||showPortraitOnDesktop)))?holder.params.pushBg:((isDesktop)?((scaleToFit)?(offsetArrB[anchorIndexV]-offsetArrT[anchorIndexV]):((bottomOffset!=0)?bottomOffset:-topOffset)):0);var offsetH=0;if(anchorToVid){offsetV+=((elHeight-vidHeight)/2)*offsetAnchor[anchorIndexV];offsetH+=((elWidth-vidWidth)/2)*offsetAnchor[anchorIndexH];}
var displayMode=(holderType=="none")?"none":"block";if(holderType.indexOf("top")>-1){positionV=100;offsetV*=-1;}else if(holderType.indexOf("bottom")>-1)positionV=0;holder.div[0].style.cssText+="display: "+displayMode+" !important;";holder.div[0].style.cssText+="position: absolute !important;";holder.div[0].style.cssText+="bottom: calc("+positionV+"% + "+offsetV+"px) !important;";holder.div[0].style.cssText+="left: calc("+positionH+"% + "+offsetH+"px) !important;";holder.div[0].style.cssText+="-webkit-transform: scale("+toScale+") "+"translate(-"+positionH+"%, "+positionV+"%) !important;";holder.div[0].style.cssText+="-webkit-transform-origin: 0% 100% !important;";holder.div[0].style.cssText+="-moz-transform: scale("+toScale+") "+"translate(-"+positionH+"%, "+positionV+"%) !important;";holder.div[0].style.cssText+="-moz-transform-origin: 0% 100% !important;";holder.div[0].style.cssText+="-o-transform: scale("+toScale+") "+"translate(-"+positionH+"%, "+positionV+"%) !important;";holder.div[0].style.cssText+="-o-transform-origin: 0% 100% !important;";holder.div[0].style.cssText+="-ms-transform: scale("+toScale+") "+"translate(-"+positionH+"%, "+positionV+"%) !important;";holder.div[0].style.cssText+="-ms-transform-origin: 0% 100% !important;";holder.div[0].style.cssText+="transform: scale("+toScale+") "+"translate(-"+positionH+"%, "+positionV+"%) !important;";holder.div[0].style.cssText+="transform-origin: 0% 100% !important;";}
function shouldScale(currentSize,maxSize){return(Math.min(currentSize,maxSize)==maxSize);}
function setAttributesToIroll(){getIrollEl().attr('aspect-ratio',(SCOPE.adRatioType==defaultRatio?"16x9":"4x3"));if(!orientationSet){orientationSet=true;getIrollEl().attr('orientation',(elWidth>elHeight?"Landscape":"Portrait"));}}
function getIrollEl(){if(!irollEl){var docOwner=element[0].ownerDocument;irollEl=docOwner.getElementById("iv-iroll");}
return $(irollEl);}
function setPlayBtnHolder(){var playBtnHolder=$(".iv-elem-cont",getIrollEl());if(!playBtnHolder[0])return;SCOPE.ivcAddResizeHolder(playBtnHolder,portrait.FIXED_ON_PREROLL,landscape.FIXED_ON_PREROLL,{anchor:"MM",fullscreen:true,zIndex:9999});$(playBtnHolder)[0].style.cssText+="top: auto !important";$(playBtnHolder)[0].style.cssText+="cursor: pointer";}
SCOPE.getHolderData=function(holder){var scale,resizeFactor;holders.forEach(function(_holder){if(_holder.div==holder){scale=_holder.params.scale;resizeFactor=_holder.params.resizeFactor;}});return{scale:(scale!=1)?parseFloat(scale).toFixed(6):1,resize:resizeFactor};};SCOPE.getHolderScale=function(holder){return SCOPE.getHolderData(holder).scale;}}})(IVC||(IVC={}));
var IVC;(function(SCOPE){SCOPE.startIVCTimeline=function(context,useFrames,fps){ivcLog("ivcTimeline version: 1.0.1");SCOPE.ivcTimeline={useFrames:useFrames==undefined?false:useFrames,fps:fps==undefined?29.97:fps,steps:[],add:function(at,callback){if(SCOPE.ivcTimeline.useFrames){var atArr=at.toString().split(".");if(atArr[1]){atArr[1]=(parseInt(atArr[1])/(SCOPE.ivcTimeline.fps*Math.pow(10,atArr[1].length-2)));at=parseInt(atArr[0])+atArr[1];}}
SCOPE.ivcTimeline.steps.push({at:at,callback:callback,done:false});SCOPE.ivcTimeline.steps=_.sortBy(SCOPE.ivcTimeline.steps,"at");}};function loop(){SCOPE.ivcTimeline.steps.forEach(function(item){if(!item.done&&context.getVideo().getCurrentTime()>=item.at){item.callback.call(undefined,context.getVideo().getCurrentTime());item.done=true;}});window.requestAnimationFrame(loop);}
window.requestAnimationFrame(loop);}})(IVC||(IVC={}));
var IVC;(function(SCOPE){var polyfillVersion="1.0.0";var shouldUsePolyfills=typeof SCOPE.shouldUsePolyfills==='undefined'?true:SCOPE.shouldUsePolyfills;if(!shouldUsePolyfills)return;else ivcLog("ivcPolyfill version: "+polyfillVersion);function PointerEventsPolyfill(options){this.options={mouseEvents:['click','dblclick','mousedown','mouseup','interact'],usePolyfillIf:function(){if(navigator.appName=='Microsoft Internet Explorer')
{var agent=navigator.userAgent;if(agent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/)!=null){var version=parseFloat(RegExp.$1);if(version<11)
return true;}}
return false;}};if(options){var obj=this;$.each(options,function(k,v){obj.options[k]=v;});}
if(this.options.usePolyfillIf())
this.register_mouse_events();}
PointerEventsPolyfill.initialize=function(options){if(PointerEventsPolyfill.singleton==null)
PointerEventsPolyfill.singleton=new PointerEventsPolyfill(options);return PointerEventsPolyfill.singleton;};PointerEventsPolyfill.prototype.register_mouse_events=function(){this.options.mouseEvents.forEach(function(mouseEvent){document.addEventListener(mouseEvent,function(e){var clickedEl=$(e.target);if(clickedEl.css('pointer-events')=='none'){e.stopImmediatePropagation();e.preventDefault();var origDisplayAttribute=clickedEl.css('display');clickedEl.css('display','none');var underneathElem=document.elementFromPoint(e.pageX,e.pageY);if(origDisplayAttribute)clickedEl.css('display',origDisplayAttribute);else clickedEl.css('display','');$(underneathElem).trigger(e.type);}
return true;},true);})};PointerEventsPolyfill.initialize();})(IVC||(IVC={}));
var IVC;(function(SCOPE){var ivcLoadManagerVersion="1.2.10";ivcLog("ivcLoadManager version: "+ivcLoadManagerVersion);var that=this;var done=[];var dd_forcePreloder=false,_forcePreloder=false;var beforVideoSlateIsOpen=false;var preloaderSpinnerIsShown;var numOfDDs=0;var doneLoading=[];SCOPE.initLoadManager=function(context,forcePreloder,ddType,customBeforeVideoSlate,ddTimeout,loadWhileOnMobileToo){var prerollNotStarted=function(){return beforVideoSlateIsOpen;}
_forcePreloder=forcePreloder===undefined?false:forcePreloder;dd_forcePreloder=!_forcePreloder;if(ddType){if(!Array.isArray(ddType))ddType=[ddType];ddType.forEach(function(item){if(!DD.hasOwnProperty(item)){throw new Error("DD type not supported! Currently only DD.C4/DD.DATE/DD.GEO/DD.TVNZ are supported");}});_forcePreloder=true;numOfDDs=ddType.length;}
loadWhileOnMobileToo=loadWhileOnMobileToo===undefined?false:loadWhileOnMobileToo;SCOPE.preloadNow=function(whatAssets,whatCallback){if(whatCallback==undefined)whatCallback=function(){};var nonPackagedAssets=0;whatAssets.forEach(function(item){if(item.indexOf("http://")>-1||item.indexOf("https://")>-1){nonPackagedAssets++;}});if(whatAssets.length==0){whatCallback.call();return;}
if(nonPackagedAssets>0&&nonPackagedAssets<whatAssets.length)throw new Error("Can't preload packaged and non-packaged items in a single call");if(nonPackagedAssets==0){context.getIroll().preloadAssets(whatAssets,function(failedAssets){if(!_.isEmpty(failedAssets)){ivcLog("assets: "+failedAssets.toString()+" failed to load");}
whatCallback.call();});}else{var nonPackagedCompleted=0;whatAssets.forEach(function(item){var dumIMG=new Image();dumIMG.onload=function(){nonPackagedCompleted++;if(nonPackagedCompleted==whatAssets.length)whatCallback.call();};dumIMG.onerror=function(){ivcLog(item+" failed to load");nonPackagedCompleted++;if(nonPackagedCompleted==whatAssets.length)whatCallback.call();};ivcLog("trying to load: ",item);dumIMG.src=item;})}}
SCOPE.closeForcedPreloader=function(){_forcePreloder=false;}
var loadManagerOrder=context.getConfig().section("loadManager");var beforePrerollAssets=loadManagerOrder.array("beforePreroll");var beforeOverlayAssets=loadManagerOrder.array("beforeOverlay");var whilePrerollAssets=loadManagerOrder.array("whilePreroll");var beforeSlateAssets=loadManagerOrder.array("beforeSlate");var beforeVideoSlateStart,overlayStart,slateStart;var beforePrerollDone=false,overlayDone=false,slateDone=false;var beforeEL,beforePlayButton,preloaderHolder,preloader;var beforeVideoSlate=customBeforeVideoSlate?customBeforeVideoSlate.component:IVA.createSlate({render:function(){return $('<div/>');},open:function(){},close:function(){}});var preloaderAndPlayButtonOverlay=IVA.createOverlay({render:function(){beforeEL=$('<div/>').css({"position":"absolute","width":"100%","height":"100%"})
beforePlayButton=$('<div id="ivc-interact-to-start-layer"/>').on('interact-to-play',function(){closeBeforeVideoComponent();});beforePlayButton[0].style.cssText="width:100%; height:100%; position:absolute; cursor:pointer; pointer-events:auto !important;"+"background:url(https://s-files.innovid.com/creative/ct_dev/play_btn.png) no-repeat center center;"+"background-color: black";preloaderHolder=$('<div/>').css({"position":"absolute","width":"100%","height":"100%","background-color":"black","top":"0px","cursor":"auto","pointer-events":"auto"});preloader=$('<div id="ivc-preloader"/>').append($('<div id="ivc-spinner"/>'));preloaderSpinnerIsShown=true;return beforeEL.append(beforePlayButton).append(preloaderHolder.append(preloader));},show:function(){if(prerollNotStarted()){SCOPE.preloadNow(beforePrerollAssets,function(){done=done.concat(beforePrerollAssets);beforePrerollDone=true;if(window.location.href.indexOf("its=true")==-1&&!_forcePreloder){closeBeforeVideoComponent();}});}
beforeEL.parent().css("z-index","10000");beforeEL.show();},hide:function(){preloaderSpinnerIsShown=false;beforeEL.parent().css("z-index","-10000");beforeEL.hide();}});if(beforePrerollAssets.length>0||window.location.href.indexOf("its=true")>-1||customBeforeVideoSlate||_forcePreloder){context.getIroll().getProgram().beforeVideo().open(beforeVideoSlate);beforVideoSlateIsOpen=true;context.getIroll().getProgram().now().show(preloaderAndPlayButtonOverlay);}else{startLoadingOnVideo();}
function closeBeforeVideoComponent(){startLoadingOnVideo();if(customBeforeVideoSlate){if(beforeVideoSlateStart==undefined)return;context.getIroll().getProgram().now().hide(preloaderAndPlayButtonOverlay);if(beforeVideoSlateStart)beforeVideoSlateStart.call();}else{context.getIroll().getProgram().now().close(beforeVideoSlate);beforVideoSlateIsOpen=false;context.getIroll().getProgram().now().hide(preloaderAndPlayButtonOverlay);}}
function startLoadingOnVideo(){SCOPE.preloadNow(beforeOverlayAssets,function(){done=done.concat(beforeOverlayAssets);})}
SCOPE.whenOverlayIsReady=function(callback){if(overlayDone){callback.call();return;}
if(beforeOverlayAssets.length==0){callback.call();startLoadingForSlate();}else{overlayStart=callback;}}
function startLoadingForSlate(){if(context.getDevice().getPlatformType()!=IVA.Device.PlatformType.DESKTOP&&!loadWhileOnMobileToo)return;SCOPE.preloadNow(whilePrerollAssets,function(){done=done.concat(whilePrerollAssets);whilePrerollAssets=[];})}
SCOPE.whenSlateIsReady=function(callback){if(slateDone||beforeSlateAssets.length==0||prerollNotStarted()){if(preloaderSpinnerIsShown&&prerollNotStarted()){beforeVideoSlateStart=callback;}else{callback.call();}}else{context.getIroll().getProgram().now().show(preloaderAndPlayButtonOverlay);beforePlayButton.hide();preloaderHolder.show();preloaderSpinnerIsShown=true;preloaderHolder.css("background-color","");preloader.css("opacity","1");ivcLog("preloading slate assets");slateStart=callback;SCOPE.preloadNow(beforeSlateAssets,function(){done=done.concat(beforeSlateAssets);});}}
checkAssetsLoadDone=function(){if(_.difference(beforeOverlayAssets,done).length===0&&overlayStart&&!overlayDone){overlayStart.call();overlayStart=null;overlayDone=true;startLoadingForSlate();};if(_.difference(beforeSlateAssets,done).length===0&&slateStart&&!slateDone&&!prerollNotStarted()){slateStart.call();slateStart=null;slateDone=true;context.getIroll().getProgram().now().hide(preloaderAndPlayButtonOverlay);ivcLog("done preloading slate assets");};if(prerollNotStarted()){if(beforePrerollDone&&!_forcePreloder&&preloaderSpinnerIsShown){preloaderHolder.hide();preloaderSpinnerIsShown=false;if(window.location.href.indexOf("its=true")==-1){closeBeforeVideoComponent();}}}
requestAnimationFrame(checkAssetsLoadDone);};if(ddType){ddType.forEach(function(item){ivcInitDDM(context,item,ddTimeout||5);})}
requestAnimationFrame(checkAssetsLoadDone);}
window.DD={GEO:"GEO",C4:"C4",DATE:"DATE",TVNZ:"TVNZ",VERSION:"VERSION"};var ivcInitDDM=function(context,type,timeout){var audioURL,myTimeout,gotNameAudio,mockData={C4:undefined,DATE:undefined,GEO:undefined,STORE:undefined,TVNZ:undefined},timedOut=false;var promptMessage={C4:"Channel 4 personalized unit\nTEST MODE - enter a name\nLIVE MODE - click Cancel",DATE:"Dynamic date unit\nTEST MODE - enter a date: MM/DD/YY\nLIVE MODE - click Cancel",GEO:"Dynamic GEO unit\nTEST MODE - enter city name / 5 digit zipcode(US) / postcode(UK) / 3 digit DMA\nLIVE MODE - click Cancel\nFALLBACK - Leave empty and click 'OK'",TVNZ:"TVNZ Personalized unit\nTEST MODE - enter a name\nFallback - click Cancel"};var dynamicFuncs={C4:channel4Personalization,DATE:generateDynamicDate,GEO:generateGeoLocation,TVNZ:tvnzPersonalizaqtion};var that=this;timeout=timeout*1000;if(window.ivcDevMode){if(context.getStudioPropertiesConfig("DD Prompt")&&context.getStudioPropertiesConfig("DD Prompt")=="true"){mockData[type]=prompt(promptMessage[type]);checkMockData();}
else if(!context.getStudioPropertiesConfig("DD Prompt"))throw new Error('\n"DD Prompt" Studio Property is missing!\nPlease add it in the config.json:\n'+'{\n'+'   "DD Prompt": "true",\n'+'   "hsp - type": "dropdown",\n'+'   "hsp - values": ["true", "false"]\n'+'}\nYou can set it to "false" while developing, but make sure to set "true" before packaging.\n')}
function checkMockData(){switch(type){case DD.DATE:if(mockData.DATE){var tmp=(mockData.DATE).split("/");if(tmp[2].length<4){tmp[2]="20"+tmp[2];}
mockData.DATE=(tmp).join("/");}
if(mockData.DATE&&new Date(mockData.DATE)=="Invalid Date"){mockData.DATE=prompt("Date format is wrong!\nUse MM/DD/YY HH/MM(optional)\nor click Cancel for the live version:");checkMockData();}
break;}}
dynamicFuncs[type]();function channel4Personalization(){DD.C4={get name(){return timedOut?"ERROR":(capitalize(mockData.C4)||capitalize(context.__contextImpl.iroll.get('name'))||capitalize(context.__contextImpl.iroll.get("first_name"))||"ERROR");},set name(n){return ivcLog("Setting name is not possible in the current context");},get audioPath(){return timedOut?"ERROR":(audioURL||"ERROR");},set audioPath(a){return ivcLog("Setting audio path is not possible in the current context");},get gotNameAudio(){return(gotNameAudio!=undefined)?gotNameAudio:false;},set gotNameAudio(a){return ivcLog("Setting audio path is not possible in the current context");}}
getAudioFile(DD.C4.name);}
function getAudioFile(name){ivcLog("///////////getAudioFile////////////////");var audioPath=context.getStudioPropertiesConfig("Audio Folder Path");if(audioPath&&audioPath!==""){var tryAudioURL=audioPath+(audioPath.slice(audioPath.length-2,audioPath.length-1)=="/"?"":"/")+name+".mp3";$.ajax({url:tryAudioURL,success:function(){audioURL=tryAudioURL;if(name!="fallback")gotNameAudio=true;doneLoadingDynamicData();},error:function(e){gotNameAudio=false;if(name!=="fallback"){getAudioFile("fallback");}else{audioURL="ERROR";doneLoadingDynamicData();}}});}else{ivcLog("If this is an audio personalized unit, please add the 'Audio Folder Path' Studio Property");doneLoadingDynamicData();}}
function capitalize(whatString){if(whatString){return whatString.toLowerCase().replace(/\b\w/g,function(m){return m.toUpperCase();});}else{return whatString;}};function generateDynamicDate(){Object.defineProperty(DD,'DATE',{get:function(){return(mockData.DATE&&(new Date(mockData.DATE)!="Invalid Date"))?new Date(mockData.DATE):new Date();},set:function(n){return ivcLog("Setting date is not possible in the current context");}});doneLoadingDynamicData();}
function generateGeoLocation(){if(!window.ivcDevMode){myTimeout=setTimeout(function(){timedOut=true;doneLoadingDynamicData();},timeout);}
var enteredDMA,tmpZip;$.ajax({url:"https://service.innovid.com/jsonpWrapper/?service=geo&callback=?",success:function(data){var geoData=geoFromXML(data);if(mockData.GEO==null){mockData.GEO=geoData;doneLoadingDynamicData();}else{mockData.GEO=mockData.GEO.trim();if(mockData.GEO==""||mockData.GEO==" "||(!isNaN(mockData.GEO)&&(mockData.GEO.length<3||mockData.GEO.length>5||mockData.GEO.length==4)&&geoData.country_code=="US")){if(window.ivcDevMode)alert("the zipcode you provided is not valid or the field is empty, you will see fallback version");mockData.GEO="ERROR";doneLoadingDynamicData();return;}
var list;if(mockData.GEO.length==3&&!isNaN(mockData.GEO)&&geoData.country_code=="US"){list="https://s-files.innovid.com/creative/ct_dev/dma2zip.json";enteredDMA=mockData.GEO;}else{list="https://s-files.innovid.com/creative/ct_dev/zip2dma.json";tmpZip=mockData.GEO;if(context.getStudioPropertiesConfig("country")){mockData.GEO=mockData.GEO+" ,"+(context.getStudioPropertiesConfig("country")=="Other"?context.getConfig().value('other-country'):context.getStudioPropertiesConfig("country"));}else if(_.contains(["US","UK","AU"],geoData.country_code)){mockData.GEO=mockData.GEO+" ,"+geoData.country_code;}else{mockData.GEO=mockData.GEO+" ,US";}}
$.ajax({url:list,dataType:"json",success:function(data){list=data;if(enteredDMA){mockData.GEO=list[mockData.GEO];}
var firstGoogleCall=true;callGoogle();function callGoogle(){ivcLog("Calling Google");$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json",dataType:"json",data:{key:googleMapsKey,address:mockData.GEO},success:function(data){if(data.status=="ZERO_RESULTS"){if(window.ivcDevMode)alert("Could not generate dynamic data, you will see fallback version");mockData.GEO="ERROR";doneLoadingDynamicData();return;}
if(firstGoogleCall){firstGoogleCall=false;mockData.GEO=data.results[0].geometry.location.lat+","+data.results[0].geometry.location.lng;callGoogle();return;}else{mockData.GEO={};mockData.GEO.lat=data.results[0].geometry.location.lat;mockData.GEO.long=data.results[0].geometry.location.lng;var address=data.results[0].address_components;address.forEach(function(obj){try{if(obj.types[0]=="locality"&&obj.types[1]=="political"){mockData.GEO.city=obj.long_name;}}catch(err){}
try{var zipcodeRg=new RegExp('^\\d{5}(-\\d{4})?$');var postcode=new RegExp('^(GIR[ ]?0AA|((AB|AL|B|BA|BB|BD|BH|BL|BN|BR|BS|BT|CA|CB|CF|CH|CM|CO|CR|CT|CV|CW|DA|DD|DE|DG|DH|DL|DN|DT|DY|E|EC|EH|EN|EX|FK|FY|G|GL|GY|GU|HA|HD|HG|HP|HR|HS|HU|HX|IG|IM|IP|IV|JE|KA|KT|KW|KY|L|LA|LD|LE|LL|LN|LS|LU|M|ME|MK|ML|N|NE|NG|NN|NP|NR|NW|OL|OX|PA|PE|PH|PL|PO|PR|RG|RH|RM|S|SA|SE|SG|SK|SL|SM|SN|SO|SP|SR|SS|ST|SW|SY|TA|TD|TF|TN|TQ|TR|TS|TW|UB|W|WA|WC|WD|WF|WN|WR|WS|WV|YO|ZE)(\\d[\\dA-Z]?[ ]?\\d[ABD-HJLN-UW-Z]{2}))|BFPO[ ]?\\d{1,4})$');if(obj.types[0]=="postal_code"){if(zipcodeRg.test(tmpZip)||postcode.test(tmpZip)){mockData.GEO.zip=tmpZip;}else{mockData.GEO.zip=obj.long_name;}}}catch(err){}
try{if(obj.types[0]=="administrative_area_level_1"&&obj.types[1]=="political"){mockData.GEO.region=obj.short_name;}}catch(err){}});mockData.GEO.dma_code=enteredDMA?enteredDMA:list[mockData.GEO.zip];doneLoadingDynamicData();}},error:function(data){if(window.ivcDevMode)alert("Could not generate dynamic data, you will see fallback version");mockData.GEO="ERROR";doneLoadingDynamicData();}})}}});}},error:function(data){mockData.GEO="ERROR";doneLoadingDynamicData();}})
Object.defineProperty(DD,'GEO',{get:function(){return mockData.GEO;},set:function(n){return ivcLog("Setting geo is not possible in the current context");}});}
function tvnzPersonalizaqtion(){myTimeout=setTimeout(function(){timedOut=true;doneLoadingDynamicData();},timeout);DD.TVNZ={get name(){return timedOut?"ERROR":(validate(mockData.TVNZ));},set name(n){return ivcLog("Setting name is not possible in the current context");}}
if(mockData.TVNZ==undefined){addPostMgsForName();window.addEventListener('message',gotMessage);}else{doneLoadingDynamicData();}}
function addPostMgsForName(){try{window.parent.parent.postMessage({namespace:'tvnz.play',type:'getSession'},'*');}catch(e)
{mockData.TVNZ="ERROR";doneLoadingDynamicData();}}
function gotMessage(event){var responseData=event.data;if(responseData.namespace!=='tvnz.play'){return;}
switch(responseData.type){case'session':var consumer=responseData.data.consumer;var name=consumer.anonymous?'n/a':consumer.firstName;window.removeEventListener('message',gotMessage);mockData.TVNZ=name;doneLoadingDynamicData();break;}}
function validate(name){if(name.toLowerCase()=="n/a"||name==undefined||name=="na"||name==null){return"ERROR";}else{return capitalize(name);}}
function doneLoadingDynamicData(){if(doneLoading.indexOf(type)>-1)return;doneLoading.push(type);if(type=="GEO"){if(myTimeout){clearTimeout(myTimeout);}
if(SCOPE.onGeoData)SCOPE.onGeoData.call();}else if(type=="C4"){if(DD.C4.name!="ERROR"){declareDynamicVersion(DD.C4.name);}else{declareDynamicVersion("Generic");}}else if(type=="DATE"){declareDynamicVersion((DD.DATE.getMonth()+1)+"_"+DD.DATE.getDate()+"_"+DD.DATE.getFullYear());}else if(type=="TVNZ"){if(DD.TVNZ.name!="ERROR"){declareDynamicVersion(DD.TVNZ.name);}else{declareDynamicVersion("Generic");}}
if(doneLoading.length<numOfDDs)return;ivcLog("doneLoadingDynamicData");if(dd_forcePreloder)_forcePreloder=false;}
function declareDynamicVersion(version){if(DD.VERSION=="VERSION"){DD.VERSION=version;}else{DD.VERSION+=(";"+version);}}};function geoFromXML(whatString){var geo={};var geoParams=["ip","continent_code","country_code","country_name","region_name","region","city","dma_code","area_code","lat","long","zip"];geoParams.forEach(function(prop){geo[prop]=(whatString.split("<"+prop+">")[1]).split("</"+prop+">")[0];});return geo;}
var googleMapsKey="AIzaSyCfewGiLBsHIKg73RTTBmakABf3WZfA8dA";})(IVC||(IVC={}));
var IVC;(function(SCOPE){SCOPE.BugOverlay=function(context,slate){var el,overlayCreative,iroll=context.getIroll(),program=iroll.getProgram(),config=context.getConfig(),preroll=context.getVideo(),that=this;var tweenSpeed=1,OverlayContent1,LOGO,widget,OverlayBackground1,OverlayContent2,HEADLINE,IFE1,CTA,Now,Destinations,box,OverlayBackground2,text,FINAL_ART_040918;var enterAnimation=new TimelineMax().pause();that.component=IVA.createOverlay({render:function(){el=$("<div id='ivc-overlay'/>");overlayCreative=$('<div id="ivc-overlay-creative"/>').hide();el.append(overlayCreative);ivcLog('BugOverlay built with PIE 0.9.81')
OverlayContent1=$('<div id="ivc_OverlayContent1"></div>');enterAnimation.from(OverlayContent1,0.85/tweenSpeed,{autoAlpha:0},1);overlayCreative.append(OverlayContent1);SCOPE.ivcAddResizeHolder(OverlayContent1,portrait.CONTENT_TOP,landscape.FIXED_ON_PREROLL,{anchorP:"MM",anchorL:"BL",zIndex:200,fullscreen:false});LOGO=$('<div id="ivc_LOGO"></div>');enterAnimation.from(LOGO,0.85/tweenSpeed,{autoAlpha:0},2);OverlayContent1.append(LOGO);widget=$('<div id="ivc_widget"></div>');enterAnimation.from(widget,0.85/tweenSpeed,{autoAlpha:0},2);OverlayContent1.append(widget);OverlayBackground1=$('<div id="ivc_OverlayBackground1"></div>');overlayCreative.append(OverlayBackground1);SCOPE.ivcAddResizeHolder(OverlayBackground1,portrait.BACKGROUND_TOP,landscape.INVISIBLE,{anchor:"MM",zIndex:199,fullscreen:false});OverlayContent2=$('<div id="ivc_OverlayContent2"></div>');enterAnimation.from(OverlayContent2,0.85/tweenSpeed,{autoAlpha:0},1);overlayCreative.append(OverlayContent2);SCOPE.ivcAddResizeHolder(OverlayContent2,portrait.CONTENT_BOTTOM,landscape.FIXED_ON_PREROLL,{anchorP:"MM",anchorL:"BL",zIndex:198,fullscreen:false});HEADLINE=$('<div id="ivc_HEADLINE"></div>');enterAnimation.from(HEADLINE,0.85/tweenSpeed,{autoAlpha:0},2);OverlayContent2.append(HEADLINE);IFE1=$('<div id="ivc_IFE1"></div>');HEADLINE.append(IFE1);CTA=$('<div id="ivc_CTA"></div>');if(context.getDevice().getPlatformType()==IVA.Device.PlatformType.DESKTOP){CTA.on('mouseover',function(e){TweenMax.to(CTA,0.2,{css:{filter:'brightness(1.2)',webkitFilter:'brightness(1.2)'}})}).on('mouseout',function(e){TweenMax.to(CTA,0.2,{css:{filter:'brightness(1)',webkitFilter:'brightness(1)'}})});}
OverlayContent2.append(CTA);Now=$('<div id="ivc_Now"></div>');Now.on('interact',function(e){e.stopPropagation();iroll.openURL('Explore_Now');});if(context.getStudioPropertiesConfig('Version')=='version1')CTA.append(Now);Destinations=$('<div id="ivc_Destinations"></div>');Destinations.on('interact',function(e){e.stopPropagation();iroll.openURL('Explore_Destinations');});if(context.getStudioPropertiesConfig('Version')=='version2')CTA.append(Destinations);box=$('<div id="ivc_box"></div>');CTA.append(box);OverlayBackground2=$('<div id="ivc_OverlayBackground2"></div>');overlayCreative.append(OverlayBackground2);SCOPE.ivcAddResizeHolder(OverlayBackground2,portrait.BACKGROUND_BOTTOM,landscape.INVISIBLE,{anchor:"MM",zIndex:197,fullscreen:false});text=$('<div id="ivc_text"></div>');HEADLINE.append(text);FINAL_ART_040918=$('<div id="ivc_FINAL_ART_040918"></div>');OverlayContent2.append(FINAL_ART_040918);overlayCreative.on("interact",function(){if(context.getStudioPropertiesConfig('Version')=='version1'){iroll.openURL('Explore_Now');}else if(context.getStudioPropertiesConfig('Version')=='version2'){iroll.openURL('Explore_Destinations');}});return el;},show:function(){SCOPE.whenOverlayIsReady(function(){setTimeout(function(){enterAnimation.play()},1);overlayCreative.show();});},hide:function(){overlayCreative.hide();}});};})(IVC||(IVC={}));
var IVC;(function(SCOPE){SCOPE.Slate=function(context){var el,slateCreative,iroll=context.getIroll(),program=iroll.getProgram(),config=context.getConfig(),preroll=context.getVideo(),that=this;var enterAnimation=new TimelineMax().pause();that.component=IVA.createSlate({render:function(){el=$("<div id='ivc-slate'/>");slateCreative=$('<div id="ivc-slate-creative"/>').hide();el.append(slateCreative);ivcLog('Slate built with PIE 0.9.81')
return el;},open:function(){SCOPE.whenSlateIsReady(function(){setTimeout(function(){enterAnimation.play()},1);slateCreative.show();});el.show();},close:function(){el.hide();}});};})(IVC||(IVC={}));
var IVC;(function(SCOPE){"use strict";var bugSlateAd=function(context){ivcLog("BugSlate template version: 1.1.0");var iroll=context.getIroll();var desktopOnly=context.getConfig().value('desktopOnly');if(typeof desktopOnly==='undefined')throw"You are using an old version of config.json. Please update.";else if(desktopOnly&&context.getDevice().getPlatformType()!==IVA.Device.PlatformType.DESKTOP){iroll.start();ivcLog("***desktop only unit***");return;}
SCOPE.postEnabled=false;SCOPE.enablePostContent=function(){if(!SCOPE.postEnabled){SCOPE.postEnabled=true;ivcLog("post content enabled");context.getIroll().getProgram().afterVideo().open(slate.component);}};var slate=new SCOPE.Slate(context),bug=new SCOPE.BugOverlay(context,slate);SCOPE.bug=bug;iroll.injectCSS("main.css");var bottomOffset=parseInt(context.getStudioPropertiesConfig("Bottom Extra Clearance"))||0;SCOPE.startIVCResize(context,1280,720,bottomOffset,0,false);SCOPE.startIVCTimeline(context);SCOPE.initCustomTracking(context);SCOPE.initLoadManager(context);iroll.getProgram().after(0).show(bug.component);iroll.start();};IVA.registerCreative(bugSlateAd);})(IVC||(IVC={}));
var VPAIDAd=function(){this.irollAd=null;this.width=0;this.height=0;this.initialWidth=0;this.initialHeight=0;this.slot=null;this.videoSlot=null;this.videoSlotCanAutoPlay=false;this.callbacks={};this.adDuration=-2;this.adRemainingTime=-2;this.adExpanded=false;this.AD_STOP_DELAY_TIME_MS=200;this._stopped=false;this._volume=-1;this.loggedEvents=[];this.adStoppableState=false;this._verificationBlockingHandler=null;this._adCompletionHandler=null;this.viewMode="";this._actionsHandler=null;};VPAIDAd.prototype.initAd=function(width,height,viewMode,desiredBitrate,creativeData,environmentVars){var that=this,initAdStartTime=new Date().getTime(),doneWaitingForBlockingDecisionOrTimeout=false;this.initialWidth=this.width=this._dimToNum(width);this.initialHeight=this.height=this._dimToNum(height);this.viewMode=viewMode;this.irollAd=this._createIrollAd();this._prepareEnvironmentVars(environmentVars);this._adCompletionHandler=new IV.VpaidAdCompletionHandler(this.irollAd.report);this._verificationBlockingHandler=new IV.VerificationNonBlockingHandler();this._actionsHandler=new IV.ActionsHandler();var fireAdLoadedOnce=_.once(function(){var totalInitAdTime=new Date().getTime()-initAdStartTime;that.irollAd.report.reportLog({event_id:"vpaid-init-ad-total-time",event_value:totalInitAdTime.toString()});setTimeout(function(){that._fire("AdLoaded");},0);});this._prepareVideoPlayer(this.videoSlot);this._prepareCreativeData(creativeData,this.slot,this.videoSlot);IV.Events.on(this.irollAd.get("id")+":core_initialized",function(){if(doneWaitingForBlockingDecisionOrTimeout){fireAdLoadedOnce();}});IV.vpaidExtensions.execute(IV.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD,this);setTimeout(function(){that.irollAd.trigger('init');that.irollAd.injectCSSToDoc();},0);this._verificationBlockingHandler.waitForBlockingDecisionOrTimeout(function(){doneWaitingForBlockingDecisionOrTimeout=true;if(that.irollAd.get('initialized')){fireAdLoadedOnce();}});};VPAIDAd.prototype.handshakeVersion=function(){return"2.0";};VPAIDAd.prototype.startAd=function(){var that=this;this.irollAd.report.reportLog({event_id:"vpaid-start-ad"});this._verificationBlockingHandler.notifyAdStarted();if(this._verificationBlockingHandler.shouldBlockAd()){this._fire("AdStarted");this.stopAd();}else{IV.vpaidExtensions.execute(IV.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_START,this);this._mapIRollEventsToVPAID();this._fire("AdStarted");this._actionsHandler.waitForActions("before_ad_start",function(){that.irollAd.trigger('start');});}};VPAIDAd.prototype.stopAd=function(){var that=this;this._cleanAdResources(function(){that._fire("AdStopped");});};VPAIDAd.prototype.resizeAd=function(width,height,viewMode){this.width=this._dimToNum(width);this.height=this._dimToNum(height);this.viewMode=viewMode;if(!!this.slot){this._fixAdSlotDimensions(this.slot,this.height,this.width);}
IV.Events.trigger("winResize");this._fire("AdSizeChange");};VPAIDAd.prototype.pauseAd=function(){this.irollAd.get('videoPlayer').pause();this._fire("AdPaused");};VPAIDAd.prototype.resumeAd=function(){if(!this.adExpanded){this.irollAd.get('videoPlayer').play();}
this._fire("AdPlaying");};VPAIDAd.prototype.expandAd=function(){};VPAIDAd.prototype.collapseAd=function(){if(this.adExpanded){IV.Events.trigger("closeSlates");}};VPAIDAd.prototype.skipAd=function(){var that=this;this._cleanAdResources(function(){that._fire("AdSkipped");that._fire("AdStopped");});};VPAIDAd.prototype.subscribe=function(aCallback,eventName,aContext){this._subscribe(aCallback,eventName,aContext,false,"VPAID_Internal");};VPAIDAd.prototype.safeSubscribe=function(aCallback,eventName,aContext,moduleName){this._subscribe(aCallback,eventName,aContext,true,moduleName);};VPAIDAd.prototype.unsubscribe=function(aCallback,eventName){if(this.callbacks.hasOwnProperty(eventName)&&(typeof this.callbacks[eventName]!=="undefined")){this.callbacks[eventName]=_.filter(this.callbacks[eventName],function(cb){return cb.callback!==aCallback;});}};VPAIDAd.prototype.getAdExpanded=function(){return this.adExpanded;};VPAIDAd.prototype.getAdSize=function()
{return{"width":this.width,"height":this.height};};VPAIDAd.prototype.getAdSkippableState=function(){return true;};VPAIDAd.prototype.getAdWidth=function(){return this.width;};VPAIDAd.prototype.getAdHeight=function(){return this.height;};VPAIDAd.prototype.getAdCompanions=function(){return"";};VPAIDAd.prototype.getAdIcons=function(){return false;};VPAIDAd.prototype.getAdLinear=function(){return true;};VPAIDAd.prototype.setAdVolume=function(vol){if(vol!==this._volume){this.irollAd.get('videoPlayer').setVolume(vol);this._volume=vol;this._fire("AdVolumeChange");IV.Events.trigger("volumechange",vol);}};VPAIDAd.prototype.getAdVolume=function(){var vol=this.irollAd.get('videoPlayer').getVolume();if(vol===-1){vol=this._volume;}
return vol;};VPAIDAd.prototype.getAdDuration=function(){return this.adDuration;};VPAIDAd.prototype.getAdRemainingTime=function(){return this.adRemainingTime;};VPAIDAd.prototype.getAdStoppableState=function(){return this.adStoppableState;};VPAIDAd.prototype._subscribe=function(aCallback,eventName,aContext,handleErrors,moduleName){var fns=this.callbacks[eventName];if(!fns)
{fns=[];this.callbacks[eventName]=fns;}
fns.push({"callback":aCallback,"context":aContext,"handleErrors":handleErrors,"module":moduleName});};VPAIDAd.prototype._cleanAdResources=function(callback){var that=this;if(!this._stopped){setTimeout(function(){that.irollAd.cleanUp();callback();},this.AD_STOP_DELAY_TIME_MS);this._stopped=true;IV.vpaidExtensions.execute(IV.vpaidExtensions.EXTENSION_POINTS.CLEAN_UP,this);}};VPAIDAd.prototype._fire=function(eventName){var props=Array.prototype.slice.call(arguments,1);var that=this;IV.toolkit.debug("VPAID Event -",eventName,props);var callbacks=this.callbacks[eventName]||[];callbacks.forEach(function(cb){var scope=null;if(typeof cb.context!=='undefined'){scope=cb.context;}
if(cb.handleErrors)
{try{cb.callback.apply(scope,props);}
catch(e){IV.Events.trigger(that.irollAd.get("id")+":ad_interface_error",cb.module,e);}}
else
{cb.callback.apply(scope,props);}});this.loggedEvents.push(eventName);};VPAIDAd.prototype._prepareEnvironmentVars=function(environmentVars){if(typeof environmentVars!=='undefined'){if(environmentVars.hasOwnProperty('slot')){this.slot=environmentVars.slot;this._fixAdSlotDimensions(this.slot,this.initialHeight,this.initialWidth);}
if(environmentVars.hasOwnProperty('videoSlot')&&!this.irollAd.shouldForceInternalPlayer()){this.videoSlot=environmentVars.videoSlot;}
if(environmentVars.hasOwnProperty('videoSlotCanAutoPlay')){this.videoSlotCanAutoPlay=environmentVars.videoSlotCanAutoPlay;}}};VPAIDAd.prototype._createIrollAd=function(){return new IV.AppsCore({data:IV.baseData.app_data,config:IV.baseData.config_data,interface:this,delayAppVisibility:false,showClickToResume:true,BackButton:true,mainEngagementEvent:"click",checkForVisibility:false});};VPAIDAd.prototype._prepareVideoPlayer=function(videoSlot){if(videoSlot!==null){var elementWrapper=new IV.VideoElementWrapper(videoSlot);var videoPlayer=new IV.SharedVideoPlayer(elementWrapper);this.irollAd.setAttribute({"videoPlayer":videoPlayer});}else{this.irollAd.setAttribute({videoPlayer:new IV.InternalVideoPlayer(this.irollAd,this._volume)});}};VPAIDAd.prototype._prepareCreativeData=function(creativeData,adSlot,videoSlot){if(typeof creativeSettings!=='undefined'){this.irollAd.setAttribute(creativeSettings);}
if(typeof creativeData!=='undefined'){var creativeParams=this._parseCreativeParams(creativeData);this.irollAd.setAttribute(creativeParams);}
if(adSlot!==null){this.irollAd.setAttribute({"mainContainer":adSlot});}
if(videoSlot!==null){this.irollAd.setAttribute({"videoContainer":videoSlot});}};VPAIDAd.prototype._setAdDuration=function(duration)
{this.adDuration=duration;};VPAIDAd.prototype._setAdRemainingTime=function(time)
{this.adRemainingTime=time;};VPAIDAd.prototype._mapIRollEventsToVPAID=function(){var id=this.irollAd.get('id'),vpaidAd=this,irollAd=this.irollAd;IV.Events.on(id+':ad_started',function(){vpaidAd._fire('AdImpression');vpaidAd._fire('AdVideoStart');});IV.Events.on(id+':video_videoPassed25',function(){vpaidAd._fire('AdVideoFirstQuartile');});IV.Events.on(id+':video_videoPassed50',function(){vpaidAd._fire('AdVideoMidpoint');});IV.Events.on(id+':video_videoPassed75',function(){vpaidAd._fire('AdVideoThirdQuartile');});IV.Events.on(id+':video_timeupdate',function(){vpaidAd._setAdRemainingTime(irollAd.get('videoPlayer').getRemainingTime());});[id+':video_started',id+':video_durationchange'].forEach(function(eventName){IV.Events.on(eventName,function(){var duration=irollAd.get('videoPlayer').getDuration();if(duration>0&&duration!==vpaidAd.getAdDuration()){vpaidAd._setAdDuration(duration);vpaidAd._setAdRemainingTime(duration);vpaidAd._fire('AdDurationChange');}});});IV.Events.on(id+':video_ended',function(){vpaidAd._fire('AdVideoComplete');vpaidAd.adStoppableState=true;vpaidAd._fire("AdStoppableStateChange");});IV.Events.on(id+':ad_ended',function(){vpaidAd._actionsHandler.waitForActions("before_ad_end",function(){vpaidAd._adCompletionHandler.waitForCompletionPixelToBeLoaded(function(){vpaidAd.stopAd();});});});IV.Events.on(id+':skip',function(){vpaidAd.skipAd();});IV.Events.on(id+':close',function(){vpaidAd.stopAd();});IV.Events.on(id+':openUrl',function(url){var playerHandles=vpaidAd._shouldPlayerHandleClickthru();IV.Events.trigger(id+":vpaid_clickthru",playerHandles);vpaidAd._fire('AdClickThru',url,null,playerHandles);vpaidAd._fire("AdPaused");if(!playerHandles){window.open(url,"_blank");}});IV.Events.on(id+':userClick',function(){vpaidAd._fire('AdInteraction');});IV.Events.on(id+':dialogOpened',function(){vpaidAd.adExpanded=true;vpaidAd._fire("AdPaused");vpaidAd._fire('AdExpandedChange');});IV.Events.on(id+':dialogClosed',function(){vpaidAd.adExpanded=false;vpaidAd._fire('AdExpandedChange');vpaidAd._fire("AdPlaying");});["slateOpened","surveyOpened"].forEach(function(ev){IV.Events.on(id+':'+ev,function(){vpaidAd.adExpanded=true;if(!vpaidAd.getAdStoppableState()){vpaidAd._fire("AdPaused");}
vpaidAd._fire('AdExpandedChange');});});["slateClosed","surveyClosed"].forEach(function(ev){IV.Events.on(id+':'+ev,function(){vpaidAd.adExpanded=false;vpaidAd._fire('AdExpandedChange');vpaidAd._fire("AdPlaying");});});IV.Events.on(id+':video_error',function(){setTimeout(function(){vpaidAd.irollAd.cleanUp();vpaidAd._fire("AdError");},vpaidAd.AD_STOP_DELAY_TIME_MS);});IV.Events.on(id+":video_controls_play",function(){vpaidAd._fire("AdPlaying");});};VPAIDAd.prototype._parseCreativeParams=function(creativeData){function _str2bool(str){return str=="true"?true:((str=="false")?false:str);}
var createDataObj={};var creativeDataString="";if(creativeData){if(creativeData.hasOwnProperty("AdParameters")&&typeof creativeData.AdParameters==='string'){creativeDataString=creativeData.AdParameters;}else if(typeof creativeData==='string'){creativeDataString=creativeData;}
_.each(creativeDataString.split(';'),function(param){var parts=param.split('=');if(parts.length==2){createDataObj[parts[0]]=_str2bool(parts[1]);}});}
return createDataObj;};VPAIDAd.prototype._dimToNum=function(dim){return Number(dim)||0;};VPAIDAd.prototype._fixAdSlotDimensions=function(slot,height,width){if(typeof slot.style!=="undefined"){if($(slot).height()===0){$(slot).height(height);}
if($(slot).width()===0){$(slot).width(width);}}};VPAIDAd.prototype._overrideVerificationBlockingHandlerAndStartTimer=function(handler){this._verificationBlockingHandler=handler;handler.startTimeoutTimer();};VPAIDAd.prototype._shouldPlayerHandleClickthru=function(){return this.irollAd.inAppDetector.isInApp()||!IV.FeatureBitsResolver.isEnabled(IV.FeatureBitsResolver.FEATURE_NAMES.VPAID_CLKTRU_HANDLE_BY_INNOVID_FOR_NON_IN_APP);};(function(SCOPE){SCOPE.VPAIDExtensions=function(){var extensions={};this.EXTENSION_POINTS={"BEFORE_AD_LOAD":1,"BEFORE_AD_START":2,"CLEAN_UP":3};this.PRIORTIES={"LOW":1,"HIGH":2,"MONITOR":3};this.PRIORITY_ORDER=[this.PRIORTIES.LOW,this.PRIORTIES.HIGH,this.PRIORTIES.MONITOR];this.register=function(func,extensionPoint,priority){if(typeof priority==="undefined"){priority=this.PRIORTIES.LOW;}
if(!extensions.hasOwnProperty(extensionPoint)){extensions[extensionPoint]={};_.each(this.PRIORTIES,function(val){extensions[extensionPoint][val]=[];});}
extensions[extensionPoint][priority].push(func);};this.unregisterAll=function(){extensions={};};this.execute=function(extPoint,context){if(extensions.hasOwnProperty(extPoint)){_.each(this.PRIORITY_ORDER,function(pr){_.each(extensions[extPoint][pr],function(func){func.call(this,context);});});}};};SCOPE.vpaidExtensions=new SCOPE.VPAIDExtensions();})(IV);(function(SCOPE){SCOPE.VPAIDAdProxy=function(vpaidAd){var wrapAndLogWithArgs=function(func,funcName){return function(){func.apply(vpaidAd,arguments);SCOPE.toolkit.debug("VPAID method -",funcName,"(",Array.prototype.slice.call(arguments),")");};};var wrapAndLogReturnValue=function(func,funcName){return function(){var returnValue=func.apply(vpaidAd,arguments);SCOPE.toolkit.debug("VPAID method -",funcName,"(",returnValue,")");return returnValue;};};var vpaidSpec={initAd:wrapAndLogWithArgs(vpaidAd.initAd,"initAd"),handshakeVersion:vpaidAd.handshakeVersion.bind(vpaidAd),startAd:wrapAndLogWithArgs(vpaidAd.startAd,"startAd"),stopAd:wrapAndLogWithArgs(vpaidAd.stopAd,"stopAd"),pauseAd:wrapAndLogWithArgs(vpaidAd.pauseAd,"pauseAd"),resumeAd:wrapAndLogWithArgs(vpaidAd.resumeAd,"resumeAd"),resizeAd:wrapAndLogWithArgs(vpaidAd.resizeAd,"resizeAd"),expandAd:wrapAndLogWithArgs(vpaidAd.expandAd,"expandAd"),collapseAd:wrapAndLogWithArgs(vpaidAd.collapseAd,"collapseAd"),skipAd:wrapAndLogWithArgs(vpaidAd.skipAd,"skipAd"),subscribe:vpaidAd.subscribe.bind(vpaidAd),unsubscribe:vpaidAd.unsubscribe.bind(vpaidAd),getAdExpanded:wrapAndLogReturnValue(vpaidAd.getAdExpanded,"getAdExpanded"),getAdSkippableState:wrapAndLogReturnValue(vpaidAd.getAdSkippableState,"getAdSkippableState"),getAdWidth:wrapAndLogReturnValue(vpaidAd.getAdWidth,"getAdWidth"),getAdHeight:wrapAndLogReturnValue(vpaidAd.getAdHeight,"getAdHeight"),getAdCompanions:wrapAndLogReturnValue(vpaidAd.getAdCompanions,"getAdCompanions"),getAdIcons:wrapAndLogReturnValue(vpaidAd.getAdIcons,"getAdIcons"),getAdLinear:wrapAndLogReturnValue(vpaidAd.getAdLinear,"getAdLinear"),getAdVolume:wrapAndLogReturnValue(vpaidAd.getAdVolume,"getAdVolume"),getAdDuration:wrapAndLogReturnValue(vpaidAd.getAdDuration,"getAdDuration"),getAdRemainingTime:wrapAndLogReturnValue(vpaidAd.getAdRemainingTime,"getAdRemainingTime"),getAdStoppableState:wrapAndLogReturnValue(vpaidAd.getAdStoppableState,"getAdStoppableState"),setAdVolume:wrapAndLogWithArgs(vpaidAd.setAdVolume,"setAdVolume")};return vpaidSpec;}})(IV);var getVPAIDAd=(function(){var vpaidAdProxy=IV.VPAIDAdProxy(new VPAIDAd());return function(){return vpaidAdProxy;}})();
(function(SCOPE,onCreativeReady){if(isCreativeWrappedWithIframe()){setTimeout(function(){onCreativeReady(SCOPE);},0);}
function isCreativeWrappedWithIframe(){return!!onCreativeReady;}})(IVA||(IVA={}),IVA["onCreativeReady"]);
(function(SCOPE){SCOPE.vpaidExtensions.register(function VPAIDFullScreenDetection(vpaidAd){var
doc=vpaidAd.slot.ownerDocument,videoSlot=vpaidAd.videoSlot,_isFullScreen=false;function toggleFullScreen(isFullScreen){_isFullScreen=isFullScreen;if(isFullScreen){if(screen.width>0&&screen.height>0){vpaidAd.resizeAd(screen.width,screen.height);}}else{vpaidAd.resizeAd(vpaidAd.initialWidth,vpaidAd.initialHeight);}}
$(doc).on("fullscreenchange",function(){toggleFullScreen(doc["fullscreen"]);}).on("mozfullscreenchange",function(){toggleFullScreen(doc["mozFullScreen"]);}).on("webkitfullscreenchange",function(){toggleFullScreen(doc["webkitIsFullScreen"]);}).on("MSFullscreenChange",function(){toggleFullScreen(!!doc["msFullscreenElement"]);});$(videoSlot).on("webkitbeginfullscreen",function(){toggleFullScreen(true);}).on("webkitendfullscreen",function(){toggleFullScreen(false);});var view=doc.parentWindow||doc.defaultView;$(view).on("orientationchange",function(){setTimeout(function(){if(_isFullScreen){vpaidAd.resizeAd($(view).width(),$(view).height());}},300);});},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_START);})(IV);
(function(SCOPE){SCOPE.vpaidExtensions.register(function(vpaidAd){var pausedCB=function(){vpaidAd.irollAd.trigger("playButtonStateChanged",'paused');};var playedCB=function(){vpaidAd.irollAd.trigger("playButtonStateChanged",'played');};vpaidAd.subscribe(playedCB,"AdStarted");vpaidAd.subscribe(pausedCB,"AdPaused");vpaidAd.subscribe(playedCB,"AdPlaying");vpaidAd.subscribe(pausedCB,"AdStopped");},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD);})(IV);
var IV;(function(IV){var VpaidPixelLoadedHandler=(function(){function VpaidPixelLoadedHandler(actionName){this.pixelFired=false;this.actionName=actionName;}
VpaidPixelLoadedHandler.prototype.waitForPixelToFire=function(firedCb){if(firedCb){this.firedCb=_.once(firedCb);if(this.pixelFired){this.firedCb();}}};VpaidPixelLoadedHandler.prototype.postFiredPixel=function(){this.pixelFired=this.wasPixelFired();if(this.pixelFired){if(this.firedCb){this.firedCb();}}};return VpaidPixelLoadedHandler;})();IV.VpaidPixelLoadedHandler=VpaidPixelLoadedHandler;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var VpaidAdCompletionHandler=(function(_super){__extends(VpaidAdCompletionHandler,_super);function VpaidAdCompletionHandler(irollReporter){var _this=this;_super.call(this,VpaidAdCompletionHandler.QUARTILES_ACTION_NAME);this.timerId=null;this.irollReporter=irollReporter;this.irollReporter.addPostLoadedPixelCallback(function(){return _this.postFiredPixel();},VpaidAdCompletionHandler.QUARTILES_ACTION_NAME);}
Object.defineProperty(VpaidAdCompletionHandler,"COMPLETION_PIXEL_TIMEOUT_MS",{get:function(){return 1000;},enumerable:true,configurable:true});Object.defineProperty(VpaidAdCompletionHandler,"COMPLETION_TIMEOUT_EVENT_ID",{get:function(){return"vpaid-completion-pixel-timeout";},enumerable:true,configurable:true});Object.defineProperty(VpaidAdCompletionHandler,"QUARTILES_ACTION_NAME",{get:function(){return"vpoint";},enumerable:true,configurable:true});Object.defineProperty(VpaidAdCompletionHandler,"QUARTILES_EVENT_ID",{get:function(){return"percent";},enumerable:true,configurable:true});Object.defineProperty(VpaidAdCompletionHandler,"COMPLETION_PIXEL_OPTIONS",{get:function(){return{action:VpaidAdCompletionHandler.QUARTILES_ACTION_NAME,event_id:VpaidAdCompletionHandler.QUARTILES_EVENT_ID,event_value:100};},enumerable:true,configurable:true});;VpaidAdCompletionHandler.prototype.postFiredPixel=function(){if(this.wasPixelFired()&&this.timerId){clearTimeout(this.timerId);this.timerId=null;}
_super.prototype.postFiredPixel.call(this);};VpaidAdCompletionHandler.prototype.wasPixelFired=function(){return this.irollReporter.wasPixelLoaded(VpaidAdCompletionHandler.COMPLETION_PIXEL_OPTIONS);};VpaidAdCompletionHandler.prototype.waitForCompletionPixelToBeLoaded=function(loadedCb){var _this=this;this.waitForPixelToFire(loadedCb);if(!this.pixelFired){this.timerId=setTimeout(function(){if(!_this.pixelFired){_this.timerId=null;_this.irollReporter.reportLog({event_id:VpaidAdCompletionHandler.COMPLETION_TIMEOUT_EVENT_ID,event_value:VpaidAdCompletionHandler.COMPLETION_PIXEL_TIMEOUT_MS.toString()});}
loadedCb();},VpaidAdCompletionHandler.COMPLETION_PIXEL_TIMEOUT_MS);}};return VpaidAdCompletionHandler;})(IV.VpaidPixelLoadedHandler);IV.VpaidAdCompletionHandler=VpaidAdCompletionHandler;})(IV||(IV={}));
var IV;(function(IV){var VerificationNonBlockingHandler=(function(){function VerificationNonBlockingHandler(){}
VerificationNonBlockingHandler.prototype.waitForBlockingDecisionOrTimeout=function(postWaitCallback){postWaitCallback();};VerificationNonBlockingHandler.prototype.shouldBlockAd=function(){return false;};VerificationNonBlockingHandler.prototype.notifyAdStarted=function(){};VerificationNonBlockingHandler.prototype.startTimeoutTimer=function(){};return VerificationNonBlockingHandler;})();IV.VerificationNonBlockingHandler=VerificationNonBlockingHandler;})(IV||(IV={}));
var IV;(function(IV){var ActionsHandler=(function(){function ActionsHandler(){this.eventHandlers={};}
ActionsHandler.prototype.addHandler=function(eventType,handler){if(this.eventHandlers.hasOwnProperty(eventType)){this.eventHandlers[eventType].push(handler);}
else{this.eventHandlers[eventType]=[handler];}};ActionsHandler.prototype.waitForActions=function(eventType,callback){if(this.eventHandlers.hasOwnProperty(eventType)&&this.eventHandlers[eventType].length>0){var handlers=this.eventHandlers[eventType];var afterCallback=_.after(handlers.length,callback);handlers.forEach(function(handler){handler.waitForAction(afterCallback);});}
else{callback();}};return ActionsHandler;})();IV.ActionsHandler=ActionsHandler;})(IV||(IV={}));
(function(SCOPE){SCOPE.VPAIDAdWrapper=function(vpaidAd,moduleName){this.handshakeVersion=function(){return vpaidAd.handshakeVersion();};this.subscribe=function(aCallback,eventName,aContext){if(typeof aContext==="undefined")aContext=this;vpaidAd.safeSubscribe(aCallback,eventName,aContext,moduleName);};this.unsubscribe=function(aCallback,eventName){vpaidAd.unsubscribe(aCallback,eventName);};this.getAdExpanded=function(){return vpaidAd.getAdExpanded();};this.getAdSize=function()
{return vpaidAd.getAdSize();};this.getAdSkippableState=function(){return vpaidAd.getAdSkippableState();};this.getAdWidth=function(){return vpaidAd.getAdWidth();};this.getAdHeight=function(){return vpaidAd.getAdHeight();};this.getAdCompanions=function(){return vpaidAd.getAdCompanions();};this.getAdIcons=function(){return vpaidAd.getAdIcons();};this.getAdLinear=function(){return vpaidAd.getAdLinear();};this.getAdVolume=function(){return vpaidAd.getAdVolume();};this.getAdDuration=function(){return vpaidAd.getAdDuration();};this.getAdRemainingTime=function(){return vpaidAd.getAdRemainingTime();};this.getPlayer=function(){var player=vpaidAd.videoSlot;return _.isElement(player)?player:null;};this.getSlot=function(){return vpaidAd.slot;};this.getPreviousEvents=function(){return vpaidAd.loggedEvents;};this.getViewMode=function(){return vpaidAd.viewMode;}};})(IV);
var IV;(function(IV){var IframeInjection=(function(){function IframeInjection(){}
IframeInjection.prototype.setInjection=function(fn){this.injectionFn=fn;};IframeInjection.prototype.onTimeout=function(fn){this.timeoutCb=fn;};IframeInjection.prototype.onInjection=function(fn){this.injectCb=fn;};IframeInjection.prototype.inject=function(){if(this.injectCb){this.injectCb();}
if(this.injectionFn){return this.injectionFn();}
else{return null;}};IframeInjection.prototype.timeout=function(){this.timeoutCb&&this.timeoutCb();};return IframeInjection;})();IV.IframeInjection=IframeInjection;})(IV||(IV={}));
var IV;(function(IV){var IframeIntegrationLoader=(function(){function IframeIntegrationLoader(vpaidWrapper,irollReporter,iframeInjector){this.scriptLoaded=false;this.integrationTimeoutTimerId=null;this.irollReporter=irollReporter;this.vpaidWrapper=vpaidWrapper;this.iframeInjector=iframeInjector;this.randomIframeContextName=this.generateRandomIframeContextName();}
Object.defineProperty(IframeIntegrationLoader,"MONITORING_LOAD_TIMEOUT_MS",{get:function(){return 5000;},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"SCRIPT_STATE",{get:function(){return{READY:"READY",NOT_READY:"NOT READY"};},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"INTEGRATION_CALLBACK_NAME",{get:function(){return"ivOnIntegrationReady";},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"IFRAME_CONTEXT_NAME",{get:function(){return"ivIfrIntCtxObj";},enumerable:true,configurable:true});IframeIntegrationLoader.prototype.load=function(targetWindow,injectionContext){var _this=this;this.injection=injectionContext;this.vpaidWrapper.subscribe(function(){_this.adImpression();},"AdImpression");var injectedIframe=this.iframeInjector.injectIframeIntoDoc(targetWindow.document);this.injection.onTimeout(function(){_this.reportTimeoutError();});this.integrationTimeoutTimerId=setTimeout(function(){_this.injection.timeout();},IframeIntegrationLoader.MONITORING_LOAD_TIMEOUT_MS);this.injection.onInjection(function(){_this.stopTimeoutTimer();_this.scriptLoaded=true;});if(injectedIframe){this.writeContentIntoIframe(targetWindow,injectedIframe);}};IframeIntegrationLoader.prototype.writeContentIntoIframe=function(targetWindow,injectedIframe){var content=this.buildInjectionContent(targetWindow);var ifrWin=injectedIframe.contentWindow;var ifrDoc=ifrWin.document;ifrDoc.open();ifrWin[this.randomIframeContextName]=targetWindow;ifrDoc.write(content);ifrDoc.close();};IframeIntegrationLoader.prototype.reportTimeoutError=function(){this.irollReporter.reportLog({event_id:this.timeoutErrorEventId(),event_value:IframeIntegrationLoader.MONITORING_LOAD_TIMEOUT_MS.toString()});};IframeIntegrationLoader.prototype.isScriptLoaded=function(){return this.scriptLoaded;};IframeIntegrationLoader.prototype.adImpression=function(){var evtValue=this.isScriptLoaded()?IframeIntegrationLoader.SCRIPT_STATE.READY:IframeIntegrationLoader.SCRIPT_STATE.NOT_READY;this.irollReporter.reportLog({event_id:this.impressionEventId(),event_value:evtValue});};IframeIntegrationLoader.prototype.generateRandomIframeContextName=function(){var randomNumber=Math.floor(Math.random()*Math.pow(10,9));return IframeIntegrationLoader.IFRAME_CONTEXT_NAME+"_"+randomNumber.toString(10);};IframeIntegrationLoader.prototype.stopTimeoutTimer=function(){if(this.integrationTimeoutTimerId){clearTimeout(this.integrationTimeoutTimerId);}};return IframeIntegrationLoader;})();IV.IframeIntegrationLoader=IframeIntegrationLoader;})(IV||(IV={}));
;
var IV;(function(IV){var ComscoreApiProxy=(function(){function ComscoreApiProxy(partnerId,adNode,comscoreTrackingUrl){this.partnerId=partnerId;this.adNode=adNode;this.comscoreTrackingUrl=comscoreTrackingUrl+ComscoreApiProxy.VCE4V;}
Object.defineProperty(ComscoreApiProxy,"VCE4V",{get:function(){return"&vce4v=1";},enumerable:true,configurable:true});ComscoreApiProxy.prototype.init=function(comscoreInstance){this.comscoreInstance=comscoreInstance;this.comscoreInstance.init(this.partnerId,{playerNode:this.adNode});};ComscoreApiProxy.prototype.trackEvent=function(eventType,params){this.comscoreInstance.trackEvent(eventType,this.comscoreTrackingUrl,params);};return ComscoreApiProxy;})();IV.ComscoreApiProxy=ComscoreApiProxy;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var ComscoreIntegrationLoader=(function(_super){__extends(ComscoreIntegrationLoader,_super);function ComscoreIntegrationLoader(vpaidWrapper,irollReporter,iframeInjector,comscoreRunner){_super.call(this,vpaidWrapper,irollReporter,iframeInjector);this.comscoreRunner=comscoreRunner;}
Object.defineProperty(ComscoreIntegrationLoader,"IMPRESSION_EVENT_NAME",{get:function(){return"comscore-impression";},enumerable:true,configurable:true});Object.defineProperty(ComscoreIntegrationLoader,"TIMEOUT_ERROR_EVENT_ID",{get:function(){return"comscore-not-loaded";},enumerable:true,configurable:true});ComscoreIntegrationLoader.prototype.buildInjectionContent=function(targetWindow){var _this=this;this.injection.setInjection(function(){return _this.comscoreRunner;});targetWindow[ComscoreIntegrationLoader.INTEGRATION_CALLBACK_NAME]=function(){return _this.injection.inject();};return"\n<body onload=\"start()\">\n    <script>\n    !function(){var e=\"encodeURIComponent\",n=\"decodeURIComponent\",r=\"createElement\",t=\"location\",a=\"getElementsByTagName\",c=\"getElementById\",i=\"length\",o=\"script\",v=\"indexOf\",u=\"charAt\",f=\"href\",s=\"replace\",l=\"split\",_=\"substr\",d=\"src\",h=\"http\",p=\"addEventListener\",m=\"queryParams\",y=\"optionalParams\",g=\"ns_ad_\",b=g+\"pcd\",w=g+\"vs\",k=\"defaultTrackingURL\",E=\"handlerForVCECallback\",T=\"loader\",L=\"playerNode\",P=\"playerId\",R=\"partnerId\",U=\"notInited\",I=window,C=document;ns_=I.ns_||{},ns_.vce_vh=ns_.vce_vh||{},ns_.vce_vh.player_cache=ns_.vce_vh.player_cache||{},ns_.vce_vh.Loader=ns_.vce_vh.Loader||function(g){function k(e){return e?e[s](/\\s+/g,\"\"):e}function E(){try{return g.ns_.vce_v.R&&g.ns_.vce_v&&g.ns_}catch(e){return!1}}function T(){var e=k(ue);return e=e+\"#cs_vp_sv=\"+Y+\"&ns_ad_pa=\"+S+\"&ns_swfid=\"+Z}function L(e){var n=G[r](o);n.type=\"text/javascript\",n[d]=e,n.async=!0;try{var t=G[c](V);if(!t)return;t[p](\"loadedmetadata\",function(e){t.duration&&(ee[b]=Math.floor(t.duration)),t.volume&&(ee[w]=0!==t.volume)},!1),t.parentNode.insertBefore(n,t.nextSibling)}catch(a){}}function P(e){var n={};return n=O(e),!n[b]&&ee[b]&&(n[b]=ee[b]),!n[w]&&ee[w]&&(n[w]=ee[w]),n}function R(e,n,r){n||(n=W),e&&n&&(r?H.push({eventType:e,eventURL:n,optionalParams:r}):H.push({eventType:e,eventURL:n,optionalParams:{}}),setTimeout(U,0))}function U(){var e=0,n=H[i],r={},t=\"\",a={};if(J>K){for(e=0;n>e;++e)I(H[e]);return void(H[i]=0)}if(!E())return J+=Q,void setTimeout(U,Q);if(0!==n){for(e=0;n>e;++e){try{r=F(H[e].eventURL),t=r.url+\"?\"+D(r[m]),j(),a=P(H[e][y]),a.bufferTime=J}catch(c){}try{g.ns_.vce_v.Tr(Z,H[e].eventType,t,D(a))}catch(c){}}H[i]=0}}function I(e){var n,r,t={},a=\"\",c={},i=\"v_\"+e.eventType,o=e[y],v={},u=\"\";try{t=F(e.eventURL),a=t.url;for(n in t[m])c[n]=t[m][n];if(r=c.c2+\"\"+c.c3,c.ns__t=(new Date).getTime(),r in fe?(c.ns__p=fe[r],$=fe[r]):fe[r]=c.ns__t,c.ns_ad_vevent=i,c.ns_ad_event=\"video\",c.ns_ad_pa=S,$)for(var f=[\"c3\",\"ca3\",\"cb3\",\"cc3\",\"cd3\",\"ce3\",\"cf3\",\"cg3\",\"ch3\",\"ci3\",\"cj3\",\"ck3\",\"cl3\"],s=0;s<f.length;s++){var l=f[s],_=l.replace(/3/gi,1);c.hasOwnProperty(l)&&3==c[_]&&(c[l]=\"_e0_\"+c[l])}if(c.cs_vp_sv=Y,c.ns_ad_wt=J,o){j(),v=P(o);for(var d in v)c[d]=v[d]}u=a+\"?\"+D(c),q(u)}catch(h){}}function C(e){var n,r=0;for(n in e)e[n]&&r++;return r}function D(e){var n=\"\";for(var r in e)\"\"!==n&&(n+=\"&\"),n+=r+\"=\"+ae(e[r]).replace(/-/g,\"%2D\").replace(/@/g,\"%40\").replace(/\\*/g,\"%2A\");return n}function F(e){var r=\"\",t={},a=\"\",c=0,o=[];if(!e)return{url:null,queryParams:null};if(e=k(e),0!==e[v](h)&&(e=h+\"://\"+e),ie[u](4)!=e[u](4)&&(e=ie+(\"s\"==ie[u](4)?e[_](7):e[_](9))),-1!=e[v](\"?\")){if(r=e[_](0,e[v](\"?\")),a=e[_](e[v](\"?\")+1),-1!=a[v](\"&\")){t={},a=a.replace(/&amp;/gi,\"&\").replace(/amp;/gi,\"\");var f=a[l](\"&\");for(c=0;c<f[i];++c)if(o=f[c][l](\"=\"),2==o[i])try{t[g[n](o[0])]=g[n](o[1])}catch(s){t[o[0]]=o[1]}}else if(o=a[l](\"=\"),2==o[i]){t={};try{t[g[n](o[0])]=g[n](o[1])}catch(s){t[o[0]]=o[1]}}}else r=e;return{url:r,queryParams:t}}function O(e){var r,t={};if(!e)return{};if(0===C(e))return{};for(r in e)try{t[g[n](r)]=g[n](e[r])}catch(a){r=g[n](r),t[r]=e[r]}return t}function j(){if(V){var e=G[c](V);!ee[b]&&e.duration&&(ee[b]=e.duration),!ee[w]&&e.volume&&(ee[w]=0!==e.volume)}}function q(e){var n=new Image;n.src=e}function x(){var e=G[c](V),n=!1;if(!e)return!1;for(var r=0,t=te[i];t>r;++r)n=n||e==G[te[r]],G[te[r]]&&(n=n||e==G[te[r]][a](\"video\")[0]),n=n||ne;return n}function B(e,n){z&&z(e,n)}function M(){var e,n=X+\"evt\",r=X+\"fs\";V&&(e=G[c](V)),e&&(e[n]=B,e[r]=x)}function N(e){z=e}function A(e,n,r){S=e;var t=G[c](n);t&&(t[Z]=function(){return!0},V=n,L(T()),M(),r&&(W=r),t[p](\"webkitbeginfullscreen\",function(){ne=!0},!1),t[p](\"webkitendfullscreen\",function(){ne=!1},!1))}var S,V,z,W,G=g.document,H=[],J=0,K=5e3,Q=500,X=\"cs_\",Y=\"1.1706.21h\",Z=X+Math.floor(1e13*Math.random()+1),$=0,ee={},ne=!1,re=\"FullscreenElement\",te=[\"ms\"+re,\"webkit\"+re,\"mozFullScreenElement\",\"fullscreenElement\",\"o\"+re,\"khtml\"+re],ae=g[e]?g[e]:escape,ce=ae(G[t]&&G[t][f]?G[t][f]:G.URL),ie=\"http\"+(\"s\"==ce[u](4)?\"s://s\":\"://\"),oe=ie+\"b.scorecardresearch.com\",ve=\"/c2/vce4v/\",ue=oe+ve+\"rs.js\",fe={};return{init:A,addCallback:N,trackEvent:R}},ns_.vce_vh.boot=ns_.vce_vh.boot||function(){function e(e){if(e.length<2)return!1;var n=e[0];if(\"string\"==typeof n&&n.trim().length>0){for(var r=1,t=e.length;t>r;++r){var a=e[r];if(!a[L]&&!a[P])break}if(r===t)return!0}return!1}function n(){if(e(arguments)){for(var n=arguments,r=n[0].trim(),i=1,o=n.length;o>i;++i){var v,u,f,s=n[i],l=!!(s[P]&&s[P].trim().length>0);if(l?(v=s[P].trim(),f=I,u=C[c][v]):(u=s[L],f=u.ownerDocument.defaultView||u.ownerDocument.parentWindow,v=u.id),v=u.id||(u.id=\"ns_ad\"+ +new Date),v.trim().length<=0)return;var _=new a(f);t[v]={},u&&(t[v][L]=u),t[v][T]=_,t[v][R]=r,t[v][k]=s[k]?s[k].trim():null,t[v][E]=s[E],t[v][U]=!0}for(var d in t)if(t.hasOwnProperty(d)){var h=t[d],p=h[R];if(h[U]){var m=h[E];m&&m instanceof Function&&h[T].addCallback(m),h[T].init(p,d,h[k]),h[U]=!1}}}}function r(e,n,r,a){var c=\"\",i=\"\";if(a)c=\"string\"==typeof a?a.trim():a.id;else for(var o in t)if(t.hasOwnProperty(o)){c=o;break}c&&t[c]&&(i=n?n:t[c][k],t[c][T].trackEvent(e,i,r))}var t=ns_.vce_vh.player_cache,a=ns_.vce_vh.Loader;return{init:n,redirect:r}}(),I.cs_vce_=I.cs_vce_||{init:ns_.vce_vh.boot.init,trackEvent:ns_.vce_vh.boot.redirect}}();</script>\n    <script>\n        function start() {\n            var runner = "+this.randomIframeContextName+"."+ComscoreIntegrationLoader.INTEGRATION_CALLBACK_NAME+"();\n            runner.run(window[\"cs_vce_\"]);\n        }\n    </script>\n</body>";};ComscoreIntegrationLoader.prototype.timeoutErrorEventId=function(){return ComscoreIntegrationLoader.TIMEOUT_ERROR_EVENT_ID;};ComscoreIntegrationLoader.prototype.impressionEventId=function(){return ComscoreIntegrationLoader.IMPRESSION_EVENT_NAME;};return ComscoreIntegrationLoader;})(IV.IframeIntegrationLoader);IV.ComscoreIntegrationLoader=ComscoreIntegrationLoader;})(IV||(IV={}));
var IV;(function(IV){var ComscoreIntegrationRunner=(function(){function ComscoreIntegrationRunner(vpaidEventsHandler,reporter,comscoreInstance){this.vpaidEventsHandler=vpaidEventsHandler;this.reporter=reporter;this.comscoreInstanceProxy=comscoreInstance;}
Object.defineProperty(ComscoreIntegrationRunner,"INIT_EVENT_NAME",{get:function(){return"comscore-init";},enumerable:true,configurable:true});Object.defineProperty(ComscoreIntegrationRunner,"INIT_RESULT",{get:function(){return{SUCCESS:"succeed",FAIL:"failed"};},enumerable:true,configurable:true});ComscoreIntegrationRunner.prototype.run=function(comscoreInstance){try{this.reportInitFwSuccess(true);this.vpaidEventsHandler.startListening(this.comscoreInstanceProxy);this.comscoreInstanceProxy.init(comscoreInstance);}
catch(e){this.reportInitFwSuccess(false,e.message);}};ComscoreIntegrationRunner.prototype.reportInitFwSuccess=function(success,value){this.reporter.reportLog({event_id:ComscoreIntegrationRunner.INIT_EVENT_NAME,event_value:success?ComscoreIntegrationRunner.INIT_RESULT.SUCCESS:ComscoreIntegrationRunner.INIT_RESULT.FAIL+": "+value});};return ComscoreIntegrationRunner;})();IV.ComscoreIntegrationRunner=ComscoreIntegrationRunner;})(IV||(IV={}));
var IV;(function(IV){var ComscoreVpaidEventsHandler=(function(){function ComscoreVpaidEventsHandler(vpaidWrapper,reporter){this.vpaidWrapper=vpaidWrapper;this.reporter=reporter;this.debounceCallFullScreen=_.debounce(this.callFullScreenEvent,1000,true);this.debounceCallExitFullScreen=_.debounce(this.callExitFullScreen,1000,true);}
Object.defineProperty(ComscoreVpaidEventsHandler,"ComscoreEvents",{get:function(){return{START_EVENT:"start",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",MUTE:"mute",UNMUTE:"unmute",PAUSE:"pause",RESUME:"resume",FULL_SCREEN:"fullScreen",EXIT_FULL_SCREEN:"exitFullScreen"};},enumerable:true,configurable:true});Object.defineProperty(ComscoreVpaidEventsHandler,"COMSCORE_SEND_EVENT_ERROR",{get:function(){return"comscore-track-event-error";},enumerable:true,configurable:true});ComscoreVpaidEventsHandler.prototype.startListening=function(comscoreInstance){var _this=this;this.comscoreInstance=comscoreInstance;this.vpaidWrapper.subscribe(function(){return _this.adImpression();},IV.VpaidEvents.AD_IMPRESSION);this.vpaidWrapper.subscribe(function(){return _this.adVolumeChange();},IV.VpaidEvents.AD_VOLUME_CHANGE);this.vpaidWrapper.subscribe(function(){return _this.adVideoFirstQuartile();},IV.VpaidEvents.AD_VIDEO_FIRST_QUARTILE);this.vpaidWrapper.subscribe(function(){return _this.adVideoMidpoint();},IV.VpaidEvents.AD_VIDEO_MIDPOINT);this.vpaidWrapper.subscribe(function(){return _this.adVideoThirdQuartile();},IV.VpaidEvents.AD_VIDEO_THIRD_QUARTILE);this.vpaidWrapper.subscribe(function(){return _this.adVideoComplete();},IV.VpaidEvents.AD_VIDEO_COMPLETE);this.vpaidWrapper.subscribe(function(){return _this.adPaused();},IV.VpaidEvents.AD_PAUSED);this.vpaidWrapper.subscribe(function(){return _this.adPlaying();},IV.VpaidEvents.AD_PLAYING);this.vpaidWrapper.subscribe(function(){return _this.adSizeChange();},IV.VpaidEvents.AD_SIZE_CHANGE);};ComscoreVpaidEventsHandler.prototype.callComscoreTrackEvent=function(eventType,params){try{this.comscoreInstance.trackEvent(eventType,params);}
catch(e){this.reporter.reportLog({event_id:ComscoreVpaidEventsHandler.COMSCORE_SEND_EVENT_ERROR,event_value:e.message});}};ComscoreVpaidEventsHandler.prototype.trackEvent=function(eventType){var params={ns_ad_ctp:false,ns_ad_cd:this.vpaidWrapper.getAdDuration(),ns_ad_vs:(this.vpaidWrapper.getAdVolume()===0)?true:false,ns_ad_fs:(this.vpaidWrapper.getViewMode()==="fullscreen")?true:false};this.callComscoreTrackEvent(eventType,params);};ComscoreVpaidEventsHandler.prototype.adImpression=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.START_EVENT);};ComscoreVpaidEventsHandler.prototype.adVideoFirstQuartile=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.FIRST_QUARTILE);};ComscoreVpaidEventsHandler.prototype.adVideoMidpoint=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.MIDPOINT);};ComscoreVpaidEventsHandler.prototype.adVideoThirdQuartile=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.THIRD_QUARTILE);};ComscoreVpaidEventsHandler.prototype.adVideoComplete=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.COMPLETE);};ComscoreVpaidEventsHandler.prototype.adPaused=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.PAUSE);};ComscoreVpaidEventsHandler.prototype.adPlaying=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.RESUME);};ComscoreVpaidEventsHandler.prototype.callMuteEvent=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.MUTE);};ComscoreVpaidEventsHandler.prototype.callUnmuteEvent=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.UNMUTE);};ComscoreVpaidEventsHandler.prototype.adVolumeChange=function(){this.isVolumeMute()?this.callMuteEvent():this.callUnmuteEvent();};ComscoreVpaidEventsHandler.prototype.callFullScreenEvent=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.FULL_SCREEN);};ComscoreVpaidEventsHandler.prototype.callExitFullScreen=function(){this.trackEvent(ComscoreVpaidEventsHandler.ComscoreEvents.EXIT_FULL_SCREEN);};ComscoreVpaidEventsHandler.prototype.adSizeChange=function(){this.isFullScreen()?this.debounceCallFullScreen():this.debounceCallExitFullScreen();};ComscoreVpaidEventsHandler.prototype.isFullScreen=function(){return this.vpaidWrapper.getViewMode()==="fullscreen";};ComscoreVpaidEventsHandler.prototype.isVolumeMute=function(){return this.vpaidWrapper.getAdVolume()===0;};return ComscoreVpaidEventsHandler;})();IV.ComscoreVpaidEventsHandler=ComscoreVpaidEventsHandler;})(IV||(IV={}));
var IV;(function(IV){var VpaidEvents=(function(){function VpaidEvents(){}
Object.defineProperty(VpaidEvents,"AD_LOADED",{get:function(){return"AdLoaded";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_STARTED",{get:function(){return"AdStarted";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_STOPPED",{get:function(){return"AdStopped";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SKIPPED",{get:function(){return"AdSkipped";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SKIPPABLE_CHANGE",{get:function(){return"AdSkippableStateChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_DURATION_CHANGE",{get:function(){return"AdDurationChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VOLUME_CHANGE",{get:function(){return"AdVolumeChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_IMPRESSION",{get:function(){return"AdImpression";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_START",{get:function(){return"AdVideoStart";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_FIRST_QUARTILE",{get:function(){return"AdVideoFirstQuartile";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_MIDPOINT",{get:function(){return"AdVideoMidpoint";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_THIRD_QUARTILE",{get:function(){return"AdVideoThirdQuartile";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_COMPLETE",{get:function(){return"AdVideoComplete";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_CLICK_THRU",{get:function(){return"AdClickThru";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_PAUSED",{get:function(){return"AdPaused";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_PLAYING",{get:function(){return"AdPlaying";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_ERROR",{get:function(){return"AdError";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SIZE_CHANGE",{get:function(){return"AdSizeChange";},enumerable:true,configurable:true});return VpaidEvents;})();IV.VpaidEvents=VpaidEvents;})(IV||(IV={}));
(function(SCOPE){SCOPE.vpaidExtensions.register(function(vpaidAd){var COMSCORE_PARTNER_ID=SCOPE.baseData.config_data['comscore']['partnerId'];var INTEGRATION_NAME="comscore";var reporter=vpaidAd.irollAd.report;var vpaidWrapper=new SCOPE.VPAIDAdWrapper(vpaidAd,INTEGRATION_NAME);var comscoreTrackingUrl=SCOPE.baseData.app_data["service-config"]["comscore"]["trackingUrl"];var vpaidEventsHandler=new SCOPE.ComscoreVpaidEventsHandler(vpaidWrapper,reporter);var videoElement=vpaidWrapper.getPlayer()||vpaidWrapper.getSlot();var comscoreInstance=new SCOPE.ComscoreApiProxy(COMSCORE_PARTNER_ID,videoElement,comscoreTrackingUrl);var comscoreRunner=new SCOPE.ComscoreIntegrationRunner(vpaidEventsHandler,reporter,comscoreInstance);var iframeInjector=new SCOPE.FriendlyIframeInjector(INTEGRATION_NAME,vpaidWrapper.getSlot());var comscoreLoader=new SCOPE.ComscoreIntegrationLoader(vpaidWrapper,reporter,iframeInjector,comscoreRunner);comscoreLoader.load(window,new IV.IframeInjection());},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD);})(IV);
(function(SCOPE){SCOPE.VPAIDAdWrapper=function(vpaidAd,moduleName){this.handshakeVersion=function(){return vpaidAd.handshakeVersion();};this.subscribe=function(aCallback,eventName,aContext){if(typeof aContext==="undefined")aContext=this;vpaidAd.safeSubscribe(aCallback,eventName,aContext,moduleName);};this.unsubscribe=function(aCallback,eventName){vpaidAd.unsubscribe(aCallback,eventName);};this.getAdExpanded=function(){return vpaidAd.getAdExpanded();};this.getAdSize=function()
{return vpaidAd.getAdSize();};this.getAdSkippableState=function(){return vpaidAd.getAdSkippableState();};this.getAdWidth=function(){return vpaidAd.getAdWidth();};this.getAdHeight=function(){return vpaidAd.getAdHeight();};this.getAdCompanions=function(){return vpaidAd.getAdCompanions();};this.getAdIcons=function(){return vpaidAd.getAdIcons();};this.getAdLinear=function(){return vpaidAd.getAdLinear();};this.getAdVolume=function(){return vpaidAd.getAdVolume();};this.getAdDuration=function(){return vpaidAd.getAdDuration();};this.getAdRemainingTime=function(){return vpaidAd.getAdRemainingTime();};this.getPlayer=function(){var player=vpaidAd.videoSlot;return _.isElement(player)?player:null;};this.getSlot=function(){return vpaidAd.slot;};this.getPreviousEvents=function(){return vpaidAd.loggedEvents;};this.getViewMode=function(){return vpaidAd.viewMode;}};})(IV);
;
var IV;(function(IV){var IntegrationDiagnosticReporter=(function(){function IntegrationDiagnosticReporter(reporter){this.entries={};this.reporter=reporter;}
IntegrationDiagnosticReporter.prototype.addDiagnosticPixel=function(integrationName,eventName,templateUrl){if(!this.entries.hasOwnProperty(integrationName)){this.entries[integrationName]={};}
if(!this.entries[integrationName].hasOwnProperty(eventName)){this.entries[integrationName][eventName]=[];}
this.entries[integrationName][eventName].push(_.template(templateUrl));};IntegrationDiagnosticReporter.prototype.reportDiagnosticEvent=function(integrationName,eventName,templateValues){var _this=this;if(this.entries.hasOwnProperty(integrationName)&&this.entries[integrationName].hasOwnProperty(eventName)){this.entries[integrationName][eventName].forEach(function(compiledUrl){var url=compiledUrl(templateValues);_this.reporter.firePixel(url);});}};return IntegrationDiagnosticReporter;})();IV.IntegrationDiagnosticReporter=IntegrationDiagnosticReporter;})(IV||(IV={}));
var IV;(function(IV){var IframeInjection=(function(){function IframeInjection(){}
IframeInjection.prototype.setInjection=function(fn){this.injectionFn=fn;};IframeInjection.prototype.onTimeout=function(fn){this.timeoutCb=fn;};IframeInjection.prototype.onInjection=function(fn){this.injectCb=fn;};IframeInjection.prototype.inject=function(){if(this.injectCb){this.injectCb();}
if(this.injectionFn){return this.injectionFn();}
else{return null;}};IframeInjection.prototype.timeout=function(){this.timeoutCb&&this.timeoutCb();};return IframeInjection;})();IV.IframeInjection=IframeInjection;})(IV||(IV={}));
var IV;(function(IV){var IframeIntegrationLoader=(function(){function IframeIntegrationLoader(vpaidWrapper,irollReporter,iframeInjector){this.scriptLoaded=false;this.integrationTimeoutTimerId=null;this.irollReporter=irollReporter;this.vpaidWrapper=vpaidWrapper;this.iframeInjector=iframeInjector;this.randomIframeContextName=this.generateRandomIframeContextName();}
Object.defineProperty(IframeIntegrationLoader,"MONITORING_LOAD_TIMEOUT_MS",{get:function(){return 5000;},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"SCRIPT_STATE",{get:function(){return{READY:"READY",NOT_READY:"NOT READY"};},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"INTEGRATION_CALLBACK_NAME",{get:function(){return"ivOnIntegrationReady";},enumerable:true,configurable:true});Object.defineProperty(IframeIntegrationLoader,"IFRAME_CONTEXT_NAME",{get:function(){return"ivIfrIntCtxObj";},enumerable:true,configurable:true});IframeIntegrationLoader.prototype.load=function(targetWindow,injectionContext){var _this=this;this.injection=injectionContext;this.vpaidWrapper.subscribe(function(){_this.adImpression();},"AdImpression");var injectedIframe=this.iframeInjector.injectIframeIntoDoc(targetWindow.document);this.injection.onTimeout(function(){_this.reportTimeoutError();});this.integrationTimeoutTimerId=setTimeout(function(){_this.injection.timeout();},IframeIntegrationLoader.MONITORING_LOAD_TIMEOUT_MS);this.injection.onInjection(function(){_this.stopTimeoutTimer();_this.scriptLoaded=true;});if(injectedIframe){this.writeContentIntoIframe(targetWindow,injectedIframe);}};IframeIntegrationLoader.prototype.writeContentIntoIframe=function(targetWindow,injectedIframe){var content=this.buildInjectionContent(targetWindow);var ifrWin=injectedIframe.contentWindow;var ifrDoc=ifrWin.document;ifrDoc.open();ifrWin[this.randomIframeContextName]=targetWindow;ifrDoc.write(content);ifrDoc.close();};IframeIntegrationLoader.prototype.reportTimeoutError=function(){this.irollReporter.reportLog({event_id:this.timeoutErrorEventId(),event_value:IframeIntegrationLoader.MONITORING_LOAD_TIMEOUT_MS.toString()});};IframeIntegrationLoader.prototype.isScriptLoaded=function(){return this.scriptLoaded;};IframeIntegrationLoader.prototype.adImpression=function(){var evtValue=this.isScriptLoaded()?IframeIntegrationLoader.SCRIPT_STATE.READY:IframeIntegrationLoader.SCRIPT_STATE.NOT_READY;this.irollReporter.reportLog({event_id:this.impressionEventId(),event_value:evtValue});};IframeIntegrationLoader.prototype.generateRandomIframeContextName=function(){var randomNumber=Math.floor(Math.random()*Math.pow(10,9));return IframeIntegrationLoader.IFRAME_CONTEXT_NAME+"_"+randomNumber.toString(10);};IframeIntegrationLoader.prototype.stopTimeoutTimer=function(){if(this.integrationTimeoutTimerId){clearTimeout(this.integrationTimeoutTimerId);}};return IframeIntegrationLoader;})();IV.IframeIntegrationLoader=IframeIntegrationLoader;})(IV||(IV={}));
;
var IV;(function(IV){var VpaidEvents=(function(){function VpaidEvents(){}
Object.defineProperty(VpaidEvents,"AD_LOADED",{get:function(){return"AdLoaded";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_STARTED",{get:function(){return"AdStarted";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_STOPPED",{get:function(){return"AdStopped";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SKIPPED",{get:function(){return"AdSkipped";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SKIPPABLE_CHANGE",{get:function(){return"AdSkippableStateChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_DURATION_CHANGE",{get:function(){return"AdDurationChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VOLUME_CHANGE",{get:function(){return"AdVolumeChange";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_IMPRESSION",{get:function(){return"AdImpression";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_START",{get:function(){return"AdVideoStart";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_FIRST_QUARTILE",{get:function(){return"AdVideoFirstQuartile";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_MIDPOINT",{get:function(){return"AdVideoMidpoint";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_THIRD_QUARTILE",{get:function(){return"AdVideoThirdQuartile";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_VIDEO_COMPLETE",{get:function(){return"AdVideoComplete";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_CLICK_THRU",{get:function(){return"AdClickThru";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_PAUSED",{get:function(){return"AdPaused";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_PLAYING",{get:function(){return"AdPlaying";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_ERROR",{get:function(){return"AdError";},enumerable:true,configurable:true});Object.defineProperty(VpaidEvents,"AD_SIZE_CHANGE",{get:function(){return"AdSizeChange";},enumerable:true,configurable:true});return VpaidEvents;})();IV.VpaidEvents=VpaidEvents;})(IV||(IV={}));
var IV;(function(IV){var IasConfigComposer=(function(){function IasConfigComposer(sessionId){this.sessionId=sessionId;}
Object.defineProperty(IasConfigComposer,"IAS_NODE_NAME",{get:function(){return"integral";},enumerable:true,configurable:true});IasConfigComposer.prototype.compose=function(adConfig){var placementConfig=adConfig.app_data["placement-config"];var iasConfig=adConfig.app_data["service-config"][IasConfigComposer.IAS_NODE_NAME];return{partner:iasConfig["partner"],advEntityId:iasConfig["adv_entity_id"],pubEntityId:iasConfig["pub_entity_id"],creativeId:placementConfig["placement-hash"],campId:placementConfig["campaign-id"],placementId:placementConfig["placements-group-id"],impId:this.sessionId,debug:{enabled:false}};};return IasConfigComposer;})();IV.IasConfigComposer=IasConfigComposer;})(IV||(IV={}));
var IV;(function(IV){var IasInstanceProxy=(function(){function IasInstanceProxy(fwConfig,adNode,iasInstance){this.initStartTime=0;this.totalTimeToDecision=0;this.fwConfig=fwConfig;this.adNode=adNode;this.iasInstance=iasInstance;}
Object.defineProperty(IasInstanceProxy,"IAS_INSTANCE_CLASS_NAME",{get:function(){return"__IASVANS";},enumerable:true,configurable:true});IasInstanceProxy.prototype.initFW=function(blockingCb){var _this=this;if(typeof this.iasInstance==="undefined"||this.iasInstance===null){this.iasInstance=new IV[IasInstanceProxy.IAS_INSTANCE_CLASS_NAME]();}
this.initStartTime=new Date().getTime();this.iasInstance.initFW(this.fwConfig,this.adNode,function(result){_this.calculateTotalTimeToDecision();blockingCb(result);});};IasInstanceProxy.prototype.sendEvent=function(eventName,params){this.iasInstance.sendEvent(eventName,params);};IasInstanceProxy.prototype.getTotalTimeToDecision=function(){if(this.totalTimeToDecision===0){this.calculateTotalTimeToDecision();}
return this.totalTimeToDecision;};IasInstanceProxy.prototype.calculateTotalTimeToDecision=function(){this.totalTimeToDecision=new Date().getTime()-this.initStartTime;};return IasInstanceProxy;})();IV.IasInstanceProxy=IasInstanceProxy;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var IasIntegrationDiagnosticReporter=(function(_super){__extends(IasIntegrationDiagnosticReporter,_super);function IasIntegrationDiagnosticReporter(reporter,moduleName,config){_super.call(this,reporter);this.moduleName=moduleName;this.config=config;this.registerDiagnosticEvents();}
Object.defineProperty(IasIntegrationDiagnosticReporter,"INIT_EVENT_CODE",{get:function(){return"inn_init";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationDiagnosticReporter,"IMPRESSION_EVENT_CODE",{get:function(){return"inn_ai";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationDiagnosticReporter,"MONITOR_PARAMS_ARRAY",{get:function(){return[{DOMAIN:"https://spixel.adsafeprotected.com",AN_ID:"10173"}];},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationDiagnosticReporter,"VANS_VERSION_NUMBER",{get:function(){return"3.5.0";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationDiagnosticReporter,"BASE_TEMPLATE_URL",{get:function(){return"<%= DOMAIN %>/mon?anId=<%= AN_ID %>";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationDiagnosticReporter,"TEMPLATE_PARAMS",{get:function(){return"&campId=innovid&"+"pubId=<%= EVENT_CODE %>&"+"planId=<%= ADV_ENTITY_ID %>&"+"placementId=<%= PUB_ENTITY_ID %>&"+"advId=<%= INNOVID_CAMPAIGN_ID %>&"+"pubOrder=<%= INNOVID_PLACEMENT_ID %>&"+"pubCreative=<%= INNOVID_CREATIVE_ID %>&"+"impId=<%= INNOVID_SESSION_ID %>&"+"ts=<%= TIMESTAMP %>&"+"custom=<%= VANS_VERSION_NUMBER %>&"+"custom2=jv3&"+"adsafe_par";},enumerable:true,configurable:true});IasIntegrationDiagnosticReporter.prototype.registerDiagnosticEvents=function(){var _this=this;IasIntegrationDiagnosticReporter.MONITOR_PARAMS_ARRAY.forEach(function(monitorParams){var compiledTemplate=_.template(IasIntegrationDiagnosticReporter.BASE_TEMPLATE_URL);var templateUrl=compiledTemplate(monitorParams);_this.addDiagnosticPixel(_this.moduleName,IasIntegrationDiagnosticReporter.INIT_EVENT_CODE,templateUrl+IasIntegrationDiagnosticReporter.TEMPLATE_PARAMS);_this.addDiagnosticPixel(_this.moduleName,IasIntegrationDiagnosticReporter.IMPRESSION_EVENT_CODE,templateUrl+IasIntegrationDiagnosticReporter.TEMPLATE_PARAMS);});};IasIntegrationDiagnosticReporter.prototype.reportEvent=function(eventName){var availableEventNames=[IasIntegrationDiagnosticReporter.INIT_EVENT_CODE,IasIntegrationDiagnosticReporter.IMPRESSION_EVENT_CODE];if(_.contains(availableEventNames,eventName)){var data={EVENT_CODE:eventName,ADV_ENTITY_ID:this.config.advEntityId,PUB_ENTITY_ID:this.config.pubEntityId,INNOVID_CAMPAIGN_ID:this.config.campId,INNOVID_PLACEMENT_ID:this.config.placementId,INNOVID_CREATIVE_ID:this.config.creativeId,INNOVID_SESSION_ID:this.config.impId,TIMESTAMP:new Date().getTime().toString(10),VANS_VERSION_NUMBER:IasIntegrationDiagnosticReporter.VANS_VERSION_NUMBER};this.reportDiagnosticEvent(this.moduleName,eventName,data);}};return IasIntegrationDiagnosticReporter;})(IV.IntegrationDiagnosticReporter);IV.IasIntegrationDiagnosticReporter=IasIntegrationDiagnosticReporter;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var IasIntegrationLoader=(function(_super){__extends(IasIntegrationLoader,_super);function IasIntegrationLoader(vpaidWrapper,irollReporter,iframeInjector,iasRunner,diagnosticReporter){_super.call(this,vpaidWrapper,irollReporter,iframeInjector);this.iasRunner=iasRunner;}
Object.defineProperty(IasIntegrationLoader,"IMPRESSION_EVENT_NAME",{get:function(){return"ias-impression";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationLoader,"TIMEOUT_ERROR_EVENT_ID",{get:function(){return"ias-not-loaded";},enumerable:true,configurable:true});IasIntegrationLoader.prototype.buildInjectionContent=function(targetWindow){var _this=this;this.injection.setInjection(function(){return _this.iasRunner;});targetWindow[IasIntegrationLoader.INTEGRATION_CALLBACK_NAME]=function(){return _this.injection.inject();};return"\n<body onload=\"start()\">\n    <script>\n        function start() {\n            var runner = "+this.randomIframeContextName+"."+IasIntegrationLoader.INTEGRATION_CALLBACK_NAME+"();\n            runner.run();\n        }\n    </script>\n</body>";};IasIntegrationLoader.prototype.timeoutErrorEventId=function(){return IasIntegrationLoader.TIMEOUT_ERROR_EVENT_ID;};IasIntegrationLoader.prototype.impressionEventId=function(){return IasIntegrationLoader.IMPRESSION_EVENT_NAME;};return IasIntegrationLoader;})(IV.IframeIntegrationLoader);IV.IasIntegrationLoader=IasIntegrationLoader;})(IV||(IV={}));
var IV;(function(IV){var IasIntegrationRunner=(function(){function IasIntegrationRunner(vpaidEventsHandler,blockingHandler,reporter,diagnosticReporter,iasInstanceProxy){this.vpaidEventsHandler=vpaidEventsHandler;this.blockingHandler=blockingHandler;this.reporter=reporter;this.diagnosticReporter=diagnosticReporter;this.iasInstanceProxy=iasInstanceProxy;}
Object.defineProperty(IasIntegrationRunner,"INIT_EVENT_NAME",{get:function(){return"ias-init-fw";},enumerable:true,configurable:true});Object.defineProperty(IasIntegrationRunner,"INIT_RESULT",{get:function(){return{SUCCESS:"succeed",FAIL:"failed"};},enumerable:true,configurable:true});IasIntegrationRunner.prototype.run=function(){var _this=this;try{this.vpaidEventsHandler.startListening(this.iasInstanceProxy,this.blockingHandler);this.iasInstanceProxy.initFW(function(result){return _this.blockingHandler.onDecisionMade(result);});this.reportInitFwSuccess(true);}
catch(e){this.reportInitFwSuccess(false,e.message);}};IasIntegrationRunner.prototype.reportInitFwSuccess=function(success,value){this.diagnosticReporter.reportEvent(IV.IasIntegrationDiagnosticReporter.INIT_EVENT_CODE);this.reporter.reportLog({event_id:IasIntegrationRunner.INIT_EVENT_NAME,event_value:success?IasIntegrationRunner.INIT_RESULT.SUCCESS:IasIntegrationRunner.INIT_RESULT.FAIL+": "+value});};return IasIntegrationRunner;})();IV.IasIntegrationRunner=IasIntegrationRunner;})(IV||(IV={}));
var IV;(function(IV){var IasVpaidEventsHandler=(function(){function IasVpaidEventsHandler(vpaidWrapper,reporter,diagnosticReporter){this.sendImpressionOnce=function(){};this.vpaidWrapper=vpaidWrapper;this.reporter=reporter;this.diagnosticReporter=diagnosticReporter;}
Object.defineProperty(IasVpaidEventsHandler,"IAS_SEND_EVENT_ERROR",{get:function(){return"ias-send-event-error";},enumerable:true,configurable:true});Object.defineProperty(IasVpaidEventsHandler,"IAS_IMPRESSION_INTEGRAL_DID_BLOCK_VALUE",{get:function(){return"ias-integral_didBlock-value";},enumerable:true,configurable:true});Object.defineProperty(IasVpaidEventsHandler,"IAS_IMPRESSION_INTEGRAL_TIME_TO_DECISION_VALUE",{get:function(){return"ias-integral_timeToDecision-value";},enumerable:true,configurable:true});IasVpaidEventsHandler.prototype.startListening=function(iasInstanceProxy,iasBlockingHandler){var _this=this;this.iasInstanceProxy=iasInstanceProxy;this.iasBlockingHandler=iasBlockingHandler;this.sendImpressionOnce=_.once(function(){var params={volume:_this.getVolume(),ad_duration:_this.getDuration(),integral_didBlock:_this.iasBlockingHandler.wasDecisionUsedAndWasBlock(),integral_timeToDecision:_this.iasInstanceProxy.getTotalTimeToDecision()};_this.sendEvent(IV.VpaidEvents.AD_IMPRESSION,params);_this.diagnosticReporter.reportEvent(IV.IasIntegrationDiagnosticReporter.IMPRESSION_EVENT_CODE);_this.reporter.reportLog({event_id:IasVpaidEventsHandler.IAS_IMPRESSION_INTEGRAL_DID_BLOCK_VALUE,event_value:_this.iasBlockingHandler.wasDecisionUsedAndWasBlock().toString()});_this.reporter.reportLog({event_id:IasVpaidEventsHandler.IAS_IMPRESSION_INTEGRAL_TIME_TO_DECISION_VALUE,event_value:_this.iasInstanceProxy.getTotalTimeToDecision().toString()});});this.vpaidWrapper.subscribe(function(){return _this.adLoaded();},IV.VpaidEvents.AD_LOADED);this.vpaidWrapper.subscribe(function(){return _this.adStarted();},IV.VpaidEvents.AD_STARTED);this.vpaidWrapper.subscribe(function(){return _this.adStopped();},IV.VpaidEvents.AD_STOPPED);this.vpaidWrapper.subscribe(function(){return _this.adSkipped();},IV.VpaidEvents.AD_SKIPPED);this.vpaidWrapper.subscribe(function(){return _this.adSkippableStateChange();},IV.VpaidEvents.AD_SKIPPABLE_CHANGE);this.vpaidWrapper.subscribe(function(){return _this.adDurationChange();},IV.VpaidEvents.AD_DURATION_CHANGE);this.vpaidWrapper.subscribe(function(){return _this.adVolumeChange();},IV.VpaidEvents.AD_VOLUME_CHANGE);this.vpaidWrapper.subscribe(function(){return _this.adImpression();},IV.VpaidEvents.AD_IMPRESSION);this.vpaidWrapper.subscribe(function(){return _this.adVideoStart();},IV.VpaidEvents.AD_VIDEO_START);this.vpaidWrapper.subscribe(function(){return _this.adVideoFirstQuartile();},IV.VpaidEvents.AD_VIDEO_FIRST_QUARTILE);this.vpaidWrapper.subscribe(function(){return _this.adVideoMidpoint();},IV.VpaidEvents.AD_VIDEO_MIDPOINT);this.vpaidWrapper.subscribe(function(){return _this.adVideoThirdQuartile();},IV.VpaidEvents.AD_VIDEO_THIRD_QUARTILE);this.vpaidWrapper.subscribe(function(){return _this.adVideoComplete();},IV.VpaidEvents.AD_VIDEO_COMPLETE);this.vpaidWrapper.subscribe(function(url,id,playerHandles){return _this.adClickThru(url,id,playerHandles);},IV.VpaidEvents.AD_CLICK_THRU);this.vpaidWrapper.subscribe(function(){return _this.adPaused();},IV.VpaidEvents.AD_PAUSED);this.vpaidWrapper.subscribe(function(){return _this.adPlaying();},IV.VpaidEvents.AD_PLAYING);this.vpaidWrapper.subscribe(function(){return _this.adError();},IV.VpaidEvents.AD_ERROR);this.vpaidWrapper.subscribe(function(){return _this.adSizeChange();},IV.VpaidEvents.AD_SIZE_CHANGE);};IasVpaidEventsHandler.prototype.adLoaded=function(){this.sendPureEvent(IV.VpaidEvents.AD_LOADED);};IasVpaidEventsHandler.prototype.adStarted=function(){this.sendPureEvent(IV.VpaidEvents.AD_STARTED);};IasVpaidEventsHandler.prototype.adStopped=function(){this.sendPureEvent(IV.VpaidEvents.AD_STOPPED);};IasVpaidEventsHandler.prototype.adSkipped=function(){this.sendPureEvent(IV.VpaidEvents.AD_SKIPPED);};IasVpaidEventsHandler.prototype.adSkippableStateChange=function(){this.sendPureEvent(IV.VpaidEvents.AD_SKIPPABLE_CHANGE);};IasVpaidEventsHandler.prototype.adDurationChange=function(){this.sendPureEvent(IV.VpaidEvents.AD_DURATION_CHANGE);};IasVpaidEventsHandler.prototype.adVolumeChange=function(){this.sendPureEvent(IV.VpaidEvents.AD_VOLUME_CHANGE);};IasVpaidEventsHandler.prototype.adImpression=function(){this.sendImpressionEvent();};IasVpaidEventsHandler.prototype.adVideoStart=function(){this.sendPureEvent(IV.VpaidEvents.AD_VIDEO_START);};IasVpaidEventsHandler.prototype.adVideoFirstQuartile=function(){this.sendPureEvent(IV.VpaidEvents.AD_VIDEO_FIRST_QUARTILE);};IasVpaidEventsHandler.prototype.adVideoMidpoint=function(){this.sendPureEvent(IV.VpaidEvents.AD_VIDEO_MIDPOINT);};IasVpaidEventsHandler.prototype.adVideoThirdQuartile=function(){this.sendPureEvent(IV.VpaidEvents.AD_VIDEO_THIRD_QUARTILE);};IasVpaidEventsHandler.prototype.adVideoComplete=function(){this.sendPureEvent(IV.VpaidEvents.AD_VIDEO_COMPLETE);};IasVpaidEventsHandler.prototype.adClickThru=function(url,id,playerHandles){this.sendClickThruEvent(url,id,playerHandles);};IasVpaidEventsHandler.prototype.adPaused=function(){this.sendPureEvent(IV.VpaidEvents.AD_PAUSED);};IasVpaidEventsHandler.prototype.adPlaying=function(){this.sendPureEvent(IV.VpaidEvents.AD_PLAYING);};IasVpaidEventsHandler.prototype.adError=function(){this.sendPureEvent(IV.VpaidEvents.AD_ERROR);};IasVpaidEventsHandler.prototype.adSizeChange=function(){this.sendAdSizeChangeEvent();};IasVpaidEventsHandler.prototype.getVolume=function(){return this.vpaidWrapper.getAdVolume();};IasVpaidEventsHandler.prototype.getDuration=function(){return this.vpaidWrapper.getAdDuration();};IasVpaidEventsHandler.prototype.getWidth=function(){return this.vpaidWrapper.getAdWidth();};IasVpaidEventsHandler.prototype.getHeight=function(){return this.vpaidWrapper.getAdHeight();};IasVpaidEventsHandler.prototype.sendImpressionEvent=function(){this.sendImpressionOnce();};IasVpaidEventsHandler.prototype.sendClickThruEvent=function(url,id,playerHandles){var params={volume:this.getVolume(),ad_duration:this.getDuration(),url:url,id:id,playerHandles:playerHandles};this.sendEvent(IV.VpaidEvents.AD_CLICK_THRU,params);};IasVpaidEventsHandler.prototype.sendAdSizeChangeEvent=function(){var params={volume:this.getVolume(),ad_duration:this.getDuration(),width:this.getWidth(),height:this.getHeight(),viewMode:IasVpaidEventsHandler.VIEW_MODE};this.sendEvent(IV.VpaidEvents.AD_SIZE_CHANGE,params);};IasVpaidEventsHandler.prototype.sendPureEvent=function(eventName){var params={volume:this.getVolume(),ad_duration:this.getDuration()};this.sendEvent(eventName,params);};IasVpaidEventsHandler.prototype.sendEvent=function(eventName,params){try{this.iasInstanceProxy.sendEvent(eventName,params);}
catch(e){this.reporter.reportLog({event_id:IasVpaidEventsHandler.IAS_SEND_EVENT_ERROR,event_value:e.message});}};IasVpaidEventsHandler.VIEW_MODE="normal";return IasVpaidEventsHandler;})();IV.IasVpaidEventsHandler=IasVpaidEventsHandler;})(IV||(IV={}));
var IV;(function(IV){var VerificationBlockingConfig=(function(){function VerificationBlockingConfig(decisionHandler,timeoutHandler,useRealBlocking,irollReporter,integrationName){this._decisionHandler=decisionHandler;this._timeoutHandler=timeoutHandler;this._useRealBlocking=useRealBlocking;this._irollReporter=irollReporter;this._integrationName=integrationName;}
Object.defineProperty(VerificationBlockingConfig.prototype,"decisionHandler",{get:function(){return this._decisionHandler;},enumerable:true,configurable:true});Object.defineProperty(VerificationBlockingConfig.prototype,"timeoutHandler",{get:function(){return this._timeoutHandler;},enumerable:true,configurable:true});Object.defineProperty(VerificationBlockingConfig.prototype,"useRealBlocking",{get:function(){return this._useRealBlocking;},enumerable:true,configurable:true});Object.defineProperty(VerificationBlockingConfig.prototype,"irollReporter",{get:function(){return this._irollReporter;},enumerable:true,configurable:true});Object.defineProperty(VerificationBlockingConfig.prototype,"integrationName",{get:function(){return this._integrationName;},enumerable:true,configurable:true});return VerificationBlockingConfig;})();IV.VerificationBlockingConfig=VerificationBlockingConfig;})(IV||(IV={}));
var IV;(function(IV){var VerificationBlockingDecisionHandler=(function(){function VerificationBlockingDecisionHandler(irollReporter,vpaidWrapper){this.decisionMade=false;this.irollReporter=irollReporter;this.vpaidWrapper=vpaidWrapper;this.registerToAdVideoComplete();}
Object.defineProperty(VerificationBlockingDecisionHandler,"AD_COMPLETE_EVENT_VALUE",{get:function(){return"ad_complete";},enumerable:true,configurable:true});VerificationBlockingDecisionHandler.prototype.decisionWasOnTime=function(decision){this.decisionMade=true;this.irollReporter.reportLog({event_id:this.blockingDecisionEventIdPrefix()+"-on-time",event_value:this.toDecisionString(decision)});};VerificationBlockingDecisionHandler.prototype.decisionWasTooLate=function(decision,totalTime){this.decisionMade=true;this.irollReporter.reportLog({event_id:this.blockingDecisionEventIdPrefix()+"-after-timeout-total",event_value:totalTime.toString()});this.irollReporter.reportLog({event_id:this.blockingDecisionEventIdPrefix()+"-after-timeout-value",event_value:this.toDecisionString(decision)});};VerificationBlockingDecisionHandler.prototype.isDecisionMade=function(){return this.decisionMade;};VerificationBlockingDecisionHandler.prototype.toDecisionString=function(decision){return decision.toString();};VerificationBlockingDecisionHandler.prototype.registerToAdVideoComplete=function(){var _this=this;this.vpaidWrapper.subscribe(function(){return _this.onAdComplete();},"AdVideoComplete",this);};VerificationBlockingDecisionHandler.prototype.onAdComplete=function(){if(!this.isDecisionMade()){this.irollReporter.reportLog({event_id:this.blockingDecisionEventIdPrefix()+"-not-made",event_value:VerificationBlockingDecisionHandler.AD_COMPLETE_EVENT_VALUE});}};return VerificationBlockingDecisionHandler;})();IV.VerificationBlockingDecisionHandler=VerificationBlockingDecisionHandler;})(IV||(IV={}));
var IV;(function(IV){var VerificationBlockingHandler=(function(){function VerificationBlockingHandler(verificationBlockingConfig){this.blockAd=false;this.startTime=0;this.decisionTime=0;this.adStarted=false;this.decisionHandler=verificationBlockingConfig.decisionHandler;this.timeoutHandler=verificationBlockingConfig.timeoutHandler;this.useRealBlocking=verificationBlockingConfig.useRealBlocking;this.irollReporter=verificationBlockingConfig.irollReporter;this.integrationName=verificationBlockingConfig.integrationName;}
VerificationBlockingHandler.prototype.waitForBlockingDecisionOrTimeout=function(postWaitCallback){this.postWaitCallback=postWaitCallback;if(this.decisionHandler.isDecisionMade()||this.timeoutHandler.isTimeoutOccurred()){this.timeoutHandler.stopTimer();this.postWaitCallback();}};VerificationBlockingHandler.prototype.shouldBlockAd=function(){if(this.blockAd){return this.useRealBlocking;}
return false;};VerificationBlockingHandler.prototype.onDecisionMade=function(decision){this.decisionTime=new Date().getTime();this.blockAd=this.decisionHandler.shouldBlockAd(decision);if(!this.isAdStarted()){this.timeoutHandler.stopTimer();this.decisionHandler.decisionWasOnTime(decision);if(this.postWaitCallback&&!this.timeoutHandler.isTimeoutOccurred()){this.postWaitCallback();}}
else{this.decisionHandler.decisionWasTooLate(decision,this.decisionTime-this.startTime);}};VerificationBlockingHandler.prototype.startTimeoutTimer=function(){var _this=this;this.startTime=new Date().getTime();this.timeoutHandler.startTimer(function(){if(_this.postWaitCallback){_this.postWaitCallback();}});};VerificationBlockingHandler.prototype.notifyAdStarted=function(){this.adStarted=true;if(!this.decisionHandler.isDecisionMade()&&this.timeoutHandler.isTimeoutOccurred()){this.reportBlockingDecisionTimedOut();}};VerificationBlockingHandler.prototype.eventIdForBlockingTimeout=function(){return this.integrationName+"-blocking-timeout";};VerificationBlockingHandler.prototype.reportBlockingDecisionTimedOut=function(){this.irollReporter.reportLog({event_id:this.eventIdForBlockingTimeout(),event_value:this.timeoutHandler.getTimeoutValueMs().toString()});};VerificationBlockingHandler.prototype.isAdStarted=function(){return this.adStarted;};return VerificationBlockingHandler;})();IV.VerificationBlockingHandler=VerificationBlockingHandler;})(IV||(IV={}));
var IV;(function(IV){var VerificationBlockingTimeoutHandler=(function(){function VerificationBlockingTimeoutHandler(timeoutMs){this.timeoutOccurred=false;this.timeoutMs=timeoutMs;}
VerificationBlockingTimeoutHandler.prototype.startTimer=function(onTimeoutCallback){var _this=this;this.timerId=setTimeout(function(){_this.timeoutOccurred=true;_this.timerId=null;onTimeoutCallback();},this.timeoutMs);};VerificationBlockingTimeoutHandler.prototype.stopTimer=function(){if(this.timerId){clearTimeout(this.timerId);this.timerId=null;}};VerificationBlockingTimeoutHandler.prototype.isTimeoutOccurred=function(){return this.timeoutOccurred;};VerificationBlockingTimeoutHandler.prototype.getTimeoutValueMs=function(){return this.timeoutMs;};return VerificationBlockingTimeoutHandler;})();IV.VerificationBlockingTimeoutHandler=VerificationBlockingTimeoutHandler;})(IV||(IV={}));
;
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var IasBlockingDecisionHandler=(function(_super){__extends(IasBlockingDecisionHandler,_super);function IasBlockingDecisionHandler(){_super.apply(this,arguments);}
Object.defineProperty(IasBlockingDecisionHandler,"BLOCKING_DECISION_EVENT_ID",{get:function(){return"ias-blocking-decision";},enumerable:true,configurable:true});Object.defineProperty(IasBlockingDecisionHandler,"BLOCKING_DECISION",{get:function(){return{BLOCK:"block",ALLOW:"safe"};},enumerable:true,configurable:true});IasBlockingDecisionHandler.prototype.shouldBlockAd=function(decision){return decision===IasBlockingDecisionHandler.BLOCKING_DECISION.BLOCK;};IasBlockingDecisionHandler.prototype.blockingDecisionEventIdPrefix=function(){return IasBlockingDecisionHandler.BLOCKING_DECISION_EVENT_ID;};return IasBlockingDecisionHandler;})(IV.VerificationBlockingDecisionHandler);IV.IasBlockingDecisionHandler=IasBlockingDecisionHandler;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var IasBlockingHandler=(function(_super){__extends(IasBlockingHandler,_super);function IasBlockingHandler(verificationBlockingConfig,iasVpaidEventsHandler,vpaidWrapper){_super.call(this,verificationBlockingConfig);this.decisionUsedAndWasBlock=false;this.iasVpaidEventsHandler=iasVpaidEventsHandler;this.vpaidWrapper=vpaidWrapper;}
IasBlockingHandler.prototype.onDecisionMade=function(decision){var _this=this;var adStarted=this.isAdStarted();_super.prototype.onDecisionMade.call(this,decision);if(this.blockAd&&!adStarted){this.decisionUsedAndWasBlock=true;this.vpaidWrapper.subscribe(function(){return _this.iasVpaidEventsHandler.sendImpressionEvent();},"AdStarted");}};IasBlockingHandler.prototype.wasDecisionUsedAndWasBlock=function(){return this.decisionUsedAndWasBlock;};return IasBlockingHandler;})(IV.VerificationBlockingHandler);IV.IasBlockingHandler=IasBlockingHandler;})(IV||(IV={}));
var IV;(function(IV){var IasNonBlockingHandler=(function(){function IasNonBlockingHandler(){}
IasNonBlockingHandler.prototype.onDecisionMade=function(decision){};IasNonBlockingHandler.prototype.wasDecisionUsedAndWasBlock=function(){return false;};return IasNonBlockingHandler;})();IV.IasNonBlockingHandler=IasNonBlockingHandler;})(IV||(IV={}));
(function(SCOPE){SCOPE.__IASVANS=function(x){var c={now:function(){return(new Date).getTime()},sendMonitoringPixel:function(b){try{this.sendUrlRequest(["//pixel.adsafeprotected.com/mon?anId=10173&campId=",encodeURIComponent(l.getPartnerId()),"&pubId=",encodeURIComponent("vans-js_"+b)].join(""))}catch(a){k.report("smp",a)}},sendMonitoringDebugPixel:function(){var b=["adstop"],a={};return function(h,f){var g=l.hasDebugEnabled(),e=-1<b.indexOf(h)&&a[h];if(g&&!e)try{var d=l.getAltMonDomain(),t=c.addProtocolToDomain("spixel.adsafeprotected.com")+"/mon?anId=10173&campId="+encodeURIComponent(l.getPartnerId())+"&pubId=",p=c.addProtocolToDomain(d)+"/mon?anId=925116&campId="+encodeURIComponent(l.getPartnerId())+"&pubId=",r=encodeURIComponent(h),q;q=f.replace(/=undefined&/g,"=&");this.sendUrlRequest([t,r,q].join(""));this.sendUrlRequest([p,r,q].join(""));a[h]=!0}catch(n){k.report("smp",n)}}}(),sendUrlRequest:function(b,a){var c,f;if(b){c=this.getWindow();try{f=new c.XMLHttpRequest,a&&(f.onreadystatechange=a),f.open("GET",b),f.send()}catch(g){}}},stringify:function(b){if("AdImpression"!==b.messageType)return JSON.stringify(b);var a={};a.passthroughObj=l.getPassThroughObj();var c="";try{c=JSON.stringify(b)}catch(f){k.report("ser",f,a);return}return c},addProtocolToDomain:function(b){return b.match(/^[a-zA-Z]+:\/\//)?b:"https://"+b},getWindow:function(){return u.getWin()},getDocument:function(){return u.getDoc()},generateUID:function(){var b,a="";try{for(b=0;8>b;b++)a=[a,Math.floor(65536*(1+Math.random())).toString(16).substring(1)].join("")}catch(c){}return a},noop:function(){}},k=function(){var b={};return{report:function(a,h,f){if(!b[a])try{b[a]=!0;var g="//pixel.adsafeprotected.com/jsdiagnostic?code:vans-js_"+encodeURIComponent(l.getPartnerId())+"_"+a+"&err:"+encodeURIComponent(h.message);f&&(g+="&config:"+encodeURIComponent(JSON.stringify(f)));c.sendUrlRequest(g)}catch(e){}}}}(),s=function(){var b,a=!1,h=function(g,b){g==f()&&(a=!0,m.setImpressionCallback(b),c.sendMonitoringDebugPixel("hs",m.monitoringQS()),m.flushUnsentEvents());return a?"jv3":null},f=function(){b||(b=c.generateUID());return b};return{getVideoId:f,setNodeInterface:function(a){var b,d,t,p=f();try{b="IASid"+p,d="blockAd"+p,t="getIasVidBridgeVersion"+p,a.className+=" integral-vid-"+p,a[d]=c.noop,a[b]=h,a[t]=function(){return"2"},a.getVersion=function(){return"3.5.0"}}catch(r){k.report("sni",r)}},isEstablished:function(){return a},resetHandshake:function(){a=!1}}}(),C=function(){var b,a=function(){var a=function(a){return"undefined"!==typeof a},b=function(){var b="u";try{a(window.opera)&&a(window.opera.buildNumber)?b="o":a(window.mozInnerScreenY)?b="g":a(window.chrome)&&a(window.chrome.csi)?b="c":a(window.msWriteProfilerMark)&&a(window.crypto)?b="e":a(window.attachEvent)||a(window.msCrypto)?b="i":a(window.WebKitPoint)&&(b="w")}catch(c){}return b}(),c=function(){var b=function(b){for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];""!==e&&"null"!==e&&"undefined"!==e&&null!==e&&a(e)||delete b[c]}return b},c=function(b){var c={},e,d;for(d in b)b.hasOwnProperty(d)&&(e=b[d],a(c[e])?c[e]+=d:c[e]=d);b={};for(d in c)c.hasOwnProperty(d)&&(e=c[d],b[e]=d);return b};return function(){var e=function(){var b={g:"",q:""};try{b.q=window.parent.parent.parent.parent.parent.parent.parent.parent.parent.parent.location.href}catch(v){var c=v.message,c=c.substring(c.lastIndexOf("<")+1,c.lastIndexOf(">")),d;if(d=a(c))if(d=!1,a(window.navigator)&&a(window.navigator.userAgent)){var e=window.navigator.userAgent.match(/Firefox\/([\.0-9]+)/);null!==e&&2==e.length&&(e=e[1].split("."),3==parseInt(e[0],10)&&6>=parseInt(e[1],10)&&(3==e.length?13>=parseInt(e[2],10)&&(d=!0):d=!0))}d&&(b.g=c)}return b},d={};try{d.a=encodeURIComponent(top.location.href)}catch(f){}try{d.b=encodeURIComponent(parent.location.href)}catch(h){}if(window!=top){try{d.c=encodeURIComponent(parent.document.referrer)}catch(k){}try{d.e=encodeURIComponent(window.document.referrer)}catch(m){}}try{d.d=encodeURIComponent(window.location.href)}catch(l){}try{var v=e();d.g=encodeURIComponent(v.g);d.q=encodeURIComponent(v.q)}catch(D){}var d=b(d),d=c(d),e=[],w;for(w in d)d.hasOwnProperty(w)&&e.push({key:w,val:d[w]});e.sort(function(a,b){return a.val.length>b.val.length?1:a.val.length<b.val.length?-1:0});return e}()}();return{br:b,urls:c}},h=function(a,b,c){var f=["//pixel.adsafeprotected.com/db2/video/",b,"/",c,"/skeleton.js?videoId=",s.getVideoId()].join("");b=function(a){f=[f,"&adsafe_url=",a.val,"&adsafe_type=",a.key].join("")};try{a.urls.forEach(b),f=[f,"&adsafe_jsinfo=br:",a.br].join("")}catch(h){k.report("bvu",h)}return f},f=function(){if(4==this.readyState)if(200==this.status)try{b("failed"===JSON.parse(this.responseText).action?"block":"safe")}catch(a){k.report("ba",a)}else k.report("blk_url_req_err",{message:this.status})};return{init:function(g,e,d){var k=a();g=h(k,g,e);b=d;c.sendUrlRequest(g,f)}}}(),m=function(){var b,a=[],h=!1,f=function(a){var b="";Object.keys(a).forEach(function(c){-1===["advEntityId","pubEntityId","partner","debug"].indexOf(c)&&(b+="&"+c+"="+a[c])});return b},g=function(e){if(s.isEstablished()){var d;try{if(d=c.stringify(e))if("AdImpression"===e.messageType)c.getWindow()[b](d);else c.getWindow().postMessage(d,"*")}catch(g){k.report("dm",g)}}else if(m.nodeProvided)try{a.push(e)}catch(h){k.report("cm",h)}else{d=x||"pixel.adsafeprotected.com";var l=m.config;try{c.stringify(e),"AdImpression"===e.messageType&&(m.isCmTag?c.sendUrlRequest(["//"+d,"/mon?",f(l)].join("")):m.isFwTag&&c.sendUrlRequest(["//"+d,"/rfw/st/",l.advEntityId+"/"+l.pubEntityId,"/skeleton.js"].join("")))}catch(q){k.report("dm",q)}}};return{sendEvent:function(a,b){if("AdImpression"===a){if(h)return;b&&(b.ext_passthrough=m.passThroughObj);h=!0;c.sendMonitoringDebugPixel("ai",m.monitoringQS())}else"AdStopped"===a||"AdVideoComplete"===a?c.sendMonitoringDebugPixel("adstop",m.monitoringQS()):"AdError"===a&&c.sendMonitoringDebugPixel("aderr",m.monitoringQS());try{g({messageType:a,id:s.getVideoId(),time:c.now(),partner:l.getPartnerId(),eventData:b})}catch(f){k.report("se",f)}},setImpressionCallback:function(a){b=a},flushUnsentEvents:function(){try{a.forEach(g)}catch(b){k.report("fue",b)}},passThroughObj:{},monitoringQS:function(){},clearSessionState:function(){h=!1;a.length=0}}}(),l=function(){var b,a={},h,f,g={},e="impId creativeId campId placementId advEntityId pubEntityId chanId".split(" "),d=function(a,b){var c,d=x||"pixel.adsafeprotected.com",e=function(a){var b="";Object.keys(a).forEach(function(c){"advEntityId"!=c&&"pubEntityId"!=c&&"partner"!=c&&(b+="&"+c+"="+a[c])});return b};try{c=["//",d,a,"?videoId=",s.getVideoId(),e(b)].join("")}catch(f){k.report("bsurl",f)}return c},l=function(a,b){var d,e=!1,f=function(){!e&&a.parentNode&&(a.parentNode.appendChild(b),clearInterval(d),e=!0,c.sendMonitoringDebugPixel("fwjsinj",n()))};f();e||(d=setInterval(f,200))},p=function(a,b,e){var f,g=c.getDocument(),h=function(a){c.sendMonitoringDebugPixel("fwjsload",n())},k=function(a){c.sendMonitoringDebugPixel("fwjsload_err",n())};try{f=g.createElement("script"),f.src=d(a,b),f.addEventListener("load",h),f.addEventListener("error",k),l(e,f)}catch(m){c.sendMonitoringPixel("inj_err")}},r=function(a,b,c){s.setNodeInterface(c);var d={};Object.getOwnPropertyNames(b).forEach(function(a){"debug"!==a&&(d[a]=b[a])});p(a,d,c)},q=function(b){e.forEach(function(c){a[c]=b[c]});f&&(a.monDomain=b.debug.monDomain)},n=function(){return"&chanId="+a.chanId+"&planId="+a.advEntityId+"&placementId="+a.pubEntityId+"&advId="+a.campId+"&pubOrder="+a.placementId+"&pubCreative="+a.creativeId+"&impId="+a.impId+"&ts="+Date.now()+"&custom=3.5.0&custom2=jv3&custom3="+h+"&adsafe_par"},y=function(a){var b=a&&a.ownerDocument,d=a&&a.parentNode,e=b&&(b.defaultView||b.parentWindow),f="adnode_type_"+(a?a.constructor.name||a.nodeName:"null");a||c.sendMonitoringDebugPixel("adnode_null",n());a&&!d&&c.sendMonitoringDebugPixel("adnode_detached",n());a&&!b&&c.sendMonitoringDebugPixel("adnode_nodoc",n());b&&!e&&c.sendMonitoringDebugPixel("adnode_nowin",n());c.sendMonitoringDebugPixel(f,n())},z=function(){g.vv="3.5.0";g.vanstag=h;g.xcamp=a.campId;g.xplac=a.placementId;g.xcreat=a.creativeId;g.ximp=a.impId},A=function(a){a.monitoringQS=n;a.passThroughObj=g;Object.keys(a).forEach(function(b){m[b]=a[b]})},B=function(a){var b=(a=a&&a.ownerDocument)&&a.parentWindow;return!!(a&&a.defaultView||b)};return{initCM:function(a,d){var e=B(d);if(!a||!a.partner)throw Error("Missing partnerId");u.setWin(d);b=a.partner;f=a.debug&&a.debug.enabled;h="cm";try{if(!a.anId)throw Error("Missing anId");q(a);z();A({isFwTag:!1,isCmTag:!0,nodeProvided:e,config:a});c.sendMonitoringDebugPixel("init",n());y(d);e&&r("/jsvid",a,d)}catch(g){k.report("icm",g)}},initFW:function(a,d,e){var g,l=B(d);if(!a||!a.partner)throw Error("Missing partnerId");u.setWin(d);b=a.partner;f=a.debug&&a.debug.enabled;h="fw";try{if(!a.advEntityId||!a.pubEntityId)throw Error("Missing client id: advEntityId: "+a.advEntityId+" ,pubEntityId: "+a.pubEntityId);q(a);z();A({isFwTag:!0,isCmTag:!1,nodeProvided:l,config:a});c.sendMonitoringDebugPixel("init",n());y(d);e&&C.init(a.advEntityId,a.pubEntityId,e);l&&(g="/fwjsvid/st/"+a.advEntityId+"/"+a.pubEntityId+"/skeleton.js",r(g,a,d))}catch(m){k.report("ifw",m)}},getPartnerId:function(){return b},getPassThroughObj:function(){return g},getAltMonDomain:function(){return a.monDomain},hasDebugEnabled:function(){return f}}}(),u=function(){var b=window;return{getWin:function(){return b},setWin:function(a){(a=a&&a.ownerDocument)&&a.defaultView?b=a.defaultView:a&&a.parentWindow?b=a.parentWindow:k.report("sc",{message:""})},getDoc:function(){return b.document}}}();return{initFW:l.initFW,initCM:l.initCM,sendEvent:m.sendEvent}};})(IV);
(function(SCOPE){SCOPE.IasBlockingHandlerFactory=function(vpaidAd,integrationData){this.createHandler=function(){var iasConfig=SCOPE.baseData.app_data["service-config"]["integral"],timeoutMs=iasConfig["timeout"],useRealBlocking=iasConfig["useRealBlocking"];var decisionHandler=new SCOPE.IasBlockingDecisionHandler(integrationData.reporter,integrationData.vpaidWrapper),timeoutHandler=new SCOPE.VerificationBlockingTimeoutHandler(timeoutMs);var blockingHandlerConfig=new SCOPE.VerificationBlockingConfig(decisionHandler,timeoutHandler,useRealBlocking,integrationData.reporter,integrationData.integrationName);var blockingHandler=new SCOPE.IasBlockingHandler(blockingHandlerConfig,integrationData.vpaidEventsHandler,integrationData.vpaidWrapper);vpaidAd._overrideVerificationBlockingHandlerAndStartTimer(blockingHandler);return blockingHandler;};};})(IV);
(function(SCOPE){SCOPE.vpaidExtensions.register(function(vpaidAd){var INTEGRATION_NAME="ias";var reporter=vpaidAd.irollAd.report;var vpaidWrapper=new SCOPE.VPAIDAdWrapper(vpaidAd,INTEGRATION_NAME);var reportData=reporter.get("reportData");var fwConfig=new SCOPE.IasConfigComposer(reportData.session_id).compose(SCOPE.baseData);var diagnosticReporter=new IV.IasIntegrationDiagnosticReporter(reporter,INTEGRATION_NAME,fwConfig);var vpaidEventsHandler=new SCOPE.IasVpaidEventsHandler(vpaidWrapper,reporter,diagnosticReporter);var iasInstanceProxy=new SCOPE.IasInstanceProxy(fwConfig,vpaidWrapper.getPlayer()||vpaidWrapper.getSlot());var iframeInjector=new SCOPE.FriendlyIframeInjector(INTEGRATION_NAME,vpaidAd.slot);var integrationData={integrationName:INTEGRATION_NAME,reporter:reporter,vpaidWrapper:vpaidWrapper,vpaidEventsHandler:vpaidEventsHandler};var blockingHandler=new SCOPE.IasBlockingHandlerFactory(vpaidAd,integrationData).createHandler();var iasRunner=new SCOPE.IasIntegrationRunner(vpaidEventsHandler,blockingHandler,reporter,diagnosticReporter,iasInstanceProxy);var loader=new SCOPE.IasIntegrationLoader(vpaidWrapper,reporter,iframeInjector,iasRunner);loader.load(window,new IV.IframeInjection());},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD);})(IV);
(function(SCOPE){SCOPE.vpaidExtensions.register(function(vpaidAd){var adSlot=vpaidAd.slot;var wrapCreativeWithIframe=(isCustomFormat()&&shouldUseIframe()&&isSlotOnOtherDocument(adSlot))||isPreroll();vpaidAd.irollAd.set("wrapCreativeWithIframe",wrapCreativeWithIframe);var waitForCreativeToLoad=isCustomFormat()&&shouldWaitForLoad();vpaidAd.irollAd.set("waitForCreativeToLoad",waitForCreativeToLoad&&wrapCreativeWithIframe);if(wrapCreativeWithIframe){var mainScript=(isPreroll()?null:IV._currentScript),injector=new SCOPE.CreativeIframeScriptInjector(),listener=new SCOPE.CreativeIframeReadyListener(vpaidAd.irollAd),wrapper=new SCOPE.CreativeIframeWrapper(vpaidAd,adSlot.ownerDocument);var builder=new SCOPE.CreativeIframeBuilder(injector,wrapper,listener);var creativeIframe=builder.setInitialSize({width:vpaidAd.initialWidth,height:vpaidAd.initialHeight}).setContainerSlot(adSlot).setScript(mainScript).build();vpaidAd.irollAd.set("canvasAppender",new SCOPE.CreativeIframeCanvasAppender(vpaidAd.irollAd,creativeIframe));}},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD);function isCustomFormat(){return typeof SCOPE.baseData.app_data.custom==="object";}
function shouldUseIframe(){return SCOPE.baseData.app_data.custom.iframe===true;}
function shouldWaitForLoad(){return SCOPE.baseData.app_data.custom.waitForLoad===true;}
function isPreroll(){return SCOPE.baseData.app_data.isPreroll===true;}
function isSlotOnOtherDocument(adSlot){return adSlot&&adSlot.ownerDocument!==document;}})(IV);
var IV;(function(IV){var CreativeIframeBuilder=(function(){function CreativeIframeBuilder(injector,wrapper,listener){this.injector=injector;this.wrapper=wrapper;this.listener=listener;}
Object.defineProperty(CreativeIframeBuilder,"IFRAME_ID",{get:function(){return"iv-creative-iframe";},enumerable:true,configurable:true});CreativeIframeBuilder.prototype.setInitialSize=function(initialSize){this.initialSize=initialSize;return this;};CreativeIframeBuilder.prototype.setContainerSlot=function(container){this.container=container;return this;};CreativeIframeBuilder.prototype.setScript=function(script){this.script=script;return this;};CreativeIframeBuilder.prototype.build=function(){var creativeIframe=this.createIframe();this.appendToContainer(creativeIframe);this.listenToCreativeReadyState();this.injectBodyAndScript(creativeIframe);return creativeIframe;};CreativeIframeBuilder.prototype.createIframe=function(){if(!this.initialSize){throw Error("Missing iframe initial size");}
var creativeIframe=document.createElement("IFRAME");creativeIframe.id=CreativeIframeBuilder.IFRAME_ID;creativeIframe.width=this.initialSize.width+"px";creativeIframe.height=this.initialSize.height+"px";creativeIframe.style.left=creativeIframe.style.right="0px";creativeIframe.frameBorder="0";creativeIframe.style.padding=creativeIframe.style.margin="0";creativeIframe.style.backgroundColor="transparent";creativeIframe.scrolling="no";creativeIframe.allowFullscreen=true;return creativeIframe;};CreativeIframeBuilder.prototype.appendToContainer=function(creativeIframe){if(!this.container){throw Error("Missing container slot");}
this.wrapper.appendIframeTo(creativeIframe,this.container);};CreativeIframeBuilder.prototype.listenToCreativeReadyState=function(){this.listener.startCreativeOnReadyEvent();};CreativeIframeBuilder.prototype.injectBodyAndScript=function(creativeIframe){if(!!this.script){this.injector.injectBodyAndScriptInto(creativeIframe,this.script);}};return CreativeIframeBuilder;})();IV.CreativeIframeBuilder=CreativeIframeBuilder;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var CreativeIframeCanvasAppender=(function(_super){__extends(CreativeIframeCanvasAppender,_super);function CreativeIframeCanvasAppender(core,creativeIframe){_super.call(this,core);this.creativeIframe=creativeIframe;}
CreativeIframeCanvasAppender.prototype.getSize=function(){return{"width":parseInt(this.creativeIframe.width,10),"height":parseInt(this.creativeIframe.height,10)};};CreativeIframeCanvasAppender.prototype.appendToContainer=function(elem){this.creativeIframe.contentWindow.document.body.appendChild(elem);elem.style.width="100% !important";elem.style.height="100% !important";};return CreativeIframeCanvasAppender;})(IV.CanvasAppender);IV.CreativeIframeCanvasAppender=CreativeIframeCanvasAppender;})(IV||(IV={}));
var IV;(function(IV){var CreativeIframeReadyListener=(function(){function CreativeIframeReadyListener(core){var _this=this;this.startListenTime=0;this.customFormat=null;this.creativeSDK=null;this.irollReady=false;this.core=core;this.reporter=core.report;this.fireCoreInitializedOnce=_.once(function(){return _this.fireCoreInitialized();});this.startCreativeOnce=_.once(function(){return _this.startCreative();});}
Object.defineProperty(CreativeIframeReadyListener,"CREATIVE_IFRAME_LOAD_TIME_EVENT_ID",{get:function(){return"vpaid-creative-ifr-load-time";},enumerable:true,configurable:true});CreativeIframeReadyListener.prototype.startCreativeOnReadyEvent=function(){var _this=this;this.addOnCreativeReadyCallbackToMyself();IV.Events.on("CustomFormatReady",function(customFormat){if(!_this.core.shouldWaitForCreativeToLoad()){customFormat.preparePlay();customFormat.play();}
_this.customFormat=customFormat;if(_this.creativeSDK){_this.startCreativeOnce();}});IV.Events.on("IRollInit",function(){_this.irollReady=true;if(_this.shouldFireCoreInitialized()){_this.fireCoreInitializedOnce();}});this.startListenTime=new Date().getTime();};CreativeIframeReadyListener.prototype.addOnCreativeReadyCallbackToMyself=function(){var _this=this;IV["theCreativeIsReady"]=function(creativeSDK){_this.onCreativeReady(creativeSDK);};};CreativeIframeReadyListener.prototype.onCreativeReady=function(creativeSDK){this.creativeSDK=creativeSDK;if(this.shouldFireCoreInitialized()){this.fireCoreInitializedOnce();}
if(this.customFormat){this.startCreativeOnce();}};CreativeIframeReadyListener.prototype.shouldFireCoreInitialized=function(){return!!this.creativeSDK&&this.irollReady;};CreativeIframeReadyListener.prototype.fireCoreInitialized=function(){if(this.core.shouldWaitForCreativeToLoad()){this.core.set("initialized",true);IV.Events.trigger(this.core.get("id")+":core_initialized",this.core);}};CreativeIframeReadyListener.prototype.startCreative=function(){if(this.creativeSDK&&this.customFormat){this.reporter.reportLog({event_id:CreativeIframeReadyListener.CREATIVE_IFRAME_LOAD_TIME_EVENT_ID,event_value:(new Date().getTime()-this.startListenTime).toString()});this.creativeSDK.Events.trigger("StartCreative",this.customFormat);}};return CreativeIframeReadyListener;})();IV.CreativeIframeReadyListener=CreativeIframeReadyListener;})(IV||(IV={}));
var IV;(function(IV){var CreativeIframeScriptInjector=(function(){function CreativeIframeScriptInjector(){}
CreativeIframeScriptInjector.prototype.injectBodyAndScriptInto=function(creativeIframe,script){var ifrWin=creativeIframe.contentWindow;var ifrDoc=ifrWin.document;ifrDoc.open().write("<bo"+"dy>"+"<scr"+"ipt>\n                    var IVA = {\n                        onCreativeReady: function(sdk) { \n                            ivIfrCtx && ivIfrCtx.theCreativeIsReady(sdk); \n                        }\n                    };\n                </scr"+"ipt>"+"<scr"+"ipt type=\""+script.type+"\" src=\""+script.src+"\"></scr"+"ipt>"+"</bo"+"dy>");ifrDoc.close();ifrWin["ivIfrCtx"]=IV;};return CreativeIframeScriptInjector;})();IV.CreativeIframeScriptInjector=CreativeIframeScriptInjector;})(IV||(IV={}));
var IV;(function(IV){var CreativeIframeWrapper=(function(){function CreativeIframeWrapper(vpaidAd,contextDoc){this.vpaidAd=vpaidAd;this.contextDoc=contextDoc;}
Object.defineProperty(CreativeIframeWrapper,"MONITOR_INTERVAL_MS",{get:function(){return 250;},enumerable:true,configurable:true});Object.defineProperty(CreativeIframeWrapper,"CONTAINER_ID",{get:function(){return"iv-creative-iframe-container";},enumerable:true,configurable:true});Object.defineProperty(CreativeIframeWrapper,"FULLSCREEN_ATTRIBUTES",{get:function(){return["fullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","webkitFullscreenElement"];},enumerable:true,configurable:true});CreativeIframeWrapper.prototype.appendIframeTo=function(creativeIframe,elem){this.creativeIframe=creativeIframe;var container=document.createElement("DIV");container.id=CreativeIframeWrapper.CONTAINER_ID;$(container).css({width:"100%",height:"100%",position:"absolute",left:"0px",top:"0px"});container.appendChild(creativeIframe);elem.appendChild(container);this.monitorContainerSize(elem);};CreativeIframeWrapper.prototype.monitorContainerSize=function(container){var _this=this;this.vpaidAd.subscribe(function(){return _this.updateContainerSize(container);},"AdSizeChange",this);setInterval(function(){return _this.checkAdSize(container);},CreativeIframeWrapper.MONITOR_INTERVAL_MS);};CreativeIframeWrapper.prototype.updateContainerSize=function(container){$(container).width(this.vpaidAd.getAdWidth());$(container).height(this.vpaidAd.getAdHeight());this.checkAdSize(container);};CreativeIframeWrapper.prototype.checkAdSize=function(container){if(this.isFullscreen()){this.updateIframeSize(screen.width,screen.height);}
else{var containerWidth=$(container).width();var containerHeight=$(container).height();var iframeWidth=parseInt(this.creativeIframe.width,10);var iframeHeight=parseInt(this.creativeIframe.height,10);if(containerWidth!==iframeWidth||containerHeight!==iframeHeight){this.updateIframeSize(containerWidth,containerHeight);}}};CreativeIframeWrapper.prototype.isFullscreen=function(){return this.isFullscreenViewMode()||this.isDomFullscreen();};CreativeIframeWrapper.prototype.isFullscreenViewMode=function(){return this.vpaidAd.viewMode==="fullscreen";};CreativeIframeWrapper.prototype.isDomFullscreen=function(){var _this=this;return CreativeIframeWrapper.FULLSCREEN_ATTRIBUTES.some(function(fsAttr){return _this.contextDoc&&!!_this.contextDoc[fsAttr];});};CreativeIframeWrapper.prototype.updateIframeSize=function(width,height){this.creativeIframe.width=width+"px";this.creativeIframe.height=height+"px";};return CreativeIframeWrapper;})();IV.CreativeIframeWrapper=CreativeIframeWrapper;})(IV||(IV={}));
(function(SCOPE){SCOPE.VPAIDAdWrapper=function(vpaidAd,moduleName){this.handshakeVersion=function(){return vpaidAd.handshakeVersion();};this.subscribe=function(aCallback,eventName,aContext){if(typeof aContext==="undefined")aContext=this;vpaidAd.safeSubscribe(aCallback,eventName,aContext,moduleName);};this.unsubscribe=function(aCallback,eventName){vpaidAd.unsubscribe(aCallback,eventName);};this.getAdExpanded=function(){return vpaidAd.getAdExpanded();};this.getAdSize=function()
{return vpaidAd.getAdSize();};this.getAdSkippableState=function(){return vpaidAd.getAdSkippableState();};this.getAdWidth=function(){return vpaidAd.getAdWidth();};this.getAdHeight=function(){return vpaidAd.getAdHeight();};this.getAdCompanions=function(){return vpaidAd.getAdCompanions();};this.getAdIcons=function(){return vpaidAd.getAdIcons();};this.getAdLinear=function(){return vpaidAd.getAdLinear();};this.getAdVolume=function(){return vpaidAd.getAdVolume();};this.getAdDuration=function(){return vpaidAd.getAdDuration();};this.getAdRemainingTime=function(){return vpaidAd.getAdRemainingTime();};this.getPlayer=function(){var player=vpaidAd.videoSlot;return _.isElement(player)?player:null;};this.getSlot=function(){return vpaidAd.slot;};this.getPreviousEvents=function(){return vpaidAd.loggedEvents;};this.getViewMode=function(){return vpaidAd.viewMode;}};})(IV);
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var VpaidAdImpressionHandler=(function(_super){__extends(VpaidAdImpressionHandler,_super);function VpaidAdImpressionHandler(irollReporter){var _this=this;_super.call(this,VpaidAdImpressionHandler.IMPRESSION_ACTION_NAME);this.irollReporter=irollReporter;this.irollReporter.addPostReportedPixelCallback(function(){return _this.postFiredPixel();},VpaidAdImpressionHandler.IMPRESSION_ACTION_NAME);}
Object.defineProperty(VpaidAdImpressionHandler,"IMPRESSION_PIXEL_TIMEOUT_MS",{get:function(){return 5000;},enumerable:true,configurable:true});Object.defineProperty(VpaidAdImpressionHandler,"IMPRESSION_TIMEOUT_EVENT_ID",{get:function(){return"vpaid-impression-pixel-timeout";},enumerable:true,configurable:true});Object.defineProperty(VpaidAdImpressionHandler,"IMPRESSION_ACTION_NAME",{get:function(){return"play";},enumerable:true,configurable:true});Object.defineProperty(VpaidAdImpressionHandler,"IMPRESSION_PIXEL_OPTIONS",{get:function(){return{action:VpaidAdImpressionHandler.IMPRESSION_ACTION_NAME};},enumerable:true,configurable:true});;VpaidAdImpressionHandler.prototype.wasPixelFired=function(){return this.irollReporter.wasPixelReported(VpaidAdImpressionHandler.IMPRESSION_PIXEL_OPTIONS);};VpaidAdImpressionHandler.prototype.waitForImpressionPixelToBeReported=function(loadedCb){var _this=this;this.waitForPixelToFire(loadedCb);if(!this.pixelFired){setTimeout(function(){if(!_this.pixelFired){_this.irollReporter.reportLog({event_id:VpaidAdImpressionHandler.IMPRESSION_TIMEOUT_EVENT_ID,event_value:VpaidAdImpressionHandler.IMPRESSION_PIXEL_TIMEOUT_MS.toString()});}},VpaidAdImpressionHandler.IMPRESSION_PIXEL_TIMEOUT_MS);}};return VpaidAdImpressionHandler;})(IV.VpaidPixelLoadedHandler);IV.VpaidAdImpressionHandler=VpaidAdImpressionHandler;})(IV||(IV={}));
(function(SCOPE){SCOPE.vpaidExtensions.register(function(vpaidAd){var MODULE_NAME="innovid_viewability";var contextWindow=window;var globalCoreEventsId=vpaidAd.irollAd.get("id");var reporter=vpaidAd.irollAd.report;var isInApp=vpaidAd.irollAd.inAppDetector.isInApp();var SCREEN_OFFSET=isInApp?0:50;var vpaidWrapper=new SCOPE.VPAIDAdWrapper(vpaidAd,MODULE_NAME);var defaultViewabilityObject=new SCOPE.ViewabilityCheckResult();var geometryCalculator=new SCOPE.GeometryCalculator();var intersectionObserverCalculator=new SCOPE.IntersectionObserverCalculator(defaultViewabilityObject);var domObscuringCalculator=new IV.DomObscuringCalculator(document);var fullscreenHelper=new SCOPE.FullscreenHelper(SCREEN_OFFSET);var viewabilityCalculator=new SCOPE.ViewabilityCalculator(contextWindow,defaultViewabilityObject,geometryCalculator,intersectionObserverCalculator,domObscuringCalculator,fullscreenHelper);var adSizeChangeHelper=new SCOPE.ViewabilityAdSizeChangeHelper(contextWindow,vpaidWrapper,viewabilityCalculator,fullscreenHelper);var viewabilityReporters=isInApp?[new SCOPE.ViewabilityLogsReporter(reporter),new SCOPE.ViewabilityStatsReporter(reporter)]:[new SCOPE.ViewabilityStatsReporter(reporter)];var viewabilityEventsDispatcher=new SCOPE.ViewabilityEventsDispatcher(vpaidAd.irollAd.fireTrackingEvent.bind(vpaidAd.irollAd));var listener=new SCOPE.ViewabilityListener(globalCoreEventsId,viewabilityCalculator);var videoPlayer=vpaidAd.irollAd.get("videoPlayer");var adImpressionHanlder=new SCOPE.VpaidAdImpressionHandler(reporter);var manager=new SCOPE.ViewabilityManager(vpaidWrapper,listener,viewabilityCalculator,adImpressionHanlder,videoPlayer);adSizeChangeHelper.listenToSizeChange();viewabilityEventsDispatcher.observe(manager);viewabilityReporters.forEach(function(reporter){reporter.observe(manager);});var errorObserver=new IV.ViewabilityErrorObserver(globalCoreEventsId,MODULE_NAME);errorObserver.observe(manager);vpaidWrapper.subscribe(function(){SCOPE.ViewabilityIframeDetector.reportIframeType(globalCoreEventsId,contextWindow);},"AdImpression");manager.start();},SCOPE.vpaidExtensions.EXTENSION_POINTS.BEFORE_AD_LOAD);})(IV);
var IV;(function(IV){var ViewabilityReporter=(function(){function ViewabilityReporter(reporter){this.reporter=reporter;}
ViewabilityReporter.prototype.reportVP1S=function(measurableResult){this.reportViewability(IV.ViewabilityPixelEvents.EventId.VP_1S,measurableResult);};ViewabilityReporter.prototype.observe=function(observable){var _this=this;observable.onQuartile(function(eventId,result){return _this.reportViewability(eventId,result);}).onMeasurable(function(result){return _this.reportVP1S(result);}).onViewable(function(result){return _this.reportConsecutiveTime(result);});};return ViewabilityReporter;})();IV.ViewabilityReporter=ViewabilityReporter;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityAdSizeChangeHelper=(function(){function ViewabilityAdSizeChangeHelper(contextWindow,vpaidWrapper,viewabilityCalculator,fullscreenHelper){this.contextWindow=contextWindow;this.vpaidWrapper=vpaidWrapper;this.viewabilityCalculator=viewabilityCalculator;this.fullscreenHelper=fullscreenHelper;}
ViewabilityAdSizeChangeHelper.prototype.listenToSizeChange=function(){var _this=this;this.vpaidWrapper.subscribe(function(){return _this.onAdSizeChange();},"AdSizeChange",this);};ViewabilityAdSizeChangeHelper.prototype.onAdSizeChange=function(){var width=this.vpaidWrapper.getAdWidth();var height=this.vpaidWrapper.getAdHeight();this.viewabilityCalculator.toggleFullscreen(this.fullscreenHelper.isSameOrBiggerThanScreenSize(this.contextWindow,width,height));};return ViewabilityAdSizeChangeHelper;})();IV.ViewabilityAdSizeChangeHelper=ViewabilityAdSizeChangeHelper;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityConsecutiveTimeResult=(function(){function ViewabilityConsecutiveTimeResult(_checkResult,_ctTime,_ctCountThreshold,_ctFocus){this.checkResult=_checkResult;this.ctTime=_ctTime;this.ctCountThreshold=_ctCountThreshold;this.ctFocus=_ctFocus;}
ViewabilityConsecutiveTimeResult.prototype.setVolume=function(volume){this.checkResult.volume=volume;};ViewabilityConsecutiveTimeResult.prototype.toString=function(){return this.checkResult.toString()+";"+this.ctTime+";"+this.ctCountThreshold+";"+this.ctFocus;};return ViewabilityConsecutiveTimeResult;})();IV.ViewabilityConsecutiveTimeResult=ViewabilityConsecutiveTimeResult;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityErrorObserver=(function(){function ViewabilityErrorObserver(globalCoreEventsId,moduleName){this.globalCoreEventsId=globalCoreEventsId;this.moduleName=moduleName;}
Object.defineProperty(ViewabilityErrorObserver,"AD_ERROR_EVENT_NAME",{get:function(){return"ad_interface_error";},enumerable:true,configurable:true});ViewabilityErrorObserver.prototype.observe=function(observable){var _this=this;observable.onError(function(error){IV.Events.trigger(_this.globalCoreEventsId+":"+ViewabilityErrorObserver.AD_ERROR_EVENT_NAME,_this.moduleName,error);});};return ViewabilityErrorObserver;})();IV.ViewabilityErrorObserver=ViewabilityErrorObserver;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityEventsDispatcher=(function(){function ViewabilityEventsDispatcher(fireTrackingEventCb){this.fireTrackingEventCb=fireTrackingEventCb;}
ViewabilityEventsDispatcher.prototype.dispatchMeasurableEvent=function(){var _this=this;setTimeout(function(){return _this.fireTrackingEventCb("measurable");},0);};ViewabilityEventsDispatcher.prototype.dispatchViewableEvent=function(){var _this=this;setTimeout(function(){return _this.fireTrackingEventCb("viewable");},0);};ViewabilityEventsDispatcher.prototype.observe=function(observable){var _this=this;observable.onMeasurable(function(){return _this.dispatchMeasurableEvent();}).onViewable(function(){return _this.dispatchViewableEvent();});};return ViewabilityEventsDispatcher;})();IV.ViewabilityEventsDispatcher=ViewabilityEventsDispatcher;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityListener=(function(){function ViewabilityListener(globalCoreEventsId,viewabilityCalculator){this.intervalId=null;this.lastTime=0;this.accumulatedTime=0;this.paused=false;this.globalCoreEventsId=globalCoreEventsId;this.viewabilityCalculator=viewabilityCalculator;}
Object.defineProperty(ViewabilityListener,"VIEWABILITY_CHECK_INTERVAL_MS",{get:function(){return 200;},enumerable:true,configurable:true});Object.defineProperty(ViewabilityListener,"VIEWABLE_DURATION",{get:function(){return 2000;},enumerable:true,configurable:true});ViewabilityListener.prototype.checkViewability=function(viewabilityElement,adSlot,onMeasurable,onConsecutiveTime,onError){if(this.isPaused()){return;}
var currentTime=(new Date()).getTime();if(this.lastTime===0){this.lastTime=currentTime;return;}
try{var result=this.viewabilityCalculator.checkViewability(viewabilityElement,adSlot);if(result.isMeasurable()){onMeasurable(result);}
if(result.isViewable()){this.accumulatedTime+=currentTime-this.lastTime;this.lastTime=currentTime;if(this.accumulatedTime>=ViewabilityListener.VIEWABLE_DURATION){this.stop();onConsecutiveTime(new IV.ViewabilityConsecutiveTimeResult(result,this.accumulatedTime,1,result.focusState));}}
else{this.reset();}}
catch(e){onError(e);}};ViewabilityListener.prototype.start=function(viewabilityElement,adSlot,onMeasurable,onConsecutiveTime,onError){if(!this.isStarted()){var checkViewability=this.checkViewability.bind(this,viewabilityElement,adSlot,onMeasurable,onConsecutiveTime,onError);this.registerToPlayPause();checkViewability();this.intervalId=setInterval(checkViewability,ViewabilityListener.VIEWABILITY_CHECK_INTERVAL_MS);}};ViewabilityListener.prototype.resume=function(){this.paused=false;};ViewabilityListener.prototype.pause=function(){this.paused=true;this.lastTime=0;};ViewabilityListener.prototype.stop=function(){if(this.isStarted()){clearInterval(this.intervalId);this.intervalId=null;}};ViewabilityListener.prototype.reset=function(){this.accumulatedTime=0;this.lastTime=0;};ViewabilityListener.prototype.isStarted=function(){return!!this.intervalId;};ViewabilityListener.prototype.isPaused=function(){return this.paused;};ViewabilityListener.prototype.registerToPlayPause=function(){var _this=this;IV.Events.on(this.globalCoreEventsId+":video_play",function(){_this.resume();});IV.Events.on(this.globalCoreEventsId+":video_pause",function(){_this.pause();});};return ViewabilityListener;})();IV.ViewabilityListener=ViewabilityListener;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var ViewabilityLogsReporter=(function(_super){__extends(ViewabilityLogsReporter,_super);function ViewabilityLogsReporter(){_super.apply(this,arguments);}
ViewabilityLogsReporter.prototype.reportViewability=function(eventId,checkResult){this.reporter.reportLog({event_id:IV.ViewabilityPixelEvents.ACTION_NAME+"_"+eventId,event_value:checkResult.toString()});};ViewabilityLogsReporter.prototype.reportConsecutiveTime=function(consecutiveTimeResult){this.reporter.reportLog({event_id:IV.ViewabilityPixelEvents.ACTION_NAME+"_"+IV.ViewabilityPixelEvents.EventId.CONSECUTIVE_TIME,event_value:consecutiveTimeResult.toString()});};return ViewabilityLogsReporter;})(IV.ViewabilityReporter);IV.ViewabilityLogsReporter=ViewabilityLogsReporter;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityManager=(function(){function ViewabilityManager(vpaidWrapper,viewabilityListener,viewabilityCalculator,adImpressionHandler,player){this.impressionOccurred=false;this.vpaidWrapper=vpaidWrapper;this.viewabilityListener=viewabilityListener;this.viewabilityCalculator=viewabilityCalculator;this.adImpressionHandler=adImpressionHandler;this.player=player;var videoSlot=this.vpaidWrapper.getPlayer();this.adSlot=this.vpaidWrapper.getSlot();this.viewabilityElement=videoSlot!==null?videoSlot:this.adSlot;this.reportVp1sOnce=_.once(this.reportVP1S);this.reportConsecutiveTimeOnce=_.once(this.reportConsecutiveTime);this.measurableCallbacks=[];this.viewableCallbacks=[];this.quartilesCallbacks=[];this.errorCallbacks=[];}
ViewabilityManager.prototype.start=function(){var _this=this;try{this.viewabilityCalculator.initialize(this.viewabilityElement);}
catch(e){this.reportError(e);}
this.vpaidWrapper.subscribe(function(){return _this.onAdImpression();},"AdImpression",this);this.vpaidWrapper.subscribe(function(){return _this.onAdFirstQuartile();},"AdVideoFirstQuartile",this);this.vpaidWrapper.subscribe(function(){return _this.onAdMidpoint();},"AdVideoMidpoint",this);this.vpaidWrapper.subscribe(function(){return _this.onAdThirdQuartile();},"AdVideoThirdQuartile",this);this.vpaidWrapper.subscribe(function(){return _this.onAdComplete();},"AdVideoComplete",this);this.vpaidWrapper.subscribe(function(){return _this.onAdPaused();},"AdPaused",this);this.vpaidWrapper.subscribe(function(){return _this.onAdPlaying();},"AdPlaying",this);this.vpaidWrapper.subscribe(function(){return _this.onAdStopped();},"AdStopped",this);this.vpaidWrapper.subscribe(function(){return _this.onAdStopped();},"AdError",this);};ViewabilityManager.prototype.onQuartile=function(cb){this.quartilesCallbacks.push(cb);return this;};ViewabilityManager.prototype.onMeasurable=function(cb){this.measurableCallbacks.push(cb);return this;};ViewabilityManager.prototype.onViewable=function(cb){this.viewableCallbacks.push(cb);return this;};ViewabilityManager.prototype.onError=function(cb){this.errorCallbacks.push(cb);return this;};ViewabilityManager.prototype.onAdImpression=function(){var _this=this;this.adImpressionHandler.waitForImpressionPixelToBeReported(function(){_this.impressionOccurred=true;_this.checkAndReportViewability(IV.ViewabilityPixelEvents.EventId.VP_START);_this.startCheckingViewability();});};ViewabilityManager.prototype.startCheckingViewability=function(){var _this=this;this.viewabilityListener.start(this.viewabilityElement,this.adSlot,function(result){_this.reportVp1sOnce(result);},function(result){_this.reportConsecutiveTimeOnce(result);},function(e){return _this.reportError(e);});};ViewabilityManager.prototype.onAdFirstQuartile=function(){this.checkAndReportViewability(IV.ViewabilityPixelEvents.EventId.VP_FIRST_QUARTILE);};ViewabilityManager.prototype.onAdMidpoint=function(){this.checkAndReportViewability(IV.ViewabilityPixelEvents.EventId.VP_MIDPOINT);};ViewabilityManager.prototype.onAdThirdQuartile=function(){this.checkAndReportViewability(IV.ViewabilityPixelEvents.EventId.VP_THIRD_QUARTILE);};ViewabilityManager.prototype.onAdComplete=function(){var FORCE_VP1S=true;this.checkAndReportViewability(IV.ViewabilityPixelEvents.EventId.VP_COMPLETE,FORCE_VP1S);this.viewabilityListener.stop();};ViewabilityManager.prototype.onAdPaused=function(){this.viewabilityListener.pause();};ViewabilityManager.prototype.onAdPlaying=function(){this.viewabilityListener.resume();};ViewabilityManager.prototype.onAdStopped=function(){try{this.viewabilityListener.stop();if(this.impressionOccurred){var result=this.viewabilityCalculator.checkViewability(this.viewabilityElement,this.adSlot);this.reportVp1sOnce(result);}
this.viewabilityCalculator.dispose();}
catch(e){this.reportError(e);}};ViewabilityManager.prototype.checkAndReportViewability=function(eventId,forceVp1s){if(forceVp1s===void 0){forceVp1s=false;}
try{var result=this.viewabilityCalculator.checkViewability(this.viewabilityElement,this.adSlot);result.volume=this.getVolume();this.quartilesCallbacks.forEach(function(cb){return cb(eventId,result);});if(forceVp1s||result.isMeasurable()){this.reportVp1sOnce(result);}}
catch(e){this.reportError(e);}};ViewabilityManager.prototype.reportConsecutiveTime=function(result){if(this.impressionOccurred){result.setVolume(this.getVolume());this.viewableCallbacks.forEach(function(cb){return cb(result);});}};ViewabilityManager.prototype.reportVP1S=function(result){if(this.impressionOccurred){this.measurableCallbacks.forEach(function(cb){return cb(result);});}};ViewabilityManager.prototype.reportError=function(e){this.errorCallbacks.forEach(function(cb){return cb(e);});};ViewabilityManager.prototype.getVolume=function(){var volume=this.player.getVolume();return volume>=0?volume*100:0;};return ViewabilityManager;})();IV.ViewabilityManager=ViewabilityManager;})(IV||(IV={}));
;
var IV;(function(IV){var ViewabilityPixelEvents=(function(){function ViewabilityPixelEvents(){}
Object.defineProperty(ViewabilityPixelEvents,"ACTION_NAME",{get:function(){return"viewability";},enumerable:true,configurable:true});Object.defineProperty(ViewabilityPixelEvents,"EventId",{get:function(){return{VP_START:"vp000",VP_FIRST_QUARTILE:"vp025",VP_MIDPOINT:"vp050",VP_THIRD_QUARTILE:"vp075",VP_COMPLETE:"vp100",VP_1S:"vp1s",CONSECUTIVE_TIME:"consecutiveTime"};},enumerable:true,configurable:true});return ViewabilityPixelEvents;})();IV.ViewabilityPixelEvents=ViewabilityPixelEvents;})(IV||(IV={}));
var __extends=(this&&this.__extends)||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var IV;(function(IV){var ViewabilityStatsReporter=(function(_super){__extends(ViewabilityStatsReporter,_super);function ViewabilityStatsReporter(){_super.apply(this,arguments);}
ViewabilityStatsReporter.prototype.reportViewability=function(eventId,checkResult){this.reporter.submit({action:IV.ViewabilityPixelEvents.ACTION_NAME,event_id:eventId,event_value:checkResult.toString()});};ViewabilityStatsReporter.prototype.reportConsecutiveTime=function(consecutiveTimeResult){this.reporter.submit({action:IV.ViewabilityPixelEvents.ACTION_NAME,event_id:IV.ViewabilityPixelEvents.EventId.CONSECUTIVE_TIME,event_value:consecutiveTimeResult.toString()});};return ViewabilityStatsReporter;})(IV.ViewabilityReporter);IV.ViewabilityStatsReporter=ViewabilityStatsReporter;})(IV||(IV={}));
var IV;(function(IV){var DomElementUtils=(function(){function DomElementUtils(){}
Object.defineProperty(DomElementUtils,"ELEMENT_NODE_TYPE",{get:function(){return 1;},enumerable:true,configurable:true});DomElementUtils.getObjectRect=function(elem){var objRect=null;if(elem&&(elem.getClientRects||elem.getBoundingClientRect)){try{objRect=elem.getClientRects()[0];}
catch(e){objRect=elem.getBoundingClientRect();}}
return objRect;};DomElementUtils.getOverlappingArea=function(rect,elem){var playerArea=rect.width*rect.height;var xOverlap=Math.max(0,Math.min(rect.right,elem.right)-Math.max(rect.left,elem.left));var yOverlap=Math.max(0,Math.min(rect.bottom,elem.bottom)-Math.max(rect.top,elem.top));return(xOverlap*yOverlap)/playerArea;};DomElementUtils.isDomElement=function(elem){return!!(elem&&elem.nodeType===DomElementUtils.ELEMENT_NODE_TYPE);};return DomElementUtils;})();IV.DomElementUtils=DomElementUtils;})(IV||(IV={}));
var IV;(function(IV){var DomObscuringCalculator=(function(){function DomObscuringCalculator(contextDocument){this.contextDocument=contextDocument;}
DomObscuringCalculator.prototype.checkDomObscuring=function(player,adSlot){return 0;};return DomObscuringCalculator;})();IV.DomObscuringCalculator=DomObscuringCalculator;})(IV||(IV={}));
var IV;(function(IV){var FullscreenHelper=(function(){function FullscreenHelper(screenOffset){this.screenOffset=screenOffset;}
Object.defineProperty(FullscreenHelper,"FULLSCREEN_ATTRIBUTES",{get:function(){return["fullscreen","webkitIsFullScreen","mozFullScreen","msFullscreenElement","webkitFullscreenElement"];},enumerable:true,configurable:true});FullscreenHelper.prototype.isFullscreen=function(adSlot,contextWindow,friendlyIframe){var isFS=this.isDocumentFullscreen(contextWindow.document,adSlot)||this.isElementSizeFullscreen(contextWindow,adSlot);var currWindow=contextWindow;while(!isFS&&friendlyIframe&&currWindow!==currWindow.parent){currWindow=currWindow.parent;isFS=this.isDocumentFullscreen(currWindow.document);}
return isFS;};FullscreenHelper.prototype.isElementSizeFullscreen=function(contextWindow,adSlot){if(adSlot){var width=adSlot.clientWidth;var height=adSlot.clientHeight;return this.isSameOrBiggerThanScreenSize(contextWindow,width,height);}
return false;};FullscreenHelper.prototype.isSameOrBiggerThanScreenSize=function(contextWindow,width,height){var screenWidth=contextWindow.screen.width;var screenHeight=contextWindow.screen.height;return this.isScreenSizeValid(screenWidth,screenHeight)&&(this.isPortraitFullscreen(width,height,screenWidth,screenHeight)||this.isLandscapeFullscreen(width,height,screenWidth,screenHeight));};FullscreenHelper.prototype.isPortraitFullscreen=function(width,height,screenWidth,screenHeight){return width>=screenWidth-this.screenOffset&&height>=screenHeight-this.screenOffset;};FullscreenHelper.prototype.isLandscapeFullscreen=function(width,height,screenWidth,screenHeight){return width>=screenHeight-this.screenOffset&&height>=screenWidth-this.screenOffset;};FullscreenHelper.prototype.isScreenSizeValid=function(screenWidth,screenHeight){return screenWidth>0&&screenHeight>0&&screenWidth>=this.screenOffset&&screenHeight>=this.screenOffset;};FullscreenHelper.prototype.isDocumentFullscreen=function(doc,adSlot){var isFS=false;if(doc){isFS=FullscreenHelper.FULLSCREEN_ATTRIBUTES.some(function(attr){return!!doc[attr];});if(!isFS&&adSlot&&adSlot.ownerDocument){isFS=this.isDocumentFullscreen(adSlot.ownerDocument);}}
return isFS;};return FullscreenHelper;})();IV.FullscreenHelper=FullscreenHelper;})(IV||(IV={}));
var IV;(function(IV){var GeometryCalculator=(function(){function GeometryCalculator(){}
GeometryCalculator.prototype.getViewabilityState=function(elem,contextWindow){contextWindow=this.ownerWindow(elem,contextWindow);var minViewPortSize=this.getMinViewPortSize(contextWindow),viewablePercentage;if(minViewPortSize.area===Infinity){throw Error("Failed to determine viewport");}
var assetRect=IV.DomElementUtils.getObjectRect(elem);var playerArea=assetRect.width*assetRect.height;if((minViewPortSize.area/playerArea)<0.5){viewablePercentage=Math.floor(100*minViewPortSize.area/playerArea);}
var viewPortSize=this.getViewPortSize(contextWindow.top),visibleAssetSize=this.getAssetVisibleDimension(elem,contextWindow);if(visibleAssetSize.bottom<0||visibleAssetSize.right<0||visibleAssetSize.top>viewPortSize.height||visibleAssetSize.left>viewPortSize.width){viewablePercentage=0;}
else if(visibleAssetSize.left>0&&visibleAssetSize.top>0&&visibleAssetSize.bottom<viewPortSize.height&&visibleAssetSize.right<viewPortSize.width){viewablePercentage=100;}
else{if(visibleAssetSize.bottom>viewPortSize.height){visibleAssetSize.height-=(visibleAssetSize.bottom-viewPortSize.height);}
if(visibleAssetSize.top<0){visibleAssetSize.height+=visibleAssetSize.top;}
if(visibleAssetSize.left<0){visibleAssetSize.width+=visibleAssetSize.left;}
if(visibleAssetSize.right>viewPortSize.width){visibleAssetSize.width-=(visibleAssetSize.right-viewPortSize.width);}
viewablePercentage=Math.floor(100*(visibleAssetSize.width*visibleAssetSize.height)/playerArea);}
return{clientWidth:viewPortSize.width,clientHeight:viewPortSize.height,objTop:assetRect.top,objBottom:assetRect.bottom,objLeft:assetRect.left,objRight:assetRect.right,percentViewable:viewablePercentage};};GeometryCalculator.prototype.ownerWindow=function(elem,contextWindow){try{return elem.ownerDocument.defaultView!==contextWindow?elem.ownerDocument.defaultView:contextWindow;}
catch(e){return contextWindow;}};GeometryCalculator.prototype.getMinViewPortSize=function(contextWindow){var minViewPortSize=this.getViewPortSize(contextWindow),minViewPortArea=minViewPortSize.area,currentWindow=contextWindow;while(currentWindow!==currentWindow.top){currentWindow=currentWindow.parent;var viewPortSize=this.getViewPortSize(currentWindow);if(viewPortSize.area<minViewPortArea){minViewPortArea=viewPortSize.area;minViewPortSize=viewPortSize;}}
return minViewPortSize;};GeometryCalculator.prototype.getViewPortSize=function(contextWindow){var viewPortSize={width:Infinity,height:Infinity,area:Infinity};if(!isNaN(contextWindow.document.body.clientWidth)&&contextWindow.document.body.clientWidth>0){viewPortSize.width=contextWindow.document.body.clientWidth;}
if(!isNaN(contextWindow.document.body.clientHeight)&&contextWindow.document.body.clientHeight>0){viewPortSize.height=contextWindow.document.body.clientHeight;}
if(!!contextWindow.document.documentElement&&!!contextWindow.document.documentElement.clientWidth&&!isNaN(contextWindow.document.documentElement.clientWidth)){viewPortSize.width=contextWindow.document.documentElement.clientWidth;}
if(!!contextWindow.document.documentElement&&!!contextWindow.document.documentElement.clientHeight&&!isNaN(contextWindow.document.documentElement.clientHeight)){viewPortSize.height=contextWindow.document.documentElement.clientHeight;}
if(!!contextWindow.innerWidth&&!isNaN(contextWindow.innerWidth)){viewPortSize.width=Math.min(viewPortSize.width,contextWindow.innerWidth);}
if(!!contextWindow.innerHeight&&!isNaN(contextWindow.innerHeight)){viewPortSize.height=Math.min(viewPortSize.height,contextWindow.innerHeight);}
viewPortSize.area=viewPortSize.height*viewPortSize.width;return viewPortSize;};GeometryCalculator.prototype.getAssetVisibleDimension=function(elem,contextWindow){var currWindow=contextWindow;var parentWindow=contextWindow.parent;var resultDimension={width:0,height:0,left:0,right:0,top:0,bottom:0};if(elem){var elementRect=this.getPositionRelativeToViewPort(elem,contextWindow);elementRect.width=elementRect.right-elementRect.left;elementRect.height=elementRect.bottom-elementRect.top;resultDimension=elementRect;if(currWindow!==parentWindow){var parentDimension=this.getAssetVisibleDimension(currWindow.frameElement,parentWindow);if(parentDimension.bottom<resultDimension.bottom){if(parentDimension.bottom<resultDimension.top){resultDimension.top=parentDimension.bottom;}
resultDimension.bottom=parentDimension.bottom;}
if(parentDimension.right<resultDimension.right){if(parentDimension.right<resultDimension.left){resultDimension.left=parentDimension.right;}
resultDimension.right=parentDimension.right;}
resultDimension.width=resultDimension.right-resultDimension.left;resultDimension.height=resultDimension.bottom-resultDimension.top;}}
return resultDimension;};GeometryCalculator.prototype.getPositionRelativeToViewPort=function(elem,contextWindow){var currWindow=contextWindow;var parentWindow=contextWindow.parent;var resultPosition={left:0,right:0,top:0,bottom:0};if(elem){if(currWindow!==parentWindow){resultPosition=this.getPositionRelativeToViewPort(currWindow.frameElement,parentWindow);}
else{var elementRect=IV.DomElementUtils.getObjectRect(elem);resultPosition={left:elementRect.left+resultPosition.left,right:elementRect.right+resultPosition.left,top:elementRect.top+resultPosition.top,bottom:elementRect.bottom+resultPosition.top};}}
return resultPosition;};return GeometryCalculator;})();IV.GeometryCalculator=GeometryCalculator;})(IV||(IV={}));
var IV;(function(IV){var IntersectionObserverCalculator=(function(){function IntersectionObserverCalculator(checkResult){var _this=this;this.observationCallback=function(changes){changes.forEach(function(change){_this.updateCheckObject(change);});};var thresholds=this.setThresholds(IntersectionObserverCalculator.IO_THRESHOLD_RESOLUTION);this._check=checkResult.clone();if(typeof window.IntersectionObserver!=="undefined"){this._observer=new window.IntersectionObserver(this.observationCallback,{threshold:thresholds});this.initializeViewabilityCheckResultForIO();}}
Object.defineProperty(IntersectionObserverCalculator,"IO_THRESHOLD_RESOLUTION",{get:function(){return 0.05;},enumerable:true,configurable:true});IntersectionObserverCalculator.prototype.isSupported=function(){return!!this._observer;};IntersectionObserverCalculator.prototype.observeAd=function(adElement){if(this._adElement===adElement){return;}
this._adElement=adElement;if(this.isSupported()){this._observer.observe(this._adElement);}};IntersectionObserverCalculator.prototype.disconnect=function(){this._observer.disconnect();};IntersectionObserverCalculator.prototype.checkViewability=function(){return this._check.clone();};IntersectionObserverCalculator.prototype.setThresholds=function(resolution){var thresholdLevel=0,thresholds=[];for(var i=0;i<=(1/resolution);i++){thresholds[i]=parseFloat(thresholdLevel.toFixed(2));thresholdLevel+=resolution;}
return thresholds;};IntersectionObserverCalculator.prototype.updateCheckObject=function(intersectionObserverCheck){var targetWidth=intersectionObserverCheck.boundingClientRect.right-intersectionObserverCheck.boundingClientRect.left;var targetHeight=intersectionObserverCheck.boundingClientRect.bottom-intersectionObserverCheck.boundingClientRect.top;this._check=this._check.clone();this._check.viewablePercentage=100*intersectionObserverCheck.intersectionRatio;if(targetWidth>0&&targetHeight>0){this._check.playerRectangle=new IV.PlayerRectangle(intersectionObserverCheck.boundingClientRect.left,intersectionObserverCheck.boundingClientRect.top,targetWidth,targetHeight);}
if(intersectionObserverCheck.rootBounds){this._check.clientDimensions=new IV.ClientDimensions(intersectionObserverCheck.rootBounds.width,intersectionObserverCheck.rootBounds.height);}
else{this._check.clientDimensions=new IV.ClientDimensions(targetWidth,targetHeight);}};IntersectionObserverCalculator.prototype.initializeViewabilityCheckResultForIO=function(){this._check.checkMethod=IV.ViewabilityCheckResult.CheckMethod.IO;this._check.status=IV.ViewabilityCheckResult.Status.OK;};return IntersectionObserverCalculator;})();IV.IntersectionObserverCalculator=IntersectionObserverCalculator;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityCalculator=(function(){function ViewabilityCalculator(contextWindow,defaultCheckObj,geometryCalculator,intersectionObserverCalculator,domObscuringCalculator,fullscreenHelper){this.forceFullscreen=false;this.contextWindow=contextWindow;this.defaultCheckObj=defaultCheckObj;this.geometryCalculator=geometryCalculator;this.intersectionObserverCalculator=intersectionObserverCalculator;this.domObscuringCalculator=domObscuringCalculator;this.fullscreenHelper=fullscreenHelper;}
ViewabilityCalculator.prototype.initialize=function(player){this.intersectionObserverCalculator.observeAd(player);};ViewabilityCalculator.prototype.checkViewability=function(player,adSlot){var check=this.defaultCheckObj.clone();var adSlotRect=IV.DomElementUtils.getObjectRect(adSlot);if(adSlotRect){check.clientDimensions=this.getClientDimensions(adSlotRect.width,adSlotRect.height);check.playerRectangle=new IV.PlayerRectangle(adSlotRect.left,adSlotRect.top,adSlotRect.width,adSlotRect.height);}
if(IV.DomElementUtils.isDomElement(player)){if(IV.FeatureBitsResolver.isEnabled(IV.FeatureBitsResolver.FEATURE_NAMES.VPAID_VIEWABILITY_GEO_FRIENDLY_IFRAME)){check=this.checkGeometry(player,this.checkIntersectionObserver(player,this.checkFullScreen(adSlot,this.checkDomObscuring(player,adSlot,this.checkCssInvisibility(player,check)))));}
else{check=this.checkIntersectionObserver(player,this.checkGeometry(player,this.checkFullScreen(adSlot,this.checkDomObscuring(player,adSlot,this.checkCssInvisibility(player,check)))));}}
if(check.checkMethod!==IV.ViewabilityCheckResult.CheckMethod.FULL_SCREEN){check.focusState=this.isInFocus(adSlot)?IV.ViewabilityCheckResult.FocusState.ON:IV.ViewabilityCheckResult.FocusState.OFF;}
check.iframeState=IV.ViewabilityIframeDetector.isIframe(this.contextWindow)?IV.ViewabilityCheckResult.IFrameState.IN_IFRAME:IV.ViewabilityCheckResult.IFrameState.NOT_IN_IFRAME;if(IV.ViewabilityIframeDetector.isIframe(this.contextWindow)&&check.checkMethod===IV.ViewabilityCheckResult.CheckMethod.NONE){check.status=IV.ViewabilityCheckResult.Status.IN_IFRAME;}
return check;};ViewabilityCalculator.prototype.dispose=function(){this.intersectionObserverCalculator.disconnect();};ViewabilityCalculator.prototype.checkGeometry=function(player,check){if(check.checkMethod!==IV.ViewabilityCheckResult.CheckMethod.NONE){return check;}
if(IV.FeatureBitsResolver.isEnabled(IV.FeatureBitsResolver.FEATURE_NAMES.VPAID_VIEWABILITY_GEO_FRIENDLY_IFRAME)){if(IV.ViewabilityIframeDetector.isCrossdomainIframe(this.contextWindow)){return check;}}
else{if(IV.ViewabilityIframeDetector.isIframe(this.contextWindow)){return check;}}
var originalCheck=check.clone();try{var viewabilityResult=this.geometryCalculator.getViewabilityState(player,this.contextWindow);check.checkMethod=IV.ViewabilityCheckResult.CheckMethod.GEOMETRY;check.status=IV.ViewabilityCheckResult.Status.OK;if(viewabilityResult.objRight>viewabilityResult.objLeft&&viewabilityResult.objBottom>viewabilityResult.objTop){check.playerRectangle=new IV.PlayerRectangle(viewabilityResult.objLeft,viewabilityResult.objTop,viewabilityResult.objBottom-viewabilityResult.objTop,viewabilityResult.objRight-viewabilityResult.objLeft);}
check.clientDimensions=new IV.ClientDimensions(viewabilityResult.clientWidth,viewabilityResult.clientHeight);check.viewablePercentage=viewabilityResult.percentViewable-check.percentObscured;return check;}
catch(ignore){}
return originalCheck;};ViewabilityCalculator.prototype.checkIntersectionObserver=function(player,check){if(check.checkMethod!==IV.ViewabilityCheckResult.CheckMethod.NONE||!this.intersectionObserverCalculator.isSupported()){return check;}
var originalCheck=check.clone();try{this.intersectionObserverCalculator.observeAd(player);return this.intersectionObserverCalculator.checkViewability();}
catch(ignore){}
return originalCheck;};ViewabilityCalculator.prototype.checkFullScreen=function(adSlot,check){var originalCheck=check.clone();try{if(this.isFullScreen(adSlot)){check.status=IV.ViewabilityCheckResult.Status.OK;check.checkMethod=IV.ViewabilityCheckResult.CheckMethod.FULL_SCREEN;check.viewablePercentage=100;check.playerRectangle=new IV.PlayerRectangle(0,0,this.contextWindow.screen.width,this.contextWindow.screen.height);check.focusState=IV.ViewabilityCheckResult.FocusState.ON;}
return check;}
catch(ignore){}
return originalCheck;};ViewabilityCalculator.prototype.checkCssInvisibility=function(player,check){var originalCheck=check.clone();try{var style=this.contextWindow.getComputedStyle(player,null);var visibility=style.getPropertyValue("visibility");var display=style.getPropertyValue("display");if(visibility==="hidden"||display==="none"){check.checkMethod=IV.ViewabilityCheckResult.CheckMethod.CSS_INVISIBILITY;check.status=IV.ViewabilityCheckResult.Status.OK;check.viewablePercentage=0;}
return check;}
catch(ignore){}
return originalCheck;};ViewabilityCalculator.prototype.checkDomObscuring=function(player,adSlot,check){var originalCheck=check.clone();try{check.percentObscured=this.domObscuringCalculator.checkDomObscuring(player,adSlot);if(check.percentObscured>50){check.viewablePercentage=100-check.percentObscured;check.checkMethod=IV.ViewabilityCheckResult.CheckMethod.DOM_OBSCURING;check.status=IV.ViewabilityCheckResult.Status.OK;return check;}
return check;}
catch(ignore){}
return originalCheck;};ViewabilityCalculator.prototype.isFullScreen=function(adSlot){return this.forceFullscreen||this.fullscreenHelper.isFullscreen(adSlot,this.contextWindow,IV.ViewabilityIframeDetector.isIframe(this.contextWindow)?!IV.ViewabilityIframeDetector.isCrossdomainIframe(this.contextWindow):true);};ViewabilityCalculator.prototype.isInFocus=function(adSlot){if(adSlot&&adSlot.ownerDocument&&typeof adSlot.ownerDocument.hidden!=="undefined"){if(adSlot.ownerDocument.hidden===true){return false;}}
if(IV.ViewabilityIframeDetector.isCrossdomainIframe(this.contextWindow)){return true;}
if(this.contextWindow.top.document.hasFocus){return this.contextWindow.top.document.hasFocus();}
return true;};ViewabilityCalculator.prototype.getClientDimensions=function(fallbackWidth,fallbackHeight){var clientDimensions=new IV.ClientDimensions(0,0);var contextDocument=this.contextWindow.document;if(!IV.ViewabilityIframeDetector.isCrossdomainIframe(this.contextWindow)){var topDoc=this.contextWindow.top.document;clientDimensions=new IV.ClientDimensions(topDoc.body.clientWidth,topDoc.body.clientHeight);}
else if(contextDocument.body.clientWidth&&contextDocument.body.clientHeight){clientDimensions=new IV.ClientDimensions(contextDocument.body.clientWidth,contextDocument.body.clientHeight);}
else{clientDimensions=new IV.ClientDimensions(fallbackWidth,fallbackHeight);}
return clientDimensions;};ViewabilityCalculator.prototype.toggleFullscreen=function(isFullscreen){this.forceFullscreen=isFullscreen;};return ViewabilityCalculator;})();IV.ViewabilityCalculator=ViewabilityCalculator;})(IV||(IV={}));
var IV;(function(IV){var IntegerUtils=(function(){function IntegerUtils(){}
IntegerUtils.toInteger=function(num){if(isNaN(num)){return 0;}
else{return num|0;}};return IntegerUtils;})();var ClientDimensions=(function(){function ClientDimensions(_width,_height){this._width=IntegerUtils.toInteger(_width);this._height=IntegerUtils.toInteger(_height);}
ClientDimensions.prototype.toString=function(){return this._width+","+this._height;};ClientDimensions.prototype.clone=function(){return new ClientDimensions(this._width,this._height);};return ClientDimensions;})();IV.ClientDimensions=ClientDimensions;var PlayerRectangle=(function(){function PlayerRectangle(_left,_top,_width,_height){this._left=IntegerUtils.toInteger(_left);this._top=IntegerUtils.toInteger(_top);this._width=IntegerUtils.toInteger(_width);this._height=IntegerUtils.toInteger(_height);}
PlayerRectangle.prototype.toString=function(){return this._left+","+this._top+","+this._width+","+this._height;};PlayerRectangle.prototype.clone=function(){return new PlayerRectangle(this._left,this._top,this._width,this._height);};return PlayerRectangle;})();IV.PlayerRectangle=PlayerRectangle;var ViewabilityCheckResult=(function(){function ViewabilityCheckResult(_status,_checkMethod,_viewablePercentage,_clientDimensions,_playerRectangle,_focusState,_volume,_iframeState){if(_status===void 0){_status=ViewabilityCheckResult.Status.UNKNOWN;}
if(_checkMethod===void 0){_checkMethod=ViewabilityCheckResult.CheckMethod.NONE;}
if(_viewablePercentage===void 0){_viewablePercentage=0;}
if(_clientDimensions===void 0){_clientDimensions=new ClientDimensions(0,0);}
if(_playerRectangle===void 0){_playerRectangle=new PlayerRectangle(0,0,0,0);}
if(_focusState===void 0){_focusState=ViewabilityCheckResult.FocusState.OFF;}
if(_volume===void 0){_volume=0;}
if(_iframeState===void 0){_iframeState=ViewabilityCheckResult.IFrameState.NOT_IN_IFRAME;}
this.status=ViewabilityCheckResult.Status.UNKNOWN;this.viewablePercentage=0;this.clientDimensions=new ClientDimensions(0,0);this.playerRectangle=new PlayerRectangle(0,0,0,0);this.focusState=ViewabilityCheckResult.FocusState.OFF;this.volume=0;this.checkMethod=ViewabilityCheckResult.CheckMethod.NONE;this.iframeState=ViewabilityCheckResult.IFrameState.NOT_IN_IFRAME;this.percentObscured=0;this.status=_status;this.viewablePercentage=_viewablePercentage;this.clientDimensions=_clientDimensions;this.playerRectangle=_playerRectangle;this.focusState=_focusState;this.volume=_volume;this.checkMethod=_checkMethod;this.iframeState=_iframeState;this.percentObscured=0;}
Object.defineProperty(ViewabilityCheckResult,"Status",{get:function(){return{OK:1,NO_ACCESS:-1,PLAYER_NOT_FOUND:-2,IN_IFRAME:-3,UNKNOWN:-4};},enumerable:true,configurable:true});Object.defineProperty(ViewabilityCheckResult,"CheckMethod",{get:function(){return{NONE:-1,GEOMETRY:0,BEACON:1,IO:2,CSS_INVISIBILITY:3,DOM_OBSCURING:4,FULL_SCREEN:5};},enumerable:true,configurable:true});Object.defineProperty(ViewabilityCheckResult,"FocusState",{get:function(){return{OFF:0,ON:1};},enumerable:true,configurable:true});Object.defineProperty(ViewabilityCheckResult,"IFrameState",{get:function(){return{NOT_IN_IFRAME:0,IN_IFRAME:1};},enumerable:true,configurable:true});Object.defineProperty(ViewabilityCheckResult,"VIEWABLE_PERCENTAGE",{get:function(){return 50;},enumerable:true,configurable:true});ViewabilityCheckResult.prototype.toString=function(){return(this.status+";")+
(IntegerUtils.toInteger(this.viewablePercentage)+";")+
(this.clientDimensions.toString()+";")+
(this.playerRectangle.toString()+";")+
(this.focusState+";")+
(IntegerUtils.toInteger(this.volume)+";")+"1;"+
(this.checkMethod+";")+
(""+this.iframeState);};ViewabilityCheckResult.prototype.clone=function(){var clientDimensions=this.clientDimensions?this.clientDimensions.clone():this.clientDimensions;var playerRectangle=this.playerRectangle?this.playerRectangle.clone():this.playerRectangle;return new ViewabilityCheckResult(this.status,this.checkMethod,this.viewablePercentage,clientDimensions,playerRectangle,this.focusState,this.volume,this.iframeState);};ViewabilityCheckResult.prototype.isMeasurable=function(){return this.status===ViewabilityCheckResult.Status.OK;};ViewabilityCheckResult.prototype.isViewable=function(){return this.isMeasurable()&&this.isInViewableSpace()&&this.isInFocus();};ViewabilityCheckResult.prototype.isInViewableSpace=function(){return this.viewablePercentage>=ViewabilityCheckResult.VIEWABLE_PERCENTAGE;};ViewabilityCheckResult.prototype.isInFocus=function(){return this.focusState===ViewabilityCheckResult.FocusState.ON;};return ViewabilityCheckResult;})();IV.ViewabilityCheckResult=ViewabilityCheckResult;})(IV||(IV={}));
var IV;(function(IV){var ViewabilityIframeDetector=(function(){function ViewabilityIframeDetector(){}
Object.defineProperty(ViewabilityIframeDetector,"IFRAME_TYPE_EVENT_ID",{get:function(){return"viewability_iframe_type";},enumerable:true,configurable:true});Object.defineProperty(ViewabilityIframeDetector,"IFRAME_TYPES",{get:function(){return{FRIENDLY:"friendly",NON_FRIENDLY:"non_friendly",INLINE:"inline"};},enumerable:true,configurable:true});ViewabilityIframeDetector.isIframe=function(contextWindow){return contextWindow.top!==contextWindow;};ViewabilityIframeDetector.isCrossdomainIframe=function(contextWindow){var contextDocument=contextWindow.document;try{var referrerDomain=this.getDomainFromFullUrl(contextDocument.referrer);if(!ViewabilityIframeDetector.isIframe(contextWindow)){return false;}
else if(referrerDomain&&contextDocument.domain&&contextDocument.domain!==referrerDomain){return true;}
else if(contextWindow.top.document.domain===contextWindow.document.domain){return false;}}
catch(ignore){}
return true;};ViewabilityIframeDetector.reportIframeType=function(globalCoreEventsId,contextWindow){var detector={isFriendly:function(){return ViewabilityIframeDetector.isIframe(contextWindow)&&!ViewabilityIframeDetector.isCrossdomainIframe(contextWindow);},isInline:function(){return!ViewabilityIframeDetector.isIframe(contextWindow);}};var iframeType=detector.isInline()?ViewabilityIframeDetector.IFRAME_TYPES.INLINE:(detector.isFriendly()?ViewabilityIframeDetector.IFRAME_TYPES.FRIENDLY:ViewabilityIframeDetector.IFRAME_TYPES.NON_FRIENDLY);IV.Events.trigger(globalCoreEventsId+":"+ViewabilityIframeDetector.IFRAME_TYPE_EVENT_ID,iframeType);};ViewabilityIframeDetector.getDomainFromFullUrl=function(url){if(url){var a=document.createElement("a");a.href=url;return a.hostname;}
return null;};return ViewabilityIframeDetector;})();IV.ViewabilityIframeDetector=ViewabilityIframeDetector;})(IV||(IV={}));
